<!DOCTYPE html>
<!-- saved from url=(0098)https://thepoorengineer.com/en/category/projects/attitude-determination-with-quaternion-using-ekf/ -->
<html lang="en-GB"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">

<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="profile" href="https://gmpg.org/xfn/11">
<link rel="pingback" href="https://thepoorengineer.com/xmlrpc.php">

<meta name="robots" content="index, follow, max-image-preview:large, max-snippet:-1, max-video-preview:-1">

	<!-- This site is optimized with the Yoast SEO plugin v18.0 - https://yoast.com/wordpress/plugins/seo/ -->
	<title>Attitude Determination with Quaternion using Extended Kalman Filter Archives - ThePoorEngineer</title>
	<link rel="canonical" href="https://thepoorengineer.com/en/category/projects/attitude-determination-with-quaternion-using-ekf/">
	<meta property="og:locale" content="en_GB">
	<meta property="og:type" content="article">
	<meta property="og:title" content="Attitude Determination with Quaternion using Extended Kalman Filter Archives - ThePoorEngineer">
	<meta property="og:url" content="https://thepoorengineer.com/en/category/projects/attitude-determination-with-quaternion-using-ekf/">
	<meta property="og:site_name" content="ThePoorEngineer">
	<meta name="twitter:card" content="summary">
	<script type="text/javascript" async="" src="./Attitude Determination with Quaternion using Extended Kalman Filter Archives - ThePoorEngineer_files/recaptcha__en.js.download" crossorigin="anonymous" integrity="sha384-YOM1VjUkAnOtLKpWHvk6KSrYAoLEkaoPuep5VFiDATRna5swsN03dxDH51fiq3/H"></script><script type="application/ld+json" class="yoast-schema-graph">{"@context":"https://schema.org","@graph":[{"@type":"WebSite","@id":"https://thepoorengineer.com/en/6-2/#website","url":"https://thepoorengineer.com/en/6-2/","name":"ThePoorEngineer","description":"Working hard to be lazy","potentialAction":[{"@type":"SearchAction","target":{"@type":"EntryPoint","urlTemplate":"https://thepoorengineer.com/en/6-2/?s={search_term_string}"},"query-input":"required name=search_term_string"}],"inLanguage":"en-GB"},{"@type":"CollectionPage","@id":"https://thepoorengineer.com/en/category/projects/attitude-determination-with-quaternion-using-ekf/#webpage","url":"https://thepoorengineer.com/en/category/projects/attitude-determination-with-quaternion-using-ekf/","name":"Attitude Determination with Quaternion using Extended Kalman Filter Archives - ThePoorEngineer","isPartOf":{"@id":"https://thepoorengineer.com/en/6-2/#website"},"breadcrumb":{"@id":"https://thepoorengineer.com/en/category/projects/attitude-determination-with-quaternion-using-ekf/#breadcrumb"},"inLanguage":"en-GB","potentialAction":[{"@type":"ReadAction","target":["https://thepoorengineer.com/en/category/projects/attitude-determination-with-quaternion-using-ekf/"]}]},{"@type":"BreadcrumbList","@id":"https://thepoorengineer.com/en/category/projects/attitude-determination-with-quaternion-using-ekf/#breadcrumb","itemListElement":[{"@type":"ListItem","position":1,"name":"Home","item":"https://thepoorengineer.com/en/6-2/"},{"@type":"ListItem","position":2,"name":"PROJECTS","item":"https://thepoorengineer.com/en/category/projects/"},{"@type":"ListItem","position":3,"name":"Attitude Determination with Quaternion using Extended Kalman Filter"}]}]}</script>
	<!-- / Yoast SEO plugin. -->


<link rel="dns-prefetch" href="https://www.google.com/">
<link rel="dns-prefetch" href="https://fonts.googleapis.com/">
<link rel="dns-prefetch" href="https://s.w.org/">
<link rel="alternate" type="application/rss+xml" title="ThePoorEngineer » Feed" href="https://thepoorengineer.com/en/feed/">
<link rel="alternate" type="application/rss+xml" title="ThePoorEngineer » Comments Feed" href="https://thepoorengineer.com/en/comments/feed/">
<link rel="alternate" type="application/rss+xml" title="ThePoorEngineer » Attitude Determination with Quaternion using Extended Kalman Filter Category Feed" href="https://thepoorengineer.com/en/category/projects/attitude-determination-with-quaternion-using-ekf/feed/">
<script type="text/javascript">
window._wpemojiSettings = {"baseUrl":"https:\/\/s.w.org\/images\/core\/emoji\/13.1.0\/72x72\/","ext":".png","svgUrl":"https:\/\/s.w.org\/images\/core\/emoji\/13.1.0\/svg\/","svgExt":".svg","source":{"concatemoji":"https:\/\/thepoorengineer.com\/wp-includes\/js\/wp-emoji-release.min.js?ver=5.9"}};
/*! This file is auto-generated */
!function(e,a,t){var n,r,o,i=a.createElement("canvas"),p=i.getContext&&i.getContext("2d");function s(e,t){var a=String.fromCharCode;p.clearRect(0,0,i.width,i.height),p.fillText(a.apply(this,e),0,0);e=i.toDataURL();return p.clearRect(0,0,i.width,i.height),p.fillText(a.apply(this,t),0,0),e===i.toDataURL()}function c(e){var t=a.createElement("script");t.src=e,t.defer=t.type="text/javascript",a.getElementsByTagName("head")[0].appendChild(t)}for(o=Array("flag","emoji"),t.supports={everything:!0,everythingExceptFlag:!0},r=0;r<o.length;r++)t.supports[o[r]]=function(e){if(!p||!p.fillText)return!1;switch(p.textBaseline="top",p.font="600 32px Arial",e){case"flag":return s([127987,65039,8205,9895,65039],[127987,65039,8203,9895,65039])?!1:!s([55356,56826,55356,56819],[55356,56826,8203,55356,56819])&&!s([55356,57332,56128,56423,56128,56418,56128,56421,56128,56430,56128,56423,56128,56447],[55356,57332,8203,56128,56423,8203,56128,56418,8203,56128,56421,8203,56128,56430,8203,56128,56423,8203,56128,56447]);case"emoji":return!s([10084,65039,8205,55357,56613],[10084,65039,8203,55357,56613])}return!1}(o[r]),t.supports.everything=t.supports.everything&&t.supports[o[r]],"flag"!==o[r]&&(t.supports.everythingExceptFlag=t.supports.everythingExceptFlag&&t.supports[o[r]]);t.supports.everythingExceptFlag=t.supports.everythingExceptFlag&&!t.supports.flag,t.DOMReady=!1,t.readyCallback=function(){t.DOMReady=!0},t.supports.everything||(n=function(){t.readyCallback()},a.addEventListener?(a.addEventListener("DOMContentLoaded",n,!1),e.addEventListener("load",n,!1)):(e.attachEvent("onload",n),a.attachEvent("onreadystatechange",function(){"complete"===a.readyState&&t.readyCallback()})),(n=t.source||{}).concatemoji?c(n.concatemoji):n.wpemoji&&n.twemoji&&(c(n.twemoji),c(n.wpemoji)))}(window,document,window._wpemojiSettings);
</script><script src="./Attitude Determination with Quaternion using Extended Kalman Filter Archives - ThePoorEngineer_files/wp-emoji-release.min.js.download" type="text/javascript" defer=""></script>
<style type="text/css">
img.wp-smiley,
img.emoji {
	display: inline !important;
	border: none !important;
	box-shadow: none !important;
	height: 1em !important;
	width: 1em !important;
	margin: 0 0.07em !important;
	vertical-align: -0.1em !important;
	background: none !important;
	padding: 0 !important;
}
</style>
	<link rel="stylesheet" id="wp-block-library-css" href="./Attitude Determination with Quaternion using Extended Kalman Filter Archives - ThePoorEngineer_files/style.min.css" type="text/css" media="all">
<style id="global-styles-inline-css" type="text/css">
body{--wp--preset--color--black: #000000;--wp--preset--color--cyan-bluish-gray: #abb8c3;--wp--preset--color--white: #ffffff;--wp--preset--color--pale-pink: #f78da7;--wp--preset--color--vivid-red: #cf2e2e;--wp--preset--color--luminous-vivid-orange: #ff6900;--wp--preset--color--luminous-vivid-amber: #fcb900;--wp--preset--color--light-green-cyan: #7bdcb5;--wp--preset--color--vivid-green-cyan: #00d084;--wp--preset--color--pale-cyan-blue: #8ed1fc;--wp--preset--color--vivid-cyan-blue: #0693e3;--wp--preset--color--vivid-purple: #9b51e0;--wp--preset--gradient--vivid-cyan-blue-to-vivid-purple: linear-gradient(135deg,rgba(6,147,227,1) 0%,rgb(155,81,224) 100%);--wp--preset--gradient--light-green-cyan-to-vivid-green-cyan: linear-gradient(135deg,rgb(122,220,180) 0%,rgb(0,208,130) 100%);--wp--preset--gradient--luminous-vivid-amber-to-luminous-vivid-orange: linear-gradient(135deg,rgba(252,185,0,1) 0%,rgba(255,105,0,1) 100%);--wp--preset--gradient--luminous-vivid-orange-to-vivid-red: linear-gradient(135deg,rgba(255,105,0,1) 0%,rgb(207,46,46) 100%);--wp--preset--gradient--very-light-gray-to-cyan-bluish-gray: linear-gradient(135deg,rgb(238,238,238) 0%,rgb(169,184,195) 100%);--wp--preset--gradient--cool-to-warm-spectrum: linear-gradient(135deg,rgb(74,234,220) 0%,rgb(151,120,209) 20%,rgb(207,42,186) 40%,rgb(238,44,130) 60%,rgb(251,105,98) 80%,rgb(254,248,76) 100%);--wp--preset--gradient--blush-light-purple: linear-gradient(135deg,rgb(255,206,236) 0%,rgb(152,150,240) 100%);--wp--preset--gradient--blush-bordeaux: linear-gradient(135deg,rgb(254,205,165) 0%,rgb(254,45,45) 50%,rgb(107,0,62) 100%);--wp--preset--gradient--luminous-dusk: linear-gradient(135deg,rgb(255,203,112) 0%,rgb(199,81,192) 50%,rgb(65,88,208) 100%);--wp--preset--gradient--pale-ocean: linear-gradient(135deg,rgb(255,245,203) 0%,rgb(182,227,212) 50%,rgb(51,167,181) 100%);--wp--preset--gradient--electric-grass: linear-gradient(135deg,rgb(202,248,128) 0%,rgb(113,206,126) 100%);--wp--preset--gradient--midnight: linear-gradient(135deg,rgb(2,3,129) 0%,rgb(40,116,252) 100%);--wp--preset--duotone--dark-grayscale: url('#wp-duotone-dark-grayscale');--wp--preset--duotone--grayscale: url('#wp-duotone-grayscale');--wp--preset--duotone--purple-yellow: url('#wp-duotone-purple-yellow');--wp--preset--duotone--blue-red: url('#wp-duotone-blue-red');--wp--preset--duotone--midnight: url('#wp-duotone-midnight');--wp--preset--duotone--magenta-yellow: url('#wp-duotone-magenta-yellow');--wp--preset--duotone--purple-green: url('#wp-duotone-purple-green');--wp--preset--duotone--blue-orange: url('#wp-duotone-blue-orange');--wp--preset--font-size--small: 13px;--wp--preset--font-size--medium: 20px;--wp--preset--font-size--large: 36px;--wp--preset--font-size--x-large: 42px;}.has-black-color{color: var(--wp--preset--color--black) !important;}.has-cyan-bluish-gray-color{color: var(--wp--preset--color--cyan-bluish-gray) !important;}.has-white-color{color: var(--wp--preset--color--white) !important;}.has-pale-pink-color{color: var(--wp--preset--color--pale-pink) !important;}.has-vivid-red-color{color: var(--wp--preset--color--vivid-red) !important;}.has-luminous-vivid-orange-color{color: var(--wp--preset--color--luminous-vivid-orange) !important;}.has-luminous-vivid-amber-color{color: var(--wp--preset--color--luminous-vivid-amber) !important;}.has-light-green-cyan-color{color: var(--wp--preset--color--light-green-cyan) !important;}.has-vivid-green-cyan-color{color: var(--wp--preset--color--vivid-green-cyan) !important;}.has-pale-cyan-blue-color{color: var(--wp--preset--color--pale-cyan-blue) !important;}.has-vivid-cyan-blue-color{color: var(--wp--preset--color--vivid-cyan-blue) !important;}.has-vivid-purple-color{color: var(--wp--preset--color--vivid-purple) !important;}.has-black-background-color{background-color: var(--wp--preset--color--black) !important;}.has-cyan-bluish-gray-background-color{background-color: var(--wp--preset--color--cyan-bluish-gray) !important;}.has-white-background-color{background-color: var(--wp--preset--color--white) !important;}.has-pale-pink-background-color{background-color: var(--wp--preset--color--pale-pink) !important;}.has-vivid-red-background-color{background-color: var(--wp--preset--color--vivid-red) !important;}.has-luminous-vivid-orange-background-color{background-color: var(--wp--preset--color--luminous-vivid-orange) !important;}.has-luminous-vivid-amber-background-color{background-color: var(--wp--preset--color--luminous-vivid-amber) !important;}.has-light-green-cyan-background-color{background-color: var(--wp--preset--color--light-green-cyan) !important;}.has-vivid-green-cyan-background-color{background-color: var(--wp--preset--color--vivid-green-cyan) !important;}.has-pale-cyan-blue-background-color{background-color: var(--wp--preset--color--pale-cyan-blue) !important;}.has-vivid-cyan-blue-background-color{background-color: var(--wp--preset--color--vivid-cyan-blue) !important;}.has-vivid-purple-background-color{background-color: var(--wp--preset--color--vivid-purple) !important;}.has-black-border-color{border-color: var(--wp--preset--color--black) !important;}.has-cyan-bluish-gray-border-color{border-color: var(--wp--preset--color--cyan-bluish-gray) !important;}.has-white-border-color{border-color: var(--wp--preset--color--white) !important;}.has-pale-pink-border-color{border-color: var(--wp--preset--color--pale-pink) !important;}.has-vivid-red-border-color{border-color: var(--wp--preset--color--vivid-red) !important;}.has-luminous-vivid-orange-border-color{border-color: var(--wp--preset--color--luminous-vivid-orange) !important;}.has-luminous-vivid-amber-border-color{border-color: var(--wp--preset--color--luminous-vivid-amber) !important;}.has-light-green-cyan-border-color{border-color: var(--wp--preset--color--light-green-cyan) !important;}.has-vivid-green-cyan-border-color{border-color: var(--wp--preset--color--vivid-green-cyan) !important;}.has-pale-cyan-blue-border-color{border-color: var(--wp--preset--color--pale-cyan-blue) !important;}.has-vivid-cyan-blue-border-color{border-color: var(--wp--preset--color--vivid-cyan-blue) !important;}.has-vivid-purple-border-color{border-color: var(--wp--preset--color--vivid-purple) !important;}.has-vivid-cyan-blue-to-vivid-purple-gradient-background{background: var(--wp--preset--gradient--vivid-cyan-blue-to-vivid-purple) !important;}.has-light-green-cyan-to-vivid-green-cyan-gradient-background{background: var(--wp--preset--gradient--light-green-cyan-to-vivid-green-cyan) !important;}.has-luminous-vivid-amber-to-luminous-vivid-orange-gradient-background{background: var(--wp--preset--gradient--luminous-vivid-amber-to-luminous-vivid-orange) !important;}.has-luminous-vivid-orange-to-vivid-red-gradient-background{background: var(--wp--preset--gradient--luminous-vivid-orange-to-vivid-red) !important;}.has-very-light-gray-to-cyan-bluish-gray-gradient-background{background: var(--wp--preset--gradient--very-light-gray-to-cyan-bluish-gray) !important;}.has-cool-to-warm-spectrum-gradient-background{background: var(--wp--preset--gradient--cool-to-warm-spectrum) !important;}.has-blush-light-purple-gradient-background{background: var(--wp--preset--gradient--blush-light-purple) !important;}.has-blush-bordeaux-gradient-background{background: var(--wp--preset--gradient--blush-bordeaux) !important;}.has-luminous-dusk-gradient-background{background: var(--wp--preset--gradient--luminous-dusk) !important;}.has-pale-ocean-gradient-background{background: var(--wp--preset--gradient--pale-ocean) !important;}.has-electric-grass-gradient-background{background: var(--wp--preset--gradient--electric-grass) !important;}.has-midnight-gradient-background{background: var(--wp--preset--gradient--midnight) !important;}.has-small-font-size{font-size: var(--wp--preset--font-size--small) !important;}.has-medium-font-size{font-size: var(--wp--preset--font-size--medium) !important;}.has-large-font-size{font-size: var(--wp--preset--font-size--large) !important;}.has-x-large-font-size{font-size: var(--wp--preset--font-size--x-large) !important;}
</style>
<link rel="stylesheet" id="apss-font-awesome-four-css" href="./Attitude Determination with Quaternion using Extended Kalman Filter Archives - ThePoorEngineer_files/font-awesome.min.css" type="text/css" media="all">
<link rel="stylesheet" id="apss-frontend-css-css" href="./Attitude Determination with Quaternion using Extended Kalman Filter Archives - ThePoorEngineer_files/frontend.css" type="text/css" media="all">
<link rel="stylesheet" id="apss-font-opensans-css" href="./Attitude Determination with Quaternion using Extended Kalman Filter Archives - ThePoorEngineer_files/css" type="text/css" media="all">
<link rel="stylesheet" id="ctct_form_styles-css" href="./Attitude Determination with Quaternion using Extended Kalman Filter Archives - ThePoorEngineer_files/style.css" type="text/css" media="all">
<link rel="stylesheet" id="ufbl-custom-select-css-css" href="./Attitude Determination with Quaternion using Extended Kalman Filter Archives - ThePoorEngineer_files/jquery.selectbox.css" type="text/css" media="all">
<link rel="stylesheet" id="ufbl-front-css-css" href="./Attitude Determination with Quaternion using Extended Kalman Filter Archives - ThePoorEngineer_files/frontend(1).css" type="text/css" media="all">
<link rel="stylesheet" id="aberration-fonts-css" href="./Attitude Determination with Quaternion using Extended Kalman Filter Archives - ThePoorEngineer_files/css(1)" type="text/css" media="all">
<link rel="stylesheet" id="fontAwesome-css" href="./Attitude Determination with Quaternion using Extended Kalman Filter Archives - ThePoorEngineer_files/font-awesome.min(1).css" type="text/css" media="all">
<link rel="stylesheet" id="bootstrap-css" href="./Attitude Determination with Quaternion using Extended Kalman Filter Archives - ThePoorEngineer_files/grid.min.css" type="text/css" media="all">
<link rel="stylesheet" id="aberration-style-css" href="./Attitude Determination with Quaternion using Extended Kalman Filter Archives - ThePoorEngineer_files/style(1).css" type="text/css" media="all">
<style id="aberration-style-inline-css" type="text/css">
html { font-size: 100%;}
body {background-color:#fff; color:#505050}
#page, .site-footer {background-color:#fff}
h1,h2,h3,h4,h5,h6,.entry-title a, .entry-title a:visited,.widget-title {color:#333}
a, a:visited, .entry-title a:hover {color:#b2995d}
		a:hover {color:#505050}
#site-branding {background-color:#d7dbde}
.site-title a, .site-title a:visited, .site-title {color: #000;}
				.site-title:after {background-color:#000}
.site-description {color: #000;}
.main-navigation li { font-size: 1rem;}
			.main-navigation li li > a { font-size: 0.875rem;}
h1 { font-size: 1.75rem;} h2 { font-size: 1.5rem;}	h3 { font-size: 1.25rem;}	h4 { font-size: 1.125rem;}
		h5 { font-size: 1rem;}	h6 { font-size: 0.75rem;} #sidebar-bottom h4 { font-size: 1.125rem;}
.site-content { font-size: 0.813rem;} .comment { font-size: 0.813rem;}
#no-banner {background-color:#f5f5f5}
hr {border-color:#e8e8e8}
#bottom-wrapper {background-color:#f5f5f5}
		#bottom-wrapper {color:#505050}
		#bottom-wrapper .widget-title {color:#333}
		#bottom-wrapper a, #bottom-wrapper a:visited {color:#B2995D}
		#bottom-wrapper a:hover {color:#505050}
		#bottom-wrapper .widget_archive li, #bottom-wrapper .widget_categories li, #bottom-wrapper .widget_links li, #bottom-wrapper .widget_meta li, #bottom-wrapper .widget_nav_menu li, #bottom-wrapper .widget_pages li, #bottom-wrapper .widget_recent_comments li, #bottom-wrapper .widget_recent_entries li {border-color:#e6e6e6 }
#sidebar-right, #sidebar-left {color:#505050 }
		.widget_archive a, .widget_categories a, .widget_links a, .widget_meta a, .widget_nav_menu a, .widget_pages a, .widget_recent_comments a, .widget_recent_entries a, .widget_archive a:visited, .widget_categories a:visited, .widget_links a:visited, .widget_meta a:visited, .widget_nav_menu a:visited, .widget_pages a:visited, .widget_recent_comments a:visited, .widget_recent_entries a:visited {color:#505050 }
		.widget_archive a:hover,.widget_categories a:hover,.widget_links a:hover,.widget_meta a:hover,.widget_nav_menu a:hover,.widget_pages a:hover,.widget_recent_comments a:hover,.widget_recent_entries a:hover {color:#B2995D }
		.widget_archive li, .widget_categories li, .widget_links li, .widget_meta li, .widget_nav_menu li, .widget_pages li, .widget_recent_comments li, .widget_recent_entries li {border-color:#e6e6e6 }
.widget .tagcloud a, .widget .tagcloud a:visited {border-color:#d9d9d9; color:#686868 }
		#bottom-wrapper .tagcloud a {border-color:#b9bbb2; color:#686868 }
		.widget .tagcloud a:hover {background-color:#303030; color:#f3f3f3 }
		#bottom-wrapper .tagcloud a:hover {background-color:#303030; color:#f3f3f3 }
.site-footer {background-color:#fff;: border-color:#e6e6e6; color:#a7a7a7 }
		.site-footer .widget-title {color:#a7a7a7 }
		.site-footer a, .site-footer a:visited, #footer-menu li:after {color:#a7a7a7 }
		.site-footer a:hover {color:#505050 }
		
.social-icons a { color: #ffffff; background-color:#c4bf9f}
		#image-navigation a { color: #c4bf9f}
.social-icons a:hover { color: #ffffff; background-color:#d5d1b8}	
		#image-navigation a:hover { color: #d5d1b8}
.menu-toggle { color: #f3f3f3; border-color:#f3f3f3}
		.menu-toggle:active,.menu-toggle:focus,.menu-toggle:hover,.menu-toggle.nobanner:active,.menu-toggle.nobanner:focus,.menu-toggle.nobanner:hover { border-color: #000; background-color:#000}
.menu-toggle.nobanner { color: #303030; border-color:#303030}
.main-navigation.toggled-on a, .main-navigation.toggled-on li.home a { color: #000;}
		.main-navigation.toggled-on a:hover, .main-navigation.toggled-on li.home a:hover,
		.main-navigation.toggled-on .nav-menu.nobanner li a:hover, .main-navigation.toggled-on .nav-menu.nobanner li.home a:hover { color: #b2995d;}
		.toggled-on li { border-color: #e6e6e6;}
		.main-navigation.toggled-on .nav-menu { background-color: #f3f3f3;}
.main-navigation li a, .main-navigation li.home a { color: #ffffff;}
		.main-navigation .nav-menu.nobanner a, .main-navigation .nav-menu.nobanner li.home a { color: #000000;}
.main-navigation li.home a:hover,	
		.main-navigation a:hover, 
		.main-navigation .current-menu-item > a, 
		.main-navigation .current-menu-item > a, 
		.main-navigation .current-menu-ancestor > a { color: #f7e5d2;}
		.main-navigation .nav-menu.nobanner li.home a:hover,	
		.main-navigation .nav-menu.nobanner a:hover,	
		.main-navigation .nav-menu.nobanner .current-menu-item > a,	
		.main-navigation .nav-menu.nobanner .current-menu-item > a, 
		.main-navigation .nav-menu.nobanner .current-menu-ancestor > a { color: #b2995d;}
.main-navigation li li > a { color: #ffffff;}
		.main-navigation .nav-menu.nobanner li li a { color: #444444;}
		.main-navigation .nav-menu.nobanner ul { background-color: #f5f5f5;}
.main-navigation li li a:hover { border-left-color:#ffffff}
		.main-navigation .nav-menu.nobanner li li a:hover { border-left-color: #000000;}
.featured {background-color:#000000; color: #ffffff}
.back-to-top {color:#ffffff; background-color:#000000}
.back-to-top:hover { color:#ffffff; background-color:#565656}
.format-quote .entry-title, .format-quote p, .format-quote a { color: #ffffff;}
		.format-quote {background-color:#c4bf9f}
.format-image .entry-title a, .grid .format-image .entry-title a { color: #cccccc;}
button, input[type="button"],input[type="submit"],input[type="reset"],
		.btn {color:#505050; border-color: #c4c4c4; background-color:#ffffff}
button:hover, input[type="button"]:hover,input[type="submit"]:hover,input[type="reset"]:hover,
		.btn:hover {color:#f3f3f3; border-color: #303030; background-color:#303030}
#error-title, #error-message, #error-title:after {color:#ffffff}
#error-button a, #error-button a:visited {color:#ffffff; border-color: #ffffff; background-color:}
#error-button a:hover {color:#ffffff; border-color: ; background-color:}

</style>
<script type="text/javascript" src="./Attitude Determination with Quaternion using Extended Kalman Filter Archives - ThePoorEngineer_files/jquery.min.js.download" id="jquery-core-js"></script>
<script type="text/javascript" src="./Attitude Determination with Quaternion using Extended Kalman Filter Archives - ThePoorEngineer_files/jquery-migrate.min.js.download" id="jquery-migrate-js"></script>
<script type="text/javascript" src="./Attitude Determination with Quaternion using Extended Kalman Filter Archives - ThePoorEngineer_files/jquery.selectbox-0.2.min.js.download" id="ufbl-custom-select-js-js"></script>
<script type="text/javascript" id="ufbl-front-js-js-extra">
/* <![CDATA[ */
var frontend_js_obj = {"default_error_message":"This field is required","ajax_url":"https:\/\/thepoorengineer.com\/wp-admin\/admin-ajax.php","ajax_nonce":"d58f06d4ae"};
/* ]]> */
</script>
<script type="text/javascript" src="./Attitude Determination with Quaternion using Extended Kalman Filter Archives - ThePoorEngineer_files/frontend.js.download" id="ufbl-front-js-js"></script>
<link rel="https://api.w.org/" href="https://thepoorengineer.com/wp-json/"><link rel="alternate" type="application/json" href="https://thepoorengineer.com/wp-json/wp/v2/categories/96"><link rel="EditURI" type="application/rsd+xml" title="RSD" href="https://thepoorengineer.com/xmlrpc.php?rsd">
<link rel="wlwmanifest" type="application/wlwmanifest+xml" href="https://thepoorengineer.com/wp-includes/wlwmanifest.xml"> 
<meta name="generator" content="WordPress 5.9">
<!-- Analytics by WP-Statistics v13.1.4 - https://wp-statistics.com/ -->
<link rel="icon" href="https://thepoorengineer.com/wp-content/uploads/2016/11/cropped-Untitled2-32x32.png" sizes="32x32">
<link rel="icon" href="https://thepoorengineer.com/wp-content/uploads/2016/11/cropped-Untitled2-192x192.png" sizes="192x192">
<link rel="apple-touch-icon" href="https://thepoorengineer.com/wp-content/uploads/2016/11/cropped-Untitled2-180x180.png">
<meta name="msapplication-TileImage" content="https://thepoorengineer.com/wp-content/uploads/2016/11/cropped-Untitled2-270x270.png">
		<style type="text/css" id="wp-custom-css">
			/*
Welcome to Custom CSS!

To learn how this works, see http://wp.me/PEmnE-Bt
*/
.entry-title {
	text-align: left;
	width: 100%;
}

.entry-meta {
	text-align: left;
}		</style>
		
<script type="text/x-mathjax-config;executed=true">
  MathJax.Hub.Config({ tex2jax: { inlineMath: [['$','$'], ["\\(","\\)"]] } });
</script>
<script src="./Attitude Determination with Quaternion using Extended Kalman Filter Archives - ThePoorEngineer_files/MathJax.js.download" id="">
</script>
<meta http-equiv="X-UA-Compatible" content="IE=EmulateIE7">
	
<style type="text/css">.MathJax_Hover_Frame {border-radius: .25em; -webkit-border-radius: .25em; -moz-border-radius: .25em; -khtml-border-radius: .25em; box-shadow: 0px 0px 15px #83A; -webkit-box-shadow: 0px 0px 15px #83A; -moz-box-shadow: 0px 0px 15px #83A; -khtml-box-shadow: 0px 0px 15px #83A; border: 1px solid #A6D ! important; display: inline-block; position: absolute}
.MathJax_Menu_Button .MathJax_Hover_Arrow {position: absolute; cursor: pointer; display: inline-block; border: 2px solid #AAA; border-radius: 4px; -webkit-border-radius: 4px; -moz-border-radius: 4px; -khtml-border-radius: 4px; font-family: 'Courier New',Courier; font-size: 9px; color: #F0F0F0}
.MathJax_Menu_Button .MathJax_Hover_Arrow span {display: block; background-color: #AAA; border: 1px solid; border-radius: 3px; line-height: 0; padding: 4px}
.MathJax_Hover_Arrow:hover {color: white!important; border: 2px solid #CCC!important}
.MathJax_Hover_Arrow:hover span {background-color: #CCC!important}
</style><style type="text/css">#MathJax_About {position: fixed; left: 50%; width: auto; text-align: center; border: 3px outset; padding: 1em 2em; background-color: #DDDDDD; color: black; cursor: default; font-family: message-box; font-size: 120%; font-style: normal; text-indent: 0; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal; word-wrap: normal; white-space: nowrap; float: none; z-index: 201; border-radius: 15px; -webkit-border-radius: 15px; -moz-border-radius: 15px; -khtml-border-radius: 15px; box-shadow: 0px 10px 20px #808080; -webkit-box-shadow: 0px 10px 20px #808080; -moz-box-shadow: 0px 10px 20px #808080; -khtml-box-shadow: 0px 10px 20px #808080; filter: progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true')}
#MathJax_About.MathJax_MousePost {outline: none}
.MathJax_Menu {position: absolute; background-color: white; color: black; width: auto; padding: 2px; border: 1px solid #CCCCCC; margin: 0; cursor: default; font: menu; text-align: left; text-indent: 0; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal; word-wrap: normal; white-space: nowrap; float: none; z-index: 201; box-shadow: 0px 10px 20px #808080; -webkit-box-shadow: 0px 10px 20px #808080; -moz-box-shadow: 0px 10px 20px #808080; -khtml-box-shadow: 0px 10px 20px #808080; filter: progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true')}
.MathJax_MenuItem {padding: 2px 2em; background: transparent}
.MathJax_MenuArrow {position: absolute; right: .5em; padding-top: .25em; color: #666666; font-size: .75em}
.MathJax_MenuActive .MathJax_MenuArrow {color: white}
.MathJax_MenuArrow.RTL {left: .5em; right: auto}
.MathJax_MenuCheck {position: absolute; left: .7em}
.MathJax_MenuCheck.RTL {right: .7em; left: auto}
.MathJax_MenuRadioCheck {position: absolute; left: 1em}
.MathJax_MenuRadioCheck.RTL {right: 1em; left: auto}
.MathJax_MenuLabel {padding: 2px 2em 4px 1.33em; font-style: italic}
.MathJax_MenuRule {border-top: 1px solid #CCCCCC; margin: 4px 1px 0px}
.MathJax_MenuDisabled {color: GrayText}
.MathJax_MenuActive {background-color: Highlight; color: HighlightText}
.MathJax_MenuDisabled:focus, .MathJax_MenuLabel:focus {background-color: #E8E8E8}
.MathJax_ContextMenu:focus {outline: none}
.MathJax_ContextMenu .MathJax_MenuItem:focus {outline: none}
#MathJax_AboutClose {top: .2em; right: .2em}
.MathJax_Menu .MathJax_MenuClose {top: -10px; left: -10px}
.MathJax_MenuClose {position: absolute; cursor: pointer; display: inline-block; border: 2px solid #AAA; border-radius: 18px; -webkit-border-radius: 18px; -moz-border-radius: 18px; -khtml-border-radius: 18px; font-family: 'Courier New',Courier; font-size: 24px; color: #F0F0F0}
.MathJax_MenuClose span {display: block; background-color: #AAA; border: 1.5px solid; border-radius: 18px; -webkit-border-radius: 18px; -moz-border-radius: 18px; -khtml-border-radius: 18px; line-height: 0; padding: 8px 0 6px}
.MathJax_MenuClose:hover {color: white!important; border: 2px solid #CCC!important}
.MathJax_MenuClose:hover span {background-color: #CCC!important}
.MathJax_MenuClose:hover:focus {outline: none}
</style><style type="text/css">.MathJax_Preview .MJXf-math {color: inherit!important}
</style><style type="text/css">.MJX_Assistive_MathML {position: absolute!important; top: 0; left: 0; clip: rect(1px, 1px, 1px, 1px); padding: 1px 0 0 0!important; border: 0!important; height: 1px!important; width: 1px!important; overflow: hidden!important; display: block!important; -webkit-touch-callout: none; -webkit-user-select: none; -khtml-user-select: none; -moz-user-select: none; -ms-user-select: none; user-select: none}
.MJX_Assistive_MathML.MJX_Assistive_MathML_Block {width: 100%!important}
</style><style type="text/css">#MathJax_Zoom {position: absolute; background-color: #F0F0F0; overflow: auto; display: block; z-index: 301; padding: .5em; border: 1px solid black; margin: 0; font-weight: normal; font-style: normal; text-align: left; text-indent: 0; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal; word-wrap: normal; white-space: nowrap; float: none; -webkit-box-sizing: content-box; -moz-box-sizing: content-box; box-sizing: content-box; box-shadow: 5px 5px 15px #AAAAAA; -webkit-box-shadow: 5px 5px 15px #AAAAAA; -moz-box-shadow: 5px 5px 15px #AAAAAA; -khtml-box-shadow: 5px 5px 15px #AAAAAA; filter: progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true')}
#MathJax_ZoomOverlay {position: absolute; left: 0; top: 0; z-index: 300; display: inline-block; width: 100%; height: 100%; border: 0; padding: 0; margin: 0; background-color: white; opacity: 0; filter: alpha(opacity=0)}
#MathJax_ZoomFrame {position: relative; display: inline-block; height: 0; width: 0}
#MathJax_ZoomEventTrap {position: absolute; left: 0; top: 0; z-index: 302; display: inline-block; border: 0; padding: 0; margin: 0; background-color: white; opacity: 0; filter: alpha(opacity=0)}
</style><style type="text/css">.MathJax_Preview {color: #888}
#MathJax_Message {position: fixed; left: 1em; bottom: 1.5em; background-color: #E6E6E6; border: 1px solid #959595; margin: 0px; padding: 2px 8px; z-index: 102; color: black; font-size: 80%; width: auto; white-space: nowrap}
#MathJax_MSIE_Frame {position: absolute; top: 0; left: 0; width: 0px; z-index: 101; border: 0px; margin: 0px; padding: 0px}
.MathJax_Error {color: #CC0000; font-style: italic}
</style><style data-emotion="css"></style><style type="text/css">.MJXp-script {font-size: .8em}
.MJXp-right {-webkit-transform-origin: right; -moz-transform-origin: right; -ms-transform-origin: right; -o-transform-origin: right; transform-origin: right}
.MJXp-bold {font-weight: bold}
.MJXp-italic {font-style: italic}
.MJXp-scr {font-family: MathJax_Script,'Times New Roman',Times,STIXGeneral,serif}
.MJXp-frak {font-family: MathJax_Fraktur,'Times New Roman',Times,STIXGeneral,serif}
.MJXp-sf {font-family: MathJax_SansSerif,'Times New Roman',Times,STIXGeneral,serif}
.MJXp-cal {font-family: MathJax_Caligraphic,'Times New Roman',Times,STIXGeneral,serif}
.MJXp-mono {font-family: MathJax_Typewriter,'Times New Roman',Times,STIXGeneral,serif}
.MJXp-largeop {font-size: 150%}
.MJXp-largeop.MJXp-int {vertical-align: -.2em}
.MJXp-math {display: inline-block; line-height: 1.2; text-indent: 0; font-family: 'Times New Roman',Times,STIXGeneral,serif; white-space: nowrap; border-collapse: collapse}
.MJXp-display {display: block; text-align: center; margin: 1em 0}
.MJXp-math span {display: inline-block}
.MJXp-box {display: block!important; text-align: center}
.MJXp-box:after {content: " "}
.MJXp-rule {display: block!important; margin-top: .1em}
.MJXp-char {display: block!important}
.MJXp-mo {margin: 0 .15em}
.MJXp-mfrac {margin: 0 .125em; vertical-align: .25em}
.MJXp-denom {display: inline-table!important; width: 100%}
.MJXp-denom > * {display: table-row!important}
.MJXp-surd {vertical-align: top}
.MJXp-surd > * {display: block!important}
.MJXp-script-box > *  {display: table!important; height: 50%}
.MJXp-script-box > * > * {display: table-cell!important; vertical-align: top}
.MJXp-script-box > *:last-child > * {vertical-align: bottom}
.MJXp-script-box > * > * > * {display: block!important}
.MJXp-mphantom {visibility: hidden}
.MJXp-munderover {display: inline-table!important}
.MJXp-over {display: inline-block!important; text-align: center}
.MJXp-over > * {display: block!important}
.MJXp-munderover > * {display: table-row!important}
.MJXp-mtable {vertical-align: .25em; margin: 0 .125em}
.MJXp-mtable > * {display: inline-table!important; vertical-align: middle}
.MJXp-mtr {display: table-row!important}
.MJXp-mtd {display: table-cell!important; text-align: center; padding: .5em 0 0 .5em}
.MJXp-mtr > .MJXp-mtd:first-child {padding-left: 0}
.MJXp-mtr:first-child > .MJXp-mtd {padding-top: 0}
.MJXp-mlabeledtr {display: table-row!important}
.MJXp-mlabeledtr > .MJXp-mtd:first-child {padding-left: 0}
.MJXp-mlabeledtr:first-child > .MJXp-mtd {padding-top: 0}
.MJXp-merror {background-color: #FFFF88; color: #CC0000; border: 1px solid #CC0000; padding: 1px 3px; font-style: normal; font-size: 90%}
.MJXp-scale0 {-webkit-transform: scaleX(.0); -moz-transform: scaleX(.0); -ms-transform: scaleX(.0); -o-transform: scaleX(.0); transform: scaleX(.0)}
.MJXp-scale1 {-webkit-transform: scaleX(.1); -moz-transform: scaleX(.1); -ms-transform: scaleX(.1); -o-transform: scaleX(.1); transform: scaleX(.1)}
.MJXp-scale2 {-webkit-transform: scaleX(.2); -moz-transform: scaleX(.2); -ms-transform: scaleX(.2); -o-transform: scaleX(.2); transform: scaleX(.2)}
.MJXp-scale3 {-webkit-transform: scaleX(.3); -moz-transform: scaleX(.3); -ms-transform: scaleX(.3); -o-transform: scaleX(.3); transform: scaleX(.3)}
.MJXp-scale4 {-webkit-transform: scaleX(.4); -moz-transform: scaleX(.4); -ms-transform: scaleX(.4); -o-transform: scaleX(.4); transform: scaleX(.4)}
.MJXp-scale5 {-webkit-transform: scaleX(.5); -moz-transform: scaleX(.5); -ms-transform: scaleX(.5); -o-transform: scaleX(.5); transform: scaleX(.5)}
.MJXp-scale6 {-webkit-transform: scaleX(.6); -moz-transform: scaleX(.6); -ms-transform: scaleX(.6); -o-transform: scaleX(.6); transform: scaleX(.6)}
.MJXp-scale7 {-webkit-transform: scaleX(.7); -moz-transform: scaleX(.7); -ms-transform: scaleX(.7); -o-transform: scaleX(.7); transform: scaleX(.7)}
.MJXp-scale8 {-webkit-transform: scaleX(.8); -moz-transform: scaleX(.8); -ms-transform: scaleX(.8); -o-transform: scaleX(.8); transform: scaleX(.8)}
.MJXp-scale9 {-webkit-transform: scaleX(.9); -moz-transform: scaleX(.9); -ms-transform: scaleX(.9); -o-transform: scaleX(.9); transform: scaleX(.9)}
.MathJax_PHTML .noError {vertical-align: ; font-size: 90%; text-align: left; color: black; padding: 1px 3px; border: 1px solid}
</style><style type="text/css">.MathJax_Display {text-align: center; margin: 1em 0em; position: relative; display: block!important; text-indent: 0; max-width: none; max-height: none; min-width: 0; min-height: 0; width: 100%}
.MathJax .merror {background-color: #FFFF88; color: #CC0000; border: 1px solid #CC0000; padding: 1px 3px; font-style: normal; font-size: 90%}
.MathJax .MJX-monospace {font-family: monospace}
.MathJax .MJX-sans-serif {font-family: sans-serif}
#MathJax_Tooltip {background-color: InfoBackground; color: InfoText; border: 1px solid black; box-shadow: 2px 2px 5px #AAAAAA; -webkit-box-shadow: 2px 2px 5px #AAAAAA; -moz-box-shadow: 2px 2px 5px #AAAAAA; -khtml-box-shadow: 2px 2px 5px #AAAAAA; filter: progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true'); padding: 3px 4px; z-index: 401; position: absolute; left: 0; top: 0; width: auto; height: auto; display: none}
.MathJax {display: inline; font-style: normal; font-weight: normal; line-height: normal; font-size: 100%; font-size-adjust: none; text-indent: 0; text-align: left; text-transform: none; letter-spacing: normal; word-spacing: normal; word-wrap: normal; white-space: nowrap; float: none; direction: ltr; max-width: none; max-height: none; min-width: 0; min-height: 0; border: 0; padding: 0; margin: 0}
.MathJax:focus, body :focus .MathJax {display: inline-table}
.MathJax.MathJax_FullWidth {text-align: center; display: table-cell!important; width: 10000em!important}
.MathJax img, .MathJax nobr, .MathJax a {border: 0; padding: 0; margin: 0; max-width: none; max-height: none; min-width: 0; min-height: 0; vertical-align: 0; line-height: normal; text-decoration: none}
img.MathJax_strut {border: 0!important; padding: 0!important; margin: 0!important; vertical-align: 0!important}
.MathJax span {display: inline; position: static; border: 0; padding: 0; margin: 0; vertical-align: 0; line-height: normal; text-decoration: none}
.MathJax nobr {white-space: nowrap!important}
.MathJax img {display: inline!important; float: none!important}
.MathJax * {transition: none; -webkit-transition: none; -moz-transition: none; -ms-transition: none; -o-transition: none}
.MathJax_Processing {visibility: hidden; position: fixed; width: 0; height: 0; overflow: hidden}
.MathJax_Processed {display: none!important}
.MathJax_ExBox {display: block!important; overflow: hidden; width: 1px; height: 60ex; min-height: 0; max-height: none}
.MathJax .MathJax_EmBox {display: block!important; overflow: hidden; width: 1px; height: 60em; min-height: 0; max-height: none}
.MathJax_LineBox {display: table!important}
.MathJax_LineBox span {display: table-cell!important; width: 10000em!important; min-width: 0; max-width: none; padding: 0; border: 0; margin: 0}
.MathJax .MathJax_HitBox {cursor: text; background: white; opacity: 0; filter: alpha(opacity=0)}
.MathJax .MathJax_HitBox * {filter: none; opacity: 1; background: transparent}
#MathJax_Tooltip * {filter: none; opacity: 1; background: transparent}
@font-face {font-family: MathJax_Main; src: url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/woff/MathJax_Main-Regular.woff?V=2.7.1') format('woff'), url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/otf/MathJax_Main-Regular.otf?V=2.7.1') format('opentype')}
@font-face {font-family: MathJax_Main-bold; src: url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/woff/MathJax_Main-Bold.woff?V=2.7.1') format('woff'), url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/otf/MathJax_Main-Bold.otf?V=2.7.1') format('opentype')}
@font-face {font-family: MathJax_Main-italic; src: url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/woff/MathJax_Main-Italic.woff?V=2.7.1') format('woff'), url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/otf/MathJax_Main-Italic.otf?V=2.7.1') format('opentype')}
@font-face {font-family: MathJax_Math-italic; src: url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/woff/MathJax_Math-Italic.woff?V=2.7.1') format('woff'), url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/otf/MathJax_Math-Italic.otf?V=2.7.1') format('opentype')}
@font-face {font-family: MathJax_Caligraphic; src: url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/woff/MathJax_Caligraphic-Regular.woff?V=2.7.1') format('woff'), url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/otf/MathJax_Caligraphic-Regular.otf?V=2.7.1') format('opentype')}
@font-face {font-family: MathJax_Size1; src: url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/woff/MathJax_Size1-Regular.woff?V=2.7.1') format('woff'), url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/otf/MathJax_Size1-Regular.otf?V=2.7.1') format('opentype')}
@font-face {font-family: MathJax_Size2; src: url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/woff/MathJax_Size2-Regular.woff?V=2.7.1') format('woff'), url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/otf/MathJax_Size2-Regular.otf?V=2.7.1') format('opentype')}
@font-face {font-family: MathJax_Size3; src: url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/woff/MathJax_Size3-Regular.woff?V=2.7.1') format('woff'), url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/otf/MathJax_Size3-Regular.otf?V=2.7.1') format('opentype')}
@font-face {font-family: MathJax_Size4; src: url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/woff/MathJax_Size4-Regular.woff?V=2.7.1') format('woff'), url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/otf/MathJax_Size4-Regular.otf?V=2.7.1') format('opentype')}
.MathJax .noError {vertical-align: ; font-size: 90%; text-align: left; color: black; padding: 1px 3px; border: 1px solid}
</style><style type="text/css">@font-face {font-family: MathJax_AMS; src: url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/woff/MathJax_AMS-Regular.woff?V=2.7.1') format('woff'), url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/otf/MathJax_AMS-Regular.otf?V=2.7.1') format('opentype')}
</style></head>

<body data-rsssl="1" class="archive category category-attitude-determination-with-quaternion-using-ekf category-96 ctct-aberration-lite" itemscope="itemscope" itemtype="http://schema.org/WebPage"><div style="visibility: hidden; overflow: hidden; position: absolute; top: 0px; height: 1px; width: auto; padding: 0px; border: 0px; margin: 0px; text-align: left; text-indent: 0px; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal;"><div id="MathJax_Hidden"></div></div><div id="MathJax_Message" style="display: none;"></div>
<div id="page" class="hfeed site">
	<a class="skip-link screen-reader-text" href="https://thepoorengineer.com/en/category/projects/attitude-determination-with-quaternion-using-ekf/#content">Skip to content</a>

    <header id="masthead" class="site-header" itemscope="itemscope" itemtype="http://schema.org/WPHeader">
    
           <div id="site-branding-wrapper">
              <div id="site-branding">
                				          
                                     
                        <div class="site-title" itemprop="headline"><a href="https://thepoorengineer.com/en/6-2/" rel="home">ThePoorEngineer</a></div>
                        
                                     
                                  			<div class="site-description" itemprop="description"><p>Working hard to be lazy</p></div>
               		    

            </div><!-- .site-branding --> 			
        	</div><!-- #site-branding-wrapper -->
            
            <nav id="site-navigation" class="main-navigation">
                <div class="toggle-container visible-xs visible-sm hidden-md hidden-lg">
				
					 <button class="menu-toggle nobanner">Menu</button>                </div>
                                
                <div class="menu-primary-menu-container"><ul id="menu-primary-menu" class="nav-menu nobanner"><li id="menu-item-48" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-48"><a href="https://thepoorengineer.com/en/6-2/about-me/">ABOUT</a></li>
<li id="menu-item-166" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-has-children menu-item-166"><a href="https://thepoorengineer.com/en/6-2/life/">LIFE</a>
<ul class="sub-menu">
	<li id="menu-item-170" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-has-children menu-item-170"><a href="https://thepoorengineer.com/en/6-2/life/japan-current/">JAPAN (current)</a>
	<ul class="sub-menu">
		<li id="menu-item-72" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-72"><a href="https://thepoorengineer.com/en/category/life/japan/tokyo/">TOKYO (current)</a></li>
		<li id="menu-item-949" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-949"><a href="https://thepoorengineer.com/en/category/life/japan/osaka/">OSAKA</a></li>
		<li id="menu-item-953" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-953"><a href="https://thepoorengineer.com/en/category/life/japan/kyoto/">KYOTO</a></li>
		<li id="menu-item-952" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-952"><a href="https://thepoorengineer.com/en/category/life/japan/gunma/">GUNMA</a></li>
		<li id="menu-item-950" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-950"><a href="https://thepoorengineer.com/en/category/life/japan/kumamoto/">KUMAMOTO</a></li>
		<li id="menu-item-951" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-951"><a href="https://thepoorengineer.com/en/category/life/japan/shizuoka/">SHIZUOKA</a></li>
	</ul>
</li>
	<li id="menu-item-400" class="menu-item menu-item-type-post_type menu-item-object-post menu-item-400"><a href="https://thepoorengineer.com/en/singapore/">SINGAPORE</a></li>
	<li id="menu-item-489" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-has-children menu-item-489"><a href="https://thepoorengineer.com/en/6-2/indonesia/">INDONESIA</a>
	<ul class="sub-menu">
		<li id="menu-item-490" class="menu-item menu-item-type-post_type menu-item-object-post menu-item-490"><a href="https://thepoorengineer.com/en/pekanbaru/">PEKANBARU</a></li>
	</ul>
</li>
	<li id="menu-item-1058" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-has-children menu-item-1058"><a href="https://thepoorengineer.com/en/category/life/czech-republic/">CZECH</a>
	<ul class="sub-menu">
		<li id="menu-item-1089" class="menu-item menu-item-type-post_type menu-item-object-post menu-item-1089"><a href="https://thepoorengineer.com/en/prague/">Prague</a></li>
	</ul>
</li>
</ul>
</li>
<li id="menu-item-173" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-has-children menu-item-173"><a href="https://thepoorengineer.com/en/6-2/projects/">PROJECTS</a>
<ul class="sub-menu">
	<li id="menu-item-185" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-has-children menu-item-185"><a href="https://thepoorengineer.com/en/6-2/projects/arduino/">ARDUINO</a>
	<ul class="sub-menu">
		<li id="menu-item-665" class="menu-item menu-item-type-post_type menu-item-object-post menu-item-665"><a href="https://thepoorengineer.com/en/arduino-starter-kit/">Starter Kit</a></li>
		<li id="menu-item-676" class="menu-item menu-item-type-post_type menu-item-object-post menu-item-676"><a href="https://thepoorengineer.com/en/plant-watering-automation/">Plant Watering Automation</a></li>
		<li id="menu-item-1159" class="menu-item menu-item-type-post_type menu-item-object-post menu-item-1159"><a href="https://thepoorengineer.com/en/arduino-wireless-transmission/">Wireless Transmission</a></li>
		<li id="menu-item-990" class="menu-item menu-item-type-post_type menu-item-object-post menu-item-990"><a href="https://thepoorengineer.com/en/arduino-epaper-clock/">Arduino E-Paper Clock</a></li>
		<li id="menu-item-1362" class="menu-item menu-item-type-post_type menu-item-object-post menu-item-1362"><a href="https://thepoorengineer.com/en/arduino-feedback-control-system/">A Complete Tutorial for Feedback Control System on Arduino</a></li>
		<li id="menu-item-2056" class="menu-item menu-item-type-post_type menu-item-object-post menu-item-2056"><a href="https://thepoorengineer.com/en/python-fft-plot/">Real Time Frequency Plot with Python</a></li>
		<li id="menu-item-2219" class="menu-item menu-item-type-post_type menu-item-object-post menu-item-2219"><a href="https://thepoorengineer.com/en/spinning-led-display/">Spinning LED Display</a></li>
	</ul>
</li>
	<li id="menu-item-553" class="menu-item menu-item-type-post_type menu-item-object-post menu-item-553"><a href="https://thepoorengineer.com/en/snake-cplusplus/">C++ SNAKE GAME</a></li>
	<li id="menu-item-1160" class="menu-item menu-item-type-post_type menu-item-object-post menu-item-1160"><a href="https://thepoorengineer.com/en/ryzen/">BUILDING A COMPUTER</a></li>
	<li id="menu-item-1841" class="menu-item menu-item-type-post_type menu-item-object-post menu-item-1841"><a href="https://thepoorengineer.com/en/attitude-determination/">ATTITUDE DETERMINATION WITH QUATERNION USING EKF</a></li>
</ul>
</li>
<li id="menu-item-478" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-has-children menu-item-478"><a href="https://thepoorengineer.com/en/6-2/woodcarving/">WOODCARVING</a>
<ul class="sub-menu">
	<li id="menu-item-962" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-962"><a href="https://thepoorengineer.com/en/category/woodcarving/nameplate/">NAMEPLATES</a></li>
	<li id="menu-item-1202" class="menu-item menu-item-type-post_type menu-item-object-post menu-item-1202"><a href="https://thepoorengineer.com/en/wooden-frame-carving/">WOODEN FRAMES</a></li>
	<li id="menu-item-963" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-963"><a href="https://thepoorengineer.com/en/category/woodcarving/miniature-figures/">MINIATURE FIGURES</a></li>
	<li id="menu-item-972" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-972"><a href="https://thepoorengineer.com/en/6-2/woodcarving/woodcarving-gallery/">GALLERY</a></li>
</ul>
</li>
<li id="menu-item-56" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-56"><a href="https://thepoorengineer.com/en/6-2/contact-me/">CONTACT</a></li>
</ul></div>                            
            </nav><!-- #site-navigation -->
            
    </header>

    <div id="banner-wrapper">
        <div id="no-banner"></div>    </div>



<div id="content" class="site-content clearfix">



 
<div id="primary" class="content-area">
        <main id="main" class="site-main" itemprop="mainEntityOfPage" itemscope="itemscope" itemtype="http://schema.org/Blog">
        

 <div class="container"><div class="row"><div class="col-md-8 top-featured-right"><header class="page-header"><h1 class="page-title">Attitude Determination with Quaternion using Extended Kalman Filter</h1></header>            


		



<article id="post-1891" class="post-1891 post type-post status-publish format-standard hentry category-attitude-determination-with-quaternion-using-ekf clearfix" itemscope="itemscope" itemtype="http://schema.org/BlogPosting" itemprop="blogPost">

	   
	<header class="entry-header">
  
		<h2 class="entry-title" itemprop="headline"><a href="https://thepoorengineer.com/en/ekf-impl/" rel="bookmark">Extended Kalman Filter Implementation</a></h2>    
    

				<div class="entry-meta">
			<span class="posted-on">Posted on <a href="https://thepoorengineer.com/en/ekf-impl/" rel="bookmark"><time class="entry-date published" datetime="2018-09-10T22:23:46+09:00">September 10, 2018</time><time class="updated" datetime="2019-10-04T21:58:37+09:00" itemprop="dateUpdated">October 4, 2019</time></a></span>		</div><!-- .entry-meta -->
			</header><!-- .entry-header -->

	<div class="entry-content" itemprop="text">
    
    
  	<h3>Table of Contents</h3>
<ol>
<li><a href="https://thepoorengineer.com/en/attitude-determination/">Foreword and Introduction</a></li>
<li><a href="https://thepoorengineer.com/en/graphics/">Preparing the Graphics</a>
<ul>
<li><a href="https://thepoorengineer.com/en/graphics/#wireframe">Creating the Wireframe</a></li>
<li><a href="https://thepoorengineer.com/en/graphics/#perspective">Creating a Perspective View</a></li>
<li><a href="https://thepoorengineer.com/en/graphics/#pygame">Drawing in Pygame</a></li>
</ul>
</li>
<li><a href="https://thepoorengineer.com/en/quaternion/">Quaternion Rotation</a>
<ul>
<li><a href="https://thepoorengineer.com/en/quaternion/#quaternion">Quaternion basics</a></li>
<li><a href="https://thepoorengineer.com/en/quaternion/#testRotation">Testing Quaternion Rotation in Pygame</a></li>
<li><a href="https://thepoorengineer.com/en/quaternion/#gyroRotation">Implementing Rotations with MEMS Gyrometer Data</a></li>
</ul>
</li>
<li><a href="https://thepoorengineer.com/en/calibrating-the-magnetometer/">Calibrating the Magnetometer</a>
<ul>
<li><a href="https://thepoorengineer.com/en/calibrating-the-magnetometer/#ErrorModel">Error Modelling</a></li>
<li><a href="https://thepoorengineer.com/en/calibrating-the-magnetometer/#MeasurementModel">Measurement Model</a></li>
<li><a href="https://thepoorengineer.com/en/calibrating-the-magnetometer/#Calibration">Calibration</a></li>
</ul>
</li>
<li><strong><span style="color: red;">Extended Kalman Filter Implementation</span></strong>
<ul>
<li><strong><a href="https://thepoorengineer.com/en/category/projects/attitude-determination-with-quaternion-using-ekf/#KalmanStates">Kalman Filter States</a></strong></li>
<li><strong><a href="https://thepoorengineer.com/en/category/projects/attitude-determination-with-quaternion-using-ekf/#AccelData">Accelerometer Data</a></strong></li>
<li><strong><a href="https://thepoorengineer.com/en/category/projects/attitude-determination-with-quaternion-using-ekf/#MagData">Magnetometer Data</a></strong></li>
<li><strong><a href="https://thepoorengineer.com/en/category/projects/attitude-determination-with-quaternion-using-ekf/#EKFimpl">Quaternion EKF Implementation</a></strong></li>
</ul>
</li>
<li><strong><a href="https://thepoorengineer.com/en/category/projects/attitude-determination-with-quaternion-using-ekf/#conclusion">Conclusion</a></strong></li>
</ol>
<p>In this section, we will be finally implementing the extended kalman filter. This implementation is based on the following dissertation:&nbsp;<a href="http://www.diva-portal.org/smash/get/diva2:818704/FULLTEXT01.pdf">Extended Kalman Filter for Robust UAV Attitude Estimation,&nbsp;Martin Pettersson</a>. However, I have added in some other stuffs by myself as well, and the coding was done from scratch without referring to the pseudocode in the paper too.</p>
<p>Let me first give a basic overview of this section before we go into the details. As we can see from <a href="https://thepoorengineer.com/en/quaternion/">section 3</a>, using the gyrometer data alone is insufficient because it will eventually drift away from its original reference point over time. Furthermore, there is no way for the gyrometer to know the actual orientation after a certain period of time due to a lack of reference points. In order to alleviate these problems, we are going to use the accelerometer to provide a reference vector that is pointing downwards (gravity), and a magnetometer to provide another vector pointing in the magnetic north direction. With these 2 reference vectors, the orientation of the sensor will be fully defined thus we can use them as a reference to counter the drift of the gyrometer.</p>
<p>Another way of looking at this problem is that we will need at least 2 reference vectors in order to fully define a 3 dimensional orientation. As such, we will need at least 2 reference vectors for this method to work. You can have more to improve the accuracy but you will definitely need to have at least 2.</p>
<p>Below is a video which shows the extended kalman filter implementation, and here are the files that I used in the video (and also for the section below)</p>
<ul>
<li><a href="https://thepoorengineer.com/wp-content/uploads/2018/07/ArduinoExtractSensorData.zip"><span style="font-size: 12pt;">Arduino Code</span></a></li>
<li><a href="https://thepoorengineer.com/wp-content/uploads/2018/09/PythonIMU_EKF.zip"><span style="font-size: 12pt;">Python Code (EKF implementation)</span></a></li>
</ul>
<p><iframe title="Extended Kalman Filter (EKF) Implementation of Quaternion Rotations with MEMS Gyrometer" width="1100" height="619" src="./Attitude Determination with Quaternion using Extended Kalman Filter Archives - ThePoorEngineer_files/dEd4cNfmi0s.html" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe></p>
<div id="KalmanStates"></div>
<hr>
<h2>Kalman Filter States</h2>
<p>In order to use the Kalman Filter, we first have to define the states that we want to use. This is why there are so many different kalman filter implementations out there. Every author out there is saying that using their chosen states, you will be able to achieve a better result. However, for the purpose of this tutorial, we are just going to implement a really simple (in comparison to other implementations) one which is similar to the one implemented in my <a href="https://thepoorengineer.com/en/angle-control-absolute/">other post for determining a 1 dimensional angle</a>&nbsp;using kalman filter.</p>
<p>Although I said that this is simple relatively, it is actually not that simple. Moving from 2D to 3D is really a big jump as you have to start using vectors and matrices, but that’s not something to be afraid of so let us press on.</p>
<p>The states that we will be using for this implementation is given as follows:</p>
<p style="text-align: center;"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-1-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;msup&gt;&lt;mrow&gt;&lt;mo&gt;[&lt;/mo&gt;&lt;mtable rowspacing=&quot;4pt&quot; columnspacing=&quot;1em&quot;&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mn&gt;3&lt;/mn&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;msup&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;mi&gt;g&lt;/mi&gt;&lt;/msup&gt;&lt;/mrow&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;msup&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;mi&gt;g&lt;/mi&gt;&lt;/msup&gt;&lt;/mrow&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;msup&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;mi&gt;g&lt;/mi&gt;&lt;/msup&gt;&lt;/mrow&gt;&lt;mn&gt;3&lt;/mn&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;/mtable&gt;&lt;mo&gt;]&lt;/mo&gt;&lt;/mrow&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;/msup&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1" style="width: 20.723em; display: inline-block;"><span style="display: inline-block; position: relative; width: 16.69em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(1.244em, 1016.69em, 2.795em, -999.997em); top: -2.354em; left: 0em;"><span class="mrow" id="MathJax-Span-2"><span class="mi" id="MathJax-Span-3" style="font-family: MathJax_Math-italic;">x</span><span class="mo" id="MathJax-Span-4" style="font-family: MathJax_Main; padding-left: 0.251em;">=</span><span class="msubsup" id="MathJax-Span-5" style="padding-left: 0.251em;"><span style="display: inline-block; position: relative; width: 14.829em; height: 0px;"><span style="position: absolute; clip: rect(3.043em, 1014.15em, 4.408em, -999.997em); top: -3.967em; left: 0em;"><span class="mrow" id="MathJax-Span-6"><span class="mo" id="MathJax-Span-7" style="font-family: MathJax_Main;">[</span><span class="mtable" id="MathJax-Span-8" style="padding-right: 0.189em; padding-left: 0.189em;"><span style="display: inline-block; position: relative; width: 13.341em; height: 0px;"><span style="position: absolute; clip: rect(3.415em, 1000.87em, 4.408em, -999.997em); top: -3.967em; left: 0em;"><span style="display: inline-block; position: relative; width: 0.872em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.87em, 4.346em, -999.997em); top: -3.905em; left: 50%; margin-left: -0.431em;"><span class="mtd" id="MathJax-Span-9"><span class="mrow" id="MathJax-Span-10"><span class="msubsup" id="MathJax-Span-11"><span style="display: inline-block; position: relative; width: 0.872em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.44em, 4.346em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-12" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.437em;"><span class="mn" id="MathJax-Span-13" style="font-size: 70.7%; font-family: MathJax_Main;">0</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.415em, 1000.87em, 4.408em, -999.997em); top: -3.967em; left: 1.864em;"><span style="display: inline-block; position: relative; width: 0.872em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.87em, 4.346em, -999.997em); top: -3.905em; left: 50%; margin-left: -0.431em;"><span class="mtd" id="MathJax-Span-14"><span class="mrow" id="MathJax-Span-15"><span class="msubsup" id="MathJax-Span-16"><span style="display: inline-block; position: relative; width: 0.872em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.44em, 4.346em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-17" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.437em;"><span class="mn" id="MathJax-Span-18" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.415em, 1000.87em, 4.408em, -999.997em); top: -3.967em; left: 3.725em;"><span style="display: inline-block; position: relative; width: 0.872em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.87em, 4.346em, -999.997em); top: -3.905em; left: 50%; margin-left: -0.431em;"><span class="mtd" id="MathJax-Span-19"><span class="mrow" id="MathJax-Span-20"><span class="msubsup" id="MathJax-Span-21"><span style="display: inline-block; position: relative; width: 0.872em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.44em, 4.346em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-22" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.437em;"><span class="mn" id="MathJax-Span-23" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.415em, 1000.87em, 4.408em, -999.997em); top: -3.967em; left: 5.648em;"><span style="display: inline-block; position: relative; width: 0.872em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.87em, 4.346em, -999.997em); top: -3.905em; left: 50%; margin-left: -0.431em;"><span class="mtd" id="MathJax-Span-24"><span class="mrow" id="MathJax-Span-25"><span class="msubsup" id="MathJax-Span-26"><span style="display: inline-block; position: relative; width: 0.872em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.44em, 4.346em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-27" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.437em;"><span class="mn" id="MathJax-Span-28" style="font-size: 70.7%; font-family: MathJax_Main;">3</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.167em, 1001.31em, 4.346em, -999.997em); top: -3.967em; left: 7.509em;"><span style="display: inline-block; position: relative; width: 1.306em; height: 0px;"><span style="position: absolute; clip: rect(3.105em, 1001.31em, 4.283em, -999.997em); top: -3.905em; left: 50%; margin-left: -0.617em;"><span class="mtd" id="MathJax-Span-29"><span class="mrow" id="MathJax-Span-30"><span class="msubsup" id="MathJax-Span-31"><span style="display: inline-block; position: relative; width: 1.306em; height: 0px;"><span style="position: absolute; clip: rect(3.105em, 1000.87em, 4.159em, -999.997em); top: -3.967em; left: 0em;"><span class="texatom" id="MathJax-Span-32"><span class="mrow" id="MathJax-Span-33"><span class="msubsup" id="MathJax-Span-34"><span style="display: inline-block; position: relative; width: 0.872em; height: 0px;"><span style="position: absolute; clip: rect(3.105em, 1000.44em, 4.159em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-35" style="font-family: MathJax_Math-italic;">b</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -4.339em; left: 0.437em;"><span class="mi" id="MathJax-Span-36" style="font-size: 70.7%; font-family: MathJax_Math-italic;">g<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.872em;"><span class="mn" id="MathJax-Span-37" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.167em, 1001.31em, 4.346em, -999.997em); top: -3.967em; left: 9.743em;"><span style="display: inline-block; position: relative; width: 1.306em; height: 0px;"><span style="position: absolute; clip: rect(3.105em, 1001.31em, 4.283em, -999.997em); top: -3.905em; left: 50%; margin-left: -0.617em;"><span class="mtd" id="MathJax-Span-38"><span class="mrow" id="MathJax-Span-39"><span class="msubsup" id="MathJax-Span-40"><span style="display: inline-block; position: relative; width: 1.306em; height: 0px;"><span style="position: absolute; clip: rect(3.105em, 1000.87em, 4.159em, -999.997em); top: -3.967em; left: 0em;"><span class="texatom" id="MathJax-Span-41"><span class="mrow" id="MathJax-Span-42"><span class="msubsup" id="MathJax-Span-43"><span style="display: inline-block; position: relative; width: 0.872em; height: 0px;"><span style="position: absolute; clip: rect(3.105em, 1000.44em, 4.159em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-44" style="font-family: MathJax_Math-italic;">b</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -4.339em; left: 0.437em;"><span class="mi" id="MathJax-Span-45" style="font-size: 70.7%; font-family: MathJax_Math-italic;">g<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.872em;"><span class="mn" id="MathJax-Span-46" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.167em, 1001.31em, 4.346em, -999.997em); top: -3.967em; left: 12.038em;"><span style="display: inline-block; position: relative; width: 1.306em; height: 0px;"><span style="position: absolute; clip: rect(3.105em, 1001.31em, 4.346em, -999.997em); top: -3.905em; left: 50%; margin-left: -0.617em;"><span class="mtd" id="MathJax-Span-47"><span class="mrow" id="MathJax-Span-48"><span class="msubsup" id="MathJax-Span-49"><span style="display: inline-block; position: relative; width: 1.306em; height: 0px;"><span style="position: absolute; clip: rect(3.105em, 1000.87em, 4.159em, -999.997em); top: -3.967em; left: 0em;"><span class="texatom" id="MathJax-Span-50"><span class="mrow" id="MathJax-Span-51"><span class="msubsup" id="MathJax-Span-52"><span style="display: inline-block; position: relative; width: 0.872em; height: 0px;"><span style="position: absolute; clip: rect(3.105em, 1000.44em, 4.159em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-53" style="font-family: MathJax_Math-italic;">b</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -4.339em; left: 0.437em;"><span class="mi" id="MathJax-Span-54" style="font-size: 70.7%; font-family: MathJax_Math-italic;">g<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.872em;"><span class="mn" id="MathJax-Span-55" style="font-size: 70.7%; font-family: MathJax_Main;">3</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="mo" id="MathJax-Span-56" style="font-family: MathJax_Main;">]</span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -4.463em; left: 14.271em;"><span class="mi" id="MathJax-Span-57" style="font-size: 70.7%; font-family: MathJax_Math-italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.065em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.36em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.381em; border-left: 0px solid; width: 0px; height: 1.619em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>x</mi><mo>=</mo><msup><mrow><mo>[</mo><mtable rowspacing="4pt" columnspacing="1em"><mtr><mtd><msub><mi>q</mi><mn>0</mn></msub></mtd><mtd><msub><mi>q</mi><mn>1</mn></msub></mtd><mtd><msub><mi>q</mi><mn>2</mn></msub></mtd><mtd><msub><mi>q</mi><mn>3</mn></msub></mtd><mtd><msub><mrow class="MJX-TeXAtom-ORD"><msup><mi>b</mi><mi>g</mi></msup></mrow><mn>1</mn></msub></mtd><mtd><msub><mrow class="MJX-TeXAtom-ORD"><msup><mi>b</mi><mi>g</mi></msup></mrow><mn>2</mn></msub></mtd><mtd><msub><mrow class="MJX-TeXAtom-ORD"><msup><mi>b</mi><mi>g</mi></msup></mrow><mn>3</mn></msub></mtd></mtr></mtable><mo>]</mo></mrow><mi>T</mi></msup></math></span></span><script type="math/tex" id="MathJax-Element-1"> x = \begin{bmatrix} q_0 & q_1 & q_2 & q_3 & {b^g}_1 & {b^g}_2 & {b^g}_3 \end{bmatrix}^T</script></p>
<p>where</p>
<p><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-2-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-58" style="width: 1.12em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.872em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(1.74em, 1000.87em, 2.733em, -999.997em); top: -2.354em; left: 0em;"><span class="mrow" id="MathJax-Span-59"><span class="msubsup" id="MathJax-Span-60"><span style="display: inline-block; position: relative; width: 0.872em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.44em, 4.346em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-61" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.437em;"><span class="mn" id="MathJax-Span-62" style="font-size: 70.7%; font-family: MathJax_Main;">0</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.36em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.304em; border-left: 0px solid; width: 0px; height: 0.927em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>q</mi><mn>0</mn></msub></math></span></span><script type="math/tex" id="MathJax-Element-2">q_0</script> is the scalar term in the quarternion<br>
<span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-3-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msub&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mn&gt;3&lt;/mn&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-63" style="width: 4.408em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.539em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(1.74em, 1003.54em, 2.733em, -999.997em); top: -2.354em; left: 0em;"><span class="mrow" id="MathJax-Span-64"><span class="msubsup" id="MathJax-Span-65"><span style="display: inline-block; position: relative; width: 0.872em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.44em, 4.346em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-66" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.437em;"><span class="mn" id="MathJax-Span-67" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="mo" id="MathJax-Span-68" style="font-family: MathJax_Main;">,</span><span class="msubsup" id="MathJax-Span-69" style="padding-left: 0.189em;"><span style="display: inline-block; position: relative; width: 0.872em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.44em, 4.346em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-70" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.437em;"><span class="mn" id="MathJax-Span-71" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="mo" id="MathJax-Span-72" style="font-family: MathJax_Main;">,</span><span class="msubsup" id="MathJax-Span-73" style="padding-left: 0.189em;"><span style="display: inline-block; position: relative; width: 0.872em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.44em, 4.346em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-74" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.437em;"><span class="mn" id="MathJax-Span-75" style="font-size: 70.7%; font-family: MathJax_Main;">3</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.36em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.304em; border-left: 0px solid; width: 0px; height: 0.927em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>q</mi><mn>1</mn></msub><mo>,</mo><msub><mi>q</mi><mn>2</mn></msub><mo>,</mo><msub><mi>q</mi><mn>3</mn></msub></math></span></span><script type="math/tex" id="MathJax-Element-3">q_1, q_2, q_3</script> is the vector term in the quarternion<br>
<span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-4-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;msup&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;mi&gt;g&lt;/mi&gt;&lt;/msup&gt;&lt;/mrow&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;msub&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;msup&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;mi&gt;g&lt;/mi&gt;&lt;/msup&gt;&lt;/mrow&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msub&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;msub&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;msup&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;mi&gt;g&lt;/mi&gt;&lt;/msup&gt;&lt;/mrow&gt;&lt;mn&gt;3&lt;/mn&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-76" style="width: 6.02em; display: inline-block;"><span style="display: inline-block; position: relative; width: 4.842em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(1.492em, 1004.84em, 2.733em, -999.997em); top: -2.354em; left: 0em;"><span class="mrow" id="MathJax-Span-77"><span class="msubsup" id="MathJax-Span-78"><span style="display: inline-block; position: relative; width: 1.306em; height: 0px;"><span style="position: absolute; clip: rect(3.105em, 1000.87em, 4.159em, -999.997em); top: -3.967em; left: 0em;"><span class="texatom" id="MathJax-Span-79"><span class="mrow" id="MathJax-Span-80"><span class="msubsup" id="MathJax-Span-81"><span style="display: inline-block; position: relative; width: 0.872em; height: 0px;"><span style="position: absolute; clip: rect(3.105em, 1000.44em, 4.159em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-82" style="font-family: MathJax_Math-italic;">b</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -4.339em; left: 0.437em;"><span class="mi" id="MathJax-Span-83" style="font-size: 70.7%; font-family: MathJax_Math-italic;">g<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.872em;"><span class="mn" id="MathJax-Span-84" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="mo" id="MathJax-Span-85" style="font-family: MathJax_Main;">,</span><span class="msubsup" id="MathJax-Span-86" style="padding-left: 0.189em;"><span style="display: inline-block; position: relative; width: 1.306em; height: 0px;"><span style="position: absolute; clip: rect(3.105em, 1000.87em, 4.159em, -999.997em); top: -3.967em; left: 0em;"><span class="texatom" id="MathJax-Span-87"><span class="mrow" id="MathJax-Span-88"><span class="msubsup" id="MathJax-Span-89"><span style="display: inline-block; position: relative; width: 0.872em; height: 0px;"><span style="position: absolute; clip: rect(3.105em, 1000.44em, 4.159em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-90" style="font-family: MathJax_Math-italic;">b</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -4.339em; left: 0.437em;"><span class="mi" id="MathJax-Span-91" style="font-size: 70.7%; font-family: MathJax_Math-italic;">g<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.872em;"><span class="mn" id="MathJax-Span-92" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="mo" id="MathJax-Span-93" style="font-family: MathJax_Main;">,</span><span class="msubsup" id="MathJax-Span-94" style="padding-left: 0.189em;"><span style="display: inline-block; position: relative; width: 1.306em; height: 0px;"><span style="position: absolute; clip: rect(3.105em, 1000.87em, 4.159em, -999.997em); top: -3.967em; left: 0em;"><span class="texatom" id="MathJax-Span-95"><span class="mrow" id="MathJax-Span-96"><span class="msubsup" id="MathJax-Span-97"><span style="display: inline-block; position: relative; width: 0.872em; height: 0px;"><span style="position: absolute; clip: rect(3.105em, 1000.44em, 4.159em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-98" style="font-family: MathJax_Math-italic;">b</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -4.339em; left: 0.437em;"><span class="mi" id="MathJax-Span-99" style="font-size: 70.7%; font-family: MathJax_Math-italic;">g<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.872em;"><span class="mn" id="MathJax-Span-100" style="font-size: 70.7%; font-family: MathJax_Main;">3</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.36em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.304em; border-left: 0px solid; width: 0px; height: 1.235em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mrow class="MJX-TeXAtom-ORD"><msup><mi>b</mi><mi>g</mi></msup></mrow><mn>1</mn></msub><mo>,</mo><msub><mrow class="MJX-TeXAtom-ORD"><msup><mi>b</mi><mi>g</mi></msup></mrow><mn>2</mn></msub><mo>,</mo><msub><mrow class="MJX-TeXAtom-ORD"><msup><mi>b</mi><mi>g</mi></msup></mrow><mn>3</mn></msub></math></span></span><script type="math/tex" id="MathJax-Element-4">{b^g}_1, {b^g}_2, {b^g}_3</script> is the bias of the gyrometer in the x, y, z direction respectively (units is the same as angular velocity).</p>
<p>The bias term refers to how much the gyrometer would have drifted per unit time. For more information, you can read up my<a href="https://thepoorengineer.com/en/angle-control-absolute/#kalmanAccelGyro"> other post for a 1 dimensional kalman filter implementation</a>.</p>
<p>For this implementation, we can write the states in a more concise and compact manner as shown below.</p>
<p style="text-align: center;"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-5-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mrow&gt;&lt;mo&gt;[&lt;/mo&gt;&lt;mtable rowspacing=&quot;4pt&quot; columnspacing=&quot;1em&quot;&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mover&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;&amp;#x007E;&lt;/mo&gt;&lt;/mover&gt;&lt;/mrow&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mover&gt;&lt;msup&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;mi&gt;g&lt;/mi&gt;&lt;/msup&gt;&lt;mo stretchy=&quot;false&quot;&gt;&amp;#x007E;&lt;/mo&gt;&lt;/mover&gt;&lt;/mrow&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;/mtable&gt;&lt;mo&gt;]&lt;/mo&gt;&lt;/mrow&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-101" style="width: 5.152em; display: inline-block;"><span style="display: inline-block; position: relative; width: 4.159em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(1.616em, 1003.91em, 4.594em, -999.997em); top: -3.347em; left: 0em;"><span class="mrow" id="MathJax-Span-102"><span class="mi" id="MathJax-Span-103" style="font-family: MathJax_Math-italic;">x</span><span class="mo" id="MathJax-Span-104" style="font-family: MathJax_Main; padding-left: 0.251em;">=</span><span class="mrow" id="MathJax-Span-105" style="padding-left: 0.251em;"><span class="mo" id="MathJax-Span-106" style="vertical-align: 0em;"><span style="font-family: MathJax_Size3;">[</span></span><span class="mtable" id="MathJax-Span-107" style="padding-right: 0.189em; padding-left: 0.189em;"><span style="display: inline-block; position: relative; width: 0.872em; height: 0px;"><span style="position: absolute; clip: rect(2.36em, 1000.87em, 4.966em, -999.997em); top: -3.967em; left: 0em;"><span style="display: inline-block; position: relative; width: 0.872em; height: 0px;"><span style="position: absolute; clip: rect(3.105em, 1000.56em, 4.346em, -999.997em); top: -4.712em; left: 50%; margin-left: -0.307em;"><span class="mtd" id="MathJax-Span-108"><span class="mrow" id="MathJax-Span-109"><span class="texatom" id="MathJax-Span-110"><span class="mrow" id="MathJax-Span-111"><span class="munderover" id="MathJax-Span-112"><span style="display: inline-block; position: relative; width: 0.623em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.44em, 4.346em, -999.997em); top: -3.967em; left: 0.003em;"><span class="mi" id="MathJax-Span-113" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.477em, 1000.44em, 3.973em, -999.997em); top: -4.339em; left: 0.127em;"><span class="mo" id="MathJax-Span-114" style="font-family: MathJax_Main;">~</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(2.857em, 1000.87em, 4.159em, -999.997em); top: -3.161em; left: 50%; margin-left: -0.431em;"><span class="mtd" id="MathJax-Span-115"><span class="mrow" id="MathJax-Span-116"><span class="texatom" id="MathJax-Span-117"><span class="mrow" id="MathJax-Span-118"><span class="munderover" id="MathJax-Span-119"><span style="display: inline-block; position: relative; width: 0.872em; height: 0px;"><span style="position: absolute; clip: rect(3.105em, 1000.87em, 4.159em, -999.997em); top: -3.967em; left: 0em;"><span class="msubsup" id="MathJax-Span-120"><span style="display: inline-block; position: relative; width: 0.872em; height: 0px;"><span style="position: absolute; clip: rect(3.105em, 1000.44em, 4.159em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-121" style="font-family: MathJax_Math-italic;">b</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -4.277em; left: 0.437em;"><span class="mi" id="MathJax-Span-122" style="font-size: 70.7%; font-family: MathJax_Math-italic;">g<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.477em, 1000.44em, 3.973em, -999.997em); top: -4.587em; left: 0.189em;"><span class="mo" id="MathJax-Span-123" style="font-family: MathJax_Main;">~</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="mo" id="MathJax-Span-124" style="vertical-align: 0em;"><span style="font-family: MathJax_Size3;">]</span></span></span></span><span style="display: inline-block; width: 0px; height: 3.353em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -1.381em; border-left: 0px solid; width: 0px; height: 3.312em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>x</mi><mo>=</mo><mrow><mo>[</mo><mtable rowspacing="4pt" columnspacing="1em"><mtr><mtd><mrow class="MJX-TeXAtom-ORD"><mover><mi>q</mi><mo stretchy="false">~</mo></mover></mrow></mtd></mtr><mtr><mtd><mrow class="MJX-TeXAtom-ORD"><mover><msup><mi>b</mi><mi>g</mi></msup><mo stretchy="false">~</mo></mover></mrow></mtd></mtr></mtable><mo>]</mo></mrow></math></span></span><script type="math/tex" id="MathJax-Element-5">x = \begin{bmatrix} \tilde{q} \\ \tilde{b^g} \end{bmatrix}</script>&nbsp; &nbsp; &nbsp;——————–&nbsp; &nbsp; &nbsp;(1)</p>
<p>where</p>
<p><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-6-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mover&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;&amp;#x007E;&lt;/mo&gt;&lt;/mover&gt;&lt;/mrow&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-125" style="width: 0.81em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.623em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(1.492em, 1000.56em, 2.733em, -999.997em); top: -2.354em; left: 0em;"><span class="mrow" id="MathJax-Span-126"><span class="texatom" id="MathJax-Span-127"><span class="mrow" id="MathJax-Span-128"><span class="munderover" id="MathJax-Span-129"><span style="display: inline-block; position: relative; width: 0.623em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.44em, 4.346em, -999.997em); top: -3.967em; left: 0.003em;"><span class="mi" id="MathJax-Span-130" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.477em, 1000.44em, 3.973em, -999.997em); top: -4.339em; left: 0.127em;"><span class="mo" id="MathJax-Span-131" style="font-family: MathJax_Main;">~</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.36em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.304em; border-left: 0px solid; width: 0px; height: 1.235em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow class="MJX-TeXAtom-ORD"><mover><mi>q</mi><mo stretchy="false">~</mo></mover></mrow></math></span></span><script type="math/tex" id="MathJax-Element-6">\tilde{q}</script> is the quaternion<br>
<span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-7-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mover&gt;&lt;msup&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;mi&gt;g&lt;/mi&gt;&lt;/msup&gt;&lt;mo stretchy=&quot;false&quot;&gt;&amp;#x007E;&lt;/mo&gt;&lt;/mover&gt;&lt;/mrow&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-132" style="width: 1.12em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.872em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(1.244em, 1000.87em, 2.547em, -999.997em); top: -2.354em; left: 0em;"><span class="mrow" id="MathJax-Span-133"><span class="texatom" id="MathJax-Span-134"><span class="mrow" id="MathJax-Span-135"><span class="munderover" id="MathJax-Span-136"><span style="display: inline-block; position: relative; width: 0.872em; height: 0px;"><span style="position: absolute; clip: rect(3.105em, 1000.87em, 4.159em, -999.997em); top: -3.967em; left: 0em;"><span class="msubsup" id="MathJax-Span-137"><span style="display: inline-block; position: relative; width: 0.872em; height: 0px;"><span style="position: absolute; clip: rect(3.105em, 1000.44em, 4.159em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-138" style="font-family: MathJax_Math-italic;">b</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -4.277em; left: 0.437em;"><span class="mi" id="MathJax-Span-139" style="font-size: 70.7%; font-family: MathJax_Math-italic;">g<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.477em, 1000.44em, 3.973em, -999.997em); top: -4.587em; left: 0.189em;"><span class="mo" id="MathJax-Span-140" style="font-family: MathJax_Main;">~</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.36em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.073em; border-left: 0px solid; width: 0px; height: 1.388em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow class="MJX-TeXAtom-ORD"><mover><msup><mi>b</mi><mi>g</mi></msup><mo stretchy="false">~</mo></mover></mrow></math></span></span><script type="math/tex" id="MathJax-Element-7">\tilde{b^g}</script> is the bias vector</p>
<p>Now, we need to form an equation for the system dynamics. From <a href="https://thepoorengineer.com/en/quaternion/">section 3</a>, we know that</p>
<p style="text-align: center;"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-8-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mover&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mo&gt;&amp;#x02D9;&lt;/mo&gt;&lt;/mover&gt;&lt;/mrow&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mfrac&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/mfrac&gt;&lt;mi&gt;S&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;w&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mfrac&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/mfrac&gt;&lt;mi&gt;S&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mi&gt;w&lt;/mi&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-141" style="width: 12.348em; display: inline-block;"><span style="display: inline-block; position: relative; width: 9.929em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(1.306em, 1009.93em, 2.919em, -999.997em); top: -2.354em; left: 0em;"><span class="mrow" id="MathJax-Span-142"><span class="texatom" id="MathJax-Span-143"><span class="mrow" id="MathJax-Span-144"><span class="munderover" id="MathJax-Span-145"><span style="display: inline-block; position: relative; width: 0.623em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.44em, 4.346em, -999.997em); top: -3.967em; left: 0.003em;"><span class="mi" id="MathJax-Span-146" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.105em, 1000.31em, 3.601em, -999.997em); top: -4.029em; left: 0.127em;"><span class="mo" id="MathJax-Span-147" style="font-family: MathJax_Main;">˙</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span></span><span class="mo" id="MathJax-Span-148" style="font-family: MathJax_Main; padding-left: 0.251em;">=</span><span class="mfrac" id="MathJax-Span-149" style="padding-left: 0.251em;"><span style="display: inline-block; position: relative; width: 0.499em; height: 0px; margin-right: 0.127em; margin-left: 0.127em;"><span style="position: absolute; clip: rect(3.291em, 1000.31em, 4.159em, -999.997em); top: -4.401em; left: 50%; margin-left: -0.183em;"><span class="mn" id="MathJax-Span-150" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.291em, 1000.31em, 4.159em, -999.997em); top: -3.595em; left: 50%; margin-left: -0.183em;"><span class="mn" id="MathJax-Span-151" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(0.81em, 1000.5em, 1.244em, -999.997em); top: -1.3em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 0.499em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.058em;"></span></span></span></span><span class="mi" id="MathJax-Span-152" style="font-family: MathJax_Math-italic;">S<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.065em;"></span></span><span class="mo" id="MathJax-Span-153" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-154" style="font-family: MathJax_Math-italic;">w</span><span class="mo" id="MathJax-Span-155" style="font-family: MathJax_Main;">)</span><span class="mi" id="MathJax-Span-156" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-157" style="font-family: MathJax_Main; padding-left: 0.251em;">=</span><span class="mfrac" id="MathJax-Span-158" style="padding-left: 0.251em;"><span style="display: inline-block; position: relative; width: 0.499em; height: 0px; margin-right: 0.127em; margin-left: 0.127em;"><span style="position: absolute; clip: rect(3.291em, 1000.31em, 4.159em, -999.997em); top: -4.401em; left: 50%; margin-left: -0.183em;"><span class="mn" id="MathJax-Span-159" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.291em, 1000.31em, 4.159em, -999.997em); top: -3.595em; left: 50%; margin-left: -0.183em;"><span class="mn" id="MathJax-Span-160" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(0.81em, 1000.5em, 1.244em, -999.997em); top: -1.3em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 0.499em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.058em;"></span></span></span></span><span class="mi" id="MathJax-Span-161" style="font-family: MathJax_Math-italic;">S<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.065em;"></span></span><span class="mo" id="MathJax-Span-162" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-163" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-164" style="font-family: MathJax_Main;">)</span><span class="mi" id="MathJax-Span-165" style="font-family: MathJax_Math-italic;">w</span></span><span style="display: inline-block; width: 0px; height: 2.36em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.535em; border-left: 0px solid; width: 0px; height: 1.773em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow class="MJX-TeXAtom-ORD"><mover><mi>q</mi><mo>˙</mo></mover></mrow><mo>=</mo><mfrac><mn>1</mn><mn>2</mn></mfrac><mi>S</mi><mo stretchy="false">(</mo><mi>w</mi><mo stretchy="false">)</mo><mi>q</mi><mo>=</mo><mfrac><mn>1</mn><mn>2</mn></mfrac><mi>S</mi><mo stretchy="false">(</mo><mi>q</mi><mo stretchy="false">)</mo><mi>w</mi></math></span></span><script type="math/tex" id="MathJax-Element-8">\dot{q}=\frac{1}{2}S(w)q=\frac{1}{2}S(q)w</script>&nbsp; &nbsp; &nbsp;——————–&nbsp; &nbsp; &nbsp;(2)</p>
<p>where</p>
<p><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-9-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mtable columnalign=&quot;right left right left right left right left right left right left&quot; rowspacing=&quot;3pt&quot; columnspacing=&quot;0em 2em 0em 2em 0em 2em 0em 2em 0em 2em 0em&quot; displaystyle=&quot;true&quot;&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mi&gt;S&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;w&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mi&gt;&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mrow&gt;&lt;mo&gt;[&lt;/mo&gt;&lt;mtable rowspacing=&quot;4pt&quot; columnspacing=&quot;1em&quot;&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;w&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;w&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;w&lt;/mi&gt;&lt;mn&gt;3&lt;/mn&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mi&gt;w&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mi&gt;w&lt;/mi&gt;&lt;mn&gt;3&lt;/mn&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;w&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mi&gt;w&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;w&lt;/mi&gt;&lt;mn&gt;3&lt;/mn&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mi&gt;w&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mi&gt;w&lt;/mi&gt;&lt;mn&gt;3&lt;/mn&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mi&gt;w&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;w&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;/mtable&gt;&lt;mo&gt;]&lt;/mo&gt;&lt;/mrow&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mi&gt;&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mrow&gt;&lt;mo&gt;[&lt;/mo&gt;&lt;mtable rowspacing=&quot;4pt&quot; columnspacing=&quot;1em&quot;&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mn&gt;3&lt;/mn&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;/mtable&gt;&lt;mo&gt;]&lt;/mo&gt;&lt;/mrow&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mi&gt;S&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mi&gt;&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mrow&gt;&lt;mo&gt;[&lt;/mo&gt;&lt;mtable rowspacing=&quot;4pt&quot; columnspacing=&quot;1em&quot;&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mn&gt;3&lt;/mn&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mn&gt;3&lt;/mn&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mn&gt;3&lt;/mn&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;/mtable&gt;&lt;mo&gt;]&lt;/mo&gt;&lt;/mrow&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mi&gt;w&lt;/mi&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mi&gt;&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mrow&gt;&lt;mo&gt;[&lt;/mo&gt;&lt;mtable rowspacing=&quot;4pt&quot; columnspacing=&quot;1em&quot;&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mi&gt;w&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mi&gt;w&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mi&gt;w&lt;/mi&gt;&lt;mn&gt;3&lt;/mn&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;/mtable&gt;&lt;mo&gt;]&lt;/mo&gt;&lt;/mrow&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;/mtable&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-166" style="width: 19.11em; display: inline-block;"><span style="display: inline-block; position: relative; width: 15.388em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(-8.248em, 1014.89em, 12.472em, -999.997em); top: -2.354em; left: 0em;"><span class="mrow" id="MathJax-Span-167"><span class="mtable" id="MathJax-Span-168" style="padding-right: 0.189em; padding-left: 0.189em;"><span style="display: inline-block; position: relative; width: 15.016em; height: 0px;"><span style="position: absolute; clip: rect(9.06em, 1002.05em, 25.996em, -999.997em); top: -17.553em; left: 0em;"><span style="display: inline-block; position: relative; width: 2.112em; height: 0px;"><span style="position: absolute; clip: rect(3.043em, 1002.05em, 4.408em, -999.997em); top: -11.535em; right: 0em;"><span class="mtd" id="MathJax-Span-169"><span class="mrow" id="MathJax-Span-170"><span class="mi" id="MathJax-Span-171" style="font-family: MathJax_Math-italic;">S<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.065em;"></span></span><span class="mo" id="MathJax-Span-172" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-173" style="font-family: MathJax_Math-italic;">w</span><span class="mo" id="MathJax-Span-174" style="font-family: MathJax_Main;">)</span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.353em, 1000.44em, 4.346em, -999.997em); top: -6.014em; right: 0em;"><span class="mtd" id="MathJax-Span-261"><span class="mrow" id="MathJax-Span-262"><span class="mi" id="MathJax-Span-263" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.043em, 1001.8em, 4.408em, -999.997em); top: -0.493em; right: 0em;"><span class="mtd" id="MathJax-Span-292"><span class="mrow" id="MathJax-Span-293"><span class="mi" id="MathJax-Span-294" style="font-family: MathJax_Math-italic;">S<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.065em;"></span></span><span class="mo" id="MathJax-Span-295" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-296" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-297" style="font-family: MathJax_Main;">)</span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.353em, 1000.68em, 4.159em, -999.997em); top: 4.283em; right: 0em;"><span class="mtd" id="MathJax-Span-372"><span class="mrow" id="MathJax-Span-373"><span class="mi" id="MathJax-Span-374" style="font-family: MathJax_Math-italic;">w</span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span><span style="display: inline-block; width: 0px; height: 17.559em;"></span></span><span style="position: absolute; clip: rect(10.673em, 1012.6em, 31.393em, -999.997em); top: -21.275em; left: 2.112em;"><span style="display: inline-block; position: relative; width: 12.906em; height: 0px;"><span style="position: absolute; clip: rect(3.167em, 1012.6em, 8.75em, -999.997em); top: -13.769em; left: 0em;"><span class="mtd" id="MathJax-Span-175"><span class="mrow" id="MathJax-Span-176"><span class="mi" id="MathJax-Span-177"></span><span class="mo" id="MathJax-Span-178" style="font-family: MathJax_Main; padding-left: 0.251em;">=</span><span class="mrow" id="MathJax-Span-179" style="padding-left: 0.251em;"><span class="mo" id="MathJax-Span-180" style="vertical-align: 2.857em;"><span style="display: inline-block; position: relative; width: 0.685em; height: 0px;"><span style="position: absolute; font-family: MathJax_Size4; top: -2.788em; left: 0em;">⎡<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; font-family: MathJax_Size4; top: 0.561em; left: 0em;">⎣<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -1.61em; left: 0em;">⎢<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -1.051em; left: 0em;">⎢<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -0.493em; left: 0em;">⎢<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="mtable" id="MathJax-Span-181" style="padding-right: 0.189em; padding-left: 0.189em;"><span style="display: inline-block; position: relative; width: 9.929em; height: 0px;"><span style="position: absolute; clip: rect(3.105em, 1001.12em, 8.502em, -999.997em); top: -6.014em; left: 0em;"><span style="display: inline-block; position: relative; width: 1.12em; height: 0px;"><span style="position: absolute; clip: rect(3.105em, 1000.44em, 4.159em, -999.997em); top: -6.014em; left: 50%; margin-left: -0.245em;"><span class="mtd" id="MathJax-Span-182"><span class="mrow" id="MathJax-Span-183"><span class="mn" id="MathJax-Span-184" style="font-family: MathJax_Main;">0</span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.353em, 1001.12em, 4.283em, -999.997em); top: -4.587em; left: 50%; margin-left: -0.555em;"><span class="mtd" id="MathJax-Span-203"><span class="mrow" id="MathJax-Span-204"><span class="msubsup" id="MathJax-Span-205"><span style="display: inline-block; position: relative; width: 1.12em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.68em, 4.159em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-206" style="font-family: MathJax_Math-italic;">w</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.748em;"><span class="mn" id="MathJax-Span-207" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.353em, 1001.12em, 4.283em, -999.997em); top: -3.223em; left: 50%; margin-left: -0.555em;"><span class="mtd" id="MathJax-Span-222"><span class="mrow" id="MathJax-Span-223"><span class="msubsup" id="MathJax-Span-224"><span style="display: inline-block; position: relative; width: 1.12em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.68em, 4.159em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-225" style="font-family: MathJax_Math-italic;">w</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.748em;"><span class="mn" id="MathJax-Span-226" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.353em, 1001.12em, 4.346em, -999.997em); top: -1.796em; left: 50%; margin-left: -0.555em;"><span class="mtd" id="MathJax-Span-241"><span class="mrow" id="MathJax-Span-242"><span class="msubsup" id="MathJax-Span-243"><span style="display: inline-block; position: relative; width: 1.12em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.68em, 4.159em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-244" style="font-family: MathJax_Math-italic;">w</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.748em;"><span class="mn" id="MathJax-Span-245" style="font-size: 70.7%; font-family: MathJax_Main;">3</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span><span style="display: inline-block; width: 0px; height: 6.02em;"></span></span><span style="position: absolute; clip: rect(3.167em, 1001.93em, 8.44em, -999.997em); top: -5.952em; left: 2.174em;"><span style="display: inline-block; position: relative; width: 1.926em; height: 0px;"><span style="position: absolute; clip: rect(3.229em, 1001.93em, 4.283em, -999.997em); top: -6.014em; left: 50%; margin-left: -0.927em;"><span class="mtd" id="MathJax-Span-185"><span class="mrow" id="MathJax-Span-186"><span class="mo" id="MathJax-Span-187" style="font-family: MathJax_Main;">−</span><span class="msubsup" id="MathJax-Span-188"><span style="display: inline-block; position: relative; width: 1.12em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.68em, 4.159em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-189" style="font-family: MathJax_Math-italic;">w</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.748em;"><span class="mn" id="MathJax-Span-190" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.105em, 1000.44em, 4.159em, -999.997em); top: -4.587em; left: 50%; margin-left: -0.245em;"><span class="mtd" id="MathJax-Span-208"><span class="mrow" id="MathJax-Span-209"><span class="mn" id="MathJax-Span-210" style="font-family: MathJax_Main;">0</span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.229em, 1001.93em, 4.346em, -999.997em); top: -3.223em; left: 50%; margin-left: -0.927em;"><span class="mtd" id="MathJax-Span-227"><span class="mrow" id="MathJax-Span-228"><span class="mo" id="MathJax-Span-229" style="font-family: MathJax_Main;">−</span><span class="msubsup" id="MathJax-Span-230"><span style="display: inline-block; position: relative; width: 1.12em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.68em, 4.159em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-231" style="font-family: MathJax_Math-italic;">w</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.748em;"><span class="mn" id="MathJax-Span-232" style="font-size: 70.7%; font-family: MathJax_Main;">3</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.353em, 1001.12em, 4.283em, -999.997em); top: -1.796em; left: 50%; margin-left: -0.555em;"><span class="mtd" id="MathJax-Span-246"><span class="mrow" id="MathJax-Span-247"><span class="msubsup" id="MathJax-Span-248"><span style="display: inline-block; position: relative; width: 1.12em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.68em, 4.159em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-249" style="font-family: MathJax_Math-italic;">w</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.748em;"><span class="mn" id="MathJax-Span-250" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span><span style="display: inline-block; width: 0px; height: 5.958em;"></span></span><span style="position: absolute; clip: rect(3.167em, 1001.93em, 8.44em, -999.997em); top: -5.952em; left: 5.09em;"><span style="display: inline-block; position: relative; width: 1.926em; height: 0px;"><span style="position: absolute; clip: rect(3.229em, 1001.93em, 4.283em, -999.997em); top: -6.014em; left: 50%; margin-left: -0.927em;"><span class="mtd" id="MathJax-Span-191"><span class="mrow" id="MathJax-Span-192"><span class="mo" id="MathJax-Span-193" style="font-family: MathJax_Main;">−</span><span class="msubsup" id="MathJax-Span-194"><span style="display: inline-block; position: relative; width: 1.12em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.68em, 4.159em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-195" style="font-family: MathJax_Math-italic;">w</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.748em;"><span class="mn" id="MathJax-Span-196" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.353em, 1001.12em, 4.346em, -999.997em); top: -4.587em; left: 50%; margin-left: -0.555em;"><span class="mtd" id="MathJax-Span-211"><span class="mrow" id="MathJax-Span-212"><span class="msubsup" id="MathJax-Span-213"><span style="display: inline-block; position: relative; width: 1.12em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.68em, 4.159em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-214" style="font-family: MathJax_Math-italic;">w</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.748em;"><span class="mn" id="MathJax-Span-215" style="font-size: 70.7%; font-family: MathJax_Main;">3</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.105em, 1000.44em, 4.159em, -999.997em); top: -3.223em; left: 50%; margin-left: -0.245em;"><span class="mtd" id="MathJax-Span-233"><span class="mrow" id="MathJax-Span-234"><span class="mn" id="MathJax-Span-235" style="font-family: MathJax_Main;">0</span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.229em, 1001.93em, 4.283em, -999.997em); top: -1.796em; left: 50%; margin-left: -0.927em;"><span class="mtd" id="MathJax-Span-251"><span class="mrow" id="MathJax-Span-252"><span class="mo" id="MathJax-Span-253" style="font-family: MathJax_Main;">−</span><span class="msubsup" id="MathJax-Span-254"><span style="display: inline-block; position: relative; width: 1.12em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.68em, 4.159em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-255" style="font-family: MathJax_Math-italic;">w</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.748em;"><span class="mn" id="MathJax-Span-256" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span><span style="display: inline-block; width: 0px; height: 5.958em;"></span></span><span style="position: absolute; clip: rect(3.043em, 1001.93em, 8.192em, -999.997em); top: -5.828em; left: 8.006em;"><span style="display: inline-block; position: relative; width: 1.926em; height: 0px;"><span style="position: absolute; clip: rect(3.229em, 1001.93em, 4.346em, -999.997em); top: -6.014em; left: 50%; margin-left: -0.927em;"><span class="mtd" id="MathJax-Span-197"><span class="mrow" id="MathJax-Span-198"><span class="mo" id="MathJax-Span-199" style="font-family: MathJax_Main;">−</span><span class="msubsup" id="MathJax-Span-200"><span style="display: inline-block; position: relative; width: 1.12em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.68em, 4.159em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-201" style="font-family: MathJax_Math-italic;">w</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.748em;"><span class="mn" id="MathJax-Span-202" style="font-size: 70.7%; font-family: MathJax_Main;">3</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.229em, 1001.93em, 4.283em, -999.997em); top: -4.587em; left: 50%; margin-left: -0.927em;"><span class="mtd" id="MathJax-Span-216"><span class="mrow" id="MathJax-Span-217"><span class="mo" id="MathJax-Span-218" style="font-family: MathJax_Main;">−</span><span class="msubsup" id="MathJax-Span-219"><span style="display: inline-block; position: relative; width: 1.12em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.68em, 4.159em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-220" style="font-family: MathJax_Math-italic;">w</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.748em;"><span class="mn" id="MathJax-Span-221" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.353em, 1001.12em, 4.283em, -999.997em); top: -3.223em; left: 50%; margin-left: -0.555em;"><span class="mtd" id="MathJax-Span-236"><span class="mrow" id="MathJax-Span-237"><span class="msubsup" id="MathJax-Span-238"><span style="display: inline-block; position: relative; width: 1.12em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.68em, 4.159em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-239" style="font-family: MathJax_Math-italic;">w</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.748em;"><span class="mn" id="MathJax-Span-240" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.105em, 1000.44em, 4.159em, -999.997em); top: -1.796em; left: 50%; margin-left: -0.245em;"><span class="mtd" id="MathJax-Span-257"><span class="mrow" id="MathJax-Span-258"><span class="mn" id="MathJax-Span-259" style="font-family: MathJax_Main;">0</span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span><span style="display: inline-block; width: 0px; height: 5.834em;"></span></span></span></span><span class="mo" id="MathJax-Span-260" style="vertical-align: 2.857em;"><span style="display: inline-block; position: relative; width: 0.685em; height: 0px;"><span style="position: absolute; font-family: MathJax_Size4; top: -2.788em; left: 0em;">⎤<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; font-family: MathJax_Size4; top: 0.561em; left: 0em;">⎦<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -1.61em; left: 0em;">⎥<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -1.051em; left: 0em;">⎥<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -0.493em; left: 0em;">⎥<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 6.207em;"></span></span><span style="position: absolute; clip: rect(3.167em, 1003.54em, 8.75em, -999.997em); top: -8.248em; left: 0em;"><span class="mtd" id="MathJax-Span-264"><span class="mrow" id="MathJax-Span-265"><span class="mi" id="MathJax-Span-266"></span><span class="mo" id="MathJax-Span-267" style="font-family: MathJax_Main; padding-left: 0.251em;">=</span><span class="mrow" id="MathJax-Span-268" style="padding-left: 0.251em;"><span class="mo" id="MathJax-Span-269" style="vertical-align: 2.857em;"><span style="display: inline-block; position: relative; width: 0.685em; height: 0px;"><span style="position: absolute; font-family: MathJax_Size4; top: -2.788em; left: 0em;">⎡<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; font-family: MathJax_Size4; top: 0.561em; left: 0em;">⎣<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -1.61em; left: 0em;">⎢<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -1.051em; left: 0em;">⎢<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -0.493em; left: 0em;">⎢<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="mtable" id="MathJax-Span-270" style="padding-right: 0.189em; padding-left: 0.189em;"><span style="display: inline-block; position: relative; width: 0.872em; height: 0px;"><span style="position: absolute; clip: rect(3.167em, 1000.87em, 8.378em, -999.997em); top: -5.828em; left: 0em;"><span style="display: inline-block; position: relative; width: 0.872em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.87em, 4.346em, -999.997em); top: -6.014em; left: 50%; margin-left: -0.431em;"><span class="mtd" id="MathJax-Span-271"><span class="mrow" id="MathJax-Span-272"><span class="msubsup" id="MathJax-Span-273"><span style="display: inline-block; position: relative; width: 0.872em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.44em, 4.346em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-274" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.437em;"><span class="mn" id="MathJax-Span-275" style="font-size: 70.7%; font-family: MathJax_Main;">0</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.353em, 1000.87em, 4.346em, -999.997em); top: -4.587em; left: 50%; margin-left: -0.431em;"><span class="mtd" id="MathJax-Span-276"><span class="mrow" id="MathJax-Span-277"><span class="msubsup" id="MathJax-Span-278"><span style="display: inline-block; position: relative; width: 0.872em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.44em, 4.346em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-279" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.437em;"><span class="mn" id="MathJax-Span-280" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.353em, 1000.87em, 4.346em, -999.997em); top: -3.223em; left: 50%; margin-left: -0.431em;"><span class="mtd" id="MathJax-Span-281"><span class="mrow" id="MathJax-Span-282"><span class="msubsup" id="MathJax-Span-283"><span style="display: inline-block; position: relative; width: 0.872em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.44em, 4.346em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-284" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.437em;"><span class="mn" id="MathJax-Span-285" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.353em, 1000.87em, 4.346em, -999.997em); top: -1.796em; left: 50%; margin-left: -0.431em;"><span class="mtd" id="MathJax-Span-286"><span class="mrow" id="MathJax-Span-287"><span class="msubsup" id="MathJax-Span-288"><span style="display: inline-block; position: relative; width: 0.872em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.44em, 4.346em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-289" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.437em;"><span class="mn" id="MathJax-Span-290" style="font-size: 70.7%; font-family: MathJax_Main;">3</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span><span style="display: inline-block; width: 0px; height: 5.834em;"></span></span></span></span><span class="mo" id="MathJax-Span-291" style="vertical-align: 2.857em;"><span style="display: inline-block; position: relative; width: 0.685em; height: 0px;"><span style="position: absolute; font-family: MathJax_Size4; top: -2.788em; left: 0em;">⎤<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; font-family: MathJax_Size4; top: 0.561em; left: 0em;">⎦<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -1.61em; left: 0em;">⎥<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -1.051em; left: 0em;">⎥<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -0.493em; left: 0em;">⎥<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 6.207em;"></span></span><span style="position: absolute; clip: rect(3.167em, 1009.62em, 8.75em, -999.997em); top: -2.726em; left: 0em;"><span class="mtd" id="MathJax-Span-298"><span class="mrow" id="MathJax-Span-299"><span class="mi" id="MathJax-Span-300"></span><span class="mo" id="MathJax-Span-301" style="font-family: MathJax_Main; padding-left: 0.251em;">=</span><span class="mrow" id="MathJax-Span-302" style="padding-left: 0.251em;"><span class="mo" id="MathJax-Span-303" style="vertical-align: 2.857em;"><span style="display: inline-block; position: relative; width: 0.685em; height: 0px;"><span style="position: absolute; font-family: MathJax_Size4; top: -2.788em; left: 0em;">⎡<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; font-family: MathJax_Size4; top: 0.561em; left: 0em;">⎣<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -1.61em; left: 0em;">⎢<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -1.051em; left: 0em;">⎢<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -0.493em; left: 0em;">⎢<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="mtable" id="MathJax-Span-304" style="padding-right: 0.189em; padding-left: 0.189em;"><span style="display: inline-block; position: relative; width: 6.951em; height: 0px;"><span style="position: absolute; clip: rect(3.167em, 1001.68em, 8.502em, -999.997em); top: -5.952em; left: 0em;"><span style="display: inline-block; position: relative; width: 1.678em; height: 0px;"><span style="position: absolute; clip: rect(3.229em, 1001.68em, 4.346em, -999.997em); top: -6.014em; left: 50%; margin-left: -0.803em;"><span class="mtd" id="MathJax-Span-305"><span class="mrow" id="MathJax-Span-306"><span class="mo" id="MathJax-Span-307" style="font-family: MathJax_Main;">−</span><span class="msubsup" id="MathJax-Span-308"><span style="display: inline-block; position: relative; width: 0.872em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.44em, 4.346em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-309" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.437em;"><span class="mn" id="MathJax-Span-310" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.353em, 1000.87em, 4.346em, -999.997em); top: -4.587em; left: 50%; margin-left: -0.431em;"><span class="mtd" id="MathJax-Span-323"><span class="mrow" id="MathJax-Span-324"><span class="msubsup" id="MathJax-Span-325"><span style="display: inline-block; position: relative; width: 0.872em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.44em, 4.346em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-326" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.437em;"><span class="mn" id="MathJax-Span-327" style="font-size: 70.7%; font-family: MathJax_Main;">0</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.353em, 1000.87em, 4.346em, -999.997em); top: -3.223em; left: 50%; margin-left: -0.431em;"><span class="mtd" id="MathJax-Span-339"><span class="mrow" id="MathJax-Span-340"><span class="msubsup" id="MathJax-Span-341"><span style="display: inline-block; position: relative; width: 0.872em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.44em, 4.346em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-342" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.437em;"><span class="mn" id="MathJax-Span-343" style="font-size: 70.7%; font-family: MathJax_Main;">3</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.229em, 1001.68em, 4.346em, -999.997em); top: -1.796em; left: 50%; margin-left: -0.803em;"><span class="mtd" id="MathJax-Span-355"><span class="mrow" id="MathJax-Span-356"><span class="mo" id="MathJax-Span-357" style="font-family: MathJax_Main;">−</span><span class="msubsup" id="MathJax-Span-358"><span style="display: inline-block; position: relative; width: 0.872em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.44em, 4.346em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-359" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.437em;"><span class="mn" id="MathJax-Span-360" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span><span style="display: inline-block; width: 0px; height: 5.958em;"></span></span><span style="position: absolute; clip: rect(3.167em, 1001.68em, 8.502em, -999.997em); top: -5.952em; left: 2.671em;"><span style="display: inline-block; position: relative; width: 1.678em; height: 0px;"><span style="position: absolute; clip: rect(3.229em, 1001.68em, 4.346em, -999.997em); top: -6.014em; left: 50%; margin-left: -0.803em;"><span class="mtd" id="MathJax-Span-311"><span class="mrow" id="MathJax-Span-312"><span class="mo" id="MathJax-Span-313" style="font-family: MathJax_Main;">−</span><span class="msubsup" id="MathJax-Span-314"><span style="display: inline-block; position: relative; width: 0.872em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.44em, 4.346em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-315" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.437em;"><span class="mn" id="MathJax-Span-316" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.229em, 1001.68em, 4.346em, -999.997em); top: -4.587em; left: 50%; margin-left: -0.803em;"><span class="mtd" id="MathJax-Span-328"><span class="mrow" id="MathJax-Span-329"><span class="mo" id="MathJax-Span-330" style="font-family: MathJax_Main;">−</span><span class="msubsup" id="MathJax-Span-331"><span style="display: inline-block; position: relative; width: 0.872em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.44em, 4.346em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-332" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.437em;"><span class="mn" id="MathJax-Span-333" style="font-size: 70.7%; font-family: MathJax_Main;">3</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.353em, 1000.87em, 4.346em, -999.997em); top: -3.223em; left: 50%; margin-left: -0.431em;"><span class="mtd" id="MathJax-Span-344"><span class="mrow" id="MathJax-Span-345"><span class="msubsup" id="MathJax-Span-346"><span style="display: inline-block; position: relative; width: 0.872em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.44em, 4.346em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-347" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.437em;"><span class="mn" id="MathJax-Span-348" style="font-size: 70.7%; font-family: MathJax_Main;">0</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.353em, 1000.87em, 4.346em, -999.997em); top: -1.796em; left: 50%; margin-left: -0.431em;"><span class="mtd" id="MathJax-Span-361"><span class="mrow" id="MathJax-Span-362"><span class="msubsup" id="MathJax-Span-363"><span style="display: inline-block; position: relative; width: 0.872em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.44em, 4.346em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-364" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.437em;"><span class="mn" id="MathJax-Span-365" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span><span style="display: inline-block; width: 0px; height: 5.958em;"></span></span><span style="position: absolute; clip: rect(3.167em, 1001.68em, 8.502em, -999.997em); top: -5.952em; left: 5.338em;"><span style="display: inline-block; position: relative; width: 1.678em; height: 0px;"><span style="position: absolute; clip: rect(3.229em, 1001.68em, 4.346em, -999.997em); top: -6.014em; left: 50%; margin-left: -0.803em;"><span class="mtd" id="MathJax-Span-317"><span class="mrow" id="MathJax-Span-318"><span class="mo" id="MathJax-Span-319" style="font-family: MathJax_Main;">−</span><span class="msubsup" id="MathJax-Span-320"><span style="display: inline-block; position: relative; width: 0.872em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.44em, 4.346em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-321" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.437em;"><span class="mn" id="MathJax-Span-322" style="font-size: 70.7%; font-family: MathJax_Main;">3</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.353em, 1000.87em, 4.346em, -999.997em); top: -4.587em; left: 50%; margin-left: -0.431em;"><span class="mtd" id="MathJax-Span-334"><span class="mrow" id="MathJax-Span-335"><span class="msubsup" id="MathJax-Span-336"><span style="display: inline-block; position: relative; width: 0.872em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.44em, 4.346em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-337" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.437em;"><span class="mn" id="MathJax-Span-338" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.229em, 1001.68em, 4.346em, -999.997em); top: -3.223em; left: 50%; margin-left: -0.803em;"><span class="mtd" id="MathJax-Span-349"><span class="mrow" id="MathJax-Span-350"><span class="mo" id="MathJax-Span-351" style="font-family: MathJax_Main;">−</span><span class="msubsup" id="MathJax-Span-352"><span style="display: inline-block; position: relative; width: 0.872em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.44em, 4.346em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-353" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.437em;"><span class="mn" id="MathJax-Span-354" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.353em, 1000.87em, 4.346em, -999.997em); top: -1.796em; left: 50%; margin-left: -0.431em;"><span class="mtd" id="MathJax-Span-366"><span class="mrow" id="MathJax-Span-367"><span class="msubsup" id="MathJax-Span-368"><span style="display: inline-block; position: relative; width: 0.872em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.44em, 4.346em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-369" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.437em;"><span class="mn" id="MathJax-Span-370" style="font-size: 70.7%; font-family: MathJax_Main;">0</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span><span style="display: inline-block; width: 0px; height: 5.958em;"></span></span></span></span><span class="mo" id="MathJax-Span-371" style="vertical-align: 2.857em;"><span style="display: inline-block; position: relative; width: 0.685em; height: 0px;"><span style="position: absolute; font-family: MathJax_Size4; top: -2.788em; left: 0em;">⎤<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; font-family: MathJax_Size4; top: 0.561em; left: 0em;">⎦<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -1.61em; left: 0em;">⎥<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -1.051em; left: 0em;">⎥<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -0.493em; left: 0em;">⎥<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 6.207em;"></span></span><span style="position: absolute; clip: rect(2.422em, 1003.85em, 6.641em, -999.997em); top: 3.477em; left: 0em;"><span class="mtd" id="MathJax-Span-375"><span class="mrow" id="MathJax-Span-376"><span class="mi" id="MathJax-Span-377"></span><span class="mo" id="MathJax-Span-378" style="font-family: MathJax_Main; padding-left: 0.251em;">=</span><span class="mrow" id="MathJax-Span-379" style="padding-left: 0.251em;"><span class="mo" id="MathJax-Span-380" style="vertical-align: 2.174em;"><span style="display: inline-block; position: relative; width: 0.685em; height: 0px;"><span style="position: absolute; font-family: MathJax_Size4; top: -2.788em; left: 0em;">⎡<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; font-family: MathJax_Size4; top: -0.803em; left: 0em;">⎣<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -1.796em; left: 0em;">⎢<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="mtable" id="MathJax-Span-381" style="padding-right: 0.189em; padding-left: 0.189em;"><span style="display: inline-block; position: relative; width: 1.12em; height: 0px;"><span style="position: absolute; clip: rect(2.422em, 1001.12em, 6.207em, -999.997em); top: -4.401em; left: 0em;"><span style="display: inline-block; position: relative; width: 1.12em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1001.12em, 4.283em, -999.997em); top: -5.332em; left: 50%; margin-left: -0.555em;"><span class="mtd" id="MathJax-Span-382"><span class="mrow" id="MathJax-Span-383"><span class="msubsup" id="MathJax-Span-384"><span style="display: inline-block; position: relative; width: 1.12em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.68em, 4.159em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-385" style="font-family: MathJax_Math-italic;">w</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.748em;"><span class="mn" id="MathJax-Span-386" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.353em, 1001.12em, 4.283em, -999.997em); top: -3.905em; left: 50%; margin-left: -0.555em;"><span class="mtd" id="MathJax-Span-387"><span class="mrow" id="MathJax-Span-388"><span class="msubsup" id="MathJax-Span-389"><span style="display: inline-block; position: relative; width: 1.12em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.68em, 4.159em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-390" style="font-family: MathJax_Math-italic;">w</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.748em;"><span class="mn" id="MathJax-Span-391" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.353em, 1001.12em, 4.346em, -999.997em); top: -2.54em; left: 50%; margin-left: -0.555em;"><span class="mtd" id="MathJax-Span-392"><span class="mrow" id="MathJax-Span-393"><span class="msubsup" id="MathJax-Span-394"><span style="display: inline-block; position: relative; width: 1.12em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.68em, 4.159em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-395" style="font-family: MathJax_Math-italic;">w</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.748em;"><span class="mn" id="MathJax-Span-396" style="font-size: 70.7%; font-family: MathJax_Main;">3</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.408em;"></span></span></span></span><span class="mo" id="MathJax-Span-397" style="vertical-align: 2.174em;"><span style="display: inline-block; position: relative; width: 0.685em; height: 0px;"><span style="position: absolute; font-family: MathJax_Size4; top: -2.788em; left: 0em;">⎤<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; font-family: MathJax_Size4; top: -0.803em; left: 0em;">⎦<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -1.796em; left: 0em;">⎥<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.78em;"></span></span></span><span style="display: inline-block; width: 0px; height: 21.281em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.36em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -12.381em; border-left: 0px solid; width: 0px; height: 25.312em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mtable columnalign="right left right left right left right left right left right left" rowspacing="3pt" columnspacing="0em 2em 0em 2em 0em 2em 0em 2em 0em 2em 0em" displaystyle="true"><mtr><mtd><mi>S</mi><mo stretchy="false">(</mo><mi>w</mi><mo stretchy="false">)</mo></mtd><mtd><mi></mi><mo>=</mo><mrow><mo>[</mo><mtable rowspacing="4pt" columnspacing="1em"><mtr><mtd><mn>0</mn></mtd><mtd><mo>−</mo><msub><mi>w</mi><mn>1</mn></msub></mtd><mtd><mo>−</mo><msub><mi>w</mi><mn>2</mn></msub></mtd><mtd><mo>−</mo><msub><mi>w</mi><mn>3</mn></msub></mtd></mtr><mtr><mtd><msub><mi>w</mi><mn>1</mn></msub></mtd><mtd><mn>0</mn></mtd><mtd><msub><mi>w</mi><mn>3</mn></msub></mtd><mtd><mo>−</mo><msub><mi>w</mi><mn>2</mn></msub></mtd></mtr><mtr><mtd><msub><mi>w</mi><mn>2</mn></msub></mtd><mtd><mo>−</mo><msub><mi>w</mi><mn>3</mn></msub></mtd><mtd><mn>0</mn></mtd><mtd><msub><mi>w</mi><mn>1</mn></msub></mtd></mtr><mtr><mtd><msub><mi>w</mi><mn>3</mn></msub></mtd><mtd><msub><mi>w</mi><mn>2</mn></msub></mtd><mtd><mo>−</mo><msub><mi>w</mi><mn>1</mn></msub></mtd><mtd><mn>0</mn></mtd></mtr></mtable><mo>]</mo></mrow></mtd></mtr><mtr><mtd><mi>q</mi></mtd><mtd><mi></mi><mo>=</mo><mrow><mo>[</mo><mtable rowspacing="4pt" columnspacing="1em"><mtr><mtd><msub><mi>q</mi><mn>0</mn></msub></mtd></mtr><mtr><mtd><msub><mi>q</mi><mn>1</mn></msub></mtd></mtr><mtr><mtd><msub><mi>q</mi><mn>2</mn></msub></mtd></mtr><mtr><mtd><msub><mi>q</mi><mn>3</mn></msub></mtd></mtr></mtable><mo>]</mo></mrow></mtd></mtr><mtr><mtd><mi>S</mi><mo stretchy="false">(</mo><mi>q</mi><mo stretchy="false">)</mo></mtd><mtd><mi></mi><mo>=</mo><mrow><mo>[</mo><mtable rowspacing="4pt" columnspacing="1em"><mtr><mtd><mo>−</mo><msub><mi>q</mi><mn>1</mn></msub></mtd><mtd><mo>−</mo><msub><mi>q</mi><mn>2</mn></msub></mtd><mtd><mo>−</mo><msub><mi>q</mi><mn>3</mn></msub></mtd></mtr><mtr><mtd><msub><mi>q</mi><mn>0</mn></msub></mtd><mtd><mo>−</mo><msub><mi>q</mi><mn>3</mn></msub></mtd><mtd><msub><mi>q</mi><mn>2</mn></msub></mtd></mtr><mtr><mtd><msub><mi>q</mi><mn>3</mn></msub></mtd><mtd><msub><mi>q</mi><mn>0</mn></msub></mtd><mtd><mo>−</mo><msub><mi>q</mi><mn>1</mn></msub></mtd></mtr><mtr><mtd><mo>−</mo><msub><mi>q</mi><mn>2</mn></msub></mtd><mtd><msub><mi>q</mi><mn>1</mn></msub></mtd><mtd><msub><mi>q</mi><mn>0</mn></msub></mtd></mtr></mtable><mo>]</mo></mrow></mtd></mtr><mtr><mtd><mi>w</mi></mtd><mtd><mi></mi><mo>=</mo><mrow><mo>[</mo><mtable rowspacing="4pt" columnspacing="1em"><mtr><mtd><msub><mi>w</mi><mn>1</mn></msub></mtd></mtr><mtr><mtd><msub><mi>w</mi><mn>2</mn></msub></mtd></mtr><mtr><mtd><msub><mi>w</mi><mn>3</mn></msub></mtd></mtr></mtable><mo>]</mo></mrow></mtd></mtr></mtable></math></span></span><script type="math/tex" id="MathJax-Element-9">\begin{align}S(w)&=\begin{bmatrix} 0 & -w_1 & -w_2 & -w_3 \\ w_1 & 0 & w_3 & -w_2 \\ w_2 & -w_3 & 0 & w_1 \\ w_3 & w_2 & -w_1 & 0 \end{bmatrix} \\ q&=\begin{bmatrix} q_0 \\ q_1 \\ q_2 \\ q_3\end{bmatrix} \\ S(q)&=\begin{bmatrix} -q_1 & -q_2 & -q_3 \\ q_0 & -q_3 & q_2 \\ q_3 & q_0 & -q_1 \\ -q_2 & q_1 & q_0 \end{bmatrix} \\ w&=\begin{bmatrix} w_1 \\ w_2 \\ w_3\end{bmatrix}\end{align}</script></p>
<p>In order to compensate for the gyrometer bias, we will need to add in the bias term into equation (2).</p>
<p style="text-align: center;"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-10-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mtable columnalign=&quot;right left right left right left right left right left right left&quot; rowspacing=&quot;3pt&quot; columnspacing=&quot;0em 2em 0em 2em 0em 2em 0em 2em 0em 2em 0em&quot; displaystyle=&quot;true&quot;&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mover&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mo&gt;&amp;#x02D9;&lt;/mo&gt;&lt;/mover&gt;&lt;/mrow&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mi&gt;&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mfrac&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/mfrac&gt;&lt;mi&gt;S&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;w&lt;/mi&gt;&lt;mo&gt;&amp;#x2013;&lt;/mo&gt;&lt;msup&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;mi&gt;g&lt;/mi&gt;&lt;/msup&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd /&gt;&lt;mtd&gt;&lt;mi&gt;&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mfrac&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/mfrac&gt;&lt;mi&gt;S&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;w&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mo&gt;&amp;#x2013;&lt;/mo&gt;&lt;mfrac&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/mfrac&gt;&lt;mi&gt;S&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msup&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;mi&gt;g&lt;/mi&gt;&lt;/msup&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd /&gt;&lt;mtd&gt;&lt;mi&gt;&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mfrac&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/mfrac&gt;&lt;mrow&gt;&lt;mo&gt;[&lt;/mo&gt;&lt;mtable rowspacing=&quot;4pt&quot; columnspacing=&quot;1em&quot;&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;w&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;w&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;w&lt;/mi&gt;&lt;mn&gt;3&lt;/mn&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mi&gt;w&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mi&gt;w&lt;/mi&gt;&lt;mn&gt;3&lt;/mn&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;w&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mi&gt;w&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;w&lt;/mi&gt;&lt;mn&gt;3&lt;/mn&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mi&gt;w&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mi&gt;w&lt;/mi&gt;&lt;mn&gt;3&lt;/mn&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mi&gt;w&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;w&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;/mtable&gt;&lt;mo&gt;]&lt;/mo&gt;&lt;/mrow&gt;&lt;mrow&gt;&lt;mo&gt;[&lt;/mo&gt;&lt;mtable rowspacing=&quot;4pt&quot; columnspacing=&quot;1em&quot;&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mn&gt;3&lt;/mn&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;/mtable&gt;&lt;mo&gt;]&lt;/mo&gt;&lt;/mrow&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mfrac&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/mfrac&gt;&lt;mrow&gt;&lt;mo&gt;[&lt;/mo&gt;&lt;mtable rowspacing=&quot;4pt&quot; columnspacing=&quot;1em&quot;&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;msub&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;msup&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;mi&gt;g&lt;/mi&gt;&lt;/msup&gt;&lt;/mrow&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;msub&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;msup&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;mi&gt;g&lt;/mi&gt;&lt;/msup&gt;&lt;/mrow&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;msub&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;msup&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;mi&gt;g&lt;/mi&gt;&lt;/msup&gt;&lt;/mrow&gt;&lt;mn&gt;3&lt;/mn&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;msup&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;mi&gt;g&lt;/mi&gt;&lt;/msup&gt;&lt;/mrow&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;msup&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;mi&gt;g&lt;/mi&gt;&lt;/msup&gt;&lt;/mrow&gt;&lt;mn&gt;3&lt;/mn&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;msub&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;msup&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;mi&gt;g&lt;/mi&gt;&lt;/msup&gt;&lt;/mrow&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;msup&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;mi&gt;g&lt;/mi&gt;&lt;/msup&gt;&lt;/mrow&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;msub&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;msup&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;mi&gt;g&lt;/mi&gt;&lt;/msup&gt;&lt;/mrow&gt;&lt;mn&gt;3&lt;/mn&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;msup&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;mi&gt;g&lt;/mi&gt;&lt;/msup&gt;&lt;/mrow&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;msup&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;mi&gt;g&lt;/mi&gt;&lt;/msup&gt;&lt;/mrow&gt;&lt;mn&gt;3&lt;/mn&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;msup&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;mi&gt;g&lt;/mi&gt;&lt;/msup&gt;&lt;/mrow&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;msub&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;msup&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;mi&gt;g&lt;/mi&gt;&lt;/msup&gt;&lt;/mrow&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;/mtable&gt;&lt;mo&gt;]&lt;/mo&gt;&lt;/mrow&gt;&lt;mrow&gt;&lt;mo&gt;[&lt;/mo&gt;&lt;mtable rowspacing=&quot;4pt&quot; columnspacing=&quot;1em&quot;&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mn&gt;3&lt;/mn&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;/mtable&gt;&lt;mo&gt;]&lt;/mo&gt;&lt;/mrow&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;/mtable&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-398" style="width: 42.869em; display: inline-block;"><span style="display: inline-block; position: relative; width: 34.556em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(-2.975em, 1034.06em, 7.199em, -999.997em); top: -2.354em; left: 0em;"><span class="mrow" id="MathJax-Span-399"><span class="mtable" id="MathJax-Span-400" style="padding-right: 0.189em; padding-left: 0.189em;"><span style="display: inline-block; position: relative; width: 34.184em; height: 0px;"><span style="position: absolute; clip: rect(3.167em, 1000.5em, 10.425em, -999.997em); top: -7.875em; left: 0em;"><span style="display: inline-block; position: relative; width: 0.623em; height: 0px;"><span style="position: absolute; clip: rect(3.043em, 1000.5em, 4.346em, -999.997em); top: -7.813em; right: 0em;"><span class="mtd" id="MathJax-Span-401"><span class="mrow" id="MathJax-Span-402"><span class="texatom" id="MathJax-Span-403"><span class="mrow" id="MathJax-Span-404"><span class="munderover" id="MathJax-Span-405"><span style="display: inline-block; position: relative; width: 0.623em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.44em, 4.346em, -999.997em); top: -3.967em; left: 0.003em;"><span class="mi" id="MathJax-Span-406" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.105em, 1000.31em, 3.601em, -999.997em); top: -4.029em; left: 0.127em;"><span class="mo" id="MathJax-Span-407" style="font-family: MathJax_Main;">˙</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.787em, 1000em, 4.159em, -999.997em); top: -5.456em; right: 0em;"><span class="mtd" id="MathJax-Span-424"><span class="mrow" id="MathJax-Span-425"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.787em, 1000em, 4.159em, -999.997em); top: -1.61em; right: 0em;"><span class="mtd" id="MathJax-Span-449"><span class="mrow" id="MathJax-Span-450"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span><span style="display: inline-block; width: 0px; height: 7.882em;"></span></span><span style="position: absolute; clip: rect(5.524em, 1033.25em, 15.698em, -999.997em); top: -10.853em; left: 0.623em;"><span style="display: inline-block; position: relative; width: 33.564em; height: 0px;"><span style="position: absolute; clip: rect(2.422em, 1006.27em, 4.842em, -999.997em); top: -7.813em; left: 0em;"><span class="mtd" id="MathJax-Span-408"><span class="mrow" id="MathJax-Span-409"><span class="mi" id="MathJax-Span-410"></span><span class="mo" id="MathJax-Span-411" style="font-family: MathJax_Main; padding-left: 0.251em;">=</span><span class="mfrac" id="MathJax-Span-412" style="padding-left: 0.251em;"><span style="display: inline-block; position: relative; width: 0.623em; height: 0px; margin-right: 0.127em; margin-left: 0.127em;"><span style="position: absolute; clip: rect(3.105em, 1000.44em, 4.159em, -999.997em); top: -4.65em; left: 50%; margin-left: -0.245em;"><span class="mn" id="MathJax-Span-413" style="font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.105em, 1000.44em, 4.159em, -999.997em); top: -3.285em; left: 50%; margin-left: -0.245em;"><span class="mn" id="MathJax-Span-414" style="font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(0.81em, 1000.62em, 1.244em, -999.997em); top: -1.3em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 0.623em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.058em;"></span></span></span></span><span class="mi" id="MathJax-Span-415" style="font-family: MathJax_Math-italic;">S<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.065em;"></span></span><span class="mo" id="MathJax-Span-416" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-417" style="font-family: MathJax_Math-italic;">w</span><span class="mo" id="MathJax-Span-418" style="font-family: MathJax_Main;">–</span><span class="msubsup" id="MathJax-Span-419" style="padding-left: 0.189em;"><span style="display: inline-block; position: relative; width: 0.872em; height: 0px;"><span style="position: absolute; clip: rect(3.105em, 1000.44em, 4.159em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-420" style="font-family: MathJax_Math-italic;">b</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -4.401em; left: 0.437em;"><span class="mi" id="MathJax-Span-421" style="font-size: 70.7%; font-family: MathJax_Math-italic;">g<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="mo" id="MathJax-Span-422" style="font-family: MathJax_Main;">)</span><span class="mi" id="MathJax-Span-423" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(2.422em, 1009em, 4.842em, -999.997em); top: -5.456em; left: 0em;"><span class="mtd" id="MathJax-Span-426"><span class="mrow" id="MathJax-Span-427"><span class="mi" id="MathJax-Span-428"></span><span class="mo" id="MathJax-Span-429" style="font-family: MathJax_Main; padding-left: 0.251em;">=</span><span class="mfrac" id="MathJax-Span-430" style="padding-left: 0.251em;"><span style="display: inline-block; position: relative; width: 0.623em; height: 0px; margin-right: 0.127em; margin-left: 0.127em;"><span style="position: absolute; clip: rect(3.105em, 1000.44em, 4.159em, -999.997em); top: -4.65em; left: 50%; margin-left: -0.245em;"><span class="mn" id="MathJax-Span-431" style="font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.105em, 1000.44em, 4.159em, -999.997em); top: -3.285em; left: 50%; margin-left: -0.245em;"><span class="mn" id="MathJax-Span-432" style="font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(0.81em, 1000.62em, 1.244em, -999.997em); top: -1.3em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 0.623em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.058em;"></span></span></span></span><span class="mi" id="MathJax-Span-433" style="font-family: MathJax_Math-italic;">S<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.065em;"></span></span><span class="mo" id="MathJax-Span-434" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-435" style="font-family: MathJax_Math-italic;">w</span><span class="mo" id="MathJax-Span-436" style="font-family: MathJax_Main;">)</span><span class="mi" id="MathJax-Span-437" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-438" style="font-family: MathJax_Main;">–</span><span class="mfrac" id="MathJax-Span-439" style="padding-left: 0.189em;"><span style="display: inline-block; position: relative; width: 0.623em; height: 0px; margin-right: 0.127em; margin-left: 0.127em;"><span style="position: absolute; clip: rect(3.105em, 1000.44em, 4.159em, -999.997em); top: -4.65em; left: 50%; margin-left: -0.245em;"><span class="mn" id="MathJax-Span-440" style="font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.105em, 1000.44em, 4.159em, -999.997em); top: -3.285em; left: 50%; margin-left: -0.245em;"><span class="mn" id="MathJax-Span-441" style="font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(0.81em, 1000.62em, 1.244em, -999.997em); top: -1.3em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 0.623em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.058em;"></span></span></span></span><span class="mi" id="MathJax-Span-442" style="font-family: MathJax_Math-italic;">S<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.065em;"></span></span><span class="mo" id="MathJax-Span-443" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-444"><span style="display: inline-block; position: relative; width: 0.872em; height: 0px;"><span style="position: absolute; clip: rect(3.105em, 1000.44em, 4.159em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-445" style="font-family: MathJax_Math-italic;">b</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -4.401em; left: 0.437em;"><span class="mi" id="MathJax-Span-446" style="font-size: 70.7%; font-family: MathJax_Math-italic;">g<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="mo" id="MathJax-Span-447" style="font-family: MathJax_Main;">)</span><span class="mi" id="MathJax-Span-448" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.167em, 1033.25em, 8.75em, -999.997em); top: -3.843em; left: 0em;"><span class="mtd" id="MathJax-Span-451"><span class="mrow" id="MathJax-Span-452"><span class="mi" id="MathJax-Span-453"></span><span class="mo" id="MathJax-Span-454" style="font-family: MathJax_Main; padding-left: 0.251em;">=</span><span class="mfrac" id="MathJax-Span-455" style="padding-left: 0.251em;"><span style="display: inline-block; position: relative; width: 0.623em; height: 0px; margin-right: 0.127em; margin-left: 0.127em;"><span style="position: absolute; clip: rect(3.105em, 1000.44em, 4.159em, -999.997em); top: -4.65em; left: 50%; margin-left: -0.245em;"><span class="mn" id="MathJax-Span-456" style="font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.105em, 1000.44em, 4.159em, -999.997em); top: -3.285em; left: 50%; margin-left: -0.245em;"><span class="mn" id="MathJax-Span-457" style="font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(0.81em, 1000.62em, 1.244em, -999.997em); top: -1.3em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 0.623em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.058em;"></span></span></span></span><span class="mrow" id="MathJax-Span-458"><span class="mo" id="MathJax-Span-459" style="vertical-align: 2.857em;"><span style="display: inline-block; position: relative; width: 0.685em; height: 0px;"><span style="position: absolute; font-family: MathJax_Size4; top: -2.788em; left: 0em;">⎡<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; font-family: MathJax_Size4; top: 0.561em; left: 0em;">⎣<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -1.61em; left: 0em;">⎢<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -1.051em; left: 0em;">⎢<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -0.493em; left: 0em;">⎢<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="mtable" id="MathJax-Span-460" style="padding-right: 0.189em; padding-left: 0.189em;"><span style="display: inline-block; position: relative; width: 9.929em; height: 0px;"><span style="position: absolute; clip: rect(3.105em, 1001.12em, 8.502em, -999.997em); top: -6.014em; left: 0em;"><span style="display: inline-block; position: relative; width: 1.12em; height: 0px;"><span style="position: absolute; clip: rect(3.105em, 1000.44em, 4.159em, -999.997em); top: -6.014em; left: 50%; margin-left: -0.245em;"><span class="mtd" id="MathJax-Span-461"><span class="mrow" id="MathJax-Span-462"><span class="mn" id="MathJax-Span-463" style="font-family: MathJax_Main;">0</span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.353em, 1001.12em, 4.283em, -999.997em); top: -4.587em; left: 50%; margin-left: -0.555em;"><span class="mtd" id="MathJax-Span-482"><span class="mrow" id="MathJax-Span-483"><span class="msubsup" id="MathJax-Span-484"><span style="display: inline-block; position: relative; width: 1.12em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.68em, 4.159em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-485" style="font-family: MathJax_Math-italic;">w</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.748em;"><span class="mn" id="MathJax-Span-486" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.353em, 1001.12em, 4.283em, -999.997em); top: -3.223em; left: 50%; margin-left: -0.555em;"><span class="mtd" id="MathJax-Span-501"><span class="mrow" id="MathJax-Span-502"><span class="msubsup" id="MathJax-Span-503"><span style="display: inline-block; position: relative; width: 1.12em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.68em, 4.159em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-504" style="font-family: MathJax_Math-italic;">w</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.748em;"><span class="mn" id="MathJax-Span-505" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.353em, 1001.12em, 4.346em, -999.997em); top: -1.796em; left: 50%; margin-left: -0.555em;"><span class="mtd" id="MathJax-Span-520"><span class="mrow" id="MathJax-Span-521"><span class="msubsup" id="MathJax-Span-522"><span style="display: inline-block; position: relative; width: 1.12em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.68em, 4.159em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-523" style="font-family: MathJax_Math-italic;">w</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.748em;"><span class="mn" id="MathJax-Span-524" style="font-size: 70.7%; font-family: MathJax_Main;">3</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span><span style="display: inline-block; width: 0px; height: 6.02em;"></span></span><span style="position: absolute; clip: rect(3.167em, 1001.93em, 8.44em, -999.997em); top: -5.952em; left: 2.174em;"><span style="display: inline-block; position: relative; width: 1.926em; height: 0px;"><span style="position: absolute; clip: rect(3.229em, 1001.93em, 4.283em, -999.997em); top: -6.014em; left: 50%; margin-left: -0.927em;"><span class="mtd" id="MathJax-Span-464"><span class="mrow" id="MathJax-Span-465"><span class="mo" id="MathJax-Span-466" style="font-family: MathJax_Main;">−</span><span class="msubsup" id="MathJax-Span-467"><span style="display: inline-block; position: relative; width: 1.12em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.68em, 4.159em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-468" style="font-family: MathJax_Math-italic;">w</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.748em;"><span class="mn" id="MathJax-Span-469" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.105em, 1000.44em, 4.159em, -999.997em); top: -4.587em; left: 50%; margin-left: -0.245em;"><span class="mtd" id="MathJax-Span-487"><span class="mrow" id="MathJax-Span-488"><span class="mn" id="MathJax-Span-489" style="font-family: MathJax_Main;">0</span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.229em, 1001.93em, 4.346em, -999.997em); top: -3.223em; left: 50%; margin-left: -0.927em;"><span class="mtd" id="MathJax-Span-506"><span class="mrow" id="MathJax-Span-507"><span class="mo" id="MathJax-Span-508" style="font-family: MathJax_Main;">−</span><span class="msubsup" id="MathJax-Span-509"><span style="display: inline-block; position: relative; width: 1.12em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.68em, 4.159em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-510" style="font-family: MathJax_Math-italic;">w</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.748em;"><span class="mn" id="MathJax-Span-511" style="font-size: 70.7%; font-family: MathJax_Main;">3</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.353em, 1001.12em, 4.283em, -999.997em); top: -1.796em; left: 50%; margin-left: -0.555em;"><span class="mtd" id="MathJax-Span-525"><span class="mrow" id="MathJax-Span-526"><span class="msubsup" id="MathJax-Span-527"><span style="display: inline-block; position: relative; width: 1.12em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.68em, 4.159em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-528" style="font-family: MathJax_Math-italic;">w</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.748em;"><span class="mn" id="MathJax-Span-529" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span><span style="display: inline-block; width: 0px; height: 5.958em;"></span></span><span style="position: absolute; clip: rect(3.167em, 1001.93em, 8.44em, -999.997em); top: -5.952em; left: 5.09em;"><span style="display: inline-block; position: relative; width: 1.926em; height: 0px;"><span style="position: absolute; clip: rect(3.229em, 1001.93em, 4.283em, -999.997em); top: -6.014em; left: 50%; margin-left: -0.927em;"><span class="mtd" id="MathJax-Span-470"><span class="mrow" id="MathJax-Span-471"><span class="mo" id="MathJax-Span-472" style="font-family: MathJax_Main;">−</span><span class="msubsup" id="MathJax-Span-473"><span style="display: inline-block; position: relative; width: 1.12em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.68em, 4.159em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-474" style="font-family: MathJax_Math-italic;">w</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.748em;"><span class="mn" id="MathJax-Span-475" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.353em, 1001.12em, 4.346em, -999.997em); top: -4.587em; left: 50%; margin-left: -0.555em;"><span class="mtd" id="MathJax-Span-490"><span class="mrow" id="MathJax-Span-491"><span class="msubsup" id="MathJax-Span-492"><span style="display: inline-block; position: relative; width: 1.12em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.68em, 4.159em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-493" style="font-family: MathJax_Math-italic;">w</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.748em;"><span class="mn" id="MathJax-Span-494" style="font-size: 70.7%; font-family: MathJax_Main;">3</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.105em, 1000.44em, 4.159em, -999.997em); top: -3.223em; left: 50%; margin-left: -0.245em;"><span class="mtd" id="MathJax-Span-512"><span class="mrow" id="MathJax-Span-513"><span class="mn" id="MathJax-Span-514" style="font-family: MathJax_Main;">0</span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.229em, 1001.93em, 4.283em, -999.997em); top: -1.796em; left: 50%; margin-left: -0.927em;"><span class="mtd" id="MathJax-Span-530"><span class="mrow" id="MathJax-Span-531"><span class="mo" id="MathJax-Span-532" style="font-family: MathJax_Main;">−</span><span class="msubsup" id="MathJax-Span-533"><span style="display: inline-block; position: relative; width: 1.12em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.68em, 4.159em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-534" style="font-family: MathJax_Math-italic;">w</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.748em;"><span class="mn" id="MathJax-Span-535" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span><span style="display: inline-block; width: 0px; height: 5.958em;"></span></span><span style="position: absolute; clip: rect(3.043em, 1001.93em, 8.192em, -999.997em); top: -5.828em; left: 8.006em;"><span style="display: inline-block; position: relative; width: 1.926em; height: 0px;"><span style="position: absolute; clip: rect(3.229em, 1001.93em, 4.346em, -999.997em); top: -6.014em; left: 50%; margin-left: -0.927em;"><span class="mtd" id="MathJax-Span-476"><span class="mrow" id="MathJax-Span-477"><span class="mo" id="MathJax-Span-478" style="font-family: MathJax_Main;">−</span><span class="msubsup" id="MathJax-Span-479"><span style="display: inline-block; position: relative; width: 1.12em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.68em, 4.159em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-480" style="font-family: MathJax_Math-italic;">w</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.748em;"><span class="mn" id="MathJax-Span-481" style="font-size: 70.7%; font-family: MathJax_Main;">3</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.229em, 1001.93em, 4.283em, -999.997em); top: -4.587em; left: 50%; margin-left: -0.927em;"><span class="mtd" id="MathJax-Span-495"><span class="mrow" id="MathJax-Span-496"><span class="mo" id="MathJax-Span-497" style="font-family: MathJax_Main;">−</span><span class="msubsup" id="MathJax-Span-498"><span style="display: inline-block; position: relative; width: 1.12em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.68em, 4.159em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-499" style="font-family: MathJax_Math-italic;">w</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.748em;"><span class="mn" id="MathJax-Span-500" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.353em, 1001.12em, 4.283em, -999.997em); top: -3.223em; left: 50%; margin-left: -0.555em;"><span class="mtd" id="MathJax-Span-515"><span class="mrow" id="MathJax-Span-516"><span class="msubsup" id="MathJax-Span-517"><span style="display: inline-block; position: relative; width: 1.12em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.68em, 4.159em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-518" style="font-family: MathJax_Math-italic;">w</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.748em;"><span class="mn" id="MathJax-Span-519" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.105em, 1000.44em, 4.159em, -999.997em); top: -1.796em; left: 50%; margin-left: -0.245em;"><span class="mtd" id="MathJax-Span-536"><span class="mrow" id="MathJax-Span-537"><span class="mn" id="MathJax-Span-538" style="font-family: MathJax_Main;">0</span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span><span style="display: inline-block; width: 0px; height: 5.834em;"></span></span></span></span><span class="mo" id="MathJax-Span-539" style="vertical-align: 2.857em;"><span style="display: inline-block; position: relative; width: 0.685em; height: 0px;"><span style="position: absolute; font-family: MathJax_Size4; top: -2.788em; left: 0em;">⎤<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; font-family: MathJax_Size4; top: 0.561em; left: 0em;">⎦<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -1.61em; left: 0em;">⎥<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -1.051em; left: 0em;">⎥<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -0.493em; left: 0em;">⎥<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span><span class="mrow" id="MathJax-Span-540" style="padding-left: 0.189em;"><span class="mo" id="MathJax-Span-541" style="vertical-align: 2.857em;"><span style="display: inline-block; position: relative; width: 0.685em; height: 0px;"><span style="position: absolute; font-family: MathJax_Size4; top: -2.788em; left: 0em;">⎡<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; font-family: MathJax_Size4; top: 0.561em; left: 0em;">⎣<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -1.61em; left: 0em;">⎢<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -1.051em; left: 0em;">⎢<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -0.493em; left: 0em;">⎢<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="mtable" id="MathJax-Span-542" style="padding-right: 0.189em; padding-left: 0.189em;"><span style="display: inline-block; position: relative; width: 0.872em; height: 0px;"><span style="position: absolute; clip: rect(3.167em, 1000.87em, 8.378em, -999.997em); top: -5.828em; left: 0em;"><span style="display: inline-block; position: relative; width: 0.872em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.87em, 4.346em, -999.997em); top: -6.014em; left: 50%; margin-left: -0.431em;"><span class="mtd" id="MathJax-Span-543"><span class="mrow" id="MathJax-Span-544"><span class="msubsup" id="MathJax-Span-545"><span style="display: inline-block; position: relative; width: 0.872em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.44em, 4.346em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-546" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.437em;"><span class="mn" id="MathJax-Span-547" style="font-size: 70.7%; font-family: MathJax_Main;">0</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.353em, 1000.87em, 4.346em, -999.997em); top: -4.587em; left: 50%; margin-left: -0.431em;"><span class="mtd" id="MathJax-Span-548"><span class="mrow" id="MathJax-Span-549"><span class="msubsup" id="MathJax-Span-550"><span style="display: inline-block; position: relative; width: 0.872em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.44em, 4.346em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-551" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.437em;"><span class="mn" id="MathJax-Span-552" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.353em, 1000.87em, 4.346em, -999.997em); top: -3.223em; left: 50%; margin-left: -0.431em;"><span class="mtd" id="MathJax-Span-553"><span class="mrow" id="MathJax-Span-554"><span class="msubsup" id="MathJax-Span-555"><span style="display: inline-block; position: relative; width: 0.872em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.44em, 4.346em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-556" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.437em;"><span class="mn" id="MathJax-Span-557" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.353em, 1000.87em, 4.346em, -999.997em); top: -1.796em; left: 50%; margin-left: -0.431em;"><span class="mtd" id="MathJax-Span-558"><span class="mrow" id="MathJax-Span-559"><span class="msubsup" id="MathJax-Span-560"><span style="display: inline-block; position: relative; width: 0.872em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.44em, 4.346em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-561" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.437em;"><span class="mn" id="MathJax-Span-562" style="font-size: 70.7%; font-family: MathJax_Main;">3</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span><span style="display: inline-block; width: 0px; height: 5.834em;"></span></span></span></span><span class="mo" id="MathJax-Span-563" style="vertical-align: 2.857em;"><span style="display: inline-block; position: relative; width: 0.685em; height: 0px;"><span style="position: absolute; font-family: MathJax_Size4; top: -2.788em; left: 0em;">⎤<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; font-family: MathJax_Size4; top: 0.561em; left: 0em;">⎦<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -1.61em; left: 0em;">⎥<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -1.051em; left: 0em;">⎥<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -0.493em; left: 0em;">⎥<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span><span class="mo" id="MathJax-Span-564" style="font-family: MathJax_Main; padding-left: 0.251em;">+</span><span class="mfrac" id="MathJax-Span-565" style="padding-left: 0.251em;"><span style="display: inline-block; position: relative; width: 0.623em; height: 0px; margin-right: 0.127em; margin-left: 0.127em;"><span style="position: absolute; clip: rect(3.105em, 1000.44em, 4.159em, -999.997em); top: -4.65em; left: 50%; margin-left: -0.245em;"><span class="mn" id="MathJax-Span-566" style="font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.105em, 1000.44em, 4.159em, -999.997em); top: -3.285em; left: 50%; margin-left: -0.245em;"><span class="mn" id="MathJax-Span-567" style="font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(0.81em, 1000.62em, 1.244em, -999.997em); top: -1.3em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 0.623em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.058em;"></span></span></span></span><span class="mrow" id="MathJax-Span-568"><span class="mo" id="MathJax-Span-569" style="vertical-align: 2.857em;"><span style="display: inline-block; position: relative; width: 0.685em; height: 0px;"><span style="position: absolute; font-family: MathJax_Size4; top: -2.788em; left: 0em;">⎡<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; font-family: MathJax_Size4; top: 0.561em; left: 0em;">⎣<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -1.61em; left: 0em;">⎢<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -1.051em; left: 0em;">⎢<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -0.493em; left: 0em;">⎢<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="mtable" id="MathJax-Span-570" style="padding-right: 0.189em; padding-left: 0.189em;"><span style="display: inline-block; position: relative; width: 10.425em; height: 0px;"><span style="position: absolute; clip: rect(3.105em, 1001.31em, 8.502em, -999.997em); top: -6.014em; left: 0em;"><span style="display: inline-block; position: relative; width: 1.306em; height: 0px;"><span style="position: absolute; clip: rect(3.105em, 1000.44em, 4.159em, -999.997em); top: -6.014em; left: 50%; margin-left: -0.245em;"><span class="mtd" id="MathJax-Span-571"><span class="mrow" id="MathJax-Span-572"><span class="mn" id="MathJax-Span-573" style="font-family: MathJax_Main;">0</span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.105em, 1001.31em, 4.283em, -999.997em); top: -4.587em; left: 50%; margin-left: -0.617em;"><span class="mtd" id="MathJax-Span-604"><span class="mrow" id="MathJax-Span-605"><span class="msubsup" id="MathJax-Span-606"><span style="display: inline-block; position: relative; width: 1.306em; height: 0px;"><span style="position: absolute; clip: rect(3.105em, 1000.87em, 4.159em, -999.997em); top: -3.967em; left: 0em;"><span class="texatom" id="MathJax-Span-607"><span class="mrow" id="MathJax-Span-608"><span class="msubsup" id="MathJax-Span-609"><span style="display: inline-block; position: relative; width: 0.872em; height: 0px;"><span style="position: absolute; clip: rect(3.105em, 1000.44em, 4.159em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-610" style="font-family: MathJax_Math-italic;">b</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -4.339em; left: 0.437em;"><span class="mi" id="MathJax-Span-611" style="font-size: 70.7%; font-family: MathJax_Math-italic;">g<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.872em;"><span class="mn" id="MathJax-Span-612" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.105em, 1001.31em, 4.283em, -999.997em); top: -3.223em; left: 50%; margin-left: -0.617em;"><span class="mtd" id="MathJax-Span-635"><span class="mrow" id="MathJax-Span-636"><span class="msubsup" id="MathJax-Span-637"><span style="display: inline-block; position: relative; width: 1.306em; height: 0px;"><span style="position: absolute; clip: rect(3.105em, 1000.87em, 4.159em, -999.997em); top: -3.967em; left: 0em;"><span class="texatom" id="MathJax-Span-638"><span class="mrow" id="MathJax-Span-639"><span class="msubsup" id="MathJax-Span-640"><span style="display: inline-block; position: relative; width: 0.872em; height: 0px;"><span style="position: absolute; clip: rect(3.105em, 1000.44em, 4.159em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-641" style="font-family: MathJax_Math-italic;">b</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -4.339em; left: 0.437em;"><span class="mi" id="MathJax-Span-642" style="font-size: 70.7%; font-family: MathJax_Math-italic;">g<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.872em;"><span class="mn" id="MathJax-Span-643" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.105em, 1001.31em, 4.346em, -999.997em); top: -1.796em; left: 50%; margin-left: -0.617em;"><span class="mtd" id="MathJax-Span-666"><span class="mrow" id="MathJax-Span-667"><span class="msubsup" id="MathJax-Span-668"><span style="display: inline-block; position: relative; width: 1.306em; height: 0px;"><span style="position: absolute; clip: rect(3.105em, 1000.87em, 4.159em, -999.997em); top: -3.967em; left: 0em;"><span class="texatom" id="MathJax-Span-669"><span class="mrow" id="MathJax-Span-670"><span class="msubsup" id="MathJax-Span-671"><span style="display: inline-block; position: relative; width: 0.872em; height: 0px;"><span style="position: absolute; clip: rect(3.105em, 1000.44em, 4.159em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-672" style="font-family: MathJax_Math-italic;">b</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -4.339em; left: 0.437em;"><span class="mi" id="MathJax-Span-673" style="font-size: 70.7%; font-family: MathJax_Math-italic;">g<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.872em;"><span class="mn" id="MathJax-Span-674" style="font-size: 70.7%; font-family: MathJax_Main;">3</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span><span style="display: inline-block; width: 0px; height: 6.02em;"></span></span><span style="position: absolute; clip: rect(3.105em, 1002.05em, 8.502em, -999.997em); top: -6.014em; left: 2.298em;"><span style="display: inline-block; position: relative; width: 2.05em; height: 0px;"><span style="position: absolute; clip: rect(3.105em, 1002.05em, 4.283em, -999.997em); top: -6.014em; left: 50%; margin-left: -1.051em;"><span class="mtd" id="MathJax-Span-574"><span class="mrow" id="MathJax-Span-575"><span class="mo" id="MathJax-Span-576" style="font-family: MathJax_Main;">−</span><span class="msubsup" id="MathJax-Span-577"><span style="display: inline-block; position: relative; width: 1.306em; height: 0px;"><span style="position: absolute; clip: rect(3.105em, 1000.87em, 4.159em, -999.997em); top: -3.967em; left: 0em;"><span class="texatom" id="MathJax-Span-578"><span class="mrow" id="MathJax-Span-579"><span class="msubsup" id="MathJax-Span-580"><span style="display: inline-block; position: relative; width: 0.872em; height: 0px;"><span style="position: absolute; clip: rect(3.105em, 1000.44em, 4.159em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-581" style="font-family: MathJax_Math-italic;">b</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -4.339em; left: 0.437em;"><span class="mi" id="MathJax-Span-582" style="font-size: 70.7%; font-family: MathJax_Math-italic;">g<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.872em;"><span class="mn" id="MathJax-Span-583" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.105em, 1000.44em, 4.159em, -999.997em); top: -4.587em; left: 50%; margin-left: -0.245em;"><span class="mtd" id="MathJax-Span-613"><span class="mrow" id="MathJax-Span-614"><span class="mn" id="MathJax-Span-615" style="font-family: MathJax_Main;">0</span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.105em, 1002.05em, 4.346em, -999.997em); top: -3.223em; left: 50%; margin-left: -1.051em;"><span class="mtd" id="MathJax-Span-644"><span class="mrow" id="MathJax-Span-645"><span class="mo" id="MathJax-Span-646" style="font-family: MathJax_Main;">−</span><span class="msubsup" id="MathJax-Span-647"><span style="display: inline-block; position: relative; width: 1.306em; height: 0px;"><span style="position: absolute; clip: rect(3.105em, 1000.87em, 4.159em, -999.997em); top: -3.967em; left: 0em;"><span class="texatom" id="MathJax-Span-648"><span class="mrow" id="MathJax-Span-649"><span class="msubsup" id="MathJax-Span-650"><span style="display: inline-block; position: relative; width: 0.872em; height: 0px;"><span style="position: absolute; clip: rect(3.105em, 1000.44em, 4.159em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-651" style="font-family: MathJax_Math-italic;">b</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -4.339em; left: 0.437em;"><span class="mi" id="MathJax-Span-652" style="font-size: 70.7%; font-family: MathJax_Math-italic;">g<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.872em;"><span class="mn" id="MathJax-Span-653" style="font-size: 70.7%; font-family: MathJax_Main;">3</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.105em, 1001.31em, 4.283em, -999.997em); top: -1.796em; left: 50%; margin-left: -0.617em;"><span class="mtd" id="MathJax-Span-675"><span class="mrow" id="MathJax-Span-676"><span class="msubsup" id="MathJax-Span-677"><span style="display: inline-block; position: relative; width: 1.306em; height: 0px;"><span style="position: absolute; clip: rect(3.105em, 1000.87em, 4.159em, -999.997em); top: -3.967em; left: 0em;"><span class="texatom" id="MathJax-Span-678"><span class="mrow" id="MathJax-Span-679"><span class="msubsup" id="MathJax-Span-680"><span style="display: inline-block; position: relative; width: 0.872em; height: 0px;"><span style="position: absolute; clip: rect(3.105em, 1000.44em, 4.159em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-681" style="font-family: MathJax_Math-italic;">b</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -4.339em; left: 0.437em;"><span class="mi" id="MathJax-Span-682" style="font-size: 70.7%; font-family: MathJax_Math-italic;">g<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.872em;"><span class="mn" id="MathJax-Span-683" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span><span style="display: inline-block; width: 0px; height: 6.02em;"></span></span><span style="position: absolute; clip: rect(3.105em, 1002.05em, 8.502em, -999.997em); top: -6.014em; left: 5.338em;"><span style="display: inline-block; position: relative; width: 2.05em; height: 0px;"><span style="position: absolute; clip: rect(3.105em, 1002.05em, 4.283em, -999.997em); top: -6.014em; left: 50%; margin-left: -1.051em;"><span class="mtd" id="MathJax-Span-584"><span class="mrow" id="MathJax-Span-585"><span class="mo" id="MathJax-Span-586" style="font-family: MathJax_Main;">−</span><span class="msubsup" id="MathJax-Span-587"><span style="display: inline-block; position: relative; width: 1.306em; height: 0px;"><span style="position: absolute; clip: rect(3.105em, 1000.87em, 4.159em, -999.997em); top: -3.967em; left: 0em;"><span class="texatom" id="MathJax-Span-588"><span class="mrow" id="MathJax-Span-589"><span class="msubsup" id="MathJax-Span-590"><span style="display: inline-block; position: relative; width: 0.872em; height: 0px;"><span style="position: absolute; clip: rect(3.105em, 1000.44em, 4.159em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-591" style="font-family: MathJax_Math-italic;">b</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -4.339em; left: 0.437em;"><span class="mi" id="MathJax-Span-592" style="font-size: 70.7%; font-family: MathJax_Math-italic;">g<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.872em;"><span class="mn" id="MathJax-Span-593" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.105em, 1001.31em, 4.346em, -999.997em); top: -4.587em; left: 50%; margin-left: -0.617em;"><span class="mtd" id="MathJax-Span-616"><span class="mrow" id="MathJax-Span-617"><span class="msubsup" id="MathJax-Span-618"><span style="display: inline-block; position: relative; width: 1.306em; height: 0px;"><span style="position: absolute; clip: rect(3.105em, 1000.87em, 4.159em, -999.997em); top: -3.967em; left: 0em;"><span class="texatom" id="MathJax-Span-619"><span class="mrow" id="MathJax-Span-620"><span class="msubsup" id="MathJax-Span-621"><span style="display: inline-block; position: relative; width: 0.872em; height: 0px;"><span style="position: absolute; clip: rect(3.105em, 1000.44em, 4.159em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-622" style="font-family: MathJax_Math-italic;">b</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -4.339em; left: 0.437em;"><span class="mi" id="MathJax-Span-623" style="font-size: 70.7%; font-family: MathJax_Math-italic;">g<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.872em;"><span class="mn" id="MathJax-Span-624" style="font-size: 70.7%; font-family: MathJax_Main;">3</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.105em, 1000.44em, 4.159em, -999.997em); top: -3.223em; left: 50%; margin-left: -0.245em;"><span class="mtd" id="MathJax-Span-654"><span class="mrow" id="MathJax-Span-655"><span class="mn" id="MathJax-Span-656" style="font-family: MathJax_Main;">0</span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.105em, 1002.05em, 4.283em, -999.997em); top: -1.796em; left: 50%; margin-left: -1.051em;"><span class="mtd" id="MathJax-Span-684"><span class="mrow" id="MathJax-Span-685"><span class="mo" id="MathJax-Span-686" style="font-family: MathJax_Main;">−</span><span class="msubsup" id="MathJax-Span-687"><span style="display: inline-block; position: relative; width: 1.306em; height: 0px;"><span style="position: absolute; clip: rect(3.105em, 1000.87em, 4.159em, -999.997em); top: -3.967em; left: 0em;"><span class="texatom" id="MathJax-Span-688"><span class="mrow" id="MathJax-Span-689"><span class="msubsup" id="MathJax-Span-690"><span style="display: inline-block; position: relative; width: 0.872em; height: 0px;"><span style="position: absolute; clip: rect(3.105em, 1000.44em, 4.159em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-691" style="font-family: MathJax_Math-italic;">b</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -4.339em; left: 0.437em;"><span class="mi" id="MathJax-Span-692" style="font-size: 70.7%; font-family: MathJax_Math-italic;">g<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.872em;"><span class="mn" id="MathJax-Span-693" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span><span style="display: inline-block; width: 0px; height: 6.02em;"></span></span><span style="position: absolute; clip: rect(2.981em, 1002.05em, 8.254em, -999.997em); top: -5.89em; left: 8.378em;"><span style="display: inline-block; position: relative; width: 2.05em; height: 0px;"><span style="position: absolute; clip: rect(3.105em, 1002.05em, 4.346em, -999.997em); top: -6.014em; left: 50%; margin-left: -1.051em;"><span class="mtd" id="MathJax-Span-594"><span class="mrow" id="MathJax-Span-595"><span class="mo" id="MathJax-Span-596" style="font-family: MathJax_Main;">−</span><span class="msubsup" id="MathJax-Span-597"><span style="display: inline-block; position: relative; width: 1.306em; height: 0px;"><span style="position: absolute; clip: rect(3.105em, 1000.87em, 4.159em, -999.997em); top: -3.967em; left: 0em;"><span class="texatom" id="MathJax-Span-598"><span class="mrow" id="MathJax-Span-599"><span class="msubsup" id="MathJax-Span-600"><span style="display: inline-block; position: relative; width: 0.872em; height: 0px;"><span style="position: absolute; clip: rect(3.105em, 1000.44em, 4.159em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-601" style="font-family: MathJax_Math-italic;">b</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -4.339em; left: 0.437em;"><span class="mi" id="MathJax-Span-602" style="font-size: 70.7%; font-family: MathJax_Math-italic;">g<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.872em;"><span class="mn" id="MathJax-Span-603" style="font-size: 70.7%; font-family: MathJax_Main;">3</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.105em, 1002.05em, 4.283em, -999.997em); top: -4.587em; left: 50%; margin-left: -1.051em;"><span class="mtd" id="MathJax-Span-625"><span class="mrow" id="MathJax-Span-626"><span class="mo" id="MathJax-Span-627" style="font-family: MathJax_Main;">−</span><span class="msubsup" id="MathJax-Span-628"><span style="display: inline-block; position: relative; width: 1.306em; height: 0px;"><span style="position: absolute; clip: rect(3.105em, 1000.87em, 4.159em, -999.997em); top: -3.967em; left: 0em;"><span class="texatom" id="MathJax-Span-629"><span class="mrow" id="MathJax-Span-630"><span class="msubsup" id="MathJax-Span-631"><span style="display: inline-block; position: relative; width: 0.872em; height: 0px;"><span style="position: absolute; clip: rect(3.105em, 1000.44em, 4.159em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-632" style="font-family: MathJax_Math-italic;">b</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -4.339em; left: 0.437em;"><span class="mi" id="MathJax-Span-633" style="font-size: 70.7%; font-family: MathJax_Math-italic;">g<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.872em;"><span class="mn" id="MathJax-Span-634" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.105em, 1001.31em, 4.283em, -999.997em); top: -3.223em; left: 50%; margin-left: -0.617em;"><span class="mtd" id="MathJax-Span-657"><span class="mrow" id="MathJax-Span-658"><span class="msubsup" id="MathJax-Span-659"><span style="display: inline-block; position: relative; width: 1.306em; height: 0px;"><span style="position: absolute; clip: rect(3.105em, 1000.87em, 4.159em, -999.997em); top: -3.967em; left: 0em;"><span class="texatom" id="MathJax-Span-660"><span class="mrow" id="MathJax-Span-661"><span class="msubsup" id="MathJax-Span-662"><span style="display: inline-block; position: relative; width: 0.872em; height: 0px;"><span style="position: absolute; clip: rect(3.105em, 1000.44em, 4.159em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-663" style="font-family: MathJax_Math-italic;">b</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -4.339em; left: 0.437em;"><span class="mi" id="MathJax-Span-664" style="font-size: 70.7%; font-family: MathJax_Math-italic;">g<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.872em;"><span class="mn" id="MathJax-Span-665" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.105em, 1000.44em, 4.159em, -999.997em); top: -1.796em; left: 50%; margin-left: -0.245em;"><span class="mtd" id="MathJax-Span-694"><span class="mrow" id="MathJax-Span-695"><span class="mn" id="MathJax-Span-696" style="font-family: MathJax_Main;">0</span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span><span style="display: inline-block; width: 0px; height: 5.896em;"></span></span></span></span><span class="mo" id="MathJax-Span-697" style="vertical-align: 2.857em;"><span style="display: inline-block; position: relative; width: 0.685em; height: 0px;"><span style="position: absolute; font-family: MathJax_Size4; top: -2.788em; left: 0em;">⎤<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; font-family: MathJax_Size4; top: 0.561em; left: 0em;">⎦<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -1.61em; left: 0em;">⎥<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -1.051em; left: 0em;">⎥<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -0.493em; left: 0em;">⎥<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span><span class="mrow" id="MathJax-Span-698" style="padding-left: 0.189em;"><span class="mo" id="MathJax-Span-699" style="vertical-align: 2.857em;"><span style="display: inline-block; position: relative; width: 0.685em; height: 0px;"><span style="position: absolute; font-family: MathJax_Size4; top: -2.788em; left: 0em;">⎡<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; font-family: MathJax_Size4; top: 0.561em; left: 0em;">⎣<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -1.61em; left: 0em;">⎢<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -1.051em; left: 0em;">⎢<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -0.493em; left: 0em;">⎢<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="mtable" id="MathJax-Span-700" style="padding-right: 0.189em; padding-left: 0.189em;"><span style="display: inline-block; position: relative; width: 0.872em; height: 0px;"><span style="position: absolute; clip: rect(3.167em, 1000.87em, 8.378em, -999.997em); top: -5.828em; left: 0em;"><span style="display: inline-block; position: relative; width: 0.872em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.87em, 4.346em, -999.997em); top: -6.014em; left: 50%; margin-left: -0.431em;"><span class="mtd" id="MathJax-Span-701"><span class="mrow" id="MathJax-Span-702"><span class="msubsup" id="MathJax-Span-703"><span style="display: inline-block; position: relative; width: 0.872em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.44em, 4.346em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-704" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.437em;"><span class="mn" id="MathJax-Span-705" style="font-size: 70.7%; font-family: MathJax_Main;">0</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.353em, 1000.87em, 4.346em, -999.997em); top: -4.587em; left: 50%; margin-left: -0.431em;"><span class="mtd" id="MathJax-Span-706"><span class="mrow" id="MathJax-Span-707"><span class="msubsup" id="MathJax-Span-708"><span style="display: inline-block; position: relative; width: 0.872em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.44em, 4.346em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-709" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.437em;"><span class="mn" id="MathJax-Span-710" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.353em, 1000.87em, 4.346em, -999.997em); top: -3.223em; left: 50%; margin-left: -0.431em;"><span class="mtd" id="MathJax-Span-711"><span class="mrow" id="MathJax-Span-712"><span class="msubsup" id="MathJax-Span-713"><span style="display: inline-block; position: relative; width: 0.872em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.44em, 4.346em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-714" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.437em;"><span class="mn" id="MathJax-Span-715" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.353em, 1000.87em, 4.346em, -999.997em); top: -1.796em; left: 50%; margin-left: -0.431em;"><span class="mtd" id="MathJax-Span-716"><span class="mrow" id="MathJax-Span-717"><span class="msubsup" id="MathJax-Span-718"><span style="display: inline-block; position: relative; width: 0.872em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.44em, 4.346em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-719" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.437em;"><span class="mn" id="MathJax-Span-720" style="font-size: 70.7%; font-family: MathJax_Main;">3</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span><span style="display: inline-block; width: 0px; height: 5.834em;"></span></span></span></span><span class="mo" id="MathJax-Span-721" style="vertical-align: 2.857em;"><span style="display: inline-block; position: relative; width: 0.685em; height: 0px;"><span style="position: absolute; font-family: MathJax_Size4; top: -2.788em; left: 0em;">⎤<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; font-family: MathJax_Size4; top: 0.561em; left: 0em;">⎦<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -1.61em; left: 0em;">⎥<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -1.051em; left: 0em;">⎥<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -0.493em; left: 0em;">⎥<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 6.207em;"></span></span></span><span style="display: inline-block; width: 0px; height: 10.859em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.36em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -5.842em; border-left: 0px solid; width: 0px; height: 12.388em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mtable columnalign="right left right left right left right left right left right left" rowspacing="3pt" columnspacing="0em 2em 0em 2em 0em 2em 0em 2em 0em 2em 0em" displaystyle="true"><mtr><mtd><mrow class="MJX-TeXAtom-ORD"><mover><mi>q</mi><mo>˙</mo></mover></mrow></mtd><mtd><mi></mi><mo>=</mo><mfrac><mn>1</mn><mn>2</mn></mfrac><mi>S</mi><mo stretchy="false">(</mo><mi>w</mi><mo>–</mo><msup><mi>b</mi><mi>g</mi></msup><mo stretchy="false">)</mo><mi>q</mi></mtd></mtr><mtr><mtd></mtd><mtd><mi></mi><mo>=</mo><mfrac><mn>1</mn><mn>2</mn></mfrac><mi>S</mi><mo stretchy="false">(</mo><mi>w</mi><mo stretchy="false">)</mo><mi>q</mi><mo>–</mo><mfrac><mn>1</mn><mn>2</mn></mfrac><mi>S</mi><mo stretchy="false">(</mo><msup><mi>b</mi><mi>g</mi></msup><mo stretchy="false">)</mo><mi>q</mi></mtd></mtr><mtr><mtd></mtd><mtd><mi></mi><mo>=</mo><mfrac><mn>1</mn><mn>2</mn></mfrac><mrow><mo>[</mo><mtable rowspacing="4pt" columnspacing="1em"><mtr><mtd><mn>0</mn></mtd><mtd><mo>−</mo><msub><mi>w</mi><mn>1</mn></msub></mtd><mtd><mo>−</mo><msub><mi>w</mi><mn>2</mn></msub></mtd><mtd><mo>−</mo><msub><mi>w</mi><mn>3</mn></msub></mtd></mtr><mtr><mtd><msub><mi>w</mi><mn>1</mn></msub></mtd><mtd><mn>0</mn></mtd><mtd><msub><mi>w</mi><mn>3</mn></msub></mtd><mtd><mo>−</mo><msub><mi>w</mi><mn>2</mn></msub></mtd></mtr><mtr><mtd><msub><mi>w</mi><mn>2</mn></msub></mtd><mtd><mo>−</mo><msub><mi>w</mi><mn>3</mn></msub></mtd><mtd><mn>0</mn></mtd><mtd><msub><mi>w</mi><mn>1</mn></msub></mtd></mtr><mtr><mtd><msub><mi>w</mi><mn>3</mn></msub></mtd><mtd><msub><mi>w</mi><mn>2</mn></msub></mtd><mtd><mo>−</mo><msub><mi>w</mi><mn>1</mn></msub></mtd><mtd><mn>0</mn></mtd></mtr></mtable><mo>]</mo></mrow><mrow><mo>[</mo><mtable rowspacing="4pt" columnspacing="1em"><mtr><mtd><msub><mi>q</mi><mn>0</mn></msub></mtd></mtr><mtr><mtd><msub><mi>q</mi><mn>1</mn></msub></mtd></mtr><mtr><mtd><msub><mi>q</mi><mn>2</mn></msub></mtd></mtr><mtr><mtd><msub><mi>q</mi><mn>3</mn></msub></mtd></mtr></mtable><mo>]</mo></mrow><mo>+</mo><mfrac><mn>1</mn><mn>2</mn></mfrac><mrow><mo>[</mo><mtable rowspacing="4pt" columnspacing="1em"><mtr><mtd><mn>0</mn></mtd><mtd><mo>−</mo><msub><mrow class="MJX-TeXAtom-ORD"><msup><mi>b</mi><mi>g</mi></msup></mrow><mn>1</mn></msub></mtd><mtd><mo>−</mo><msub><mrow class="MJX-TeXAtom-ORD"><msup><mi>b</mi><mi>g</mi></msup></mrow><mn>2</mn></msub></mtd><mtd><mo>−</mo><msub><mrow class="MJX-TeXAtom-ORD"><msup><mi>b</mi><mi>g</mi></msup></mrow><mn>3</mn></msub></mtd></mtr><mtr><mtd><msub><mrow class="MJX-TeXAtom-ORD"><msup><mi>b</mi><mi>g</mi></msup></mrow><mn>1</mn></msub></mtd><mtd><mn>0</mn></mtd><mtd><msub><mrow class="MJX-TeXAtom-ORD"><msup><mi>b</mi><mi>g</mi></msup></mrow><mn>3</mn></msub></mtd><mtd><mo>−</mo><msub><mrow class="MJX-TeXAtom-ORD"><msup><mi>b</mi><mi>g</mi></msup></mrow><mn>2</mn></msub></mtd></mtr><mtr><mtd><msub><mrow class="MJX-TeXAtom-ORD"><msup><mi>b</mi><mi>g</mi></msup></mrow><mn>2</mn></msub></mtd><mtd><mo>−</mo><msub><mrow class="MJX-TeXAtom-ORD"><msup><mi>b</mi><mi>g</mi></msup></mrow><mn>3</mn></msub></mtd><mtd><mn>0</mn></mtd><mtd><msub><mrow class="MJX-TeXAtom-ORD"><msup><mi>b</mi><mi>g</mi></msup></mrow><mn>1</mn></msub></mtd></mtr><mtr><mtd><msub><mrow class="MJX-TeXAtom-ORD"><msup><mi>b</mi><mi>g</mi></msup></mrow><mn>3</mn></msub></mtd><mtd><msub><mrow class="MJX-TeXAtom-ORD"><msup><mi>b</mi><mi>g</mi></msup></mrow><mn>2</mn></msub></mtd><mtd><mo>−</mo><msub><mrow class="MJX-TeXAtom-ORD"><msup><mi>b</mi><mi>g</mi></msup></mrow><mn>1</mn></msub></mtd><mtd><mn>0</mn></mtd></mtr></mtable><mo>]</mo></mrow><mrow><mo>[</mo><mtable rowspacing="4pt" columnspacing="1em"><mtr><mtd><msub><mi>q</mi><mn>0</mn></msub></mtd></mtr><mtr><mtd><msub><mi>q</mi><mn>1</mn></msub></mtd></mtr><mtr><mtd><msub><mi>q</mi><mn>2</mn></msub></mtd></mtr><mtr><mtd><msub><mi>q</mi><mn>3</mn></msub></mtd></mtr></mtable><mo>]</mo></mrow></mtd></mtr></mtable></math></span></span><script type="math/tex" id="MathJax-Element-10">\begin{align}\dot{q}&=\frac{1}{2}S(w – b^g)q \\ &=\frac{1}{2}S(w)q – \frac{1}{2}S(b^g)q \\ &= \frac{1}{2}\begin{bmatrix} 0 & -w_1 & -w_2 & -w_3 \\ w_1 & 0 & w_3 & -w_2 \\ w_2 & -w_3 & 0 & w_1 \\ w_3 & w_2 & -w_1 & 0 \end{bmatrix}\begin{bmatrix} q_0 \\ q_1 \\ q_2 \\ q_3\end{bmatrix} + \frac{1}{2}\begin{bmatrix} 0 & -{b^g}_1 & -{b^g}_2 & -{b^g}_3 \\ {b^g}_1 & 0 & {b^g}_3 & -{b^g}_2 \\ {b^g}_2 & -{b^g}_3 & 0 & {b^g}_1 \\ {b^g}_3 & {b^g}_2 & -{b^g}_1 & 0 \end{bmatrix}\begin{bmatrix} q_0 \\ q_1 \\ q_2 \\ q_3 \end{bmatrix}\end{align}</script>&nbsp; &nbsp; &nbsp;——————–&nbsp; &nbsp; &nbsp;(3)</p>
<p>Next, we will need to discretize the above equation so that we can implement it in our program that runs in discrete time. Here, we are simply going to use the first order linearized model to make things simpler. Therefore,</p>
<p style="text-align: center;"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-11-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mover&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mo&gt;&amp;#x02D9;&lt;/mo&gt;&lt;/mover&gt;&lt;/mrow&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;&amp;#x2013;&lt;/mo&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo&gt;/&lt;/mo&gt;&lt;/mrow&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-722" style="width: 13.589em; display: inline-block;"><span style="display: inline-block; position: relative; width: 10.921em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(1.43em, 1010.92em, 2.795em, -999.997em); top: -2.354em; left: 0em;"><span class="mrow" id="MathJax-Span-723"><span class="texatom" id="MathJax-Span-724"><span class="mrow" id="MathJax-Span-725"><span class="munderover" id="MathJax-Span-726"><span style="display: inline-block; position: relative; width: 0.623em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.44em, 4.346em, -999.997em); top: -3.967em; left: 0.003em;"><span class="mi" id="MathJax-Span-727" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.105em, 1000.31em, 3.601em, -999.997em); top: -4.029em; left: 0.127em;"><span class="mo" id="MathJax-Span-728" style="font-family: MathJax_Main;">˙</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span></span><span class="mo" id="MathJax-Span-729" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-730" style="font-family: MathJax_Math-italic;">k</span><span class="mo" id="MathJax-Span-731" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-732" style="font-family: MathJax_Main; padding-left: 0.251em;">=</span><span class="mo" id="MathJax-Span-733" style="font-family: MathJax_Main; padding-left: 0.251em;">[</span><span class="mi" id="MathJax-Span-734" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-735" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-736" style="font-family: MathJax_Math-italic;">k</span><span class="mo" id="MathJax-Span-737" style="font-family: MathJax_Main; padding-left: 0.251em;">+</span><span class="mn" id="MathJax-Span-738" style="font-family: MathJax_Main; padding-left: 0.251em;">1</span><span class="mo" id="MathJax-Span-739" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-740" style="font-family: MathJax_Main;">–</span><span class="mi" id="MathJax-Span-741" style="font-family: MathJax_Math-italic; padding-left: 0.189em;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-742" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-743" style="font-family: MathJax_Math-italic;">k</span><span class="mo" id="MathJax-Span-744" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-745" style="font-family: MathJax_Main;">]</span><span class="texatom" id="MathJax-Span-746"><span class="mrow" id="MathJax-Span-747"><span class="mo" id="MathJax-Span-748" style="font-family: MathJax_Main;">/</span></span></span><span class="mi" id="MathJax-Span-749" style="font-family: MathJax_Math-italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.127em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.36em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.381em; border-left: 0px solid; width: 0px; height: 1.388em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow class="MJX-TeXAtom-ORD"><mover><mi>q</mi><mo>˙</mo></mover></mrow><mo stretchy="false">(</mo><mi>k</mi><mo stretchy="false">)</mo><mo>=</mo><mo stretchy="false">[</mo><mi>q</mi><mo stretchy="false">(</mo><mi>k</mi><mo>+</mo><mn>1</mn><mo stretchy="false">)</mo><mo>–</mo><mi>q</mi><mo stretchy="false">(</mo><mi>k</mi><mo stretchy="false">)</mo><mo stretchy="false">]</mo><mrow class="MJX-TeXAtom-ORD"><mo>/</mo></mrow><mi>T</mi></math></span></span><script type="math/tex" id="MathJax-Element-11">\dot{q}(k) = [q(k+1) – q(k)] / T</script></p>
<p>where</p>
<p><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-12-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-750" style="width: 0.872em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.685em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(1.492em, 1000.68em, 2.547em, -999.997em); top: -2.354em; left: 0em;"><span class="mrow" id="MathJax-Span-751"><span class="mi" id="MathJax-Span-752" style="font-family: MathJax_Math-italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.127em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.36em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.073em; border-left: 0px solid; width: 0px; height: 1.004em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>T</mi></math></span></span><script type="math/tex" id="MathJax-Element-12">T</script> is the time taken between sample <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-13-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-753" style="width: 2.857em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.298em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(1.492em, 1002.24em, 2.609em, -999.997em); top: -2.354em; left: 0em;"><span class="mrow" id="MathJax-Span-754"><span class="mi" id="MathJax-Span-755" style="font-family: MathJax_Math-italic;">k</span><span class="mo" id="MathJax-Span-756" style="font-family: MathJax_Main; padding-left: 0.251em;">+</span><span class="mn" id="MathJax-Span-757" style="font-family: MathJax_Main; padding-left: 0.251em;">1</span></span><span style="display: inline-block; width: 0px; height: 2.36em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.15em; border-left: 0px solid; width: 0px; height: 1.158em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>k</mi><mo>+</mo><mn>1</mn></math></span></span><script type="math/tex" id="MathJax-Element-13">k+1</script> and <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-14-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-758" style="width: 0.623em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.499em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(1.492em, 1000.5em, 2.547em, -999.997em); top: -2.354em; left: 0em;"><span class="mrow" id="MathJax-Span-759"><span class="mi" id="MathJax-Span-760" style="font-family: MathJax_Math-italic;">k</span></span><span style="display: inline-block; width: 0px; height: 2.36em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.073em; border-left: 0px solid; width: 0px; height: 1.004em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>k</mi></math></span></span><script type="math/tex" id="MathJax-Element-14">k</script></p>
<p>Rearranging the equation,</p>
<p style="text-align: center;"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-15-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mover&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mo&gt;&amp;#x02D9;&lt;/mo&gt;&lt;/mover&gt;&lt;/mrow&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-761" style="width: 13.03em; display: inline-block;"><span style="display: inline-block; position: relative; width: 10.487em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(1.43em, 1010.36em, 2.795em, -999.997em); top: -2.354em; left: 0em;"><span class="mrow" id="MathJax-Span-762"><span class="mi" id="MathJax-Span-763" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-764" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-765" style="font-family: MathJax_Math-italic;">k</span><span class="mo" id="MathJax-Span-766" style="font-family: MathJax_Main; padding-left: 0.251em;">+</span><span class="mn" id="MathJax-Span-767" style="font-family: MathJax_Main; padding-left: 0.251em;">1</span><span class="mo" id="MathJax-Span-768" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-769" style="font-family: MathJax_Main; padding-left: 0.251em;">=</span><span class="mi" id="MathJax-Span-770" style="font-family: MathJax_Math-italic; padding-left: 0.251em;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.127em;"></span></span><span class="texatom" id="MathJax-Span-771"><span class="mrow" id="MathJax-Span-772"><span class="munderover" id="MathJax-Span-773"><span style="display: inline-block; position: relative; width: 0.623em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.44em, 4.346em, -999.997em); top: -3.967em; left: 0.003em;"><span class="mi" id="MathJax-Span-774" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.105em, 1000.31em, 3.601em, -999.997em); top: -4.029em; left: 0.127em;"><span class="mo" id="MathJax-Span-775" style="font-family: MathJax_Main;">˙</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span></span><span class="mo" id="MathJax-Span-776" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-777" style="font-family: MathJax_Math-italic;">k</span><span class="mo" id="MathJax-Span-778" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-779" style="font-family: MathJax_Main; padding-left: 0.251em;">+</span><span class="mi" id="MathJax-Span-780" style="font-family: MathJax_Math-italic; padding-left: 0.251em;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-781" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-782" style="font-family: MathJax_Math-italic;">k</span><span class="mo" id="MathJax-Span-783" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.36em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.381em; border-left: 0px solid; width: 0px; height: 1.388em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>q</mi><mo stretchy="false">(</mo><mi>k</mi><mo>+</mo><mn>1</mn><mo stretchy="false">)</mo><mo>=</mo><mi>T</mi><mrow class="MJX-TeXAtom-ORD"><mover><mi>q</mi><mo>˙</mo></mover></mrow><mo stretchy="false">(</mo><mi>k</mi><mo stretchy="false">)</mo><mo>+</mo><mi>q</mi><mo stretchy="false">(</mo><mi>k</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-15">q(k+1) = T\dot{q}(k) + q(k)</script>&nbsp; &nbsp; &nbsp;——————–&nbsp; &nbsp; &nbsp;(4)</p>
<p>Substituting equation (3) into equation (4),</p>
<p style="text-align: center;"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-16-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mfrac&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/mfrac&gt;&lt;mi&gt;S&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;w&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;&amp;#x2013;&lt;/mo&gt;&lt;mfrac&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/mfrac&gt;&lt;mi&gt;S&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msup&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;mi&gt;g&lt;/mi&gt;&lt;/msup&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-784" style="width: 22.708em; display: inline-block;"><span style="display: inline-block; position: relative; width: 18.303em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(1.244em, 1018.18em, 2.919em, -999.997em); top: -2.354em; left: 0em;"><span class="mrow" id="MathJax-Span-785"><span class="mi" id="MathJax-Span-786" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-787" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-788" style="font-family: MathJax_Math-italic;">k</span><span class="mo" id="MathJax-Span-789" style="font-family: MathJax_Main; padding-left: 0.251em;">+</span><span class="mn" id="MathJax-Span-790" style="font-family: MathJax_Main; padding-left: 0.251em;">1</span><span class="mo" id="MathJax-Span-791" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-792" style="font-family: MathJax_Main; padding-left: 0.251em;">=</span><span class="mfrac" id="MathJax-Span-793" style="padding-left: 0.251em;"><span style="display: inline-block; position: relative; width: 0.623em; height: 0px; margin-right: 0.127em; margin-left: 0.127em;"><span style="position: absolute; clip: rect(3.291em, 1000.5em, 4.159em, -999.997em); top: -4.401em; left: 50%; margin-left: -0.245em;"><span class="mi" id="MathJax-Span-794" style="font-size: 70.7%; font-family: MathJax_Math-italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.065em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.291em, 1000.31em, 4.159em, -999.997em); top: -3.595em; left: 50%; margin-left: -0.183em;"><span class="mn" id="MathJax-Span-795" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(0.81em, 1000.62em, 1.244em, -999.997em); top: -1.3em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 0.623em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.058em;"></span></span></span></span><span class="mi" id="MathJax-Span-796" style="font-family: MathJax_Math-italic;">S<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.065em;"></span></span><span class="mo" id="MathJax-Span-797" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-798" style="font-family: MathJax_Math-italic;">w</span><span class="mo" id="MathJax-Span-799" style="font-family: MathJax_Main;">)</span><span class="mi" id="MathJax-Span-800" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-801" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-802" style="font-family: MathJax_Math-italic;">k</span><span class="mo" id="MathJax-Span-803" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-804" style="font-family: MathJax_Main;">–</span><span class="mfrac" id="MathJax-Span-805" style="padding-left: 0.189em;"><span style="display: inline-block; position: relative; width: 0.623em; height: 0px; margin-right: 0.127em; margin-left: 0.127em;"><span style="position: absolute; clip: rect(3.291em, 1000.5em, 4.159em, -999.997em); top: -4.401em; left: 50%; margin-left: -0.245em;"><span class="mi" id="MathJax-Span-806" style="font-size: 70.7%; font-family: MathJax_Math-italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.065em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.291em, 1000.31em, 4.159em, -999.997em); top: -3.595em; left: 50%; margin-left: -0.183em;"><span class="mn" id="MathJax-Span-807" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(0.81em, 1000.62em, 1.244em, -999.997em); top: -1.3em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 0.623em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.058em;"></span></span></span></span><span class="mi" id="MathJax-Span-808" style="font-family: MathJax_Math-italic;">S<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.065em;"></span></span><span class="mo" id="MathJax-Span-809" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-810"><span style="display: inline-block; position: relative; width: 0.872em; height: 0px;"><span style="position: absolute; clip: rect(3.105em, 1000.44em, 4.159em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-811" style="font-family: MathJax_Math-italic;">b</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -4.339em; left: 0.437em;"><span class="mi" id="MathJax-Span-812" style="font-size: 70.7%; font-family: MathJax_Math-italic;">g<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="mo" id="MathJax-Span-813" style="font-family: MathJax_Main;">)</span><span class="mi" id="MathJax-Span-814" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-815" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-816" style="font-family: MathJax_Math-italic;">k</span><span class="mo" id="MathJax-Span-817" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-818" style="font-family: MathJax_Main; padding-left: 0.251em;">+</span><span class="mi" id="MathJax-Span-819" style="font-family: MathJax_Math-italic; padding-left: 0.251em;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-820" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-821" style="font-family: MathJax_Math-italic;">k</span><span class="mo" id="MathJax-Span-822" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.36em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.535em; border-left: 0px solid; width: 0px; height: 1.773em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>q</mi><mo stretchy="false">(</mo><mi>k</mi><mo>+</mo><mn>1</mn><mo stretchy="false">)</mo><mo>=</mo><mfrac><mi>T</mi><mn>2</mn></mfrac><mi>S</mi><mo stretchy="false">(</mo><mi>w</mi><mo stretchy="false">)</mo><mi>q</mi><mo stretchy="false">(</mo><mi>k</mi><mo stretchy="false">)</mo><mo>–</mo><mfrac><mi>T</mi><mn>2</mn></mfrac><mi>S</mi><mo stretchy="false">(</mo><msup><mi>b</mi><mi>g</mi></msup><mo stretchy="false">)</mo><mi>q</mi><mo stretchy="false">(</mo><mi>k</mi><mo stretchy="false">)</mo><mo>+</mo><mi>q</mi><mo stretchy="false">(</mo><mi>k</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-16">q(k+1) = \frac{T}{2}S(w)q(k) – \frac{T}{2}S(b^g)q(k) + q(k)</script>&nbsp; &nbsp; &nbsp;——————–&nbsp; &nbsp; &nbsp;(5)</p>
<p>We can actually write equation (4) in a different manner as shown below such that it will be more meaningful when written in matrix form later.</p>
<p style="text-align: center;"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-17-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mfrac&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/mfrac&gt;&lt;mi&gt;S&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mi&gt;w&lt;/mi&gt;&lt;mo&gt;&amp;#x2013;&lt;/mo&gt;&lt;mfrac&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/mfrac&gt;&lt;mi&gt;S&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;msup&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;mi&gt;g&lt;/mi&gt;&lt;/msup&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-823" style="width: 22.708em; display: inline-block;"><span style="display: inline-block; position: relative; width: 18.303em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(1.244em, 1018.18em, 2.919em, -999.997em); top: -2.354em; left: 0em;"><span class="mrow" id="MathJax-Span-824"><span class="mi" id="MathJax-Span-825" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-826" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-827" style="font-family: MathJax_Math-italic;">k</span><span class="mo" id="MathJax-Span-828" style="font-family: MathJax_Main; padding-left: 0.251em;">+</span><span class="mn" id="MathJax-Span-829" style="font-family: MathJax_Main; padding-left: 0.251em;">1</span><span class="mo" id="MathJax-Span-830" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-831" style="font-family: MathJax_Main; padding-left: 0.251em;">=</span><span class="mfrac" id="MathJax-Span-832" style="padding-left: 0.251em;"><span style="display: inline-block; position: relative; width: 0.623em; height: 0px; margin-right: 0.127em; margin-left: 0.127em;"><span style="position: absolute; clip: rect(3.291em, 1000.5em, 4.159em, -999.997em); top: -4.401em; left: 50%; margin-left: -0.245em;"><span class="mi" id="MathJax-Span-833" style="font-size: 70.7%; font-family: MathJax_Math-italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.065em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.291em, 1000.31em, 4.159em, -999.997em); top: -3.595em; left: 50%; margin-left: -0.183em;"><span class="mn" id="MathJax-Span-834" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(0.81em, 1000.62em, 1.244em, -999.997em); top: -1.3em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 0.623em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.058em;"></span></span></span></span><span class="mi" id="MathJax-Span-835" style="font-family: MathJax_Math-italic;">S<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.065em;"></span></span><span class="mo" id="MathJax-Span-836" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-837" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-838" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-839" style="font-family: MathJax_Math-italic;">k</span><span class="mo" id="MathJax-Span-840" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-841" style="font-family: MathJax_Main;">)</span><span class="mi" id="MathJax-Span-842" style="font-family: MathJax_Math-italic;">w</span><span class="mo" id="MathJax-Span-843" style="font-family: MathJax_Main;">–</span><span class="mfrac" id="MathJax-Span-844" style="padding-left: 0.189em;"><span style="display: inline-block; position: relative; width: 0.623em; height: 0px; margin-right: 0.127em; margin-left: 0.127em;"><span style="position: absolute; clip: rect(3.291em, 1000.5em, 4.159em, -999.997em); top: -4.401em; left: 50%; margin-left: -0.245em;"><span class="mi" id="MathJax-Span-845" style="font-size: 70.7%; font-family: MathJax_Math-italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.065em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.291em, 1000.31em, 4.159em, -999.997em); top: -3.595em; left: 50%; margin-left: -0.183em;"><span class="mn" id="MathJax-Span-846" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(0.81em, 1000.62em, 1.244em, -999.997em); top: -1.3em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 0.623em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.058em;"></span></span></span></span><span class="mi" id="MathJax-Span-847" style="font-family: MathJax_Math-italic;">S<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.065em;"></span></span><span class="mo" id="MathJax-Span-848" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-849" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-850" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-851" style="font-family: MathJax_Math-italic;">k</span><span class="mo" id="MathJax-Span-852" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-853" style="font-family: MathJax_Main;">)</span><span class="msubsup" id="MathJax-Span-854"><span style="display: inline-block; position: relative; width: 0.872em; height: 0px;"><span style="position: absolute; clip: rect(3.105em, 1000.44em, 4.159em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-855" style="font-family: MathJax_Math-italic;">b</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -4.339em; left: 0.437em;"><span class="mi" id="MathJax-Span-856" style="font-size: 70.7%; font-family: MathJax_Math-italic;">g<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="mo" id="MathJax-Span-857" style="font-family: MathJax_Main; padding-left: 0.251em;">+</span><span class="mi" id="MathJax-Span-858" style="font-family: MathJax_Math-italic; padding-left: 0.251em;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-859" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-860" style="font-family: MathJax_Math-italic;">k</span><span class="mo" id="MathJax-Span-861" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.36em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.535em; border-left: 0px solid; width: 0px; height: 1.773em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>q</mi><mo stretchy="false">(</mo><mi>k</mi><mo>+</mo><mn>1</mn><mo stretchy="false">)</mo><mo>=</mo><mfrac><mi>T</mi><mn>2</mn></mfrac><mi>S</mi><mo stretchy="false">(</mo><mi>q</mi><mo stretchy="false">(</mo><mi>k</mi><mo stretchy="false">)</mo><mo stretchy="false">)</mo><mi>w</mi><mo>–</mo><mfrac><mi>T</mi><mn>2</mn></mfrac><mi>S</mi><mo stretchy="false">(</mo><mi>q</mi><mo stretchy="false">(</mo><mi>k</mi><mo stretchy="false">)</mo><mo stretchy="false">)</mo><msup><mi>b</mi><mi>g</mi></msup><mo>+</mo><mi>q</mi><mo stretchy="false">(</mo><mi>k</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-17">q(k+1) = \frac{T}{2}S(q(k))w – \frac{T}{2}S(q(k))b^g + q(k)</script>&nbsp; &nbsp; &nbsp;——————–&nbsp; &nbsp; &nbsp;(6)</p>
<p>Thus, the system state equation can be written as follows.</p>
<p style="text-align: center;"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-18-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mtable columnalign=&quot;right left right left right left right left right left right left&quot; rowspacing=&quot;3pt&quot; columnspacing=&quot;0em 2em 0em 2em 0em 2em 0em 2em 0em 2em 0em&quot; displaystyle=&quot;true&quot;&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mi&gt;&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;msub&gt;&lt;mrow&gt;&lt;mo&gt;[&lt;/mo&gt;&lt;mtable rowspacing=&quot;4pt&quot; columnspacing=&quot;1em&quot;&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mi&gt;I&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mn&gt;4&lt;/mn&gt;&lt;mo&gt;&amp;#xD7;&lt;/mo&gt;&lt;mn&gt;4&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mo&gt;&amp;#x2013;&lt;/mo&gt;&lt;mfrac&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/mfrac&gt;&lt;mi&gt;S&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mn&gt;3&lt;/mn&gt;&lt;mo&gt;&amp;#xD7;&lt;/mo&gt;&lt;mn&gt;4&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mi&gt;I&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mn&gt;3&lt;/mn&gt;&lt;mo&gt;&amp;#xD7;&lt;/mo&gt;&lt;mn&gt;3&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;/mtable&gt;&lt;mo&gt;]&lt;/mo&gt;&lt;/mrow&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;/msub&gt;&lt;msub&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;msub&gt;&lt;mrow&gt;&lt;mo&gt;[&lt;/mo&gt;&lt;mtable rowspacing=&quot;4pt&quot; columnspacing=&quot;1em&quot;&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mfrac&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/mfrac&gt;&lt;mi&gt;S&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mn&gt;3&lt;/mn&gt;&lt;mo&gt;&amp;#xD7;&lt;/mo&gt;&lt;mn&gt;3&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;/mtable&gt;&lt;mo&gt;]&lt;/mo&gt;&lt;/mrow&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;/msub&gt;&lt;msub&gt;&lt;mi&gt;w&lt;/mi&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mrow&gt;&lt;mo&gt;[&lt;/mo&gt;&lt;mtable rowspacing=&quot;4pt&quot; columnspacing=&quot;1em&quot;&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;msup&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;mi&gt;g&lt;/mi&gt;&lt;/msup&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;/mtable&gt;&lt;mo&gt;]&lt;/mo&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mi&gt;&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;msub&gt;&lt;mrow&gt;&lt;mo&gt;[&lt;/mo&gt;&lt;mtable rowspacing=&quot;4pt&quot; columnspacing=&quot;1em&quot;&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mi&gt;I&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mn&gt;4&lt;/mn&gt;&lt;mo&gt;&amp;#xD7;&lt;/mo&gt;&lt;mn&gt;4&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mo&gt;&amp;#x2013;&lt;/mo&gt;&lt;mfrac&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/mfrac&gt;&lt;mi&gt;S&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mn&gt;3&lt;/mn&gt;&lt;mo&gt;&amp;#xD7;&lt;/mo&gt;&lt;mn&gt;4&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mi&gt;I&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mn&gt;3&lt;/mn&gt;&lt;mo&gt;&amp;#xD7;&lt;/mo&gt;&lt;mn&gt;3&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;/mtable&gt;&lt;mo&gt;]&lt;/mo&gt;&lt;/mrow&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;/msub&gt;&lt;msub&gt;&lt;mrow&gt;&lt;mo&gt;[&lt;/mo&gt;&lt;mtable rowspacing=&quot;4pt&quot; columnspacing=&quot;1em&quot;&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;msup&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;mi&gt;g&lt;/mi&gt;&lt;/msup&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;/mtable&gt;&lt;mo&gt;]&lt;/mo&gt;&lt;/mrow&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;msub&gt;&lt;mrow&gt;&lt;mo&gt;[&lt;/mo&gt;&lt;mtable rowspacing=&quot;4pt&quot; columnspacing=&quot;1em&quot;&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mfrac&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/mfrac&gt;&lt;mi&gt;S&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mn&gt;3&lt;/mn&gt;&lt;mo&gt;&amp;#xD7;&lt;/mo&gt;&lt;mn&gt;3&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;/mtable&gt;&lt;mo&gt;]&lt;/mo&gt;&lt;/mrow&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;/msub&gt;&lt;msub&gt;&lt;mi&gt;w&lt;/mi&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;/mtable&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-862" style="width: 29.035em; display: inline-block;"><span style="display: inline-block; position: relative; width: 23.39em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(-1.238em, 1023.2em, 5.462em, -999.997em); top: -2.354em; left: 0em;"><span class="mrow" id="MathJax-Span-863"><span class="mtable" id="MathJax-Span-864" style="padding-right: 0.189em; padding-left: 0.189em;"><span style="display: inline-block; position: relative; width: 23.018em; height: 0px;"><span style="position: absolute; clip: rect(3.539em, 1003.6em, 8.688em, -999.997em); top: -5.828em; left: 0em;"><span style="display: inline-block; position: relative; width: 3.601em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1001.93em, 4.346em, -999.997em); top: -5.642em; right: 0em;"><span class="mtd" id="MathJax-Span-865"><span class="mrow" id="MathJax-Span-866"><span class="msubsup" id="MathJax-Span-867"><span style="display: inline-block; position: relative; width: 1.926em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.5em, 4.159em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-868" style="font-family: MathJax_Math-italic;">x</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.561em;"><span class="texatom" id="MathJax-Span-869"><span class="mrow" id="MathJax-Span-870"><span class="mi" id="MathJax-Span-871" style="font-size: 70.7%; font-family: MathJax_Math-italic;">k</span><span class="mo" id="MathJax-Span-872" style="font-size: 70.7%; font-family: MathJax_Main;">+</span><span class="mn" id="MathJax-Span-873" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(2.36em, 1003.6em, 5.214em, -999.997em); top: -2.292em; right: 0em;"><span class="mtd" id="MathJax-Span-952"><span class="mrow" id="MathJax-Span-953"><span class="msubsup" id="MathJax-Span-954"><span style="display: inline-block; position: relative; width: 3.601em; height: 0px;"><span style="position: absolute; clip: rect(2.36em, 1002.05em, 5.09em, -999.997em); top: -3.967em; left: 0em;"><span class="mrow" id="MathJax-Span-955"><span class="mo" id="MathJax-Span-956" style="vertical-align: 0em;"><span style="font-family: MathJax_Size3;">[</span></span><span class="mtable" id="MathJax-Span-957" style="padding-right: 0.189em; padding-left: 0.189em;"><span style="display: inline-block; position: relative; width: 0.872em; height: 0px;"><span style="position: absolute; clip: rect(2.671em, 1000.87em, 4.904em, -999.997em); top: -3.967em; left: 0em;"><span style="display: inline-block; position: relative; width: 0.872em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.44em, 4.346em, -999.997em); top: -4.587em; left: 50%; margin-left: -0.245em;"><span class="mtd" id="MathJax-Span-958"><span class="mrow" id="MathJax-Span-959"><span class="mi" id="MathJax-Span-960" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.105em, 1000.87em, 4.159em, -999.997em); top: -3.223em; left: 50%; margin-left: -0.431em;"><span class="mtd" id="MathJax-Span-961"><span class="mrow" id="MathJax-Span-962"><span class="msubsup" id="MathJax-Span-963"><span style="display: inline-block; position: relative; width: 0.872em; height: 0px;"><span style="position: absolute; clip: rect(3.105em, 1000.44em, 4.159em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-964" style="font-family: MathJax_Math-italic;">b</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -4.339em; left: 0.437em;"><span class="mi" id="MathJax-Span-965" style="font-size: 70.7%; font-family: MathJax_Math-italic;">g<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="mo" id="MathJax-Span-966" style="vertical-align: 0em;"><span style="font-family: MathJax_Size3;">]</span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -2.975em; left: 2.298em;"><span class="texatom" id="MathJax-Span-967"><span class="mrow" id="MathJax-Span-968"><span class="mi" id="MathJax-Span-969" style="font-size: 70.7%; font-family: MathJax_Math-italic;">k</span><span class="mo" id="MathJax-Span-970" style="font-size: 70.7%; font-family: MathJax_Main;">+</span><span class="mn" id="MathJax-Span-971" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span><span style="display: inline-block; width: 0px; height: 5.834em;"></span></span><span style="position: absolute; clip: rect(3.787em, 1019.42em, 10.487em, -999.997em); top: -7.379em; left: 3.601em;"><span style="display: inline-block; position: relative; width: 19.42em; height: 0px;"><span style="position: absolute; clip: rect(2.112em, 1017.75em, 5.524em, -999.997em); top: -5.704em; left: 0em;"><span class="mtd" id="MathJax-Span-874"><span class="mrow" id="MathJax-Span-875"><span class="mi" id="MathJax-Span-876"></span><span class="mo" id="MathJax-Span-877" style="font-family: MathJax_Main; padding-left: 0.251em;">=</span><span class="msubsup" id="MathJax-Span-878" style="padding-left: 0.251em;"><span style="display: inline-block; position: relative; width: 8.254em; height: 0px;"><span style="position: absolute; clip: rect(2.05em, 1007.51em, 5.4em, -999.997em); top: -3.967em; left: 0em;"><span class="mrow" id="MathJax-Span-879"><span class="mo" id="MathJax-Span-880" style="vertical-align: 0em;"><span style="font-family: MathJax_Size4;">[</span></span><span class="mtable" id="MathJax-Span-881" style="padding-right: 0.189em; padding-left: 0.189em;"><span style="display: inline-block; position: relative; width: 6.269em; height: 0px;"><span style="position: absolute; clip: rect(2.422em, 1001.86em, 5.214em, -999.997em); top: -3.967em; left: 0em;"><span style="display: inline-block; position: relative; width: 1.864em; height: 0px;"><span style="position: absolute; clip: rect(3.105em, 1001.8em, 4.283em, -999.997em); top: -4.65em; left: 50%; margin-left: -0.865em;"><span class="mtd" id="MathJax-Span-882"><span class="mrow" id="MathJax-Span-883"><span class="msubsup" id="MathJax-Span-884"><span style="display: inline-block; position: relative; width: 1.802em; height: 0px;"><span style="position: absolute; clip: rect(3.105em, 1000.5em, 4.159em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-885" style="font-family: MathJax_Math-italic;">I<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.065em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.437em;"><span class="texatom" id="MathJax-Span-886"><span class="mrow" id="MathJax-Span-887"><span class="mn" id="MathJax-Span-888" style="font-size: 70.7%; font-family: MathJax_Main;">4</span><span class="mo" id="MathJax-Span-889" style="font-size: 70.7%; font-family: MathJax_Main;">×</span><span class="mn" id="MathJax-Span-890" style="font-size: 70.7%; font-family: MathJax_Main;">4</span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.105em, 1001.86em, 4.346em, -999.997em); top: -3.037em; left: 50%; margin-left: -0.927em;"><span class="mtd" id="MathJax-Span-901"><span class="mrow" id="MathJax-Span-902"><span class="msubsup" id="MathJax-Span-903"><span style="display: inline-block; position: relative; width: 1.864em; height: 0px;"><span style="position: absolute; clip: rect(3.105em, 1000.44em, 4.159em, -999.997em); top: -3.967em; left: 0em;"><span class="mn" id="MathJax-Span-904" style="font-family: MathJax_Main;">0</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.499em;"><span class="texatom" id="MathJax-Span-905"><span class="mrow" id="MathJax-Span-906"><span class="mn" id="MathJax-Span-907" style="font-size: 70.7%; font-family: MathJax_Main;">3</span><span class="mo" id="MathJax-Span-908" style="font-size: 70.7%; font-family: MathJax_Main;">×</span><span class="mn" id="MathJax-Span-909" style="font-size: 70.7%; font-family: MathJax_Main;">4</span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(2.174em, 1003.35em, 5.214em, -999.997em); top: -3.967em; left: 2.857em;"><span style="display: inline-block; position: relative; width: 3.415em; height: 0px;"><span style="position: absolute; clip: rect(2.857em, 1003.35em, 4.532em, -999.997em); top: -4.65em; left: 50%; margin-left: -1.734em;"><span class="mtd" id="MathJax-Span-891"><span class="mrow" id="MathJax-Span-892"><span class="mo" id="MathJax-Span-893" style="font-family: MathJax_Main;">–</span><span class="mfrac" id="MathJax-Span-894" style="padding-left: 0.189em;"><span style="display: inline-block; position: relative; width: 0.623em; height: 0px; margin-right: 0.127em; margin-left: 0.127em;"><span style="position: absolute; clip: rect(3.291em, 1000.5em, 4.159em, -999.997em); top: -4.401em; left: 50%; margin-left: -0.245em;"><span class="mi" id="MathJax-Span-895" style="font-size: 70.7%; font-family: MathJax_Math-italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.065em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.291em, 1000.31em, 4.159em, -999.997em); top: -3.595em; left: 50%; margin-left: -0.183em;"><span class="mn" id="MathJax-Span-896" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(0.81em, 1000.62em, 1.244em, -999.997em); top: -1.3em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 0.623em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.058em;"></span></span></span></span><span class="mi" id="MathJax-Span-897" style="font-family: MathJax_Math-italic;">S<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.065em;"></span></span><span class="mo" id="MathJax-Span-898" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-899" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-900" style="font-family: MathJax_Main;">)</span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.105em, 1001.8em, 4.346em, -999.997em); top: -3.037em; left: 50%; margin-left: -0.865em;"><span class="mtd" id="MathJax-Span-910"><span class="mrow" id="MathJax-Span-911"><span class="msubsup" id="MathJax-Span-912"><span style="display: inline-block; position: relative; width: 1.802em; height: 0px;"><span style="position: absolute; clip: rect(3.105em, 1000.5em, 4.159em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-913" style="font-family: MathJax_Math-italic;">I<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.065em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.437em;"><span class="texatom" id="MathJax-Span-914"><span class="mrow" id="MathJax-Span-915"><span class="mn" id="MathJax-Span-916" style="font-size: 70.7%; font-family: MathJax_Main;">3</span><span class="mo" id="MathJax-Span-917" style="font-size: 70.7%; font-family: MathJax_Main;">×</span><span class="mn" id="MathJax-Span-918" style="font-size: 70.7%; font-family: MathJax_Main;">3</span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="mo" id="MathJax-Span-919" style="vertical-align: 0em;"><span style="font-family: MathJax_Size4;">]</span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -2.664em; left: 7.819em;"><span class="mi" id="MathJax-Span-920" style="font-size: 70.7%; font-family: MathJax_Math-italic;">k</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-921"><span style="display: inline-block; position: relative; width: 0.996em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.5em, 4.159em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-922" style="font-family: MathJax_Math-italic;">x</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.561em;"><span class="mi" id="MathJax-Span-923" style="font-size: 70.7%; font-family: MathJax_Math-italic;">k</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="mo" id="MathJax-Span-924" style="font-family: MathJax_Main; padding-left: 0.251em;">+</span><span class="msubsup" id="MathJax-Span-925" style="padding-left: 0.251em;"><span style="display: inline-block; position: relative; width: 4.718em; height: 0px;"><span style="position: absolute; clip: rect(2.05em, 1004.03em, 5.4em, -999.997em); top: -3.967em; left: 0em;"><span class="mrow" id="MathJax-Span-926"><span class="mo" id="MathJax-Span-927" style="vertical-align: 0em;"><span style="font-family: MathJax_Size4;">[</span></span><span class="mtable" id="MathJax-Span-928" style="padding-right: 0.189em; padding-left: 0.189em;"><span style="display: inline-block; position: relative; width: 2.733em; height: 0px;"><span style="position: absolute; clip: rect(2.174em, 1002.67em, 5.214em, -999.997em); top: -3.967em; left: 0em;"><span style="display: inline-block; position: relative; width: 2.733em; height: 0px;"><span style="position: absolute; clip: rect(2.857em, 1002.67em, 4.532em, -999.997em); top: -4.65em; left: 50%; margin-left: -1.362em;"><span class="mtd" id="MathJax-Span-929"><span class="mrow" id="MathJax-Span-930"><span class="mfrac" id="MathJax-Span-931"><span style="display: inline-block; position: relative; width: 0.623em; height: 0px; margin-right: 0.127em; margin-left: 0.127em;"><span style="position: absolute; clip: rect(3.291em, 1000.5em, 4.159em, -999.997em); top: -4.401em; left: 50%; margin-left: -0.245em;"><span class="mi" id="MathJax-Span-932" style="font-size: 70.7%; font-family: MathJax_Math-italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.065em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.291em, 1000.31em, 4.159em, -999.997em); top: -3.595em; left: 50%; margin-left: -0.183em;"><span class="mn" id="MathJax-Span-933" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(0.81em, 1000.62em, 1.244em, -999.997em); top: -1.3em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 0.623em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.058em;"></span></span></span></span><span class="mi" id="MathJax-Span-934" style="font-family: MathJax_Math-italic;">S<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.065em;"></span></span><span class="mo" id="MathJax-Span-935" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-936" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-937" style="font-family: MathJax_Main;">)</span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.105em, 1001.86em, 4.346em, -999.997em); top: -3.037em; left: 50%; margin-left: -0.927em;"><span class="mtd" id="MathJax-Span-938"><span class="mrow" id="MathJax-Span-939"><span class="msubsup" id="MathJax-Span-940"><span style="display: inline-block; position: relative; width: 1.864em; height: 0px;"><span style="position: absolute; clip: rect(3.105em, 1000.44em, 4.159em, -999.997em); top: -3.967em; left: 0em;"><span class="mn" id="MathJax-Span-941" style="font-family: MathJax_Main;">0</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.499em;"><span class="texatom" id="MathJax-Span-942"><span class="mrow" id="MathJax-Span-943"><span class="mn" id="MathJax-Span-944" style="font-size: 70.7%; font-family: MathJax_Main;">3</span><span class="mo" id="MathJax-Span-945" style="font-size: 70.7%; font-family: MathJax_Main;">×</span><span class="mn" id="MathJax-Span-946" style="font-size: 70.7%; font-family: MathJax_Main;">3</span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="mo" id="MathJax-Span-947" style="vertical-align: 0em;"><span style="font-family: MathJax_Size4;">]</span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -2.664em; left: 4.283em;"><span class="mi" id="MathJax-Span-948" style="font-size: 70.7%; font-family: MathJax_Math-italic;">k</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-949"><span style="display: inline-block; position: relative; width: 1.182em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.68em, 4.159em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-950" style="font-family: MathJax_Math-italic;">w</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.748em;"><span class="mi" id="MathJax-Span-951" style="font-size: 70.7%; font-family: MathJax_Math-italic;">k</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.035em;"></span></span><span style="position: absolute; clip: rect(2.112em, 1019.42em, 5.524em, -999.997em); top: -2.354em; left: 0em;"><span class="mtd" id="MathJax-Span-972"><span class="mrow" id="MathJax-Span-973"><span class="mi" id="MathJax-Span-974"></span><span class="mo" id="MathJax-Span-975" style="font-family: MathJax_Main; padding-left: 0.251em;">=</span><span class="msubsup" id="MathJax-Span-976" style="padding-left: 0.251em;"><span style="display: inline-block; position: relative; width: 8.254em; height: 0px;"><span style="position: absolute; clip: rect(2.05em, 1007.51em, 5.4em, -999.997em); top: -3.967em; left: 0em;"><span class="mrow" id="MathJax-Span-977"><span class="mo" id="MathJax-Span-978" style="vertical-align: 0em;"><span style="font-family: MathJax_Size4;">[</span></span><span class="mtable" id="MathJax-Span-979" style="padding-right: 0.189em; padding-left: 0.189em;"><span style="display: inline-block; position: relative; width: 6.269em; height: 0px;"><span style="position: absolute; clip: rect(2.422em, 1001.86em, 5.214em, -999.997em); top: -3.967em; left: 0em;"><span style="display: inline-block; position: relative; width: 1.864em; height: 0px;"><span style="position: absolute; clip: rect(3.105em, 1001.8em, 4.283em, -999.997em); top: -4.65em; left: 50%; margin-left: -0.865em;"><span class="mtd" id="MathJax-Span-980"><span class="mrow" id="MathJax-Span-981"><span class="msubsup" id="MathJax-Span-982"><span style="display: inline-block; position: relative; width: 1.802em; height: 0px;"><span style="position: absolute; clip: rect(3.105em, 1000.5em, 4.159em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-983" style="font-family: MathJax_Math-italic;">I<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.065em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.437em;"><span class="texatom" id="MathJax-Span-984"><span class="mrow" id="MathJax-Span-985"><span class="mn" id="MathJax-Span-986" style="font-size: 70.7%; font-family: MathJax_Main;">4</span><span class="mo" id="MathJax-Span-987" style="font-size: 70.7%; font-family: MathJax_Main;">×</span><span class="mn" id="MathJax-Span-988" style="font-size: 70.7%; font-family: MathJax_Main;">4</span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.105em, 1001.86em, 4.346em, -999.997em); top: -3.037em; left: 50%; margin-left: -0.927em;"><span class="mtd" id="MathJax-Span-999"><span class="mrow" id="MathJax-Span-1000"><span class="msubsup" id="MathJax-Span-1001"><span style="display: inline-block; position: relative; width: 1.864em; height: 0px;"><span style="position: absolute; clip: rect(3.105em, 1000.44em, 4.159em, -999.997em); top: -3.967em; left: 0em;"><span class="mn" id="MathJax-Span-1002" style="font-family: MathJax_Main;">0</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.499em;"><span class="texatom" id="MathJax-Span-1003"><span class="mrow" id="MathJax-Span-1004"><span class="mn" id="MathJax-Span-1005" style="font-size: 70.7%; font-family: MathJax_Main;">3</span><span class="mo" id="MathJax-Span-1006" style="font-size: 70.7%; font-family: MathJax_Main;">×</span><span class="mn" id="MathJax-Span-1007" style="font-size: 70.7%; font-family: MathJax_Main;">4</span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(2.174em, 1003.35em, 5.214em, -999.997em); top: -3.967em; left: 2.857em;"><span style="display: inline-block; position: relative; width: 3.415em; height: 0px;"><span style="position: absolute; clip: rect(2.857em, 1003.35em, 4.532em, -999.997em); top: -4.65em; left: 50%; margin-left: -1.734em;"><span class="mtd" id="MathJax-Span-989"><span class="mrow" id="MathJax-Span-990"><span class="mo" id="MathJax-Span-991" style="font-family: MathJax_Main;">–</span><span class="mfrac" id="MathJax-Span-992" style="padding-left: 0.189em;"><span style="display: inline-block; position: relative; width: 0.623em; height: 0px; margin-right: 0.127em; margin-left: 0.127em;"><span style="position: absolute; clip: rect(3.291em, 1000.5em, 4.159em, -999.997em); top: -4.401em; left: 50%; margin-left: -0.245em;"><span class="mi" id="MathJax-Span-993" style="font-size: 70.7%; font-family: MathJax_Math-italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.065em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.291em, 1000.31em, 4.159em, -999.997em); top: -3.595em; left: 50%; margin-left: -0.183em;"><span class="mn" id="MathJax-Span-994" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(0.81em, 1000.62em, 1.244em, -999.997em); top: -1.3em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 0.623em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.058em;"></span></span></span></span><span class="mi" id="MathJax-Span-995" style="font-family: MathJax_Math-italic;">S<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.065em;"></span></span><span class="mo" id="MathJax-Span-996" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-997" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-998" style="font-family: MathJax_Main;">)</span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.105em, 1001.8em, 4.346em, -999.997em); top: -3.037em; left: 50%; margin-left: -0.865em;"><span class="mtd" id="MathJax-Span-1008"><span class="mrow" id="MathJax-Span-1009"><span class="msubsup" id="MathJax-Span-1010"><span style="display: inline-block; position: relative; width: 1.802em; height: 0px;"><span style="position: absolute; clip: rect(3.105em, 1000.5em, 4.159em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-1011" style="font-family: MathJax_Math-italic;">I<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.065em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.437em;"><span class="texatom" id="MathJax-Span-1012"><span class="mrow" id="MathJax-Span-1013"><span class="mn" id="MathJax-Span-1014" style="font-size: 70.7%; font-family: MathJax_Main;">3</span><span class="mo" id="MathJax-Span-1015" style="font-size: 70.7%; font-family: MathJax_Main;">×</span><span class="mn" id="MathJax-Span-1016" style="font-size: 70.7%; font-family: MathJax_Main;">3</span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="mo" id="MathJax-Span-1017" style="vertical-align: 0em;"><span style="font-family: MathJax_Size4;">]</span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -2.664em; left: 7.819em;"><span class="mi" id="MathJax-Span-1018" style="font-size: 70.7%; font-family: MathJax_Math-italic;">k</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-1019"><span style="display: inline-block; position: relative; width: 2.733em; height: 0px;"><span style="position: absolute; clip: rect(2.36em, 1002.05em, 5.09em, -999.997em); top: -3.967em; left: 0em;"><span class="mrow" id="MathJax-Span-1020"><span class="mo" id="MathJax-Span-1021" style="vertical-align: 0em;"><span style="font-family: MathJax_Size3;">[</span></span><span class="mtable" id="MathJax-Span-1022" style="padding-right: 0.189em; padding-left: 0.189em;"><span style="display: inline-block; position: relative; width: 0.872em; height: 0px;"><span style="position: absolute; clip: rect(2.671em, 1000.87em, 4.904em, -999.997em); top: -3.967em; left: 0em;"><span style="display: inline-block; position: relative; width: 0.872em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.44em, 4.346em, -999.997em); top: -4.587em; left: 50%; margin-left: -0.245em;"><span class="mtd" id="MathJax-Span-1023"><span class="mrow" id="MathJax-Span-1024"><span class="mi" id="MathJax-Span-1025" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.105em, 1000.87em, 4.159em, -999.997em); top: -3.223em; left: 50%; margin-left: -0.431em;"><span class="mtd" id="MathJax-Span-1026"><span class="mrow" id="MathJax-Span-1027"><span class="msubsup" id="MathJax-Span-1028"><span style="display: inline-block; position: relative; width: 0.872em; height: 0px;"><span style="position: absolute; clip: rect(3.105em, 1000.44em, 4.159em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-1029" style="font-family: MathJax_Math-italic;">b</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -4.339em; left: 0.437em;"><span class="mi" id="MathJax-Span-1030" style="font-size: 70.7%; font-family: MathJax_Math-italic;">g<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="mo" id="MathJax-Span-1031" style="vertical-align: 0em;"><span style="font-family: MathJax_Size3;">]</span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -2.975em; left: 2.298em;"><span class="mi" id="MathJax-Span-1032" style="font-size: 70.7%; font-family: MathJax_Math-italic;">k</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="mo" id="MathJax-Span-1033" style="font-family: MathJax_Main; padding-left: 0.251em;">+</span><span class="msubsup" id="MathJax-Span-1034" style="padding-left: 0.251em;"><span style="display: inline-block; position: relative; width: 4.718em; height: 0px;"><span style="position: absolute; clip: rect(2.05em, 1004.03em, 5.4em, -999.997em); top: -3.967em; left: 0em;"><span class="mrow" id="MathJax-Span-1035"><span class="mo" id="MathJax-Span-1036" style="vertical-align: 0em;"><span style="font-family: MathJax_Size4;">[</span></span><span class="mtable" id="MathJax-Span-1037" style="padding-right: 0.189em; padding-left: 0.189em;"><span style="display: inline-block; position: relative; width: 2.733em; height: 0px;"><span style="position: absolute; clip: rect(2.174em, 1002.67em, 5.214em, -999.997em); top: -3.967em; left: 0em;"><span style="display: inline-block; position: relative; width: 2.733em; height: 0px;"><span style="position: absolute; clip: rect(2.857em, 1002.67em, 4.532em, -999.997em); top: -4.65em; left: 50%; margin-left: -1.362em;"><span class="mtd" id="MathJax-Span-1038"><span class="mrow" id="MathJax-Span-1039"><span class="mfrac" id="MathJax-Span-1040"><span style="display: inline-block; position: relative; width: 0.623em; height: 0px; margin-right: 0.127em; margin-left: 0.127em;"><span style="position: absolute; clip: rect(3.291em, 1000.5em, 4.159em, -999.997em); top: -4.401em; left: 50%; margin-left: -0.245em;"><span class="mi" id="MathJax-Span-1041" style="font-size: 70.7%; font-family: MathJax_Math-italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.065em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.291em, 1000.31em, 4.159em, -999.997em); top: -3.595em; left: 50%; margin-left: -0.183em;"><span class="mn" id="MathJax-Span-1042" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(0.81em, 1000.62em, 1.244em, -999.997em); top: -1.3em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 0.623em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.058em;"></span></span></span></span><span class="mi" id="MathJax-Span-1043" style="font-family: MathJax_Math-italic;">S<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.065em;"></span></span><span class="mo" id="MathJax-Span-1044" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-1045" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-1046" style="font-family: MathJax_Main;">)</span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.105em, 1001.86em, 4.346em, -999.997em); top: -3.037em; left: 50%; margin-left: -0.927em;"><span class="mtd" id="MathJax-Span-1047"><span class="mrow" id="MathJax-Span-1048"><span class="msubsup" id="MathJax-Span-1049"><span style="display: inline-block; position: relative; width: 1.864em; height: 0px;"><span style="position: absolute; clip: rect(3.105em, 1000.44em, 4.159em, -999.997em); top: -3.967em; left: 0em;"><span class="mn" id="MathJax-Span-1050" style="font-family: MathJax_Main;">0</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.499em;"><span class="texatom" id="MathJax-Span-1051"><span class="mrow" id="MathJax-Span-1052"><span class="mn" id="MathJax-Span-1053" style="font-size: 70.7%; font-family: MathJax_Main;">3</span><span class="mo" id="MathJax-Span-1054" style="font-size: 70.7%; font-family: MathJax_Main;">×</span><span class="mn" id="MathJax-Span-1055" style="font-size: 70.7%; font-family: MathJax_Main;">3</span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="mo" id="MathJax-Span-1056" style="vertical-align: 0em;"><span style="font-family: MathJax_Size4;">]</span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -2.664em; left: 4.283em;"><span class="mi" id="MathJax-Span-1057" style="font-size: 70.7%; font-family: MathJax_Math-italic;">k</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-1058"><span style="display: inline-block; position: relative; width: 1.182em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.68em, 4.159em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-1059" style="font-family: MathJax_Math-italic;">w</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.748em;"><span class="mi" id="MathJax-Span-1060" style="font-size: 70.7%; font-family: MathJax_Math-italic;">k</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.035em;"></span></span></span><span style="display: inline-block; width: 0px; height: 7.385em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.36em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -3.688em; border-left: 0px solid; width: 0px; height: 8.081em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mtable columnalign="right left right left right left right left right left right left" rowspacing="3pt" columnspacing="0em 2em 0em 2em 0em 2em 0em 2em 0em 2em 0em" displaystyle="true"><mtr><mtd><msub><mi>x</mi><mrow class="MJX-TeXAtom-ORD"><mi>k</mi><mo>+</mo><mn>1</mn></mrow></msub></mtd><mtd><mi></mi><mo>=</mo><msub><mrow><mo>[</mo><mtable rowspacing="4pt" columnspacing="1em"><mtr><mtd><msub><mi>I</mi><mrow class="MJX-TeXAtom-ORD"><mn>4</mn><mo>×</mo><mn>4</mn></mrow></msub></mtd><mtd><mo>–</mo><mfrac><mi>T</mi><mn>2</mn></mfrac><mi>S</mi><mo stretchy="false">(</mo><mi>q</mi><mo stretchy="false">)</mo></mtd></mtr><mtr><mtd><msub><mn>0</mn><mrow class="MJX-TeXAtom-ORD"><mn>3</mn><mo>×</mo><mn>4</mn></mrow></msub></mtd><mtd><msub><mi>I</mi><mrow class="MJX-TeXAtom-ORD"><mn>3</mn><mo>×</mo><mn>3</mn></mrow></msub></mtd></mtr></mtable><mo>]</mo></mrow><mi>k</mi></msub><msub><mi>x</mi><mi>k</mi></msub><mo>+</mo><msub><mrow><mo>[</mo><mtable rowspacing="4pt" columnspacing="1em"><mtr><mtd><mfrac><mi>T</mi><mn>2</mn></mfrac><mi>S</mi><mo stretchy="false">(</mo><mi>q</mi><mo stretchy="false">)</mo></mtd></mtr><mtr><mtd><msub><mn>0</mn><mrow class="MJX-TeXAtom-ORD"><mn>3</mn><mo>×</mo><mn>3</mn></mrow></msub></mtd></mtr></mtable><mo>]</mo></mrow><mi>k</mi></msub><msub><mi>w</mi><mi>k</mi></msub></mtd></mtr><mtr><mtd><msub><mrow><mo>[</mo><mtable rowspacing="4pt" columnspacing="1em"><mtr><mtd><mi>q</mi></mtd></mtr><mtr><mtd><msup><mi>b</mi><mi>g</mi></msup></mtd></mtr></mtable><mo>]</mo></mrow><mrow class="MJX-TeXAtom-ORD"><mi>k</mi><mo>+</mo><mn>1</mn></mrow></msub></mtd><mtd><mi></mi><mo>=</mo><msub><mrow><mo>[</mo><mtable rowspacing="4pt" columnspacing="1em"><mtr><mtd><msub><mi>I</mi><mrow class="MJX-TeXAtom-ORD"><mn>4</mn><mo>×</mo><mn>4</mn></mrow></msub></mtd><mtd><mo>–</mo><mfrac><mi>T</mi><mn>2</mn></mfrac><mi>S</mi><mo stretchy="false">(</mo><mi>q</mi><mo stretchy="false">)</mo></mtd></mtr><mtr><mtd><msub><mn>0</mn><mrow class="MJX-TeXAtom-ORD"><mn>3</mn><mo>×</mo><mn>4</mn></mrow></msub></mtd><mtd><msub><mi>I</mi><mrow class="MJX-TeXAtom-ORD"><mn>3</mn><mo>×</mo><mn>3</mn></mrow></msub></mtd></mtr></mtable><mo>]</mo></mrow><mi>k</mi></msub><msub><mrow><mo>[</mo><mtable rowspacing="4pt" columnspacing="1em"><mtr><mtd><mi>q</mi></mtd></mtr><mtr><mtd><msup><mi>b</mi><mi>g</mi></msup></mtd></mtr></mtable><mo>]</mo></mrow><mi>k</mi></msub><mo>+</mo><msub><mrow><mo>[</mo><mtable rowspacing="4pt" columnspacing="1em"><mtr><mtd><mfrac><mi>T</mi><mn>2</mn></mfrac><mi>S</mi><mo stretchy="false">(</mo><mi>q</mi><mo stretchy="false">)</mo></mtd></mtr><mtr><mtd><msub><mn>0</mn><mrow class="MJX-TeXAtom-ORD"><mn>3</mn><mo>×</mo><mn>3</mn></mrow></msub></mtd></mtr></mtable><mo>]</mo></mrow><mi>k</mi></msub><msub><mi>w</mi><mi>k</mi></msub></mtd></mtr></mtable></math></span></span><script type="math/tex" id="MathJax-Element-18">\begin{align} x_{k+1} &= \begin{bmatrix} I_{4×4} & – \frac{T}{2}S(q) \\ 0_{3×4} & I_{3×3} \end{bmatrix}_kx_k + \begin{bmatrix} \frac{T}{2}S(q) \\ 0_{3×3} \end{bmatrix}_kw_k \\ \begin{bmatrix} q \\ b^g \end{bmatrix}_{k+1} &= \begin{bmatrix} I_{4×4} & – \frac{T}{2}S(q) \\ 0_{3×4} & I_{3×3} \end{bmatrix}_k\begin{bmatrix} q \\ b^g \end{bmatrix}_k + \begin{bmatrix} \frac{T}{2}S(q) \\ 0_{3×3} \end{bmatrix}_kw_k \end{align}</script>&nbsp; &nbsp; &nbsp;——————–&nbsp; &nbsp; &nbsp;(7)</p>
<p>*I removed the tilde sign above the variables to make the equation look cleaner but take note that some of the parameters above are vectors while others are scalars (such as <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-19-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1061" style="width: 0.872em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.685em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(1.492em, 1000.68em, 2.547em, -999.997em); top: -2.354em; left: 0em;"><span class="mrow" id="MathJax-Span-1062"><span class="mi" id="MathJax-Span-1063" style="font-family: MathJax_Math-italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.127em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.36em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.073em; border-left: 0px solid; width: 0px; height: 1.004em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>T</mi></math></span></span><script type="math/tex" id="MathJax-Element-19">T</script>).</p>
<p>If you expand equation (7), you will find that the first row will resolve into equation (6), and the second row simply says that the bias at time <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-20-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1064" style="width: 2.857em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.298em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(1.492em, 1002.24em, 2.609em, -999.997em); top: -2.354em; left: 0em;"><span class="mrow" id="MathJax-Span-1065"><span class="mi" id="MathJax-Span-1066" style="font-family: MathJax_Math-italic;">k</span><span class="mo" id="MathJax-Span-1067" style="font-family: MathJax_Main; padding-left: 0.251em;">+</span><span class="mn" id="MathJax-Span-1068" style="font-family: MathJax_Main; padding-left: 0.251em;">1</span></span><span style="display: inline-block; width: 0px; height: 2.36em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.15em; border-left: 0px solid; width: 0px; height: 1.158em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>k</mi><mo>+</mo><mn>1</mn></math></span></span><script type="math/tex" id="MathJax-Element-20">k+1</script> is the same as the bias at time <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-21-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1069" style="width: 0.623em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.499em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(1.492em, 1000.5em, 2.547em, -999.997em); top: -2.354em; left: 0em;"><span class="mrow" id="MathJax-Span-1070"><span class="mi" id="MathJax-Span-1071" style="font-family: MathJax_Math-italic;">k</span></span><span style="display: inline-block; width: 0px; height: 2.36em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.073em; border-left: 0px solid; width: 0px; height: 1.004em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>k</mi></math></span></span><script type="math/tex" id="MathJax-Element-21">k</script>. This may look silly at first because we are just saying that the bias is constant. However, the Kalman Filter alters the states of the equation thus the value of the bias actually changes over time when we actually implement the algorithm.</p>
<p>For the sake of clarity, I am going to expand equation (7) so that there will be no confusion. Below is the expanded form of equation (7).</p>
<p style="text-align: center;"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-22-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mrow&gt;&lt;mo&gt;[&lt;/mo&gt;&lt;mtable rowspacing=&quot;4pt&quot; columnspacing=&quot;1em&quot;&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mn&gt;3&lt;/mn&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;msup&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;mi&gt;g&lt;/mi&gt;&lt;/msup&gt;&lt;/mrow&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;msup&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;mi&gt;g&lt;/mi&gt;&lt;/msup&gt;&lt;/mrow&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;msup&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;mi&gt;g&lt;/mi&gt;&lt;/msup&gt;&lt;/mrow&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;/mtable&gt;&lt;mo&gt;]&lt;/mo&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mrow&gt;&lt;mo&gt;[&lt;/mo&gt;&lt;mtable rowspacing=&quot;4pt&quot; columnspacing=&quot;1em&quot;&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mfrac&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/mfrac&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mfrac&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/mfrac&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mfrac&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/mfrac&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mn&gt;3&lt;/mn&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mfrac&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/mfrac&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mfrac&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/mfrac&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mn&gt;3&lt;/mn&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mfrac&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/mfrac&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mfrac&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/mfrac&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mn&gt;3&lt;/mn&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mfrac&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/mfrac&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mfrac&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/mfrac&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mfrac&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/mfrac&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mfrac&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/mfrac&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mfrac&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/mfrac&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;/mtable&gt;&lt;mo&gt;]&lt;/mo&gt;&lt;/mrow&gt;&lt;msub&gt;&lt;mrow&gt;&lt;mo&gt;[&lt;/mo&gt;&lt;mtable rowspacing=&quot;4pt&quot; columnspacing=&quot;1em&quot;&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mn&gt;3&lt;/mn&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;msup&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;mi&gt;g&lt;/mi&gt;&lt;/msup&gt;&lt;/mrow&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;msup&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;mi&gt;g&lt;/mi&gt;&lt;/msup&gt;&lt;/mrow&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;msup&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;mi&gt;g&lt;/mi&gt;&lt;/msup&gt;&lt;/mrow&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;/mtable&gt;&lt;mo&gt;]&lt;/mo&gt;&lt;/mrow&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mfrac&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/mfrac&gt;&lt;msub&gt;&lt;mrow&gt;&lt;mo&gt;[&lt;/mo&gt;&lt;mtable rowspacing=&quot;4pt&quot; columnspacing=&quot;1em&quot;&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mn&gt;3&lt;/mn&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mn&gt;3&lt;/mn&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mn&gt;3&lt;/mn&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;/mtable&gt;&lt;mo&gt;]&lt;/mo&gt;&lt;/mrow&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;/msub&gt;&lt;msub&gt;&lt;mrow&gt;&lt;mo&gt;[&lt;/mo&gt;&lt;mtable rowspacing=&quot;4pt&quot; columnspacing=&quot;1em&quot;&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mi&gt;w&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mi&gt;w&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mi&gt;w&lt;/mi&gt;&lt;mn&gt;3&lt;/mn&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;/mtable&gt;&lt;mo&gt;]&lt;/mo&gt;&lt;/mrow&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1072" style="width: 56.951em; display: inline-block;"><span style="display: inline-block; position: relative; width: 45.909em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(2.174em, 1045.91em, 13.154em, -999.997em); top: -7.937em; left: 0em;"><span class="mrow" id="MathJax-Span-1073"><span class="msubsup" id="MathJax-Span-1074"><span style="display: inline-block; position: relative; width: 4.408em; height: 0px;"><span style="position: absolute; clip: rect(5.276em, 1002.73em, 15.14em, -999.997em); top: -10.481em; left: 0em;"><span class="mrow" id="MathJax-Span-1075"><span class="mo" id="MathJax-Span-1076" style="vertical-align: 5.028em;"><span style="display: inline-block; position: relative; width: 0.685em; height: 0px;"><span style="position: absolute; font-family: MathJax_Size4; top: -2.788em; left: 0em;">⎡<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; font-family: MathJax_Size4; top: 4.904em; left: 0em;">⎣<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -1.61em; left: 0em;">⎢<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -1.114em; left: 0em;">⎢<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -0.555em; left: 0em;">⎢<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: 0.003em; left: 0em;">⎢<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: 0.561em; left: 0em;">⎢<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: 1.058em; left: 0em;">⎢<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: 1.616em; left: 0em;">⎢<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: 2.174em; left: 0em;">⎢<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: 2.733em; left: 0em;">⎢<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: 3.229em; left: 0em;">⎢<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: 3.787em; left: 0em;">⎢<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="mtable" id="MathJax-Span-1077" style="padding-right: 0.189em; padding-left: 0.189em;"><span style="display: inline-block; position: relative; width: 1.306em; height: 0px;"><span style="position: absolute; clip: rect(5.276em, 1001.31em, 14.767em, -999.997em); top: -10.109em; left: 0em;"><span style="display: inline-block; position: relative; width: 1.306em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.87em, 4.346em, -999.997em); top: -8.185em; left: 50%; margin-left: -0.431em;"><span class="mtd" id="MathJax-Span-1078"><span class="mrow" id="MathJax-Span-1079"><span class="msubsup" id="MathJax-Span-1080"><span style="display: inline-block; position: relative; width: 0.872em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.44em, 4.346em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-1081" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.437em;"><span class="mn" id="MathJax-Span-1082" style="font-size: 70.7%; font-family: MathJax_Main;">0</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.353em, 1000.87em, 4.346em, -999.997em); top: -6.759em; left: 50%; margin-left: -0.431em;"><span class="mtd" id="MathJax-Span-1083"><span class="mrow" id="MathJax-Span-1084"><span class="msubsup" id="MathJax-Span-1085"><span style="display: inline-block; position: relative; width: 0.872em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.44em, 4.346em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-1086" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.437em;"><span class="mn" id="MathJax-Span-1087" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.353em, 1000.87em, 4.346em, -999.997em); top: -5.394em; left: 50%; margin-left: -0.431em;"><span class="mtd" id="MathJax-Span-1088"><span class="mrow" id="MathJax-Span-1089"><span class="msubsup" id="MathJax-Span-1090"><span style="display: inline-block; position: relative; width: 0.872em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.44em, 4.346em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-1091" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.437em;"><span class="mn" id="MathJax-Span-1092" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.353em, 1000.87em, 4.346em, -999.997em); top: -3.967em; left: 50%; margin-left: -0.431em;"><span class="mtd" id="MathJax-Span-1093"><span class="mrow" id="MathJax-Span-1094"><span class="msubsup" id="MathJax-Span-1095"><span style="display: inline-block; position: relative; width: 0.872em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.44em, 4.346em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-1096" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.437em;"><span class="mn" id="MathJax-Span-1097" style="font-size: 70.7%; font-family: MathJax_Main;">3</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.105em, 1001.31em, 4.346em, -999.997em); top: -2.54em; left: 50%; margin-left: -0.679em;"><span class="mtd" id="MathJax-Span-1098"><span class="mrow" id="MathJax-Span-1099"><span class="msubsup" id="MathJax-Span-1100"><span style="display: inline-block; position: relative; width: 1.306em; height: 0px;"><span style="position: absolute; clip: rect(3.105em, 1000.87em, 4.159em, -999.997em); top: -3.967em; left: 0em;"><span class="texatom" id="MathJax-Span-1101"><span class="mrow" id="MathJax-Span-1102"><span class="msubsup" id="MathJax-Span-1103"><span style="display: inline-block; position: relative; width: 0.872em; height: 0px;"><span style="position: absolute; clip: rect(3.105em, 1000.44em, 4.159em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-1104" style="font-family: MathJax_Math-italic;">b</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -4.339em; left: 0.437em;"><span class="mi" id="MathJax-Span-1105" style="font-size: 70.7%; font-family: MathJax_Math-italic;">g<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.872em;"><span class="mi" id="MathJax-Span-1106" style="font-size: 70.7%; font-family: MathJax_Math-italic;">x</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.105em, 1001.24em, 4.47em, -999.997em); top: -1.176em; left: 50%; margin-left: -0.617em;"><span class="mtd" id="MathJax-Span-1107"><span class="mrow" id="MathJax-Span-1108"><span class="msubsup" id="MathJax-Span-1109"><span style="display: inline-block; position: relative; width: 1.244em; height: 0px;"><span style="position: absolute; clip: rect(3.105em, 1000.87em, 4.159em, -999.997em); top: -3.967em; left: 0em;"><span class="texatom" id="MathJax-Span-1110"><span class="mrow" id="MathJax-Span-1111"><span class="msubsup" id="MathJax-Span-1112"><span style="display: inline-block; position: relative; width: 0.872em; height: 0px;"><span style="position: absolute; clip: rect(3.105em, 1000.44em, 4.159em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-1113" style="font-family: MathJax_Math-italic;">b</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -4.339em; left: 0.437em;"><span class="mi" id="MathJax-Span-1114" style="font-size: 70.7%; font-family: MathJax_Math-italic;">g<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.872em;"><span class="mi" id="MathJax-Span-1115" style="font-size: 70.7%; font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.105em, 1001.24em, 4.346em, -999.997em); top: 0.313em; left: 50%; margin-left: -0.617em;"><span class="mtd" id="MathJax-Span-1116"><span class="mrow" id="MathJax-Span-1117"><span class="msubsup" id="MathJax-Span-1118"><span style="display: inline-block; position: relative; width: 1.244em; height: 0px;"><span style="position: absolute; clip: rect(3.105em, 1000.87em, 4.159em, -999.997em); top: -3.967em; left: 0em;"><span class="texatom" id="MathJax-Span-1119"><span class="mrow" id="MathJax-Span-1120"><span class="msubsup" id="MathJax-Span-1121"><span style="display: inline-block; position: relative; width: 0.872em; height: 0px;"><span style="position: absolute; clip: rect(3.105em, 1000.44em, 4.159em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-1122" style="font-family: MathJax_Math-italic;">b</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -4.339em; left: 0.437em;"><span class="mi" id="MathJax-Span-1123" style="font-size: 70.7%; font-family: MathJax_Math-italic;">g<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.872em;"><span class="mi" id="MathJax-Span-1124" style="font-size: 70.7%; font-family: MathJax_Math-italic;">z<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span><span style="display: inline-block; width: 0px; height: 10.115em;"></span></span></span></span><span class="mo" id="MathJax-Span-1125" style="vertical-align: 5.028em;"><span style="display: inline-block; position: relative; width: 0.685em; height: 0px;"><span style="position: absolute; font-family: MathJax_Size4; top: -2.788em; left: 0em;">⎤<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; font-family: MathJax_Size4; top: 4.904em; left: 0em;">⎦<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -1.61em; left: 0em;">⎥<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -1.114em; left: 0em;">⎥<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -0.555em; left: 0em;">⎥<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: 0.003em; left: 0em;">⎥<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: 0.561em; left: 0em;">⎥<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: 1.058em; left: 0em;">⎥<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: 1.616em; left: 0em;">⎥<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: 2.174em; left: 0em;">⎥<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: 2.733em; left: 0em;">⎥<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: 3.229em; left: 0em;">⎥<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: 3.787em; left: 0em;">⎥<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 10.487em;"></span></span><span style="position: absolute; top: 0.561em; left: 3.043em;"><span class="texatom" id="MathJax-Span-1126"><span class="mrow" id="MathJax-Span-1127"><span class="mi" id="MathJax-Span-1128" style="font-size: 70.7%; font-family: MathJax_Math-italic;">k</span><span class="mo" id="MathJax-Span-1129" style="font-size: 70.7%; font-family: MathJax_Main;">+</span><span class="mn" id="MathJax-Span-1130" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="mo" id="MathJax-Span-1131" style="font-family: MathJax_Main; padding-left: 0.251em;">=</span><span class="mrow" id="MathJax-Span-1132" style="padding-left: 0.251em;"><span class="mo" id="MathJax-Span-1133" style="vertical-align: 5.586em;"><span style="display: inline-block; position: relative; width: 0.685em; height: 0px;"><span style="position: absolute; font-family: MathJax_Size4; top: -2.788em; left: 0em;">⎡<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; font-family: MathJax_Size4; top: 6.02em; left: 0em;">⎣<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -1.61em; left: 0em;">⎢<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -1.051em; left: 0em;">⎢<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -0.555em; left: 0em;">⎢<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: 0.003em; left: 0em;">⎢<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: 0.561em; left: 0em;">⎢<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: 1.12em; left: 0em;">⎢<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: 1.616em; left: 0em;">⎢<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: 2.174em; left: 0em;">⎢<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: 2.733em; left: 0em;">⎢<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: 3.291em; left: 0em;">⎢<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: 3.787em; left: 0em;">⎢<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: 4.346em; left: 0em;">⎢<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: 4.904em; left: 0em;">⎢<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="mtable" id="MathJax-Span-1134" style="padding-right: 0.189em; padding-left: 0.189em;"><span style="display: inline-block; position: relative; width: 20.226em; height: 0px;"><span style="position: absolute; clip: rect(5.648em, 1000.44em, 16.256em, -999.997em); top: -11.163em; left: 0em;"><span style="display: inline-block; position: relative; width: 0.499em; height: 0px;"><span style="position: absolute; clip: rect(3.105em, 1000.44em, 4.159em, -999.997em); top: -8.62em; left: 50%; margin-left: -0.245em;"><span class="mtd" id="MathJax-Span-1135"><span class="mrow" id="MathJax-Span-1136"><span class="mn" id="MathJax-Span-1137" style="font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.105em, 1000.44em, 4.159em, -999.997em); top: -6.945em; left: 50%; margin-left: -0.245em;"><span class="mtd" id="MathJax-Span-1183"><span class="mrow" id="MathJax-Span-1184"><span class="mn" id="MathJax-Span-1185" style="font-family: MathJax_Main;">0</span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.105em, 1000.44em, 4.159em, -999.997em); top: -5.208em; left: 50%; margin-left: -0.245em;"><span class="mtd" id="MathJax-Span-1229"><span class="mrow" id="MathJax-Span-1230"><span class="mn" id="MathJax-Span-1231" style="font-family: MathJax_Main;">0</span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.105em, 1000.44em, 4.159em, -999.997em); top: -3.533em; left: 50%; margin-left: -0.245em;"><span class="mtd" id="MathJax-Span-1275"><span class="mrow" id="MathJax-Span-1276"><span class="mn" id="MathJax-Span-1277" style="font-family: MathJax_Main;">0</span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.105em, 1000.44em, 4.159em, -999.997em); top: -1.92em; left: 50%; margin-left: -0.245em;"><span class="mtd" id="MathJax-Span-1321"><span class="mrow" id="MathJax-Span-1322"><span class="mn" id="MathJax-Span-1323" style="font-family: MathJax_Main;">0</span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.105em, 1000.44em, 4.159em, -999.997em); top: -0.493em; left: 50%; margin-left: -0.245em;"><span class="mtd" id="MathJax-Span-1342"><span class="mrow" id="MathJax-Span-1343"><span class="mn" id="MathJax-Span-1344" style="font-family: MathJax_Main;">0</span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.105em, 1000.44em, 4.159em, -999.997em); top: 0.872em; left: 50%; margin-left: -0.245em;"><span class="mtd" id="MathJax-Span-1363"><span class="mrow" id="MathJax-Span-1364"><span class="mn" id="MathJax-Span-1365" style="font-family: MathJax_Main;">0</span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span><span style="display: inline-block; width: 0px; height: 11.169em;"></span></span><span style="position: absolute; clip: rect(5.648em, 1000.44em, 16.256em, -999.997em); top: -11.163em; left: 1.492em;"><span style="display: inline-block; position: relative; width: 0.499em; height: 0px;"><span style="position: absolute; clip: rect(3.105em, 1000.44em, 4.159em, -999.997em); top: -8.62em; left: 50%; margin-left: -0.245em;"><span class="mtd" id="MathJax-Span-1138"><span class="mrow" id="MathJax-Span-1139"><span class="mn" id="MathJax-Span-1140" style="font-family: MathJax_Main;">0</span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.105em, 1000.44em, 4.159em, -999.997em); top: -6.945em; left: 50%; margin-left: -0.245em;"><span class="mtd" id="MathJax-Span-1186"><span class="mrow" id="MathJax-Span-1187"><span class="mn" id="MathJax-Span-1188" style="font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.105em, 1000.44em, 4.159em, -999.997em); top: -5.208em; left: 50%; margin-left: -0.245em;"><span class="mtd" id="MathJax-Span-1232"><span class="mrow" id="MathJax-Span-1233"><span class="mn" id="MathJax-Span-1234" style="font-family: MathJax_Main;">0</span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.105em, 1000.44em, 4.159em, -999.997em); top: -3.533em; left: 50%; margin-left: -0.245em;"><span class="mtd" id="MathJax-Span-1278"><span class="mrow" id="MathJax-Span-1279"><span class="mn" id="MathJax-Span-1280" style="font-family: MathJax_Main;">0</span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.105em, 1000.44em, 4.159em, -999.997em); top: -1.92em; left: 50%; margin-left: -0.245em;"><span class="mtd" id="MathJax-Span-1324"><span class="mrow" id="MathJax-Span-1325"><span class="mn" id="MathJax-Span-1326" style="font-family: MathJax_Main;">0</span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.105em, 1000.44em, 4.159em, -999.997em); top: -0.493em; left: 50%; margin-left: -0.245em;"><span class="mtd" id="MathJax-Span-1345"><span class="mrow" id="MathJax-Span-1346"><span class="mn" id="MathJax-Span-1347" style="font-family: MathJax_Main;">0</span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.105em, 1000.44em, 4.159em, -999.997em); top: 0.872em; left: 50%; margin-left: -0.245em;"><span class="mtd" id="MathJax-Span-1366"><span class="mrow" id="MathJax-Span-1367"><span class="mn" id="MathJax-Span-1368" style="font-family: MathJax_Main;">0</span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span><span style="display: inline-block; width: 0px; height: 11.169em;"></span></span><span style="position: absolute; clip: rect(5.648em, 1000.44em, 16.256em, -999.997em); top: -11.163em; left: 2.981em;"><span style="display: inline-block; position: relative; width: 0.499em; height: 0px;"><span style="position: absolute; clip: rect(3.105em, 1000.44em, 4.159em, -999.997em); top: -8.62em; left: 50%; margin-left: -0.245em;"><span class="mtd" id="MathJax-Span-1141"><span class="mrow" id="MathJax-Span-1142"><span class="mn" id="MathJax-Span-1143" style="font-family: MathJax_Main;">0</span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.105em, 1000.44em, 4.159em, -999.997em); top: -6.945em; left: 50%; margin-left: -0.245em;"><span class="mtd" id="MathJax-Span-1189"><span class="mrow" id="MathJax-Span-1190"><span class="mn" id="MathJax-Span-1191" style="font-family: MathJax_Main;">0</span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.105em, 1000.44em, 4.159em, -999.997em); top: -5.208em; left: 50%; margin-left: -0.245em;"><span class="mtd" id="MathJax-Span-1235"><span class="mrow" id="MathJax-Span-1236"><span class="mn" id="MathJax-Span-1237" style="font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.105em, 1000.44em, 4.159em, -999.997em); top: -3.533em; left: 50%; margin-left: -0.245em;"><span class="mtd" id="MathJax-Span-1281"><span class="mrow" id="MathJax-Span-1282"><span class="mn" id="MathJax-Span-1283" style="font-family: MathJax_Main;">0</span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.105em, 1000.44em, 4.159em, -999.997em); top: -1.92em; left: 50%; margin-left: -0.245em;"><span class="mtd" id="MathJax-Span-1327"><span class="mrow" id="MathJax-Span-1328"><span class="mn" id="MathJax-Span-1329" style="font-family: MathJax_Main;">0</span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.105em, 1000.44em, 4.159em, -999.997em); top: -0.493em; left: 50%; margin-left: -0.245em;"><span class="mtd" id="MathJax-Span-1348"><span class="mrow" id="MathJax-Span-1349"><span class="mn" id="MathJax-Span-1350" style="font-family: MathJax_Main;">0</span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.105em, 1000.44em, 4.159em, -999.997em); top: 0.872em; left: 50%; margin-left: -0.245em;"><span class="mtd" id="MathJax-Span-1369"><span class="mrow" id="MathJax-Span-1370"><span class="mn" id="MathJax-Span-1371" style="font-family: MathJax_Main;">0</span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span><span style="display: inline-block; width: 0px; height: 11.169em;"></span></span><span style="position: absolute; clip: rect(5.648em, 1000.44em, 16.256em, -999.997em); top: -11.163em; left: 4.532em;"><span style="display: inline-block; position: relative; width: 0.499em; height: 0px;"><span style="position: absolute; clip: rect(3.105em, 1000.44em, 4.159em, -999.997em); top: -8.62em; left: 50%; margin-left: -0.245em;"><span class="mtd" id="MathJax-Span-1144"><span class="mrow" id="MathJax-Span-1145"><span class="mn" id="MathJax-Span-1146" style="font-family: MathJax_Main;">0</span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.105em, 1000.44em, 4.159em, -999.997em); top: -6.945em; left: 50%; margin-left: -0.245em;"><span class="mtd" id="MathJax-Span-1192"><span class="mrow" id="MathJax-Span-1193"><span class="mn" id="MathJax-Span-1194" style="font-family: MathJax_Main;">0</span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.105em, 1000.44em, 4.159em, -999.997em); top: -5.208em; left: 50%; margin-left: -0.245em;"><span class="mtd" id="MathJax-Span-1238"><span class="mrow" id="MathJax-Span-1239"><span class="mn" id="MathJax-Span-1240" style="font-family: MathJax_Main;">0</span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.105em, 1000.44em, 4.159em, -999.997em); top: -3.533em; left: 50%; margin-left: -0.245em;"><span class="mtd" id="MathJax-Span-1284"><span class="mrow" id="MathJax-Span-1285"><span class="mn" id="MathJax-Span-1286" style="font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.105em, 1000.44em, 4.159em, -999.997em); top: -1.92em; left: 50%; margin-left: -0.245em;"><span class="mtd" id="MathJax-Span-1330"><span class="mrow" id="MathJax-Span-1331"><span class="mn" id="MathJax-Span-1332" style="font-family: MathJax_Main;">0</span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.105em, 1000.44em, 4.159em, -999.997em); top: -0.493em; left: 50%; margin-left: -0.245em;"><span class="mtd" id="MathJax-Span-1351"><span class="mrow" id="MathJax-Span-1352"><span class="mn" id="MathJax-Span-1353" style="font-family: MathJax_Main;">0</span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.105em, 1000.44em, 4.159em, -999.997em); top: 0.872em; left: 50%; margin-left: -0.245em;"><span class="mtd" id="MathJax-Span-1372"><span class="mrow" id="MathJax-Span-1373"><span class="mn" id="MathJax-Span-1374" style="font-family: MathJax_Main;">0</span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span><span style="display: inline-block; width: 0px; height: 11.169em;"></span></span><span style="position: absolute; clip: rect(5.648em, 1003.97em, 16.504em, -999.997em); top: -11.411em; left: 6.02em;"><span style="display: inline-block; position: relative; width: 4.097em; height: 0px;"><span style="position: absolute; clip: rect(2.857em, 1003.97em, 4.532em, -999.997em); top: -8.62em; left: 50%; margin-left: -2.044em;"><span class="mtd" id="MathJax-Span-1147"><span class="mrow" id="MathJax-Span-1148"><span class="mo" id="MathJax-Span-1149" style="font-family: MathJax_Main;">−</span><span class="mfrac" id="MathJax-Span-1150"><span style="display: inline-block; position: relative; width: 0.623em; height: 0px; margin-right: 0.127em; margin-left: 0.127em;"><span style="position: absolute; clip: rect(3.291em, 1000.5em, 4.159em, -999.997em); top: -4.401em; left: 50%; margin-left: -0.245em;"><span class="mi" id="MathJax-Span-1151" style="font-size: 70.7%; font-family: MathJax_Math-italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.065em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.291em, 1000.31em, 4.159em, -999.997em); top: -3.595em; left: 50%; margin-left: -0.183em;"><span class="mn" id="MathJax-Span-1152" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(0.81em, 1000.62em, 1.244em, -999.997em); top: -1.3em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 0.623em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.058em;"></span></span></span></span><span class="mo" id="MathJax-Span-1153" style="font-family: MathJax_Main;">(</span><span class="mo" id="MathJax-Span-1154" style="font-family: MathJax_Main;">−</span><span class="msubsup" id="MathJax-Span-1155"><span style="display: inline-block; position: relative; width: 0.872em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.44em, 4.346em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-1156" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.437em;"><span class="mn" id="MathJax-Span-1157" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="mo" id="MathJax-Span-1158" style="font-family: MathJax_Main;">)</span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(2.857em, 1003.17em, 4.532em, -999.997em); top: -6.945em; left: 50%; margin-left: -1.672em;"><span class="mtd" id="MathJax-Span-1195"><span class="mrow" id="MathJax-Span-1196"><span class="mo" id="MathJax-Span-1197" style="font-family: MathJax_Main;">−</span><span class="mfrac" id="MathJax-Span-1198"><span style="display: inline-block; position: relative; width: 0.623em; height: 0px; margin-right: 0.127em; margin-left: 0.127em;"><span style="position: absolute; clip: rect(3.291em, 1000.5em, 4.159em, -999.997em); top: -4.401em; left: 50%; margin-left: -0.245em;"><span class="mi" id="MathJax-Span-1199" style="font-size: 70.7%; font-family: MathJax_Math-italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.065em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.291em, 1000.31em, 4.159em, -999.997em); top: -3.595em; left: 50%; margin-left: -0.183em;"><span class="mn" id="MathJax-Span-1200" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(0.81em, 1000.62em, 1.244em, -999.997em); top: -1.3em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 0.623em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.058em;"></span></span></span></span><span class="mo" id="MathJax-Span-1201" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-1202"><span style="display: inline-block; position: relative; width: 0.872em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.44em, 4.346em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-1203" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.437em;"><span class="mn" id="MathJax-Span-1204" style="font-size: 70.7%; font-family: MathJax_Main;">0</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="mo" id="MathJax-Span-1205" style="font-family: MathJax_Main;">)</span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(2.857em, 1003.17em, 4.532em, -999.997em); top: -5.208em; left: 50%; margin-left: -1.672em;"><span class="mtd" id="MathJax-Span-1241"><span class="mrow" id="MathJax-Span-1242"><span class="mo" id="MathJax-Span-1243" style="font-family: MathJax_Main;">−</span><span class="mfrac" id="MathJax-Span-1244"><span style="display: inline-block; position: relative; width: 0.623em; height: 0px; margin-right: 0.127em; margin-left: 0.127em;"><span style="position: absolute; clip: rect(3.291em, 1000.5em, 4.159em, -999.997em); top: -4.401em; left: 50%; margin-left: -0.245em;"><span class="mi" id="MathJax-Span-1245" style="font-size: 70.7%; font-family: MathJax_Math-italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.065em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.291em, 1000.31em, 4.159em, -999.997em); top: -3.595em; left: 50%; margin-left: -0.183em;"><span class="mn" id="MathJax-Span-1246" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(0.81em, 1000.62em, 1.244em, -999.997em); top: -1.3em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 0.623em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.058em;"></span></span></span></span><span class="mo" id="MathJax-Span-1247" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-1248"><span style="display: inline-block; position: relative; width: 0.872em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.44em, 4.346em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-1249" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.437em;"><span class="mn" id="MathJax-Span-1250" style="font-size: 70.7%; font-family: MathJax_Main;">3</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="mo" id="MathJax-Span-1251" style="font-family: MathJax_Main;">)</span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(2.857em, 1003.97em, 4.532em, -999.997em); top: -3.533em; left: 50%; margin-left: -2.044em;"><span class="mtd" id="MathJax-Span-1287"><span class="mrow" id="MathJax-Span-1288"><span class="mo" id="MathJax-Span-1289" style="font-family: MathJax_Main;">−</span><span class="mfrac" id="MathJax-Span-1290"><span style="display: inline-block; position: relative; width: 0.623em; height: 0px; margin-right: 0.127em; margin-left: 0.127em;"><span style="position: absolute; clip: rect(3.291em, 1000.5em, 4.159em, -999.997em); top: -4.401em; left: 50%; margin-left: -0.245em;"><span class="mi" id="MathJax-Span-1291" style="font-size: 70.7%; font-family: MathJax_Math-italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.065em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.291em, 1000.31em, 4.159em, -999.997em); top: -3.595em; left: 50%; margin-left: -0.183em;"><span class="mn" id="MathJax-Span-1292" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(0.81em, 1000.62em, 1.244em, -999.997em); top: -1.3em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 0.623em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.058em;"></span></span></span></span><span class="mo" id="MathJax-Span-1293" style="font-family: MathJax_Main;">(</span><span class="mo" id="MathJax-Span-1294" style="font-family: MathJax_Main;">−</span><span class="msubsup" id="MathJax-Span-1295"><span style="display: inline-block; position: relative; width: 0.872em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.44em, 4.346em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-1296" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.437em;"><span class="mn" id="MathJax-Span-1297" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="mo" id="MathJax-Span-1298" style="font-family: MathJax_Main;">)</span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.105em, 1000.44em, 4.159em, -999.997em); top: -1.92em; left: 50%; margin-left: -0.245em;"><span class="mtd" id="MathJax-Span-1333"><span class="mrow" id="MathJax-Span-1334"><span class="mn" id="MathJax-Span-1335" style="font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.105em, 1000.44em, 4.159em, -999.997em); top: -0.493em; left: 50%; margin-left: -0.245em;"><span class="mtd" id="MathJax-Span-1354"><span class="mrow" id="MathJax-Span-1355"><span class="mn" id="MathJax-Span-1356" style="font-family: MathJax_Main;">0</span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.105em, 1000.44em, 4.159em, -999.997em); top: 0.872em; left: 50%; margin-left: -0.245em;"><span class="mtd" id="MathJax-Span-1375"><span class="mrow" id="MathJax-Span-1376"><span class="mn" id="MathJax-Span-1377" style="font-family: MathJax_Main;">0</span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span><span style="display: inline-block; width: 0px; height: 11.417em;"></span></span><span style="position: absolute; clip: rect(5.648em, 1003.97em, 16.504em, -999.997em); top: -11.411em; left: 11.045em;"><span style="display: inline-block; position: relative; width: 4.097em; height: 0px;"><span style="position: absolute; clip: rect(2.857em, 1003.97em, 4.532em, -999.997em); top: -8.62em; left: 50%; margin-left: -2.044em;"><span class="mtd" id="MathJax-Span-1159"><span class="mrow" id="MathJax-Span-1160"><span class="mo" id="MathJax-Span-1161" style="font-family: MathJax_Main;">−</span><span class="mfrac" id="MathJax-Span-1162"><span style="display: inline-block; position: relative; width: 0.623em; height: 0px; margin-right: 0.127em; margin-left: 0.127em;"><span style="position: absolute; clip: rect(3.291em, 1000.5em, 4.159em, -999.997em); top: -4.401em; left: 50%; margin-left: -0.245em;"><span class="mi" id="MathJax-Span-1163" style="font-size: 70.7%; font-family: MathJax_Math-italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.065em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.291em, 1000.31em, 4.159em, -999.997em); top: -3.595em; left: 50%; margin-left: -0.183em;"><span class="mn" id="MathJax-Span-1164" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(0.81em, 1000.62em, 1.244em, -999.997em); top: -1.3em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 0.623em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.058em;"></span></span></span></span><span class="mo" id="MathJax-Span-1165" style="font-family: MathJax_Main;">(</span><span class="mo" id="MathJax-Span-1166" style="font-family: MathJax_Main;">−</span><span class="msubsup" id="MathJax-Span-1167"><span style="display: inline-block; position: relative; width: 0.872em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.44em, 4.346em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-1168" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.437em;"><span class="mn" id="MathJax-Span-1169" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="mo" id="MathJax-Span-1170" style="font-family: MathJax_Main;">)</span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(2.857em, 1003.97em, 4.532em, -999.997em); top: -6.945em; left: 50%; margin-left: -2.044em;"><span class="mtd" id="MathJax-Span-1206"><span class="mrow" id="MathJax-Span-1207"><span class="mo" id="MathJax-Span-1208" style="font-family: MathJax_Main;">−</span><span class="mfrac" id="MathJax-Span-1209"><span style="display: inline-block; position: relative; width: 0.623em; height: 0px; margin-right: 0.127em; margin-left: 0.127em;"><span style="position: absolute; clip: rect(3.291em, 1000.5em, 4.159em, -999.997em); top: -4.401em; left: 50%; margin-left: -0.245em;"><span class="mi" id="MathJax-Span-1210" style="font-size: 70.7%; font-family: MathJax_Math-italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.065em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.291em, 1000.31em, 4.159em, -999.997em); top: -3.595em; left: 50%; margin-left: -0.183em;"><span class="mn" id="MathJax-Span-1211" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(0.81em, 1000.62em, 1.244em, -999.997em); top: -1.3em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 0.623em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.058em;"></span></span></span></span><span class="mo" id="MathJax-Span-1212" style="font-family: MathJax_Main;">(</span><span class="mo" id="MathJax-Span-1213" style="font-family: MathJax_Main;">−</span><span class="msubsup" id="MathJax-Span-1214"><span style="display: inline-block; position: relative; width: 0.872em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.44em, 4.346em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-1215" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.437em;"><span class="mn" id="MathJax-Span-1216" style="font-size: 70.7%; font-family: MathJax_Main;">3</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="mo" id="MathJax-Span-1217" style="font-family: MathJax_Main;">)</span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(2.857em, 1003.17em, 4.532em, -999.997em); top: -5.208em; left: 50%; margin-left: -1.672em;"><span class="mtd" id="MathJax-Span-1252"><span class="mrow" id="MathJax-Span-1253"><span class="mo" id="MathJax-Span-1254" style="font-family: MathJax_Main;">−</span><span class="mfrac" id="MathJax-Span-1255"><span style="display: inline-block; position: relative; width: 0.623em; height: 0px; margin-right: 0.127em; margin-left: 0.127em;"><span style="position: absolute; clip: rect(3.291em, 1000.5em, 4.159em, -999.997em); top: -4.401em; left: 50%; margin-left: -0.245em;"><span class="mi" id="MathJax-Span-1256" style="font-size: 70.7%; font-family: MathJax_Math-italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.065em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.291em, 1000.31em, 4.159em, -999.997em); top: -3.595em; left: 50%; margin-left: -0.183em;"><span class="mn" id="MathJax-Span-1257" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(0.81em, 1000.62em, 1.244em, -999.997em); top: -1.3em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 0.623em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.058em;"></span></span></span></span><span class="mo" id="MathJax-Span-1258" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-1259"><span style="display: inline-block; position: relative; width: 0.872em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.44em, 4.346em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-1260" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.437em;"><span class="mn" id="MathJax-Span-1261" style="font-size: 70.7%; font-family: MathJax_Main;">0</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="mo" id="MathJax-Span-1262" style="font-family: MathJax_Main;">)</span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(2.857em, 1003.17em, 4.532em, -999.997em); top: -3.533em; left: 50%; margin-left: -1.672em;"><span class="mtd" id="MathJax-Span-1299"><span class="mrow" id="MathJax-Span-1300"><span class="mo" id="MathJax-Span-1301" style="font-family: MathJax_Main;">−</span><span class="mfrac" id="MathJax-Span-1302"><span style="display: inline-block; position: relative; width: 0.623em; height: 0px; margin-right: 0.127em; margin-left: 0.127em;"><span style="position: absolute; clip: rect(3.291em, 1000.5em, 4.159em, -999.997em); top: -4.401em; left: 50%; margin-left: -0.245em;"><span class="mi" id="MathJax-Span-1303" style="font-size: 70.7%; font-family: MathJax_Math-italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.065em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.291em, 1000.31em, 4.159em, -999.997em); top: -3.595em; left: 50%; margin-left: -0.183em;"><span class="mn" id="MathJax-Span-1304" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(0.81em, 1000.62em, 1.244em, -999.997em); top: -1.3em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 0.623em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.058em;"></span></span></span></span><span class="mo" id="MathJax-Span-1305" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-1306"><span style="display: inline-block; position: relative; width: 0.872em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.44em, 4.346em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-1307" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.437em;"><span class="mn" id="MathJax-Span-1308" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="mo" id="MathJax-Span-1309" style="font-family: MathJax_Main;">)</span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.105em, 1000.44em, 4.159em, -999.997em); top: -1.92em; left: 50%; margin-left: -0.245em;"><span class="mtd" id="MathJax-Span-1336"><span class="mrow" id="MathJax-Span-1337"><span class="mn" id="MathJax-Span-1338" style="font-family: MathJax_Main;">0</span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.105em, 1000.44em, 4.159em, -999.997em); top: -0.493em; left: 50%; margin-left: -0.245em;"><span class="mtd" id="MathJax-Span-1357"><span class="mrow" id="MathJax-Span-1358"><span class="mn" id="MathJax-Span-1359" style="font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.105em, 1000.44em, 4.159em, -999.997em); top: 0.872em; left: 50%; margin-left: -0.245em;"><span class="mtd" id="MathJax-Span-1378"><span class="mrow" id="MathJax-Span-1379"><span class="mn" id="MathJax-Span-1380" style="font-family: MathJax_Main;">0</span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span><span style="display: inline-block; width: 0px; height: 11.417em;"></span></span><span style="position: absolute; clip: rect(5.648em, 1003.97em, 16.442em, -999.997em); top: -11.411em; left: 16.132em;"><span style="display: inline-block; position: relative; width: 4.097em; height: 0px;"><span style="position: absolute; clip: rect(2.857em, 1003.97em, 4.532em, -999.997em); top: -8.62em; left: 50%; margin-left: -2.044em;"><span class="mtd" id="MathJax-Span-1171"><span class="mrow" id="MathJax-Span-1172"><span class="mo" id="MathJax-Span-1173" style="font-family: MathJax_Main;">−</span><span class="mfrac" id="MathJax-Span-1174"><span style="display: inline-block; position: relative; width: 0.623em; height: 0px; margin-right: 0.127em; margin-left: 0.127em;"><span style="position: absolute; clip: rect(3.291em, 1000.5em, 4.159em, -999.997em); top: -4.401em; left: 50%; margin-left: -0.245em;"><span class="mi" id="MathJax-Span-1175" style="font-size: 70.7%; font-family: MathJax_Math-italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.065em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.291em, 1000.31em, 4.159em, -999.997em); top: -3.595em; left: 50%; margin-left: -0.183em;"><span class="mn" id="MathJax-Span-1176" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(0.81em, 1000.62em, 1.244em, -999.997em); top: -1.3em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 0.623em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.058em;"></span></span></span></span><span class="mo" id="MathJax-Span-1177" style="font-family: MathJax_Main;">(</span><span class="mo" id="MathJax-Span-1178" style="font-family: MathJax_Main;">−</span><span class="msubsup" id="MathJax-Span-1179"><span style="display: inline-block; position: relative; width: 0.872em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.44em, 4.346em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-1180" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.437em;"><span class="mn" id="MathJax-Span-1181" style="font-size: 70.7%; font-family: MathJax_Main;">3</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="mo" id="MathJax-Span-1182" style="font-family: MathJax_Main;">)</span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(2.857em, 1003.17em, 4.532em, -999.997em); top: -6.945em; left: 50%; margin-left: -1.672em;"><span class="mtd" id="MathJax-Span-1218"><span class="mrow" id="MathJax-Span-1219"><span class="mo" id="MathJax-Span-1220" style="font-family: MathJax_Main;">−</span><span class="mfrac" id="MathJax-Span-1221"><span style="display: inline-block; position: relative; width: 0.623em; height: 0px; margin-right: 0.127em; margin-left: 0.127em;"><span style="position: absolute; clip: rect(3.291em, 1000.5em, 4.159em, -999.997em); top: -4.401em; left: 50%; margin-left: -0.245em;"><span class="mi" id="MathJax-Span-1222" style="font-size: 70.7%; font-family: MathJax_Math-italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.065em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.291em, 1000.31em, 4.159em, -999.997em); top: -3.595em; left: 50%; margin-left: -0.183em;"><span class="mn" id="MathJax-Span-1223" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(0.81em, 1000.62em, 1.244em, -999.997em); top: -1.3em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 0.623em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.058em;"></span></span></span></span><span class="mo" id="MathJax-Span-1224" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-1225"><span style="display: inline-block; position: relative; width: 0.872em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.44em, 4.346em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-1226" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.437em;"><span class="mn" id="MathJax-Span-1227" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="mo" id="MathJax-Span-1228" style="font-family: MathJax_Main;">)</span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(2.857em, 1003.97em, 4.532em, -999.997em); top: -5.208em; left: 50%; margin-left: -2.044em;"><span class="mtd" id="MathJax-Span-1263"><span class="mrow" id="MathJax-Span-1264"><span class="mo" id="MathJax-Span-1265" style="font-family: MathJax_Main;">−</span><span class="mfrac" id="MathJax-Span-1266"><span style="display: inline-block; position: relative; width: 0.623em; height: 0px; margin-right: 0.127em; margin-left: 0.127em;"><span style="position: absolute; clip: rect(3.291em, 1000.5em, 4.159em, -999.997em); top: -4.401em; left: 50%; margin-left: -0.245em;"><span class="mi" id="MathJax-Span-1267" style="font-size: 70.7%; font-family: MathJax_Math-italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.065em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.291em, 1000.31em, 4.159em, -999.997em); top: -3.595em; left: 50%; margin-left: -0.183em;"><span class="mn" id="MathJax-Span-1268" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(0.81em, 1000.62em, 1.244em, -999.997em); top: -1.3em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 0.623em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.058em;"></span></span></span></span><span class="mo" id="MathJax-Span-1269" style="font-family: MathJax_Main;">(</span><span class="mo" id="MathJax-Span-1270" style="font-family: MathJax_Main;">−</span><span class="msubsup" id="MathJax-Span-1271"><span style="display: inline-block; position: relative; width: 0.872em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.44em, 4.346em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-1272" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.437em;"><span class="mn" id="MathJax-Span-1273" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="mo" id="MathJax-Span-1274" style="font-family: MathJax_Main;">)</span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(2.857em, 1003.17em, 4.532em, -999.997em); top: -3.533em; left: 50%; margin-left: -1.672em;"><span class="mtd" id="MathJax-Span-1310"><span class="mrow" id="MathJax-Span-1311"><span class="mo" id="MathJax-Span-1312" style="font-family: MathJax_Main;">−</span><span class="mfrac" id="MathJax-Span-1313"><span style="display: inline-block; position: relative; width: 0.623em; height: 0px; margin-right: 0.127em; margin-left: 0.127em;"><span style="position: absolute; clip: rect(3.291em, 1000.5em, 4.159em, -999.997em); top: -4.401em; left: 50%; margin-left: -0.245em;"><span class="mi" id="MathJax-Span-1314" style="font-size: 70.7%; font-family: MathJax_Math-italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.065em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.291em, 1000.31em, 4.159em, -999.997em); top: -3.595em; left: 50%; margin-left: -0.183em;"><span class="mn" id="MathJax-Span-1315" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(0.81em, 1000.62em, 1.244em, -999.997em); top: -1.3em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 0.623em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.058em;"></span></span></span></span><span class="mo" id="MathJax-Span-1316" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-1317"><span style="display: inline-block; position: relative; width: 0.872em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.44em, 4.346em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-1318" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.437em;"><span class="mn" id="MathJax-Span-1319" style="font-size: 70.7%; font-family: MathJax_Main;">0</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="mo" id="MathJax-Span-1320" style="font-family: MathJax_Main;">)</span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.105em, 1000.44em, 4.159em, -999.997em); top: -1.92em; left: 50%; margin-left: -0.245em;"><span class="mtd" id="MathJax-Span-1339"><span class="mrow" id="MathJax-Span-1340"><span class="mn" id="MathJax-Span-1341" style="font-family: MathJax_Main;">0</span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.105em, 1000.44em, 4.159em, -999.997em); top: -0.493em; left: 50%; margin-left: -0.245em;"><span class="mtd" id="MathJax-Span-1360"><span class="mrow" id="MathJax-Span-1361"><span class="mn" id="MathJax-Span-1362" style="font-family: MathJax_Main;">0</span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.105em, 1000.44em, 4.159em, -999.997em); top: 0.872em; left: 50%; margin-left: -0.245em;"><span class="mtd" id="MathJax-Span-1381"><span class="mrow" id="MathJax-Span-1382"><span class="mn" id="MathJax-Span-1383" style="font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span><span style="display: inline-block; width: 0px; height: 11.417em;"></span></span></span></span><span class="mo" id="MathJax-Span-1384" style="vertical-align: 5.586em;"><span style="display: inline-block; position: relative; width: 0.685em; height: 0px;"><span style="position: absolute; font-family: MathJax_Size4; top: -2.788em; left: 0em;">⎤<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; font-family: MathJax_Size4; top: 6.02em; left: 0em;">⎦<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -1.61em; left: 0em;">⎥<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -1.051em; left: 0em;">⎥<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -0.555em; left: 0em;">⎥<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: 0.003em; left: 0em;">⎥<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: 0.561em; left: 0em;">⎥<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: 1.12em; left: 0em;">⎥<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: 1.616em; left: 0em;">⎥<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: 2.174em; left: 0em;">⎥<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: 2.733em; left: 0em;">⎥<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: 3.291em; left: 0em;">⎥<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: 3.787em; left: 0em;">⎥<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: 4.346em; left: 0em;">⎥<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: 4.904em; left: 0em;">⎥<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span><span class="msubsup" id="MathJax-Span-1385" style="padding-left: 0.189em;"><span style="display: inline-block; position: relative; width: 3.477em; height: 0px;"><span style="position: absolute; clip: rect(5.276em, 1002.73em, 15.14em, -999.997em); top: -10.481em; left: 0em;"><span class="mrow" id="MathJax-Span-1386"><span class="mo" id="MathJax-Span-1387" style="vertical-align: 5.028em;"><span style="display: inline-block; position: relative; width: 0.685em; height: 0px;"><span style="position: absolute; font-family: MathJax_Size4; top: -2.788em; left: 0em;">⎡<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; font-family: MathJax_Size4; top: 4.904em; left: 0em;">⎣<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -1.61em; left: 0em;">⎢<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -1.114em; left: 0em;">⎢<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -0.555em; left: 0em;">⎢<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: 0.003em; left: 0em;">⎢<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: 0.561em; left: 0em;">⎢<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: 1.058em; left: 0em;">⎢<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: 1.616em; left: 0em;">⎢<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: 2.174em; left: 0em;">⎢<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: 2.733em; left: 0em;">⎢<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: 3.229em; left: 0em;">⎢<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: 3.787em; left: 0em;">⎢<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="mtable" id="MathJax-Span-1388" style="padding-right: 0.189em; padding-left: 0.189em;"><span style="display: inline-block; position: relative; width: 1.306em; height: 0px;"><span style="position: absolute; clip: rect(5.276em, 1001.31em, 14.767em, -999.997em); top: -10.109em; left: 0em;"><span style="display: inline-block; position: relative; width: 1.306em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.87em, 4.346em, -999.997em); top: -8.185em; left: 50%; margin-left: -0.431em;"><span class="mtd" id="MathJax-Span-1389"><span class="mrow" id="MathJax-Span-1390"><span class="msubsup" id="MathJax-Span-1391"><span style="display: inline-block; position: relative; width: 0.872em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.44em, 4.346em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-1392" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.437em;"><span class="mn" id="MathJax-Span-1393" style="font-size: 70.7%; font-family: MathJax_Main;">0</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.353em, 1000.87em, 4.346em, -999.997em); top: -6.759em; left: 50%; margin-left: -0.431em;"><span class="mtd" id="MathJax-Span-1394"><span class="mrow" id="MathJax-Span-1395"><span class="msubsup" id="MathJax-Span-1396"><span style="display: inline-block; position: relative; width: 0.872em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.44em, 4.346em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-1397" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.437em;"><span class="mn" id="MathJax-Span-1398" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.353em, 1000.87em, 4.346em, -999.997em); top: -5.394em; left: 50%; margin-left: -0.431em;"><span class="mtd" id="MathJax-Span-1399"><span class="mrow" id="MathJax-Span-1400"><span class="msubsup" id="MathJax-Span-1401"><span style="display: inline-block; position: relative; width: 0.872em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.44em, 4.346em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-1402" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.437em;"><span class="mn" id="MathJax-Span-1403" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.353em, 1000.87em, 4.346em, -999.997em); top: -3.967em; left: 50%; margin-left: -0.431em;"><span class="mtd" id="MathJax-Span-1404"><span class="mrow" id="MathJax-Span-1405"><span class="msubsup" id="MathJax-Span-1406"><span style="display: inline-block; position: relative; width: 0.872em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.44em, 4.346em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-1407" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.437em;"><span class="mn" id="MathJax-Span-1408" style="font-size: 70.7%; font-family: MathJax_Main;">3</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.105em, 1001.31em, 4.346em, -999.997em); top: -2.54em; left: 50%; margin-left: -0.679em;"><span class="mtd" id="MathJax-Span-1409"><span class="mrow" id="MathJax-Span-1410"><span class="msubsup" id="MathJax-Span-1411"><span style="display: inline-block; position: relative; width: 1.306em; height: 0px;"><span style="position: absolute; clip: rect(3.105em, 1000.87em, 4.159em, -999.997em); top: -3.967em; left: 0em;"><span class="texatom" id="MathJax-Span-1412"><span class="mrow" id="MathJax-Span-1413"><span class="msubsup" id="MathJax-Span-1414"><span style="display: inline-block; position: relative; width: 0.872em; height: 0px;"><span style="position: absolute; clip: rect(3.105em, 1000.44em, 4.159em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-1415" style="font-family: MathJax_Math-italic;">b</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -4.339em; left: 0.437em;"><span class="mi" id="MathJax-Span-1416" style="font-size: 70.7%; font-family: MathJax_Math-italic;">g<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.872em;"><span class="mi" id="MathJax-Span-1417" style="font-size: 70.7%; font-family: MathJax_Math-italic;">x</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.105em, 1001.24em, 4.47em, -999.997em); top: -1.176em; left: 50%; margin-left: -0.617em;"><span class="mtd" id="MathJax-Span-1418"><span class="mrow" id="MathJax-Span-1419"><span class="msubsup" id="MathJax-Span-1420"><span style="display: inline-block; position: relative; width: 1.244em; height: 0px;"><span style="position: absolute; clip: rect(3.105em, 1000.87em, 4.159em, -999.997em); top: -3.967em; left: 0em;"><span class="texatom" id="MathJax-Span-1421"><span class="mrow" id="MathJax-Span-1422"><span class="msubsup" id="MathJax-Span-1423"><span style="display: inline-block; position: relative; width: 0.872em; height: 0px;"><span style="position: absolute; clip: rect(3.105em, 1000.44em, 4.159em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-1424" style="font-family: MathJax_Math-italic;">b</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -4.339em; left: 0.437em;"><span class="mi" id="MathJax-Span-1425" style="font-size: 70.7%; font-family: MathJax_Math-italic;">g<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.872em;"><span class="mi" id="MathJax-Span-1426" style="font-size: 70.7%; font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.105em, 1001.24em, 4.346em, -999.997em); top: 0.313em; left: 50%; margin-left: -0.617em;"><span class="mtd" id="MathJax-Span-1427"><span class="mrow" id="MathJax-Span-1428"><span class="msubsup" id="MathJax-Span-1429"><span style="display: inline-block; position: relative; width: 1.244em; height: 0px;"><span style="position: absolute; clip: rect(3.105em, 1000.87em, 4.159em, -999.997em); top: -3.967em; left: 0em;"><span class="texatom" id="MathJax-Span-1430"><span class="mrow" id="MathJax-Span-1431"><span class="msubsup" id="MathJax-Span-1432"><span style="display: inline-block; position: relative; width: 0.872em; height: 0px;"><span style="position: absolute; clip: rect(3.105em, 1000.44em, 4.159em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-1433" style="font-family: MathJax_Math-italic;">b</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -4.339em; left: 0.437em;"><span class="mi" id="MathJax-Span-1434" style="font-size: 70.7%; font-family: MathJax_Math-italic;">g<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.872em;"><span class="mi" id="MathJax-Span-1435" style="font-size: 70.7%; font-family: MathJax_Math-italic;">z<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span><span style="display: inline-block; width: 0px; height: 10.115em;"></span></span></span></span><span class="mo" id="MathJax-Span-1436" style="vertical-align: 5.028em;"><span style="display: inline-block; position: relative; width: 0.685em; height: 0px;"><span style="position: absolute; font-family: MathJax_Size4; top: -2.788em; left: 0em;">⎤<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; font-family: MathJax_Size4; top: 4.904em; left: 0em;">⎦<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -1.61em; left: 0em;">⎥<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -1.114em; left: 0em;">⎥<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -0.555em; left: 0em;">⎥<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: 0.003em; left: 0em;">⎥<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: 0.561em; left: 0em;">⎥<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: 1.058em; left: 0em;">⎥<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: 1.616em; left: 0em;">⎥<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: 2.174em; left: 0em;">⎥<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: 2.733em; left: 0em;">⎥<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: 3.229em; left: 0em;">⎥<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: 3.787em; left: 0em;">⎥<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 10.487em;"></span></span><span style="position: absolute; top: 0.561em; left: 3.043em;"><span class="mi" id="MathJax-Span-1437" style="font-size: 70.7%; font-family: MathJax_Math-italic;">k</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="mo" id="MathJax-Span-1438" style="font-family: MathJax_Main; padding-left: 0.251em;">+</span><span class="mfrac" id="MathJax-Span-1439" style="padding-left: 0.251em;"><span style="display: inline-block; position: relative; width: 0.623em; height: 0px; margin-right: 0.127em; margin-left: 0.127em;"><span style="position: absolute; clip: rect(3.291em, 1000.5em, 4.159em, -999.997em); top: -4.401em; left: 50%; margin-left: -0.245em;"><span class="mi" id="MathJax-Span-1440" style="font-size: 70.7%; font-family: MathJax_Math-italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.065em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.291em, 1000.31em, 4.159em, -999.997em); top: -3.595em; left: 50%; margin-left: -0.183em;"><span class="mn" id="MathJax-Span-1441" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(0.81em, 1000.62em, 1.244em, -999.997em); top: -1.3em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 0.623em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.058em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-1442"><span style="display: inline-block; position: relative; width: 9.122em; height: 0px;"><span style="position: absolute; clip: rect(5.276em, 1008.38em, 15.078em, -999.997em); top: -10.419em; left: 0em;"><span class="mrow" id="MathJax-Span-1443"><span class="mo" id="MathJax-Span-1444" style="vertical-align: 4.966em;"><span style="display: inline-block; position: relative; width: 0.685em; height: 0px;"><span style="position: absolute; font-family: MathJax_Size4; top: -2.788em; left: 0em;">⎡<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; font-family: MathJax_Size4; top: 4.78em; left: 0em;">⎣<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -1.61em; left: 0em;">⎢<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -1.114em; left: 0em;">⎢<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -0.555em; left: 0em;">⎢<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -0.059em; left: 0em;">⎢<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: 0.499em; left: 0em;">⎢<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: 1.058em; left: 0em;">⎢<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: 1.554em; left: 0em;">⎢<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: 2.112em; left: 0em;">⎢<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: 2.609em; left: 0em;">⎢<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: 3.167em; left: 0em;">⎢<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: 3.725em; left: 0em;">⎢<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="mtable" id="MathJax-Span-1445" style="padding-right: 0.189em; padding-left: 0.189em;"><span style="display: inline-block; position: relative; width: 6.951em; height: 0px;"><span style="position: absolute; clip: rect(5.09em, 1001.68em, 14.457em, -999.997em); top: -9.984em; left: 0em;"><span style="display: inline-block; position: relative; width: 1.678em; height: 0px;"><span style="position: absolute; clip: rect(3.229em, 1001.68em, 4.346em, -999.997em); top: -8.123em; left: 50%; margin-left: -0.803em;"><span class="mtd" id="MathJax-Span-1446"><span class="mrow" id="MathJax-Span-1447"><span class="mo" id="MathJax-Span-1448" style="font-family: MathJax_Main;">−</span><span class="msubsup" id="MathJax-Span-1449"><span style="display: inline-block; position: relative; width: 0.872em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.44em, 4.346em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-1450" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.437em;"><span class="mn" id="MathJax-Span-1451" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.353em, 1000.87em, 4.346em, -999.997em); top: -6.697em; left: 50%; margin-left: -0.431em;"><span class="mtd" id="MathJax-Span-1464"><span class="mrow" id="MathJax-Span-1465"><span class="msubsup" id="MathJax-Span-1466"><span style="display: inline-block; position: relative; width: 0.872em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.44em, 4.346em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-1467" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.437em;"><span class="mn" id="MathJax-Span-1468" style="font-size: 70.7%; font-family: MathJax_Main;">0</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.353em, 1000.87em, 4.346em, -999.997em); top: -5.332em; left: 50%; margin-left: -0.431em;"><span class="mtd" id="MathJax-Span-1480"><span class="mrow" id="MathJax-Span-1481"><span class="msubsup" id="MathJax-Span-1482"><span style="display: inline-block; position: relative; width: 0.872em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.44em, 4.346em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-1483" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.437em;"><span class="mn" id="MathJax-Span-1484" style="font-size: 70.7%; font-family: MathJax_Main;">3</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.229em, 1001.68em, 4.346em, -999.997em); top: -3.905em; left: 50%; margin-left: -0.803em;"><span class="mtd" id="MathJax-Span-1496"><span class="mrow" id="MathJax-Span-1497"><span class="mo" id="MathJax-Span-1498" style="font-family: MathJax_Main;">−</span><span class="msubsup" id="MathJax-Span-1499"><span style="display: inline-block; position: relative; width: 0.872em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.44em, 4.346em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-1500" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.437em;"><span class="mn" id="MathJax-Span-1501" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.105em, 1000.44em, 4.159em, -999.997em); top: -2.54em; left: 50%; margin-left: -0.245em;"><span class="mtd" id="MathJax-Span-1512"><span class="mrow" id="MathJax-Span-1513"><span class="mn" id="MathJax-Span-1514" style="font-family: MathJax_Main;">0</span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.105em, 1000.44em, 4.159em, -999.997em); top: -1.114em; left: 50%; margin-left: -0.245em;"><span class="mtd" id="MathJax-Span-1521"><span class="mrow" id="MathJax-Span-1522"><span class="mn" id="MathJax-Span-1523" style="font-family: MathJax_Main;">0</span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.105em, 1000.44em, 4.159em, -999.997em); top: 0.313em; left: 50%; margin-left: -0.245em;"><span class="mtd" id="MathJax-Span-1530"><span class="mrow" id="MathJax-Span-1531"><span class="mn" id="MathJax-Span-1532" style="font-family: MathJax_Main;">0</span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span><span style="display: inline-block; width: 0px; height: 9.991em;"></span></span><span style="position: absolute; clip: rect(5.09em, 1001.68em, 14.457em, -999.997em); top: -9.984em; left: 2.671em;"><span style="display: inline-block; position: relative; width: 1.678em; height: 0px;"><span style="position: absolute; clip: rect(3.229em, 1001.68em, 4.346em, -999.997em); top: -8.123em; left: 50%; margin-left: -0.803em;"><span class="mtd" id="MathJax-Span-1452"><span class="mrow" id="MathJax-Span-1453"><span class="mo" id="MathJax-Span-1454" style="font-family: MathJax_Main;">−</span><span class="msubsup" id="MathJax-Span-1455"><span style="display: inline-block; position: relative; width: 0.872em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.44em, 4.346em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-1456" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.437em;"><span class="mn" id="MathJax-Span-1457" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.229em, 1001.68em, 4.346em, -999.997em); top: -6.697em; left: 50%; margin-left: -0.803em;"><span class="mtd" id="MathJax-Span-1469"><span class="mrow" id="MathJax-Span-1470"><span class="mo" id="MathJax-Span-1471" style="font-family: MathJax_Main;">−</span><span class="msubsup" id="MathJax-Span-1472"><span style="display: inline-block; position: relative; width: 0.872em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.44em, 4.346em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-1473" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.437em;"><span class="mn" id="MathJax-Span-1474" style="font-size: 70.7%; font-family: MathJax_Main;">3</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.353em, 1000.87em, 4.346em, -999.997em); top: -5.332em; left: 50%; margin-left: -0.431em;"><span class="mtd" id="MathJax-Span-1485"><span class="mrow" id="MathJax-Span-1486"><span class="msubsup" id="MathJax-Span-1487"><span style="display: inline-block; position: relative; width: 0.872em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.44em, 4.346em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-1488" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.437em;"><span class="mn" id="MathJax-Span-1489" style="font-size: 70.7%; font-family: MathJax_Main;">0</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.353em, 1000.87em, 4.346em, -999.997em); top: -3.905em; left: 50%; margin-left: -0.431em;"><span class="mtd" id="MathJax-Span-1502"><span class="mrow" id="MathJax-Span-1503"><span class="msubsup" id="MathJax-Span-1504"><span style="display: inline-block; position: relative; width: 0.872em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.44em, 4.346em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-1505" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.437em;"><span class="mn" id="MathJax-Span-1506" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.105em, 1000.44em, 4.159em, -999.997em); top: -2.54em; left: 50%; margin-left: -0.245em;"><span class="mtd" id="MathJax-Span-1515"><span class="mrow" id="MathJax-Span-1516"><span class="mn" id="MathJax-Span-1517" style="font-family: MathJax_Main;">0</span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.105em, 1000.44em, 4.159em, -999.997em); top: -1.114em; left: 50%; margin-left: -0.245em;"><span class="mtd" id="MathJax-Span-1524"><span class="mrow" id="MathJax-Span-1525"><span class="mn" id="MathJax-Span-1526" style="font-family: MathJax_Main;">0</span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.105em, 1000.44em, 4.159em, -999.997em); top: 0.313em; left: 50%; margin-left: -0.245em;"><span class="mtd" id="MathJax-Span-1533"><span class="mrow" id="MathJax-Span-1534"><span class="mn" id="MathJax-Span-1535" style="font-family: MathJax_Main;">0</span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span><span style="display: inline-block; width: 0px; height: 9.991em;"></span></span><span style="position: absolute; clip: rect(5.09em, 1001.68em, 14.457em, -999.997em); top: -9.984em; left: 5.338em;"><span style="display: inline-block; position: relative; width: 1.678em; height: 0px;"><span style="position: absolute; clip: rect(3.229em, 1001.68em, 4.346em, -999.997em); top: -8.123em; left: 50%; margin-left: -0.803em;"><span class="mtd" id="MathJax-Span-1458"><span class="mrow" id="MathJax-Span-1459"><span class="mo" id="MathJax-Span-1460" style="font-family: MathJax_Main;">−</span><span class="msubsup" id="MathJax-Span-1461"><span style="display: inline-block; position: relative; width: 0.872em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.44em, 4.346em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-1462" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.437em;"><span class="mn" id="MathJax-Span-1463" style="font-size: 70.7%; font-family: MathJax_Main;">3</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.353em, 1000.87em, 4.346em, -999.997em); top: -6.697em; left: 50%; margin-left: -0.431em;"><span class="mtd" id="MathJax-Span-1475"><span class="mrow" id="MathJax-Span-1476"><span class="msubsup" id="MathJax-Span-1477"><span style="display: inline-block; position: relative; width: 0.872em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.44em, 4.346em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-1478" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.437em;"><span class="mn" id="MathJax-Span-1479" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.229em, 1001.68em, 4.346em, -999.997em); top: -5.332em; left: 50%; margin-left: -0.803em;"><span class="mtd" id="MathJax-Span-1490"><span class="mrow" id="MathJax-Span-1491"><span class="mo" id="MathJax-Span-1492" style="font-family: MathJax_Main;">−</span><span class="msubsup" id="MathJax-Span-1493"><span style="display: inline-block; position: relative; width: 0.872em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.44em, 4.346em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-1494" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.437em;"><span class="mn" id="MathJax-Span-1495" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.353em, 1000.87em, 4.346em, -999.997em); top: -3.905em; left: 50%; margin-left: -0.431em;"><span class="mtd" id="MathJax-Span-1507"><span class="mrow" id="MathJax-Span-1508"><span class="msubsup" id="MathJax-Span-1509"><span style="display: inline-block; position: relative; width: 0.872em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.44em, 4.346em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-1510" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.437em;"><span class="mn" id="MathJax-Span-1511" style="font-size: 70.7%; font-family: MathJax_Main;">0</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.105em, 1000.44em, 4.159em, -999.997em); top: -2.54em; left: 50%; margin-left: -0.245em;"><span class="mtd" id="MathJax-Span-1518"><span class="mrow" id="MathJax-Span-1519"><span class="mn" id="MathJax-Span-1520" style="font-family: MathJax_Main;">0</span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.105em, 1000.44em, 4.159em, -999.997em); top: -1.114em; left: 50%; margin-left: -0.245em;"><span class="mtd" id="MathJax-Span-1527"><span class="mrow" id="MathJax-Span-1528"><span class="mn" id="MathJax-Span-1529" style="font-family: MathJax_Main;">0</span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.105em, 1000.44em, 4.159em, -999.997em); top: 0.313em; left: 50%; margin-left: -0.245em;"><span class="mtd" id="MathJax-Span-1536"><span class="mrow" id="MathJax-Span-1537"><span class="mn" id="MathJax-Span-1538" style="font-family: MathJax_Main;">0</span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span><span style="display: inline-block; width: 0px; height: 9.991em;"></span></span></span></span><span class="mo" id="MathJax-Span-1539" style="vertical-align: 4.966em;"><span style="display: inline-block; position: relative; width: 0.685em; height: 0px;"><span style="position: absolute; font-family: MathJax_Size4; top: -2.788em; left: 0em;">⎤<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; font-family: MathJax_Size4; top: 4.78em; left: 0em;">⎦<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -1.61em; left: 0em;">⎥<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -1.114em; left: 0em;">⎥<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -0.555em; left: 0em;">⎥<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -0.059em; left: 0em;">⎥<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: 0.499em; left: 0em;">⎥<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: 1.058em; left: 0em;">⎥<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: 1.554em; left: 0em;">⎥<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: 2.112em; left: 0em;">⎥<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: 2.609em; left: 0em;">⎥<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: 3.167em; left: 0em;">⎥<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: 3.725em; left: 0em;">⎥<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 10.425em;"></span></span><span style="position: absolute; top: 0.499em; left: 8.688em;"><span class="mi" id="MathJax-Span-1540" style="font-size: 70.7%; font-family: MathJax_Math-italic;">k</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-1541"><span style="display: inline-block; position: relative; width: 3.291em; height: 0px;"><span style="position: absolute; clip: rect(2.422em, 1002.55em, 6.641em, -999.997em); top: -4.774em; left: 0em;"><span class="mrow" id="MathJax-Span-1542"><span class="mo" id="MathJax-Span-1543" style="vertical-align: 2.174em;"><span style="display: inline-block; position: relative; width: 0.685em; height: 0px;"><span style="position: absolute; font-family: MathJax_Size4; top: -2.788em; left: 0em;">⎡<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; font-family: MathJax_Size4; top: -0.803em; left: 0em;">⎣<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -1.796em; left: 0em;">⎢<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="mtable" id="MathJax-Span-1544" style="padding-right: 0.189em; padding-left: 0.189em;"><span style="display: inline-block; position: relative; width: 1.12em; height: 0px;"><span style="position: absolute; clip: rect(2.422em, 1001.12em, 6.207em, -999.997em); top: -4.401em; left: 0em;"><span style="display: inline-block; position: relative; width: 1.12em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1001.12em, 4.283em, -999.997em); top: -5.332em; left: 50%; margin-left: -0.555em;"><span class="mtd" id="MathJax-Span-1545"><span class="mrow" id="MathJax-Span-1546"><span class="msubsup" id="MathJax-Span-1547"><span style="display: inline-block; position: relative; width: 1.12em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.68em, 4.159em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-1548" style="font-family: MathJax_Math-italic;">w</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.748em;"><span class="mn" id="MathJax-Span-1549" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.353em, 1001.12em, 4.283em, -999.997em); top: -3.905em; left: 50%; margin-left: -0.555em;"><span class="mtd" id="MathJax-Span-1550"><span class="mrow" id="MathJax-Span-1551"><span class="msubsup" id="MathJax-Span-1552"><span style="display: inline-block; position: relative; width: 1.12em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.68em, 4.159em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-1553" style="font-family: MathJax_Math-italic;">w</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.748em;"><span class="mn" id="MathJax-Span-1554" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.353em, 1001.12em, 4.346em, -999.997em); top: -2.54em; left: 50%; margin-left: -0.555em;"><span class="mtd" id="MathJax-Span-1555"><span class="mrow" id="MathJax-Span-1556"><span class="msubsup" id="MathJax-Span-1557"><span style="display: inline-block; position: relative; width: 1.12em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.68em, 4.159em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-1558" style="font-family: MathJax_Math-italic;">w</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.748em;"><span class="mn" id="MathJax-Span-1559" style="font-size: 70.7%; font-family: MathJax_Main;">3</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.408em;"></span></span></span></span><span class="mo" id="MathJax-Span-1560" style="vertical-align: 2.174em;"><span style="display: inline-block; position: relative; width: 0.685em; height: 0px;"><span style="position: absolute; font-family: MathJax_Size4; top: -2.788em; left: 0em;">⎤<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; font-family: MathJax_Size4; top: -0.803em; left: 0em;">⎦<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -1.796em; left: 0em;">⎥<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.78em;"></span></span><span style="position: absolute; top: -2.292em; left: 2.857em;"><span class="mi" id="MathJax-Span-1561" style="font-size: 70.7%; font-family: MathJax_Math-italic;">k</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 7.944em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -6.304em; border-left: 0px solid; width: 0px; height: 13.312em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mrow><mo>[</mo><mtable rowspacing="4pt" columnspacing="1em"><mtr><mtd><msub><mi>q</mi><mn>0</mn></msub></mtd></mtr><mtr><mtd><msub><mi>q</mi><mn>1</mn></msub></mtd></mtr><mtr><mtd><msub><mi>q</mi><mn>2</mn></msub></mtd></mtr><mtr><mtd><msub><mi>q</mi><mn>3</mn></msub></mtd></mtr><mtr><mtd><msub><mrow class="MJX-TeXAtom-ORD"><msup><mi>b</mi><mi>g</mi></msup></mrow><mi>x</mi></msub></mtd></mtr><mtr><mtd><msub><mrow class="MJX-TeXAtom-ORD"><msup><mi>b</mi><mi>g</mi></msup></mrow><mi>y</mi></msub></mtd></mtr><mtr><mtd><msub><mrow class="MJX-TeXAtom-ORD"><msup><mi>b</mi><mi>g</mi></msup></mrow><mi>z</mi></msub></mtd></mtr></mtable><mo>]</mo></mrow><mrow class="MJX-TeXAtom-ORD"><mi>k</mi><mo>+</mo><mn>1</mn></mrow></msub><mo>=</mo><mrow><mo>[</mo><mtable rowspacing="4pt" columnspacing="1em"><mtr><mtd><mn>1</mn></mtd><mtd><mn>0</mn></mtd><mtd><mn>0</mn></mtd><mtd><mn>0</mn></mtd><mtd><mo>−</mo><mfrac><mi>T</mi><mn>2</mn></mfrac><mo stretchy="false">(</mo><mo>−</mo><msub><mi>q</mi><mn>1</mn></msub><mo stretchy="false">)</mo></mtd><mtd><mo>−</mo><mfrac><mi>T</mi><mn>2</mn></mfrac><mo stretchy="false">(</mo><mo>−</mo><msub><mi>q</mi><mn>2</mn></msub><mo stretchy="false">)</mo></mtd><mtd><mo>−</mo><mfrac><mi>T</mi><mn>2</mn></mfrac><mo stretchy="false">(</mo><mo>−</mo><msub><mi>q</mi><mn>3</mn></msub><mo stretchy="false">)</mo></mtd></mtr><mtr><mtd><mn>0</mn></mtd><mtd><mn>1</mn></mtd><mtd><mn>0</mn></mtd><mtd><mn>0</mn></mtd><mtd><mo>−</mo><mfrac><mi>T</mi><mn>2</mn></mfrac><mo stretchy="false">(</mo><msub><mi>q</mi><mn>0</mn></msub><mo stretchy="false">)</mo></mtd><mtd><mo>−</mo><mfrac><mi>T</mi><mn>2</mn></mfrac><mo stretchy="false">(</mo><mo>−</mo><msub><mi>q</mi><mn>3</mn></msub><mo stretchy="false">)</mo></mtd><mtd><mo>−</mo><mfrac><mi>T</mi><mn>2</mn></mfrac><mo stretchy="false">(</mo><msub><mi>q</mi><mn>2</mn></msub><mo stretchy="false">)</mo></mtd></mtr><mtr><mtd><mn>0</mn></mtd><mtd><mn>0</mn></mtd><mtd><mn>1</mn></mtd><mtd><mn>0</mn></mtd><mtd><mo>−</mo><mfrac><mi>T</mi><mn>2</mn></mfrac><mo stretchy="false">(</mo><msub><mi>q</mi><mn>3</mn></msub><mo stretchy="false">)</mo></mtd><mtd><mo>−</mo><mfrac><mi>T</mi><mn>2</mn></mfrac><mo stretchy="false">(</mo><msub><mi>q</mi><mn>0</mn></msub><mo stretchy="false">)</mo></mtd><mtd><mo>−</mo><mfrac><mi>T</mi><mn>2</mn></mfrac><mo stretchy="false">(</mo><mo>−</mo><msub><mi>q</mi><mn>1</mn></msub><mo stretchy="false">)</mo></mtd></mtr><mtr><mtd><mn>0</mn></mtd><mtd><mn>0</mn></mtd><mtd><mn>0</mn></mtd><mtd><mn>1</mn></mtd><mtd><mo>−</mo><mfrac><mi>T</mi><mn>2</mn></mfrac><mo stretchy="false">(</mo><mo>−</mo><msub><mi>q</mi><mn>2</mn></msub><mo stretchy="false">)</mo></mtd><mtd><mo>−</mo><mfrac><mi>T</mi><mn>2</mn></mfrac><mo stretchy="false">(</mo><msub><mi>q</mi><mn>1</mn></msub><mo stretchy="false">)</mo></mtd><mtd><mo>−</mo><mfrac><mi>T</mi><mn>2</mn></mfrac><mo stretchy="false">(</mo><msub><mi>q</mi><mn>0</mn></msub><mo stretchy="false">)</mo></mtd></mtr><mtr><mtd><mn>0</mn></mtd><mtd><mn>0</mn></mtd><mtd><mn>0</mn></mtd><mtd><mn>0</mn></mtd><mtd><mn>1</mn></mtd><mtd><mn>0</mn></mtd><mtd><mn>0</mn></mtd></mtr><mtr><mtd><mn>0</mn></mtd><mtd><mn>0</mn></mtd><mtd><mn>0</mn></mtd><mtd><mn>0</mn></mtd><mtd><mn>0</mn></mtd><mtd><mn>1</mn></mtd><mtd><mn>0</mn></mtd></mtr><mtr><mtd><mn>0</mn></mtd><mtd><mn>0</mn></mtd><mtd><mn>0</mn></mtd><mtd><mn>0</mn></mtd><mtd><mn>0</mn></mtd><mtd><mn>0</mn></mtd><mtd><mn>1</mn></mtd></mtr></mtable><mo>]</mo></mrow><msub><mrow><mo>[</mo><mtable rowspacing="4pt" columnspacing="1em"><mtr><mtd><msub><mi>q</mi><mn>0</mn></msub></mtd></mtr><mtr><mtd><msub><mi>q</mi><mn>1</mn></msub></mtd></mtr><mtr><mtd><msub><mi>q</mi><mn>2</mn></msub></mtd></mtr><mtr><mtd><msub><mi>q</mi><mn>3</mn></msub></mtd></mtr><mtr><mtd><msub><mrow class="MJX-TeXAtom-ORD"><msup><mi>b</mi><mi>g</mi></msup></mrow><mi>x</mi></msub></mtd></mtr><mtr><mtd><msub><mrow class="MJX-TeXAtom-ORD"><msup><mi>b</mi><mi>g</mi></msup></mrow><mi>y</mi></msub></mtd></mtr><mtr><mtd><msub><mrow class="MJX-TeXAtom-ORD"><msup><mi>b</mi><mi>g</mi></msup></mrow><mi>z</mi></msub></mtd></mtr></mtable><mo>]</mo></mrow><mi>k</mi></msub><mo>+</mo><mfrac><mi>T</mi><mn>2</mn></mfrac><msub><mrow><mo>[</mo><mtable rowspacing="4pt" columnspacing="1em"><mtr><mtd><mo>−</mo><msub><mi>q</mi><mn>1</mn></msub></mtd><mtd><mo>−</mo><msub><mi>q</mi><mn>2</mn></msub></mtd><mtd><mo>−</mo><msub><mi>q</mi><mn>3</mn></msub></mtd></mtr><mtr><mtd><msub><mi>q</mi><mn>0</mn></msub></mtd><mtd><mo>−</mo><msub><mi>q</mi><mn>3</mn></msub></mtd><mtd><msub><mi>q</mi><mn>2</mn></msub></mtd></mtr><mtr><mtd><msub><mi>q</mi><mn>3</mn></msub></mtd><mtd><msub><mi>q</mi><mn>0</mn></msub></mtd><mtd><mo>−</mo><msub><mi>q</mi><mn>1</mn></msub></mtd></mtr><mtr><mtd><mo>−</mo><msub><mi>q</mi><mn>2</mn></msub></mtd><mtd><msub><mi>q</mi><mn>1</mn></msub></mtd><mtd><msub><mi>q</mi><mn>0</mn></msub></mtd></mtr><mtr><mtd><mn>0</mn></mtd><mtd><mn>0</mn></mtd><mtd><mn>0</mn></mtd></mtr><mtr><mtd><mn>0</mn></mtd><mtd><mn>0</mn></mtd><mtd><mn>0</mn></mtd></mtr><mtr><mtd><mn>0</mn></mtd><mtd><mn>0</mn></mtd><mtd><mn>0</mn></mtd></mtr></mtable><mo>]</mo></mrow><mi>k</mi></msub><msub><mrow><mo>[</mo><mtable rowspacing="4pt" columnspacing="1em"><mtr><mtd><msub><mi>w</mi><mn>1</mn></msub></mtd></mtr><mtr><mtd><msub><mi>w</mi><mn>2</mn></msub></mtd></mtr><mtr><mtd><msub><mi>w</mi><mn>3</mn></msub></mtd></mtr></mtable><mo>]</mo></mrow><mi>k</mi></msub></math></span></span><script type="math/tex" id="MathJax-Element-22">\begin{bmatrix} q_0 \\ q_1 \\ q_2 \\ q_3 \\ {b^g}_x \\ {b^g}_y \\ {b^g}_z \end{bmatrix}_{k+1} = \begin{bmatrix} 1 & 0 & 0 & 0 & -\frac{T}{2}(-q_1) & -\frac{T}{2}(-q_2) & -\frac{T}{2}(-q_3) \\ 0 & 1 & 0 & 0 & -\frac{T}{2}(q_0) & -\frac{T}{2}(-q_3) & -\frac{T}{2}(q_2) \\ 0 & 0 & 1 & 0 & -\frac{T}{2}(q_3) & -\frac{T}{2}(q_0) & -\frac{T}{2}(-q_1) \\ 0 & 0 & 0 & 1 & -\frac{T}{2}(-q_2) & -\frac{T}{2}(q_1) & -\frac{T}{2}(q_0) \\ 0 & 0 & 0 & 0 & 1 & 0 & 0 \\ 0 & 0 & 0 & 0 & 0 & 1 & 0 \\ 0 & 0 & 0 & 0 & 0 & 0 & 1 \end{bmatrix} \begin{bmatrix} q_0 \\ q_1 \\ q_2 \\ q_3 \\ {b^g}_x \\ {b^g}_y \\ {b^g}_z \end{bmatrix}_k + \frac{T}{2}\begin{bmatrix} -q_1 & -q_2 & -q_3 \\ q_0 & -q_3 & q_2 \\ q_3 & q_0 & -q_1 \\ -q_2 & q_1 & q_0 \\ 0 & 0 & 0 \\ 0 & 0 & 0 \\ 0 & 0 & 0 \end{bmatrix}_k \begin{bmatrix} w_1 \\ w_2 \\ w_3\end{bmatrix}_k</script></p>
<p>Before we move on to the actual implementation, let us first take a look at how we can use the accelerometer and magnetometer data in order get the reference vectors.</p>
<div id="AccelData"></div>
<hr>
<h2>Accelerometer Data</h2>
<p>The acceleration measured by the accelerometer module can be calculated if we know the acceleration of the body in the world frame, and the orientation of the body. Our reference vector is going to be the gravity vector, and we know that this vector will always point downwards in the world frame. Therefore, if we know the orientation of the body, we can predict the acceleration that the accelerometer is going to measure. This is all based on the assumption that external forces are negligible thus the only force that acts on the body is the gravitational force. As a result of this assumption, you will find that once you move the body hectically, the algorithm will not perform well. There are of course ways to alleviate this problem, but we will not go into there for the purpose of this tutorial.</p>
<p>The above paragraph can be summarized into the following equation.</p>
<p style="text-align: center;"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-23-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msup&gt;&lt;mi&gt;&lt;/mi&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;/msup&gt;&lt;msub&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mi&gt;m&lt;/mi&gt;&lt;/msub&gt;&lt;msup&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;/msup&gt;&lt;msub&gt;&lt;mi&gt;R&lt;/mi&gt;&lt;mi&gt;w&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mi&gt;g&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;msup&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;/msup&gt;&lt;msub&gt;&lt;mi&gt;e&lt;/mi&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;/msub&gt;&lt;msup&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;/msup&gt;&lt;msub&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1562" style="width: 14.767em; display: inline-block;"><span style="display: inline-block; position: relative; width: 11.914em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(1.306em, 1011.91em, 2.795em, -999.997em); top: -2.354em; left: 0em;"><span class="mrow" id="MathJax-Span-1563"><span class="msubsup" id="MathJax-Span-1564"><span style="display: inline-block; position: relative; width: 0.375em; height: 0px;"><span style="position: absolute; clip: rect(3.787em, 1000em, 4.159em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-1565"></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -4.339em; left: 0em;"><span class="mi" id="MathJax-Span-1566" style="font-size: 70.7%; font-family: MathJax_Math-italic;">b</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-1567"><span style="display: inline-block; position: relative; width: 1.244em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.5em, 4.159em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-1568" style="font-family: MathJax_Math-italic;">a</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.561em;"><span class="mi" id="MathJax-Span-1569" style="font-size: 70.7%; font-family: MathJax_Math-italic;">m</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-1570" style="padding-left: 0.251em;"><span style="display: inline-block; position: relative; width: 1.182em; height: 0px;"><span style="position: absolute; clip: rect(3.415em, 1000.75em, 4.035em, -999.997em); top: -3.967em; left: 0em;"><span class="mo" id="MathJax-Span-1571" style="font-family: MathJax_Main;">=</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -4.339em; left: 0.81em;"><span class="mi" id="MathJax-Span-1572" style="font-size: 70.7%; font-family: MathJax_Math-italic;">b</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-1573" style="padding-left: 0.251em;"><span style="display: inline-block; position: relative; width: 1.368em; height: 0px;"><span style="position: absolute; clip: rect(3.105em, 1000.75em, 4.159em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-1574" style="font-family: MathJax_Math-italic;">R</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.748em;"><span class="mi" id="MathJax-Span-1575" style="font-size: 70.7%; font-family: MathJax_Math-italic;">w</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="mo" id="MathJax-Span-1576" style="font-family: MathJax_Main;">(</span><span class="mo" id="MathJax-Span-1577" style="font-family: MathJax_Main;">−</span><span class="mi" id="MathJax-Span-1578" style="font-family: MathJax_Math-italic;">g<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-1579" style="font-family: MathJax_Main;">)</span><span class="msubsup" id="MathJax-Span-1580" style="padding-left: 0.251em;"><span style="display: inline-block; position: relative; width: 1.182em; height: 0px;"><span style="position: absolute; clip: rect(3.229em, 1000.75em, 4.221em, -999.997em); top: -3.967em; left: 0em;"><span class="mo" id="MathJax-Span-1581" style="font-family: MathJax_Main;">+</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -4.339em; left: 0.81em;"><span class="mi" id="MathJax-Span-1582" style="font-size: 70.7%; font-family: MathJax_Math-italic;">b</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-1583" style="padding-left: 0.251em;"><span style="display: inline-block; position: relative; width: 0.934em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.44em, 4.159em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-1584" style="font-family: MathJax_Math-italic;">e</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.499em;"><span class="mi" id="MathJax-Span-1585" style="font-size: 70.7%; font-family: MathJax_Math-italic;">a</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-1586" style="padding-left: 0.251em;"><span style="display: inline-block; position: relative; width: 1.182em; height: 0px;"><span style="position: absolute; clip: rect(3.229em, 1000.75em, 4.221em, -999.997em); top: -3.967em; left: 0em;"><span class="mo" id="MathJax-Span-1587" style="font-family: MathJax_Main;">+</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -4.339em; left: 0.81em;"><span class="mi" id="MathJax-Span-1588" style="font-size: 70.7%; font-family: MathJax_Math-italic;">b</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-1589" style="padding-left: 0.251em;"><span style="display: inline-block; position: relative; width: 0.872em; height: 0px;"><span style="position: absolute; clip: rect(3.105em, 1000.44em, 4.159em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-1590" style="font-family: MathJax_Math-italic;">b</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.437em;"><span class="mi" id="MathJax-Span-1591" style="font-size: 70.7%; font-family: MathJax_Math-italic;">a</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.36em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.381em; border-left: 0px solid; width: 0px; height: 1.542em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup><mi></mi><mi>b</mi></msup><msub><mi>a</mi><mi>m</mi></msub><msup><mo>=</mo><mi>b</mi></msup><msub><mi>R</mi><mi>w</mi></msub><mo stretchy="false">(</mo><mo>−</mo><mi>g</mi><mo stretchy="false">)</mo><msup><mo>+</mo><mi>b</mi></msup><msub><mi>e</mi><mi>a</mi></msub><msup><mo>+</mo><mi>b</mi></msup><msub><mi>b</mi><mi>a</mi></msub></math></span></span><script type="math/tex" id="MathJax-Element-23">^ba_m = ^bR_w(-g) + ^be_a + ^bb_a</script>&nbsp; &nbsp; &nbsp;——————–&nbsp; &nbsp; &nbsp;(8)</p>
<p>where</p>
<p><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-24-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msup&gt;&lt;mi&gt;&lt;/mi&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;/msup&gt;&lt;msub&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mi&gt;m&lt;/mi&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1592" style="width: 2.05em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.616em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(1.306em, 1001.62em, 2.733em, -999.997em); top: -2.354em; left: 0em;"><span class="mrow" id="MathJax-Span-1593"><span class="msubsup" id="MathJax-Span-1594"><span style="display: inline-block; position: relative; width: 0.375em; height: 0px;"><span style="position: absolute; clip: rect(3.787em, 1000em, 4.159em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-1595"></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -4.339em; left: 0em;"><span class="mi" id="MathJax-Span-1596" style="font-size: 70.7%; font-family: MathJax_Math-italic;">b</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-1597"><span style="display: inline-block; position: relative; width: 1.244em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.5em, 4.159em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-1598" style="font-family: MathJax_Math-italic;">a</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.561em;"><span class="mi" id="MathJax-Span-1599" style="font-size: 70.7%; font-family: MathJax_Math-italic;">m</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.36em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.304em; border-left: 0px solid; width: 0px; height: 1.388em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup><mi></mi><mi>b</mi></msup><msub><mi>a</mi><mi>m</mi></msub></math></span></span><script type="math/tex" id="MathJax-Element-24">^ba_m</script> is the measured acceleration in the body frame by the accelerometer<br>
<span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-25-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msup&gt;&lt;mi&gt;&lt;/mi&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;/msup&gt;&lt;msub&gt;&lt;mi&gt;R&lt;/mi&gt;&lt;mi&gt;w&lt;/mi&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1600" style="width: 2.174em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.74em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(1.306em, 1001.74em, 2.733em, -999.997em); top: -2.354em; left: 0em;"><span class="mrow" id="MathJax-Span-1601"><span class="msubsup" id="MathJax-Span-1602"><span style="display: inline-block; position: relative; width: 0.375em; height: 0px;"><span style="position: absolute; clip: rect(3.787em, 1000em, 4.159em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-1603"></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -4.339em; left: 0em;"><span class="mi" id="MathJax-Span-1604" style="font-size: 70.7%; font-family: MathJax_Math-italic;">b</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-1605"><span style="display: inline-block; position: relative; width: 1.368em; height: 0px;"><span style="position: absolute; clip: rect(3.105em, 1000.75em, 4.159em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-1606" style="font-family: MathJax_Math-italic;">R</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.748em;"><span class="mi" id="MathJax-Span-1607" style="font-size: 70.7%; font-family: MathJax_Math-italic;">w</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.36em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.304em; border-left: 0px solid; width: 0px; height: 1.388em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup><mi></mi><mi>b</mi></msup><msub><mi>R</mi><mi>w</mi></msub></math></span></span><script type="math/tex" id="MathJax-Element-25">^bR_w</script> is the rotation matrix for world frame to body frame<br>
<span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-26-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;g&lt;/mi&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1608" style="width: 0.623em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.499em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(1.74em, 1000.5em, 2.733em, -999.997em); top: -2.354em; left: 0em;"><span class="mrow" id="MathJax-Span-1609"><span class="mi" id="MathJax-Span-1610" style="font-family: MathJax_Math-italic;">g<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.36em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.304em; border-left: 0px solid; width: 0px; height: 0.927em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>g</mi></math></span></span><script type="math/tex" id="MathJax-Element-26">g</script> is the gravitational vector in the world frame, <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-27-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;g&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;msup&gt;&lt;mrow&gt;&lt;mo&gt;[&lt;/mo&gt;&lt;mtable rowspacing=&quot;4pt&quot; columnspacing=&quot;1em&quot;&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;/mtable&gt;&lt;mo&gt;]&lt;/mo&gt;&lt;/mrow&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;/msup&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1611" style="width: 8.378em; display: inline-block;"><span style="display: inline-block; position: relative; width: 6.765em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(1.244em, 1006.76em, 2.795em, -999.997em); top: -2.354em; left: 0em;"><span class="mrow" id="MathJax-Span-1612"><span class="mi" id="MathJax-Span-1613" style="font-family: MathJax_Math-italic;">g<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-1614" style="font-family: MathJax_Main; padding-left: 0.251em;">=</span><span class="msubsup" id="MathJax-Span-1615" style="padding-left: 0.251em;"><span style="display: inline-block; position: relative; width: 5.028em; height: 0px;"><span style="position: absolute; clip: rect(3.043em, 1004.35em, 4.408em, -999.997em); top: -3.967em; left: 0em;"><span class="mrow" id="MathJax-Span-1616"><span class="mo" id="MathJax-Span-1617" style="font-family: MathJax_Main;">[</span><span class="mtable" id="MathJax-Span-1618" style="padding-right: 0.189em; padding-left: 0.189em;"><span style="display: inline-block; position: relative; width: 3.477em; height: 0px;"><span style="position: absolute; clip: rect(3.167em, 1000.44em, 4.221em, -999.997em); top: -3.967em; left: 0em;"><span style="display: inline-block; position: relative; width: 0.499em; height: 0px;"><span style="position: absolute; clip: rect(3.105em, 1000.44em, 4.159em, -999.997em); top: -3.905em; left: 50%; margin-left: -0.245em;"><span class="mtd" id="MathJax-Span-1619"><span class="mrow" id="MathJax-Span-1620"><span class="mn" id="MathJax-Span-1621" style="font-family: MathJax_Main;">0</span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.167em, 1000.44em, 4.221em, -999.997em); top: -3.967em; left: 1.492em;"><span style="display: inline-block; position: relative; width: 0.499em; height: 0px;"><span style="position: absolute; clip: rect(3.105em, 1000.44em, 4.159em, -999.997em); top: -3.905em; left: 50%; margin-left: -0.245em;"><span class="mtd" id="MathJax-Span-1622"><span class="mrow" id="MathJax-Span-1623"><span class="mn" id="MathJax-Span-1624" style="font-family: MathJax_Main;">0</span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.167em, 1000.44em, 4.221em, -999.997em); top: -3.967em; left: 2.981em;"><span style="display: inline-block; position: relative; width: 0.499em; height: 0px;"><span style="position: absolute; clip: rect(3.105em, 1000.44em, 4.159em, -999.997em); top: -3.905em; left: 50%; margin-left: -0.245em;"><span class="mtd" id="MathJax-Span-1625"><span class="mrow" id="MathJax-Span-1626"><span class="mn" id="MathJax-Span-1627" style="font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="mo" id="MathJax-Span-1628" style="font-family: MathJax_Main;">]</span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -4.463em; left: 4.408em;"><span class="mi" id="MathJax-Span-1629" style="font-size: 70.7%; font-family: MathJax_Math-italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.065em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.36em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.381em; border-left: 0px solid; width: 0px; height: 1.619em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>g</mi><mo>=</mo><msup><mrow><mo>[</mo><mtable rowspacing="4pt" columnspacing="1em"><mtr><mtd><mn>0</mn></mtd><mtd><mn>0</mn></mtd><mtd><mn>1</mn></mtd></mtr></mtable><mo>]</mo></mrow><mi>T</mi></msup></math></span></span><script type="math/tex" id="MathJax-Element-27">g = \begin{bmatrix} 0 & 0 & 1 \end{bmatrix}^T</script><br>
<span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-28-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msup&gt;&lt;mi&gt;&lt;/mi&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;/msup&gt;&lt;msub&gt;&lt;mi&gt;e&lt;/mi&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1630" style="width: 1.616em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.306em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(1.306em, 1001.31em, 2.733em, -999.997em); top: -2.354em; left: 0em;"><span class="mrow" id="MathJax-Span-1631"><span class="msubsup" id="MathJax-Span-1632"><span style="display: inline-block; position: relative; width: 0.375em; height: 0px;"><span style="position: absolute; clip: rect(3.787em, 1000em, 4.159em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-1633"></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -4.339em; left: 0em;"><span class="mi" id="MathJax-Span-1634" style="font-size: 70.7%; font-family: MathJax_Math-italic;">b</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-1635"><span style="display: inline-block; position: relative; width: 0.934em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.44em, 4.159em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-1636" style="font-family: MathJax_Math-italic;">e</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.499em;"><span class="mi" id="MathJax-Span-1637" style="font-size: 70.7%; font-family: MathJax_Math-italic;">a</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.36em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.304em; border-left: 0px solid; width: 0px; height: 1.388em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup><mi></mi><mi>b</mi></msup><msub><mi>e</mi><mi>a</mi></msub></math></span></span><script type="math/tex" id="MathJax-Element-28">^be_a</script> is the accelerometer noise in the body frame<br>
<span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-29-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msup&gt;&lt;mi&gt;&lt;/mi&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;/msup&gt;&lt;msub&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1638" style="width: 1.554em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.244em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(1.306em, 1001.24em, 2.733em, -999.997em); top: -2.354em; left: 0em;"><span class="mrow" id="MathJax-Span-1639"><span class="msubsup" id="MathJax-Span-1640"><span style="display: inline-block; position: relative; width: 0.375em; height: 0px;"><span style="position: absolute; clip: rect(3.787em, 1000em, 4.159em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-1641"></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -4.339em; left: 0em;"><span class="mi" id="MathJax-Span-1642" style="font-size: 70.7%; font-family: MathJax_Math-italic;">b</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-1643"><span style="display: inline-block; position: relative; width: 0.872em; height: 0px;"><span style="position: absolute; clip: rect(3.105em, 1000.44em, 4.159em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-1644" style="font-family: MathJax_Math-italic;">b</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.437em;"><span class="mi" id="MathJax-Span-1645" style="font-size: 70.7%; font-family: MathJax_Math-italic;">a</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.36em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.304em; border-left: 0px solid; width: 0px; height: 1.388em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup><mi></mi><mi>b</mi></msup><msub><mi>b</mi><mi>a</mi></msub></math></span></span><script type="math/tex" id="MathJax-Element-29">^bb_a</script> is the accelerometer bias in the body frame</p>
<p>Since we can determine all the variables on the right hand side (except for the noise term), it is possible to predict the measured acceleration. We can then use this prediction to compare with the actual measured acceleration to determine the error in our orientation. The Extended Kalman Filter (EKF) will then automatically help us convert this error into the bias term of the gyrometer. This is what I call the magic of the EKF because I do not need to know how the conversion is done. EKF handles it all as you will see in the later section.</p>
<p>For now, let us define some of the variables above. From the quaternion,&nbsp;it is possible to derive the rotation matrix with the following equation. Do read up on my <a href="https://thepoorengineer.com/en/quaternion/#quaternion">previous post</a> if you need more information on this.</p>
<p><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-30-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msup&gt;&lt;mi&gt;&lt;/mi&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;/msup&gt;&lt;msub&gt;&lt;mi&gt;R&lt;/mi&gt;&lt;mi&gt;w&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;msup&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;msup&gt;&lt;mi&gt;&lt;/mi&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;/msup&gt;&lt;msub&gt;&lt;mi&gt;R&lt;/mi&gt;&lt;mi&gt;w&lt;/mi&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;/msup&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;R&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;msup&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;/msup&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;msup&gt;&lt;mrow&gt;&lt;mo&gt;[&lt;/mo&gt;&lt;mtable rowspacing=&quot;4pt&quot; columnspacing=&quot;1em&quot;&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;msubsup&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msubsup&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;msubsup&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msubsup&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;msubsup&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msubsup&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;msubsup&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mn&gt;3&lt;/mn&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msubsup&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;msub&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msub&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/msub&gt;&lt;msub&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mn&gt;3&lt;/mn&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;msub&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mn&gt;3&lt;/mn&gt;&lt;/msub&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/msub&gt;&lt;msub&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;msub&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msub&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/msub&gt;&lt;msub&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mn&gt;3&lt;/mn&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;msubsup&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msubsup&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;msubsup&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msubsup&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;msubsup&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msubsup&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;msubsup&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mn&gt;3&lt;/mn&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msubsup&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msub&gt;&lt;msub&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mn&gt;3&lt;/mn&gt;&lt;/msub&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/msub&gt;&lt;msub&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;msub&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mn&gt;3&lt;/mn&gt;&lt;/msub&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/msub&gt;&lt;msub&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msub&gt;&lt;msub&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mn&gt;3&lt;/mn&gt;&lt;/msub&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/msub&gt;&lt;msub&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;msubsup&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msubsup&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;msubsup&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msubsup&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;msubsup&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msubsup&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;msubsup&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mn&gt;3&lt;/mn&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msubsup&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;/mtable&gt;&lt;mo&gt;]&lt;/mo&gt;&lt;/mrow&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;/msup&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1646" style="width: 46.653em; display: inline-block;"><span style="display: inline-block; position: relative; width: 37.596em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(-0.369em, 1037.6em, 4.408em, -999.997em); top: -2.354em; left: 0em;"><span class="mrow" id="MathJax-Span-1647"><span class="msubsup" id="MathJax-Span-1648"><span style="display: inline-block; position: relative; width: 0.375em; height: 0px;"><span style="position: absolute; clip: rect(3.787em, 1000em, 4.159em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-1649"></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -4.339em; left: 0em;"><span class="mi" id="MathJax-Span-1650" style="font-size: 70.7%; font-family: MathJax_Math-italic;">b</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-1651"><span style="display: inline-block; position: relative; width: 1.368em; height: 0px;"><span style="position: absolute; clip: rect(3.105em, 1000.75em, 4.159em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-1652" style="font-family: MathJax_Math-italic;">R</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.748em;"><span class="mi" id="MathJax-Span-1653" style="font-size: 70.7%; font-family: MathJax_Math-italic;">w</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="mo" id="MathJax-Span-1654" style="font-family: MathJax_Main; padding-left: 0.251em;">=</span><span class="msubsup" id="MathJax-Span-1655" style="padding-left: 0.251em;"><span style="display: inline-block; position: relative; width: 2.298em; height: 0px;"><span style="position: absolute; clip: rect(2.919em, 1001.74em, 4.346em, -999.997em); top: -3.967em; left: 0em;"><span class="texatom" id="MathJax-Span-1656"><span class="mrow" id="MathJax-Span-1657"><span class="msubsup" id="MathJax-Span-1658"><span style="display: inline-block; position: relative; width: 0.375em; height: 0px;"><span style="position: absolute; clip: rect(3.787em, 1000em, 4.159em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-1659"></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -4.339em; left: 0em;"><span class="mi" id="MathJax-Span-1660" style="font-size: 70.7%; font-family: MathJax_Math-italic;">b</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-1661"><span style="display: inline-block; position: relative; width: 1.368em; height: 0px;"><span style="position: absolute; clip: rect(3.105em, 1000.75em, 4.159em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-1662" style="font-family: MathJax_Math-italic;">R</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.748em;"><span class="mi" id="MathJax-Span-1663" style="font-size: 70.7%; font-family: MathJax_Math-italic;">w</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -4.525em; left: 1.74em;"><span class="mi" id="MathJax-Span-1664" style="font-size: 70.7%; font-family: MathJax_Math-italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.065em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="mo" id="MathJax-Span-1665" style="font-family: MathJax_Main; padding-left: 0.251em;">=</span><span class="mi" id="MathJax-Span-1666" style="font-family: MathJax_Math-italic; padding-left: 0.251em;">R</span><span class="mo" id="MathJax-Span-1667" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-1668" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="msubsup" id="MathJax-Span-1669"><span style="display: inline-block; position: relative; width: 0.996em; height: 0px;"><span style="position: absolute; clip: rect(3.043em, 1000.31em, 4.408em, -999.997em); top: -3.967em; left: 0em;"><span class="mo" id="MathJax-Span-1670" style="font-family: MathJax_Main;">)</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -4.339em; left: 0.375em;"><span class="mi" id="MathJax-Span-1671" style="font-size: 70.7%; font-family: MathJax_Math-italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.065em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="mo" id="MathJax-Span-1672" style="font-family: MathJax_Main; padding-left: 0.251em;">=</span><span class="msubsup" id="MathJax-Span-1673" style="padding-left: 0.251em;"><span style="display: inline-block; position: relative; width: 27.112em; height: 0px;"><span style="position: absolute; clip: rect(2.671em, 1026.24em, 7.261em, -999.997em); top: -5.208em; left: 0em;"><span class="mrow" id="MathJax-Span-1674"><span class="mo" id="MathJax-Span-1675" style="vertical-align: 2.36em;"><span style="display: inline-block; position: relative; width: 0.685em; height: 0px;"><span style="position: absolute; font-family: MathJax_Size4; top: -2.788em; left: 0em;">⎡<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; font-family: MathJax_Size4; top: -0.369em; left: 0em;">⎣<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -1.734em; left: 0em;">⎢<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -1.362em; left: 0em;">⎢<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="mtable" id="MathJax-Span-1676" style="padding-right: 0.189em; padding-left: 0.189em;"><span style="display: inline-block; position: relative; width: 24.817em; height: 0px;"><span style="position: absolute; clip: rect(2.609em, 1007.63em, 7.137em, -999.997em); top: -5.146em; left: 0em;"><span style="display: inline-block; position: relative; width: 7.633em; height: 0px;"><span style="position: absolute; clip: rect(2.981em, 1007.63em, 4.47em, -999.997em); top: -5.518em; left: 50%; margin-left: -3.781em;"><span class="mtd" id="MathJax-Span-1677"><span class="mrow" id="MathJax-Span-1678"><span class="msubsup" id="MathJax-Span-1679"><span style="display: inline-block; position: relative; width: 0.934em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.44em, 4.346em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-1680" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.291em, 1000.44em, 4.159em, -999.997em); top: -4.339em; left: 0.499em;"><span class="mn" id="MathJax-Span-1681" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.291em, 1000.44em, 4.159em, -999.997em); top: -3.657em; left: 0.437em;"><span class="mn" id="MathJax-Span-1682" style="font-size: 70.7%; font-family: MathJax_Main;">0</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="mo" id="MathJax-Span-1683" style="font-family: MathJax_Main; padding-left: 0.251em;">+</span><span class="msubsup" id="MathJax-Span-1684" style="padding-left: 0.251em;"><span style="display: inline-block; position: relative; width: 0.934em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.44em, 4.346em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-1685" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.291em, 1000.44em, 4.159em, -999.997em); top: -4.339em; left: 0.499em;"><span class="mn" id="MathJax-Span-1686" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.291em, 1000.44em, 4.159em, -999.997em); top: -3.657em; left: 0.437em;"><span class="mn" id="MathJax-Span-1687" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="mo" id="MathJax-Span-1688" style="font-family: MathJax_Main; padding-left: 0.251em;">−</span><span class="msubsup" id="MathJax-Span-1689" style="padding-left: 0.251em;"><span style="display: inline-block; position: relative; width: 0.934em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.44em, 4.346em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-1690" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.291em, 1000.44em, 4.159em, -999.997em); top: -4.339em; left: 0.499em;"><span class="mn" id="MathJax-Span-1691" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.291em, 1000.44em, 4.159em, -999.997em); top: -3.657em; left: 0.437em;"><span class="mn" id="MathJax-Span-1692" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="mo" id="MathJax-Span-1693" style="font-family: MathJax_Main; padding-left: 0.251em;">−</span><span class="msubsup" id="MathJax-Span-1694" style="padding-left: 0.251em;"><span style="display: inline-block; position: relative; width: 0.934em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.44em, 4.346em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-1695" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.291em, 1000.44em, 4.159em, -999.997em); top: -4.339em; left: 0.499em;"><span class="mn" id="MathJax-Span-1696" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.291em, 1000.44em, 4.159em, -999.997em); top: -3.657em; left: 0.437em;"><span class="mn" id="MathJax-Span-1697" style="font-size: 70.7%; font-family: MathJax_Main;">3</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.043em, 1005.96em, 4.408em, -999.997em); top: -3.967em; left: 50%; margin-left: -3.037em;"><span class="mtd" id="MathJax-Span-1734"><span class="mrow" id="MathJax-Span-1735"><span class="mn" id="MathJax-Span-1736" style="font-family: MathJax_Main;">2</span><span class="mo" id="MathJax-Span-1737" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-1738"><span style="display: inline-block; position: relative; width: 0.872em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.44em, 4.346em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-1739" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.437em;"><span class="mn" id="MathJax-Span-1740" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-1741"><span style="display: inline-block; position: relative; width: 0.872em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.44em, 4.346em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-1742" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.437em;"><span class="mn" id="MathJax-Span-1743" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="mo" id="MathJax-Span-1744" style="font-family: MathJax_Main; padding-left: 0.251em;">+</span><span class="msubsup" id="MathJax-Span-1745" style="padding-left: 0.251em;"><span style="display: inline-block; position: relative; width: 0.872em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.44em, 4.346em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-1746" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.437em;"><span class="mn" id="MathJax-Span-1747" style="font-size: 70.7%; font-family: MathJax_Main;">0</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-1748"><span style="display: inline-block; position: relative; width: 0.872em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.44em, 4.346em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-1749" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.437em;"><span class="mn" id="MathJax-Span-1750" style="font-size: 70.7%; font-family: MathJax_Main;">3</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="mo" id="MathJax-Span-1751" style="font-family: MathJax_Main;">)</span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.043em, 1005.96em, 4.408em, -999.997em); top: -2.416em; left: 50%; margin-left: -3.037em;"><span class="mtd" id="MathJax-Span-1791"><span class="mrow" id="MathJax-Span-1792"><span class="mn" id="MathJax-Span-1793" style="font-family: MathJax_Main;">2</span><span class="mo" id="MathJax-Span-1794" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-1795"><span style="display: inline-block; position: relative; width: 0.872em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.44em, 4.346em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-1796" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.437em;"><span class="mn" id="MathJax-Span-1797" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-1798"><span style="display: inline-block; position: relative; width: 0.872em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.44em, 4.346em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-1799" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.437em;"><span class="mn" id="MathJax-Span-1800" style="font-size: 70.7%; font-family: MathJax_Main;">3</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="mo" id="MathJax-Span-1801" style="font-family: MathJax_Main; padding-left: 0.251em;">−</span><span class="msubsup" id="MathJax-Span-1802" style="padding-left: 0.251em;"><span style="display: inline-block; position: relative; width: 0.872em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.44em, 4.346em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-1803" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.437em;"><span class="mn" id="MathJax-Span-1804" style="font-size: 70.7%; font-family: MathJax_Main;">0</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-1805"><span style="display: inline-block; position: relative; width: 0.872em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.44em, 4.346em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-1806" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.437em;"><span class="mn" id="MathJax-Span-1807" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="mo" id="MathJax-Span-1808" style="font-family: MathJax_Main;">)</span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span><span style="display: inline-block; width: 0px; height: 5.152em;"></span></span><span style="position: absolute; clip: rect(2.609em, 1007.63em, 7.075em, -999.997em); top: -5.084em; left: 8.626em;"><span style="display: inline-block; position: relative; width: 7.633em; height: 0px;"><span style="position: absolute; clip: rect(3.043em, 1005.96em, 4.408em, -999.997em); top: -5.518em; left: 50%; margin-left: -3.037em;"><span class="mtd" id="MathJax-Span-1698"><span class="mrow" id="MathJax-Span-1699"><span class="mn" id="MathJax-Span-1700" style="font-family: MathJax_Main;">2</span><span class="mo" id="MathJax-Span-1701" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-1702"><span style="display: inline-block; position: relative; width: 0.872em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.44em, 4.346em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-1703" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.437em;"><span class="mn" id="MathJax-Span-1704" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-1705"><span style="display: inline-block; position: relative; width: 0.872em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.44em, 4.346em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-1706" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.437em;"><span class="mn" id="MathJax-Span-1707" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="mo" id="MathJax-Span-1708" style="font-family: MathJax_Main; padding-left: 0.251em;">−</span><span class="msubsup" id="MathJax-Span-1709" style="padding-left: 0.251em;"><span style="display: inline-block; position: relative; width: 0.872em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.44em, 4.346em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-1710" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.437em;"><span class="mn" id="MathJax-Span-1711" style="font-size: 70.7%; font-family: MathJax_Main;">0</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-1712"><span style="display: inline-block; position: relative; width: 0.872em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.44em, 4.346em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-1713" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.437em;"><span class="mn" id="MathJax-Span-1714" style="font-size: 70.7%; font-family: MathJax_Main;">3</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="mo" id="MathJax-Span-1715" style="font-family: MathJax_Main;">)</span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(2.981em, 1007.63em, 4.47em, -999.997em); top: -3.967em; left: 50%; margin-left: -3.781em;"><span class="mtd" id="MathJax-Span-1752"><span class="mrow" id="MathJax-Span-1753"><span class="msubsup" id="MathJax-Span-1754"><span style="display: inline-block; position: relative; width: 0.934em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.44em, 4.346em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-1755" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.291em, 1000.44em, 4.159em, -999.997em); top: -4.339em; left: 0.499em;"><span class="mn" id="MathJax-Span-1756" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.291em, 1000.44em, 4.159em, -999.997em); top: -3.657em; left: 0.437em;"><span class="mn" id="MathJax-Span-1757" style="font-size: 70.7%; font-family: MathJax_Main;">0</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="mo" id="MathJax-Span-1758" style="font-family: MathJax_Main; padding-left: 0.251em;">−</span><span class="msubsup" id="MathJax-Span-1759" style="padding-left: 0.251em;"><span style="display: inline-block; position: relative; width: 0.934em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.44em, 4.346em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-1760" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.291em, 1000.44em, 4.159em, -999.997em); top: -4.339em; left: 0.499em;"><span class="mn" id="MathJax-Span-1761" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.291em, 1000.44em, 4.159em, -999.997em); top: -3.657em; left: 0.437em;"><span class="mn" id="MathJax-Span-1762" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="mo" id="MathJax-Span-1763" style="font-family: MathJax_Main; padding-left: 0.251em;">+</span><span class="msubsup" id="MathJax-Span-1764" style="padding-left: 0.251em;"><span style="display: inline-block; position: relative; width: 0.934em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.44em, 4.346em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-1765" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.291em, 1000.44em, 4.159em, -999.997em); top: -4.339em; left: 0.499em;"><span class="mn" id="MathJax-Span-1766" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.291em, 1000.44em, 4.159em, -999.997em); top: -3.657em; left: 0.437em;"><span class="mn" id="MathJax-Span-1767" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="mo" id="MathJax-Span-1768" style="font-family: MathJax_Main; padding-left: 0.251em;">−</span><span class="msubsup" id="MathJax-Span-1769" style="padding-left: 0.251em;"><span style="display: inline-block; position: relative; width: 0.934em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.44em, 4.346em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-1770" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.291em, 1000.44em, 4.159em, -999.997em); top: -4.339em; left: 0.499em;"><span class="mn" id="MathJax-Span-1771" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.291em, 1000.44em, 4.159em, -999.997em); top: -3.657em; left: 0.437em;"><span class="mn" id="MathJax-Span-1772" style="font-size: 70.7%; font-family: MathJax_Main;">3</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.043em, 1005.96em, 4.408em, -999.997em); top: -2.416em; left: 50%; margin-left: -3.037em;"><span class="mtd" id="MathJax-Span-1809"><span class="mrow" id="MathJax-Span-1810"><span class="mn" id="MathJax-Span-1811" style="font-family: MathJax_Main;">2</span><span class="mo" id="MathJax-Span-1812" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-1813"><span style="display: inline-block; position: relative; width: 0.872em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.44em, 4.346em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-1814" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.437em;"><span class="mn" id="MathJax-Span-1815" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-1816"><span style="display: inline-block; position: relative; width: 0.872em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.44em, 4.346em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-1817" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.437em;"><span class="mn" id="MathJax-Span-1818" style="font-size: 70.7%; font-family: MathJax_Main;">3</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="mo" id="MathJax-Span-1819" style="font-family: MathJax_Main; padding-left: 0.251em;">+</span><span class="msubsup" id="MathJax-Span-1820" style="padding-left: 0.251em;"><span style="display: inline-block; position: relative; width: 0.872em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.44em, 4.346em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-1821" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.437em;"><span class="mn" id="MathJax-Span-1822" style="font-size: 70.7%; font-family: MathJax_Main;">0</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-1823"><span style="display: inline-block; position: relative; width: 0.872em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.44em, 4.346em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-1824" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.437em;"><span class="mn" id="MathJax-Span-1825" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="mo" id="MathJax-Span-1826" style="font-family: MathJax_Main;">)</span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span><span style="display: inline-block; width: 0px; height: 5.09em;"></span></span><span style="position: absolute; clip: rect(2.671em, 1007.63em, 7.199em, -999.997em); top: -5.146em; left: 17.249em;"><span style="display: inline-block; position: relative; width: 7.633em; height: 0px;"><span style="position: absolute; clip: rect(3.043em, 1005.96em, 4.408em, -999.997em); top: -5.518em; left: 50%; margin-left: -3.037em;"><span class="mtd" id="MathJax-Span-1716"><span class="mrow" id="MathJax-Span-1717"><span class="mn" id="MathJax-Span-1718" style="font-family: MathJax_Main;">2</span><span class="mo" id="MathJax-Span-1719" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-1720"><span style="display: inline-block; position: relative; width: 0.872em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.44em, 4.346em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-1721" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.437em;"><span class="mn" id="MathJax-Span-1722" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-1723"><span style="display: inline-block; position: relative; width: 0.872em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.44em, 4.346em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-1724" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.437em;"><span class="mn" id="MathJax-Span-1725" style="font-size: 70.7%; font-family: MathJax_Main;">3</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="mo" id="MathJax-Span-1726" style="font-family: MathJax_Main; padding-left: 0.251em;">+</span><span class="msubsup" id="MathJax-Span-1727" style="padding-left: 0.251em;"><span style="display: inline-block; position: relative; width: 0.872em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.44em, 4.346em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-1728" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.437em;"><span class="mn" id="MathJax-Span-1729" style="font-size: 70.7%; font-family: MathJax_Main;">0</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-1730"><span style="display: inline-block; position: relative; width: 0.872em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.44em, 4.346em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-1731" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.437em;"><span class="mn" id="MathJax-Span-1732" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="mo" id="MathJax-Span-1733" style="font-family: MathJax_Main;">)</span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.043em, 1005.96em, 4.408em, -999.997em); top: -3.967em; left: 50%; margin-left: -3.037em;"><span class="mtd" id="MathJax-Span-1773"><span class="mrow" id="MathJax-Span-1774"><span class="mn" id="MathJax-Span-1775" style="font-family: MathJax_Main;">2</span><span class="mo" id="MathJax-Span-1776" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-1777"><span style="display: inline-block; position: relative; width: 0.872em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.44em, 4.346em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-1778" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.437em;"><span class="mn" id="MathJax-Span-1779" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-1780"><span style="display: inline-block; position: relative; width: 0.872em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.44em, 4.346em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-1781" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.437em;"><span class="mn" id="MathJax-Span-1782" style="font-size: 70.7%; font-family: MathJax_Main;">3</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="mo" id="MathJax-Span-1783" style="font-family: MathJax_Main; padding-left: 0.251em;">−</span><span class="msubsup" id="MathJax-Span-1784" style="padding-left: 0.251em;"><span style="display: inline-block; position: relative; width: 0.872em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.44em, 4.346em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-1785" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.437em;"><span class="mn" id="MathJax-Span-1786" style="font-size: 70.7%; font-family: MathJax_Main;">0</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-1787"><span style="display: inline-block; position: relative; width: 0.872em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.44em, 4.346em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-1788" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.437em;"><span class="mn" id="MathJax-Span-1789" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="mo" id="MathJax-Span-1790" style="font-family: MathJax_Main;">)</span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(2.981em, 1007.63em, 4.47em, -999.997em); top: -2.416em; left: 50%; margin-left: -3.781em;"><span class="mtd" id="MathJax-Span-1827"><span class="mrow" id="MathJax-Span-1828"><span class="msubsup" id="MathJax-Span-1829"><span style="display: inline-block; position: relative; width: 0.934em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.44em, 4.346em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-1830" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.291em, 1000.44em, 4.159em, -999.997em); top: -4.339em; left: 0.499em;"><span class="mn" id="MathJax-Span-1831" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.291em, 1000.44em, 4.159em, -999.997em); top: -3.657em; left: 0.437em;"><span class="mn" id="MathJax-Span-1832" style="font-size: 70.7%; font-family: MathJax_Main;">0</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="mo" id="MathJax-Span-1833" style="font-family: MathJax_Main; padding-left: 0.251em;">−</span><span class="msubsup" id="MathJax-Span-1834" style="padding-left: 0.251em;"><span style="display: inline-block; position: relative; width: 0.934em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.44em, 4.346em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-1835" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.291em, 1000.44em, 4.159em, -999.997em); top: -4.339em; left: 0.499em;"><span class="mn" id="MathJax-Span-1836" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.291em, 1000.44em, 4.159em, -999.997em); top: -3.657em; left: 0.437em;"><span class="mn" id="MathJax-Span-1837" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="mo" id="MathJax-Span-1838" style="font-family: MathJax_Main; padding-left: 0.251em;">−</span><span class="msubsup" id="MathJax-Span-1839" style="padding-left: 0.251em;"><span style="display: inline-block; position: relative; width: 0.934em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.44em, 4.346em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-1840" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.291em, 1000.44em, 4.159em, -999.997em); top: -4.339em; left: 0.499em;"><span class="mn" id="MathJax-Span-1841" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.291em, 1000.44em, 4.159em, -999.997em); top: -3.657em; left: 0.437em;"><span class="mn" id="MathJax-Span-1842" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="mo" id="MathJax-Span-1843" style="font-family: MathJax_Main; padding-left: 0.251em;">+</span><span class="msubsup" id="MathJax-Span-1844" style="padding-left: 0.251em;"><span style="display: inline-block; position: relative; width: 0.934em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.44em, 4.346em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-1845" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.291em, 1000.44em, 4.159em, -999.997em); top: -4.339em; left: 0.499em;"><span class="mn" id="MathJax-Span-1846" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.291em, 1000.44em, 4.159em, -999.997em); top: -3.657em; left: 0.437em;"><span class="mn" id="MathJax-Span-1847" style="font-size: 70.7%; font-family: MathJax_Main;">3</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span><span style="display: inline-block; width: 0px; height: 5.152em;"></span></span></span></span><span class="mo" id="MathJax-Span-1848" style="vertical-align: 2.36em;"><span style="display: inline-block; position: relative; width: 0.685em; height: 0px;"><span style="position: absolute; font-family: MathJax_Size4; top: -2.788em; left: 0em;">⎤<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; font-family: MathJax_Size4; top: -0.369em; left: 0em;">⎦<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -1.734em; left: 0em;">⎥<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -1.362em; left: 0em;">⎥<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 5.214em;"></span></span><span style="position: absolute; top: -6.076em; left: 26.554em;"><span class="mi" id="MathJax-Span-1849" style="font-size: 70.7%; font-family: MathJax_Math-italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.065em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.36em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -2.381em; border-left: 0px solid; width: 0px; height: 5.619em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup><mi></mi><mi>b</mi></msup><msub><mi>R</mi><mi>w</mi></msub><mo>=</mo><msup><mrow class="MJX-TeXAtom-ORD"><msup><mi></mi><mi>b</mi></msup><msub><mi>R</mi><mi>w</mi></msub></mrow><mi>T</mi></msup><mo>=</mo><mi>R</mi><mo stretchy="false">(</mo><mi>q</mi><msup><mo stretchy="false">)</mo><mi>T</mi></msup><mo>=</mo><msup><mrow><mo>[</mo><mtable rowspacing="4pt" columnspacing="1em"><mtr><mtd><msubsup><mi>q</mi><mn>0</mn><mn>2</mn></msubsup><mo>+</mo><msubsup><mi>q</mi><mn>1</mn><mn>2</mn></msubsup><mo>−</mo><msubsup><mi>q</mi><mn>2</mn><mn>2</mn></msubsup><mo>−</mo><msubsup><mi>q</mi><mn>3</mn><mn>2</mn></msubsup></mtd><mtd><mn>2</mn><mo stretchy="false">(</mo><msub><mi>q</mi><mn>1</mn></msub><msub><mi>q</mi><mn>2</mn></msub><mo>−</mo><msub><mi>q</mi><mn>0</mn></msub><msub><mi>q</mi><mn>3</mn></msub><mo stretchy="false">)</mo></mtd><mtd><mn>2</mn><mo stretchy="false">(</mo><msub><mi>q</mi><mn>1</mn></msub><msub><mi>q</mi><mn>3</mn></msub><mo>+</mo><msub><mi>q</mi><mn>0</mn></msub><msub><mi>q</mi><mn>2</mn></msub><mo stretchy="false">)</mo></mtd></mtr><mtr><mtd><mn>2</mn><mo stretchy="false">(</mo><msub><mi>q</mi><mn>1</mn></msub><msub><mi>q</mi><mn>2</mn></msub><mo>+</mo><msub><mi>q</mi><mn>0</mn></msub><msub><mi>q</mi><mn>3</mn></msub><mo stretchy="false">)</mo></mtd><mtd><msubsup><mi>q</mi><mn>0</mn><mn>2</mn></msubsup><mo>−</mo><msubsup><mi>q</mi><mn>1</mn><mn>2</mn></msubsup><mo>+</mo><msubsup><mi>q</mi><mn>2</mn><mn>2</mn></msubsup><mo>−</mo><msubsup><mi>q</mi><mn>3</mn><mn>2</mn></msubsup></mtd><mtd><mn>2</mn><mo stretchy="false">(</mo><msub><mi>q</mi><mn>2</mn></msub><msub><mi>q</mi><mn>3</mn></msub><mo>−</mo><msub><mi>q</mi><mn>0</mn></msub><msub><mi>q</mi><mn>1</mn></msub><mo stretchy="false">)</mo></mtd></mtr><mtr><mtd><mn>2</mn><mo stretchy="false">(</mo><msub><mi>q</mi><mn>1</mn></msub><msub><mi>q</mi><mn>3</mn></msub><mo>−</mo><msub><mi>q</mi><mn>0</mn></msub><msub><mi>q</mi><mn>2</mn></msub><mo stretchy="false">)</mo></mtd><mtd><mn>2</mn><mo stretchy="false">(</mo><msub><mi>q</mi><mn>2</mn></msub><msub><mi>q</mi><mn>3</mn></msub><mo>+</mo><msub><mi>q</mi><mn>0</mn></msub><msub><mi>q</mi><mn>1</mn></msub><mo stretchy="false">)</mo></mtd><mtd><msubsup><mi>q</mi><mn>0</mn><mn>2</mn></msubsup><mo>−</mo><msubsup><mi>q</mi><mn>1</mn><mn>2</mn></msubsup><mo>−</mo><msubsup><mi>q</mi><mn>2</mn><mn>2</mn></msubsup><mo>+</mo><msubsup><mi>q</mi><mn>3</mn><mn>2</mn></msubsup></mtd></mtr></mtable><mo>]</mo></mrow><mi>T</mi></msup></math></span></span><script type="math/tex" id="MathJax-Element-30">^bR_w = {^bR_w}^T = R(q)^T = \begin{bmatrix} q_0^2+q_1^2-q_2^2-q_3^2 & 2(q_1q_2-q_0q_3) & 2(q_1q_3+q_0q_2) \\ 2(q_1q_2+q_0q_3) & q_0^2-q_1^2+q_2^2-q_3^2 & 2(q_2q_3-q_0q_1) \\ 2(q_1q_3-q_0q_2) & 2(q_2q_3+q_0q_1) & q_0^2-q_1^2-q_2^2+q_3^2 \end{bmatrix}^T</script></p>
<p><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-31-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msup&gt;&lt;mi&gt;&lt;/mi&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;/msup&gt;&lt;msub&gt;&lt;mi&gt;R&lt;/mi&gt;&lt;mi&gt;w&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mrow&gt;&lt;mo&gt;[&lt;/mo&gt;&lt;mtable rowspacing=&quot;4pt&quot; columnspacing=&quot;1em&quot;&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;msubsup&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msubsup&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;msubsup&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msubsup&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;msubsup&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msubsup&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;msubsup&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mn&gt;3&lt;/mn&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msubsup&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;msub&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msub&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/msub&gt;&lt;msub&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mn&gt;3&lt;/mn&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;msub&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mn&gt;3&lt;/mn&gt;&lt;/msub&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/msub&gt;&lt;msub&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;msub&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msub&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/msub&gt;&lt;msub&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mn&gt;3&lt;/mn&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;msubsup&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msubsup&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;msubsup&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msubsup&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;msubsup&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msubsup&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;msubsup&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mn&gt;3&lt;/mn&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msubsup&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msub&gt;&lt;msub&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mn&gt;3&lt;/mn&gt;&lt;/msub&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/msub&gt;&lt;msub&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;msub&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mn&gt;3&lt;/mn&gt;&lt;/msub&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/msub&gt;&lt;msub&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msub&gt;&lt;msub&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mn&gt;3&lt;/mn&gt;&lt;/msub&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/msub&gt;&lt;msub&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;msubsup&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msubsup&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;msubsup&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msubsup&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;msubsup&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msubsup&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;msubsup&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mn&gt;3&lt;/mn&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msubsup&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;/mtable&gt;&lt;mo&gt;]&lt;/mo&gt;&lt;/mrow&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1850" style="width: 36.728em; display: inline-block;"><span style="display: inline-block; position: relative; width: 29.594em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(2.174em, 1029.28em, 6.765em, -999.997em); top: -4.712em; left: 0em;"><span class="mrow" id="MathJax-Span-1851"><span class="msubsup" id="MathJax-Span-1852"><span style="display: inline-block; position: relative; width: 0.375em; height: 0px;"><span style="position: absolute; clip: rect(3.787em, 1000em, 4.159em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-1853"></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -4.339em; left: 0em;"><span class="mi" id="MathJax-Span-1854" style="font-size: 70.7%; font-family: MathJax_Math-italic;">b</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-1855"><span style="display: inline-block; position: relative; width: 1.368em; height: 0px;"><span style="position: absolute; clip: rect(3.105em, 1000.75em, 4.159em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-1856" style="font-family: MathJax_Math-italic;">R</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.748em;"><span class="mi" id="MathJax-Span-1857" style="font-size: 70.7%; font-family: MathJax_Math-italic;">w</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="mo" id="MathJax-Span-1858" style="font-family: MathJax_Main; padding-left: 0.251em;">=</span><span class="mrow" id="MathJax-Span-1859" style="padding-left: 0.251em;"><span class="mo" id="MathJax-Span-1860" style="vertical-align: 2.36em;"><span style="display: inline-block; position: relative; width: 0.685em; height: 0px;"><span style="position: absolute; font-family: MathJax_Size4; top: -2.788em; left: 0em;">⎡<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; font-family: MathJax_Size4; top: -0.369em; left: 0em;">⎣<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -1.734em; left: 0em;">⎢<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -1.362em; left: 0em;">⎢<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="mtable" id="MathJax-Span-1861" style="padding-right: 0.189em; padding-left: 0.189em;"><span style="display: inline-block; position: relative; width: 24.817em; height: 0px;"><span style="position: absolute; clip: rect(2.609em, 1007.63em, 7.137em, -999.997em); top: -5.146em; left: 0em;"><span style="display: inline-block; position: relative; width: 7.633em; height: 0px;"><span style="position: absolute; clip: rect(2.981em, 1007.63em, 4.47em, -999.997em); top: -5.518em; left: 50%; margin-left: -3.781em;"><span class="mtd" id="MathJax-Span-1862"><span class="mrow" id="MathJax-Span-1863"><span class="msubsup" id="MathJax-Span-1864"><span style="display: inline-block; position: relative; width: 0.934em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.44em, 4.346em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-1865" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.291em, 1000.44em, 4.159em, -999.997em); top: -4.339em; left: 0.499em;"><span class="mn" id="MathJax-Span-1866" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.291em, 1000.44em, 4.159em, -999.997em); top: -3.657em; left: 0.437em;"><span class="mn" id="MathJax-Span-1867" style="font-size: 70.7%; font-family: MathJax_Main;">0</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="mo" id="MathJax-Span-1868" style="font-family: MathJax_Main; padding-left: 0.251em;">+</span><span class="msubsup" id="MathJax-Span-1869" style="padding-left: 0.251em;"><span style="display: inline-block; position: relative; width: 0.934em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.44em, 4.346em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-1870" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.291em, 1000.44em, 4.159em, -999.997em); top: -4.339em; left: 0.499em;"><span class="mn" id="MathJax-Span-1871" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.291em, 1000.44em, 4.159em, -999.997em); top: -3.657em; left: 0.437em;"><span class="mn" id="MathJax-Span-1872" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="mo" id="MathJax-Span-1873" style="font-family: MathJax_Main; padding-left: 0.251em;">−</span><span class="msubsup" id="MathJax-Span-1874" style="padding-left: 0.251em;"><span style="display: inline-block; position: relative; width: 0.934em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.44em, 4.346em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-1875" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.291em, 1000.44em, 4.159em, -999.997em); top: -4.339em; left: 0.499em;"><span class="mn" id="MathJax-Span-1876" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.291em, 1000.44em, 4.159em, -999.997em); top: -3.657em; left: 0.437em;"><span class="mn" id="MathJax-Span-1877" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="mo" id="MathJax-Span-1878" style="font-family: MathJax_Main; padding-left: 0.251em;">−</span><span class="msubsup" id="MathJax-Span-1879" style="padding-left: 0.251em;"><span style="display: inline-block; position: relative; width: 0.934em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.44em, 4.346em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-1880" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.291em, 1000.44em, 4.159em, -999.997em); top: -4.339em; left: 0.499em;"><span class="mn" id="MathJax-Span-1881" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.291em, 1000.44em, 4.159em, -999.997em); top: -3.657em; left: 0.437em;"><span class="mn" id="MathJax-Span-1882" style="font-size: 70.7%; font-family: MathJax_Main;">3</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.043em, 1005.96em, 4.408em, -999.997em); top: -3.967em; left: 50%; margin-left: -3.037em;"><span class="mtd" id="MathJax-Span-1919"><span class="mrow" id="MathJax-Span-1920"><span class="mn" id="MathJax-Span-1921" style="font-family: MathJax_Main;">2</span><span class="mo" id="MathJax-Span-1922" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-1923"><span style="display: inline-block; position: relative; width: 0.872em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.44em, 4.346em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-1924" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.437em;"><span class="mn" id="MathJax-Span-1925" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-1926"><span style="display: inline-block; position: relative; width: 0.872em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.44em, 4.346em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-1927" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.437em;"><span class="mn" id="MathJax-Span-1928" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="mo" id="MathJax-Span-1929" style="font-family: MathJax_Main; padding-left: 0.251em;">−</span><span class="msubsup" id="MathJax-Span-1930" style="padding-left: 0.251em;"><span style="display: inline-block; position: relative; width: 0.872em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.44em, 4.346em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-1931" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.437em;"><span class="mn" id="MathJax-Span-1932" style="font-size: 70.7%; font-family: MathJax_Main;">0</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-1933"><span style="display: inline-block; position: relative; width: 0.872em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.44em, 4.346em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-1934" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.437em;"><span class="mn" id="MathJax-Span-1935" style="font-size: 70.7%; font-family: MathJax_Main;">3</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="mo" id="MathJax-Span-1936" style="font-family: MathJax_Main;">)</span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.043em, 1005.96em, 4.408em, -999.997em); top: -2.416em; left: 50%; margin-left: -3.037em;"><span class="mtd" id="MathJax-Span-1976"><span class="mrow" id="MathJax-Span-1977"><span class="mn" id="MathJax-Span-1978" style="font-family: MathJax_Main;">2</span><span class="mo" id="MathJax-Span-1979" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-1980"><span style="display: inline-block; position: relative; width: 0.872em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.44em, 4.346em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-1981" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.437em;"><span class="mn" id="MathJax-Span-1982" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-1983"><span style="display: inline-block; position: relative; width: 0.872em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.44em, 4.346em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-1984" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.437em;"><span class="mn" id="MathJax-Span-1985" style="font-size: 70.7%; font-family: MathJax_Main;">3</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="mo" id="MathJax-Span-1986" style="font-family: MathJax_Main; padding-left: 0.251em;">+</span><span class="msubsup" id="MathJax-Span-1987" style="padding-left: 0.251em;"><span style="display: inline-block; position: relative; width: 0.872em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.44em, 4.346em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-1988" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.437em;"><span class="mn" id="MathJax-Span-1989" style="font-size: 70.7%; font-family: MathJax_Main;">0</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-1990"><span style="display: inline-block; position: relative; width: 0.872em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.44em, 4.346em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-1991" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.437em;"><span class="mn" id="MathJax-Span-1992" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="mo" id="MathJax-Span-1993" style="font-family: MathJax_Main;">)</span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span><span style="display: inline-block; width: 0px; height: 5.152em;"></span></span><span style="position: absolute; clip: rect(2.609em, 1007.63em, 7.075em, -999.997em); top: -5.084em; left: 8.626em;"><span style="display: inline-block; position: relative; width: 7.633em; height: 0px;"><span style="position: absolute; clip: rect(3.043em, 1005.96em, 4.408em, -999.997em); top: -5.518em; left: 50%; margin-left: -3.037em;"><span class="mtd" id="MathJax-Span-1883"><span class="mrow" id="MathJax-Span-1884"><span class="mn" id="MathJax-Span-1885" style="font-family: MathJax_Main;">2</span><span class="mo" id="MathJax-Span-1886" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-1887"><span style="display: inline-block; position: relative; width: 0.872em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.44em, 4.346em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-1888" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.437em;"><span class="mn" id="MathJax-Span-1889" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-1890"><span style="display: inline-block; position: relative; width: 0.872em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.44em, 4.346em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-1891" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.437em;"><span class="mn" id="MathJax-Span-1892" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="mo" id="MathJax-Span-1893" style="font-family: MathJax_Main; padding-left: 0.251em;">+</span><span class="msubsup" id="MathJax-Span-1894" style="padding-left: 0.251em;"><span style="display: inline-block; position: relative; width: 0.872em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.44em, 4.346em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-1895" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.437em;"><span class="mn" id="MathJax-Span-1896" style="font-size: 70.7%; font-family: MathJax_Main;">0</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-1897"><span style="display: inline-block; position: relative; width: 0.872em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.44em, 4.346em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-1898" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.437em;"><span class="mn" id="MathJax-Span-1899" style="font-size: 70.7%; font-family: MathJax_Main;">3</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="mo" id="MathJax-Span-1900" style="font-family: MathJax_Main;">)</span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(2.981em, 1007.63em, 4.47em, -999.997em); top: -3.967em; left: 50%; margin-left: -3.781em;"><span class="mtd" id="MathJax-Span-1937"><span class="mrow" id="MathJax-Span-1938"><span class="msubsup" id="MathJax-Span-1939"><span style="display: inline-block; position: relative; width: 0.934em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.44em, 4.346em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-1940" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.291em, 1000.44em, 4.159em, -999.997em); top: -4.339em; left: 0.499em;"><span class="mn" id="MathJax-Span-1941" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.291em, 1000.44em, 4.159em, -999.997em); top: -3.657em; left: 0.437em;"><span class="mn" id="MathJax-Span-1942" style="font-size: 70.7%; font-family: MathJax_Main;">0</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="mo" id="MathJax-Span-1943" style="font-family: MathJax_Main; padding-left: 0.251em;">−</span><span class="msubsup" id="MathJax-Span-1944" style="padding-left: 0.251em;"><span style="display: inline-block; position: relative; width: 0.934em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.44em, 4.346em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-1945" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.291em, 1000.44em, 4.159em, -999.997em); top: -4.339em; left: 0.499em;"><span class="mn" id="MathJax-Span-1946" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.291em, 1000.44em, 4.159em, -999.997em); top: -3.657em; left: 0.437em;"><span class="mn" id="MathJax-Span-1947" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="mo" id="MathJax-Span-1948" style="font-family: MathJax_Main; padding-left: 0.251em;">+</span><span class="msubsup" id="MathJax-Span-1949" style="padding-left: 0.251em;"><span style="display: inline-block; position: relative; width: 0.934em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.44em, 4.346em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-1950" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.291em, 1000.44em, 4.159em, -999.997em); top: -4.339em; left: 0.499em;"><span class="mn" id="MathJax-Span-1951" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.291em, 1000.44em, 4.159em, -999.997em); top: -3.657em; left: 0.437em;"><span class="mn" id="MathJax-Span-1952" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="mo" id="MathJax-Span-1953" style="font-family: MathJax_Main; padding-left: 0.251em;">−</span><span class="msubsup" id="MathJax-Span-1954" style="padding-left: 0.251em;"><span style="display: inline-block; position: relative; width: 0.934em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.44em, 4.346em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-1955" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.291em, 1000.44em, 4.159em, -999.997em); top: -4.339em; left: 0.499em;"><span class="mn" id="MathJax-Span-1956" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.291em, 1000.44em, 4.159em, -999.997em); top: -3.657em; left: 0.437em;"><span class="mn" id="MathJax-Span-1957" style="font-size: 70.7%; font-family: MathJax_Main;">3</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.043em, 1005.96em, 4.408em, -999.997em); top: -2.416em; left: 50%; margin-left: -3.037em;"><span class="mtd" id="MathJax-Span-1994"><span class="mrow" id="MathJax-Span-1995"><span class="mn" id="MathJax-Span-1996" style="font-family: MathJax_Main;">2</span><span class="mo" id="MathJax-Span-1997" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-1998"><span style="display: inline-block; position: relative; width: 0.872em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.44em, 4.346em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-1999" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.437em;"><span class="mn" id="MathJax-Span-2000" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-2001"><span style="display: inline-block; position: relative; width: 0.872em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.44em, 4.346em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-2002" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.437em;"><span class="mn" id="MathJax-Span-2003" style="font-size: 70.7%; font-family: MathJax_Main;">3</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="mo" id="MathJax-Span-2004" style="font-family: MathJax_Main; padding-left: 0.251em;">−</span><span class="msubsup" id="MathJax-Span-2005" style="padding-left: 0.251em;"><span style="display: inline-block; position: relative; width: 0.872em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.44em, 4.346em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-2006" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.437em;"><span class="mn" id="MathJax-Span-2007" style="font-size: 70.7%; font-family: MathJax_Main;">0</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-2008"><span style="display: inline-block; position: relative; width: 0.872em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.44em, 4.346em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-2009" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.437em;"><span class="mn" id="MathJax-Span-2010" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="mo" id="MathJax-Span-2011" style="font-family: MathJax_Main;">)</span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span><span style="display: inline-block; width: 0px; height: 5.09em;"></span></span><span style="position: absolute; clip: rect(2.671em, 1007.63em, 7.199em, -999.997em); top: -5.146em; left: 17.249em;"><span style="display: inline-block; position: relative; width: 7.633em; height: 0px;"><span style="position: absolute; clip: rect(3.043em, 1005.96em, 4.408em, -999.997em); top: -5.518em; left: 50%; margin-left: -3.037em;"><span class="mtd" id="MathJax-Span-1901"><span class="mrow" id="MathJax-Span-1902"><span class="mn" id="MathJax-Span-1903" style="font-family: MathJax_Main;">2</span><span class="mo" id="MathJax-Span-1904" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-1905"><span style="display: inline-block; position: relative; width: 0.872em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.44em, 4.346em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-1906" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.437em;"><span class="mn" id="MathJax-Span-1907" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-1908"><span style="display: inline-block; position: relative; width: 0.872em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.44em, 4.346em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-1909" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.437em;"><span class="mn" id="MathJax-Span-1910" style="font-size: 70.7%; font-family: MathJax_Main;">3</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="mo" id="MathJax-Span-1911" style="font-family: MathJax_Main; padding-left: 0.251em;">−</span><span class="msubsup" id="MathJax-Span-1912" style="padding-left: 0.251em;"><span style="display: inline-block; position: relative; width: 0.872em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.44em, 4.346em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-1913" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.437em;"><span class="mn" id="MathJax-Span-1914" style="font-size: 70.7%; font-family: MathJax_Main;">0</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-1915"><span style="display: inline-block; position: relative; width: 0.872em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.44em, 4.346em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-1916" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.437em;"><span class="mn" id="MathJax-Span-1917" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="mo" id="MathJax-Span-1918" style="font-family: MathJax_Main;">)</span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.043em, 1005.96em, 4.408em, -999.997em); top: -3.967em; left: 50%; margin-left: -3.037em;"><span class="mtd" id="MathJax-Span-1958"><span class="mrow" id="MathJax-Span-1959"><span class="mn" id="MathJax-Span-1960" style="font-family: MathJax_Main;">2</span><span class="mo" id="MathJax-Span-1961" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-1962"><span style="display: inline-block; position: relative; width: 0.872em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.44em, 4.346em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-1963" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.437em;"><span class="mn" id="MathJax-Span-1964" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-1965"><span style="display: inline-block; position: relative; width: 0.872em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.44em, 4.346em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-1966" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.437em;"><span class="mn" id="MathJax-Span-1967" style="font-size: 70.7%; font-family: MathJax_Main;">3</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="mo" id="MathJax-Span-1968" style="font-family: MathJax_Main; padding-left: 0.251em;">+</span><span class="msubsup" id="MathJax-Span-1969" style="padding-left: 0.251em;"><span style="display: inline-block; position: relative; width: 0.872em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.44em, 4.346em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-1970" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.437em;"><span class="mn" id="MathJax-Span-1971" style="font-size: 70.7%; font-family: MathJax_Main;">0</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-1972"><span style="display: inline-block; position: relative; width: 0.872em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.44em, 4.346em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-1973" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.437em;"><span class="mn" id="MathJax-Span-1974" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="mo" id="MathJax-Span-1975" style="font-family: MathJax_Main;">)</span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(2.981em, 1007.63em, 4.47em, -999.997em); top: -2.416em; left: 50%; margin-left: -3.781em;"><span class="mtd" id="MathJax-Span-2012"><span class="mrow" id="MathJax-Span-2013"><span class="msubsup" id="MathJax-Span-2014"><span style="display: inline-block; position: relative; width: 0.934em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.44em, 4.346em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-2015" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.291em, 1000.44em, 4.159em, -999.997em); top: -4.339em; left: 0.499em;"><span class="mn" id="MathJax-Span-2016" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.291em, 1000.44em, 4.159em, -999.997em); top: -3.657em; left: 0.437em;"><span class="mn" id="MathJax-Span-2017" style="font-size: 70.7%; font-family: MathJax_Main;">0</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="mo" id="MathJax-Span-2018" style="font-family: MathJax_Main; padding-left: 0.251em;">−</span><span class="msubsup" id="MathJax-Span-2019" style="padding-left: 0.251em;"><span style="display: inline-block; position: relative; width: 0.934em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.44em, 4.346em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-2020" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.291em, 1000.44em, 4.159em, -999.997em); top: -4.339em; left: 0.499em;"><span class="mn" id="MathJax-Span-2021" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.291em, 1000.44em, 4.159em, -999.997em); top: -3.657em; left: 0.437em;"><span class="mn" id="MathJax-Span-2022" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="mo" id="MathJax-Span-2023" style="font-family: MathJax_Main; padding-left: 0.251em;">−</span><span class="msubsup" id="MathJax-Span-2024" style="padding-left: 0.251em;"><span style="display: inline-block; position: relative; width: 0.934em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.44em, 4.346em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-2025" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.291em, 1000.44em, 4.159em, -999.997em); top: -4.339em; left: 0.499em;"><span class="mn" id="MathJax-Span-2026" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.291em, 1000.44em, 4.159em, -999.997em); top: -3.657em; left: 0.437em;"><span class="mn" id="MathJax-Span-2027" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="mo" id="MathJax-Span-2028" style="font-family: MathJax_Main; padding-left: 0.251em;">+</span><span class="msubsup" id="MathJax-Span-2029" style="padding-left: 0.251em;"><span style="display: inline-block; position: relative; width: 0.934em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.44em, 4.346em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-2030" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.291em, 1000.44em, 4.159em, -999.997em); top: -4.339em; left: 0.499em;"><span class="mn" id="MathJax-Span-2031" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.291em, 1000.44em, 4.159em, -999.997em); top: -3.657em; left: 0.437em;"><span class="mn" id="MathJax-Span-2032" style="font-size: 70.7%; font-family: MathJax_Main;">3</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span><span style="display: inline-block; width: 0px; height: 5.152em;"></span></span></span></span><span class="mo" id="MathJax-Span-2033" style="vertical-align: 2.36em;"><span style="display: inline-block; position: relative; width: 0.685em; height: 0px;"><span style="position: absolute; font-family: MathJax_Size4; top: -2.788em; left: 0em;">⎤<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; font-family: MathJax_Size4; top: -0.369em; left: 0em;">⎦<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -1.734em; left: 0em;">⎥<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -1.362em; left: 0em;">⎥<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.718em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -2.381em; border-left: 0px solid; width: 0px; height: 5.388em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup><mi></mi><mi>b</mi></msup><msub><mi>R</mi><mi>w</mi></msub><mo>=</mo><mrow><mo>[</mo><mtable rowspacing="4pt" columnspacing="1em"><mtr><mtd><msubsup><mi>q</mi><mn>0</mn><mn>2</mn></msubsup><mo>+</mo><msubsup><mi>q</mi><mn>1</mn><mn>2</mn></msubsup><mo>−</mo><msubsup><mi>q</mi><mn>2</mn><mn>2</mn></msubsup><mo>−</mo><msubsup><mi>q</mi><mn>3</mn><mn>2</mn></msubsup></mtd><mtd><mn>2</mn><mo stretchy="false">(</mo><msub><mi>q</mi><mn>1</mn></msub><msub><mi>q</mi><mn>2</mn></msub><mo>+</mo><msub><mi>q</mi><mn>0</mn></msub><msub><mi>q</mi><mn>3</mn></msub><mo stretchy="false">)</mo></mtd><mtd><mn>2</mn><mo stretchy="false">(</mo><msub><mi>q</mi><mn>1</mn></msub><msub><mi>q</mi><mn>3</mn></msub><mo>−</mo><msub><mi>q</mi><mn>0</mn></msub><msub><mi>q</mi><mn>2</mn></msub><mo stretchy="false">)</mo></mtd></mtr><mtr><mtd><mn>2</mn><mo stretchy="false">(</mo><msub><mi>q</mi><mn>1</mn></msub><msub><mi>q</mi><mn>2</mn></msub><mo>−</mo><msub><mi>q</mi><mn>0</mn></msub><msub><mi>q</mi><mn>3</mn></msub><mo stretchy="false">)</mo></mtd><mtd><msubsup><mi>q</mi><mn>0</mn><mn>2</mn></msubsup><mo>−</mo><msubsup><mi>q</mi><mn>1</mn><mn>2</mn></msubsup><mo>+</mo><msubsup><mi>q</mi><mn>2</mn><mn>2</mn></msubsup><mo>−</mo><msubsup><mi>q</mi><mn>3</mn><mn>2</mn></msubsup></mtd><mtd><mn>2</mn><mo stretchy="false">(</mo><msub><mi>q</mi><mn>2</mn></msub><msub><mi>q</mi><mn>3</mn></msub><mo>+</mo><msub><mi>q</mi><mn>0</mn></msub><msub><mi>q</mi><mn>1</mn></msub><mo stretchy="false">)</mo></mtd></mtr><mtr><mtd><mn>2</mn><mo stretchy="false">(</mo><msub><mi>q</mi><mn>1</mn></msub><msub><mi>q</mi><mn>3</mn></msub><mo>+</mo><msub><mi>q</mi><mn>0</mn></msub><msub><mi>q</mi><mn>2</mn></msub><mo stretchy="false">)</mo></mtd><mtd><mn>2</mn><mo stretchy="false">(</mo><msub><mi>q</mi><mn>2</mn></msub><msub><mi>q</mi><mn>3</mn></msub><mo>−</mo><msub><mi>q</mi><mn>0</mn></msub><msub><mi>q</mi><mn>1</mn></msub><mo stretchy="false">)</mo></mtd><mtd><msubsup><mi>q</mi><mn>0</mn><mn>2</mn></msubsup><mo>−</mo><msubsup><mi>q</mi><mn>1</mn><mn>2</mn></msubsup><mo>−</mo><msubsup><mi>q</mi><mn>2</mn><mn>2</mn></msubsup><mo>+</mo><msubsup><mi>q</mi><mn>3</mn><mn>2</mn></msubsup></mtd></mtr></mtable><mo>]</mo></mrow></math></span></span><script type="math/tex" id="MathJax-Element-31">^bR_w = \begin{bmatrix} q_0^2+q_1^2-q_2^2-q_3^2 & 2(q_1q_2+q_0q_3) & 2(q_1q_3-q_0q_2) \\ 2(q_1q_2-q_0q_3) & q_0^2-q_1^2+q_2^2-q_3^2 & 2(q_2q_3+q_0q_1) \\ 2(q_1q_3+q_0q_2) & 2(q_2q_3-q_0q_1) & q_0^2-q_1^2-q_2^2+q_3^2 \end{bmatrix}</script>&nbsp; &nbsp; &nbsp;——————–&nbsp; &nbsp; &nbsp;(9)</p>
<p>Since we know that&nbsp;<span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-32-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;g&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;msup&gt;&lt;mrow&gt;&lt;mo&gt;[&lt;/mo&gt;&lt;mtable rowspacing=&quot;4pt&quot; columnspacing=&quot;1em&quot;&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;/mtable&gt;&lt;mo&gt;]&lt;/mo&gt;&lt;/mrow&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;/msup&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2034" style="width: 8.378em; display: inline-block;"><span style="display: inline-block; position: relative; width: 6.765em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(1.244em, 1006.76em, 2.795em, -999.997em); top: -2.354em; left: 0em;"><span class="mrow" id="MathJax-Span-2035"><span class="mi" id="MathJax-Span-2036" style="font-family: MathJax_Math-italic;">g<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-2037" style="font-family: MathJax_Main; padding-left: 0.251em;">=</span><span class="msubsup" id="MathJax-Span-2038" style="padding-left: 0.251em;"><span style="display: inline-block; position: relative; width: 5.028em; height: 0px;"><span style="position: absolute; clip: rect(3.043em, 1004.35em, 4.408em, -999.997em); top: -3.967em; left: 0em;"><span class="mrow" id="MathJax-Span-2039"><span class="mo" id="MathJax-Span-2040" style="font-family: MathJax_Main;">[</span><span class="mtable" id="MathJax-Span-2041" style="padding-right: 0.189em; padding-left: 0.189em;"><span style="display: inline-block; position: relative; width: 3.477em; height: 0px;"><span style="position: absolute; clip: rect(3.167em, 1000.44em, 4.221em, -999.997em); top: -3.967em; left: 0em;"><span style="display: inline-block; position: relative; width: 0.499em; height: 0px;"><span style="position: absolute; clip: rect(3.105em, 1000.44em, 4.159em, -999.997em); top: -3.905em; left: 50%; margin-left: -0.245em;"><span class="mtd" id="MathJax-Span-2042"><span class="mrow" id="MathJax-Span-2043"><span class="mn" id="MathJax-Span-2044" style="font-family: MathJax_Main;">0</span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.167em, 1000.44em, 4.221em, -999.997em); top: -3.967em; left: 1.492em;"><span style="display: inline-block; position: relative; width: 0.499em; height: 0px;"><span style="position: absolute; clip: rect(3.105em, 1000.44em, 4.159em, -999.997em); top: -3.905em; left: 50%; margin-left: -0.245em;"><span class="mtd" id="MathJax-Span-2045"><span class="mrow" id="MathJax-Span-2046"><span class="mn" id="MathJax-Span-2047" style="font-family: MathJax_Main;">0</span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.167em, 1000.44em, 4.221em, -999.997em); top: -3.967em; left: 2.981em;"><span style="display: inline-block; position: relative; width: 0.499em; height: 0px;"><span style="position: absolute; clip: rect(3.105em, 1000.44em, 4.159em, -999.997em); top: -3.905em; left: 50%; margin-left: -0.245em;"><span class="mtd" id="MathJax-Span-2048"><span class="mrow" id="MathJax-Span-2049"><span class="mn" id="MathJax-Span-2050" style="font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="mo" id="MathJax-Span-2051" style="font-family: MathJax_Main;">]</span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -4.463em; left: 4.408em;"><span class="mi" id="MathJax-Span-2052" style="font-size: 70.7%; font-family: MathJax_Math-italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.065em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.36em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.381em; border-left: 0px solid; width: 0px; height: 1.619em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>g</mi><mo>=</mo><msup><mrow><mo>[</mo><mtable rowspacing="4pt" columnspacing="1em"><mtr><mtd><mn>0</mn></mtd><mtd><mn>0</mn></mtd><mtd><mn>1</mn></mtd></mtr></mtable><mo>]</mo></mrow><mi>T</mi></msup></math></span></span><script type="math/tex" id="MathJax-Element-32">g = \begin{bmatrix} 0 & 0 & 1 \end{bmatrix}^T</script>, we can substitute equation (9) into equation (8) and then simplify equation (8) to get the following equation.</p>
<p><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-33-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mrow&gt;&lt;mo&gt;[&lt;/mo&gt;&lt;mtable rowspacing=&quot;4pt&quot; columnspacing=&quot;1em&quot;&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;msup&gt;&lt;mi&gt;&lt;/mi&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;/msup&gt;&lt;msub&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;msup&gt;&lt;mi&gt;&lt;/mi&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;/msup&gt;&lt;msub&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;msup&gt;&lt;mi&gt;&lt;/mi&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;/msup&gt;&lt;msub&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;/mtable&gt;&lt;mo&gt;]&lt;/mo&gt;&lt;/mrow&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mrow&gt;&lt;mo&gt;[&lt;/mo&gt;&lt;mtable rowspacing=&quot;4pt&quot; columnspacing=&quot;1em&quot;&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;msub&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mn&gt;3&lt;/mn&gt;&lt;/msub&gt;&lt;mo&gt;&amp;#x2013;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/msub&gt;&lt;msub&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msub&gt;&lt;msub&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mn&gt;3&lt;/mn&gt;&lt;/msub&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/msub&gt;&lt;msub&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;msubsup&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msubsup&gt;&lt;mo&gt;&amp;#x2013;&lt;/mo&gt;&lt;msubsup&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msubsup&gt;&lt;mo&gt;&amp;#x2013;&lt;/mo&gt;&lt;msubsup&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msubsup&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;msubsup&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mn&gt;3&lt;/mn&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msubsup&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;/mtable&gt;&lt;mo&gt;]&lt;/mo&gt;&lt;/mrow&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mrow&gt;&lt;mo&gt;[&lt;/mo&gt;&lt;mtable rowspacing=&quot;4pt&quot; columnspacing=&quot;1em&quot;&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;msup&gt;&lt;mi&gt;&lt;/mi&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;/msup&gt;&lt;msub&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;msup&gt;&lt;mi&gt;&lt;/mi&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;/msup&gt;&lt;msub&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;msup&gt;&lt;mi&gt;&lt;/mi&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;/msup&gt;&lt;msub&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;/mtable&gt;&lt;mo&gt;]&lt;/mo&gt;&lt;/mrow&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mrow&gt;&lt;mo&gt;[&lt;/mo&gt;&lt;mtable rowspacing=&quot;4pt&quot; columnspacing=&quot;1em&quot;&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;msup&gt;&lt;mi&gt;&lt;/mi&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;/msup&gt;&lt;msub&gt;&lt;mi&gt;e&lt;/mi&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;msup&gt;&lt;mi&gt;&lt;/mi&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;/msup&gt;&lt;msub&gt;&lt;mi&gt;e&lt;/mi&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;msup&gt;&lt;mi&gt;&lt;/mi&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;/msup&gt;&lt;msub&gt;&lt;mi&gt;e&lt;/mi&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;/mtable&gt;&lt;mo&gt;]&lt;/mo&gt;&lt;/mrow&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2053" style="width: 27.609em; display: inline-block;"><span style="display: inline-block; position: relative; width: 22.274em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(2.174em, 1021.96em, 6.641em, -999.997em); top: -4.65em; left: 0em;"><span class="mrow" id="MathJax-Span-2054"><span class="mrow" id="MathJax-Span-2055"><span class="mo" id="MathJax-Span-2056" style="vertical-align: 2.298em;"><span style="display: inline-block; position: relative; width: 0.685em; height: 0px;"><span style="position: absolute; font-family: MathJax_Size4; top: -2.788em; left: 0em;">⎡<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; font-family: MathJax_Size4; top: -0.555em; left: 0em;">⎣<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -1.61em; left: 0em;">⎢<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="mtable" id="MathJax-Span-2057" style="padding-right: 0.189em; padding-left: 0.189em;"><span style="display: inline-block; position: relative; width: 1.368em; height: 0px;"><span style="position: absolute; clip: rect(2.547em, 1001.37em, 6.951em, -999.997em); top: -5.022em; left: 0em;"><span style="display: inline-block; position: relative; width: 1.368em; height: 0px;"><span style="position: absolute; clip: rect(2.919em, 1001.37em, 4.346em, -999.997em); top: -5.394em; left: 50%; margin-left: -0.679em;"><span class="mtd" id="MathJax-Span-2058"><span class="mrow" id="MathJax-Span-2059"><span class="msubsup" id="MathJax-Span-2060"><span style="display: inline-block; position: relative; width: 0.375em; height: 0px;"><span style="position: absolute; clip: rect(3.787em, 1000em, 4.159em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-2061"></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -4.339em; left: 0em;"><span class="mi" id="MathJax-Span-2062" style="font-size: 70.7%; font-family: MathJax_Math-italic;">b</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-2063"><span style="display: inline-block; position: relative; width: 0.996em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.5em, 4.159em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-2064" style="font-family: MathJax_Math-italic;">a</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.561em;"><span class="mi" id="MathJax-Span-2065" style="font-size: 70.7%; font-family: MathJax_Math-italic;">x</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(2.919em, 1001.31em, 4.47em, -999.997em); top: -3.967em; left: 50%; margin-left: -0.679em;"><span class="mtd" id="MathJax-Span-2066"><span class="mrow" id="MathJax-Span-2067"><span class="msubsup" id="MathJax-Span-2068"><span style="display: inline-block; position: relative; width: 0.375em; height: 0px;"><span style="position: absolute; clip: rect(3.787em, 1000em, 4.159em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-2069"></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -4.339em; left: 0em;"><span class="mi" id="MathJax-Span-2070" style="font-size: 70.7%; font-family: MathJax_Math-italic;">b</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-2071"><span style="display: inline-block; position: relative; width: 0.934em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.5em, 4.159em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-2072" style="font-family: MathJax_Math-italic;">a</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.561em;"><span class="mi" id="MathJax-Span-2073" style="font-size: 70.7%; font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(2.919em, 1001.31em, 4.346em, -999.997em); top: -2.416em; left: 50%; margin-left: -0.679em;"><span class="mtd" id="MathJax-Span-2074"><span class="mrow" id="MathJax-Span-2075"><span class="msubsup" id="MathJax-Span-2076"><span style="display: inline-block; position: relative; width: 0.375em; height: 0px;"><span style="position: absolute; clip: rect(3.787em, 1000em, 4.159em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-2077"></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -4.339em; left: 0em;"><span class="mi" id="MathJax-Span-2078" style="font-size: 70.7%; font-family: MathJax_Math-italic;">b</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-2079"><span style="display: inline-block; position: relative; width: 0.934em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.5em, 4.159em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-2080" style="font-family: MathJax_Math-italic;">a</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.561em;"><span class="mi" id="MathJax-Span-2081" style="font-size: 70.7%; font-family: MathJax_Math-italic;">z<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span><span style="display: inline-block; width: 0px; height: 5.028em;"></span></span></span></span><span class="mo" id="MathJax-Span-2082" style="vertical-align: 2.298em;"><span style="display: inline-block; position: relative; width: 0.685em; height: 0px;"><span style="position: absolute; font-family: MathJax_Size4; top: -2.788em; left: 0em;">⎤<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; font-family: MathJax_Size4; top: -0.555em; left: 0em;">⎦<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -1.61em; left: 0em;">⎥<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span><span class="mo" id="MathJax-Span-2083" style="font-family: MathJax_Main; padding-left: 0.251em;">=</span><span class="mo" id="MathJax-Span-2084" style="font-family: MathJax_Main; padding-left: 0.251em;">−</span><span class="mrow" id="MathJax-Span-2085" style="padding-left: 0.189em;"><span class="mo" id="MathJax-Span-2086" style="vertical-align: 2.298em;"><span style="display: inline-block; position: relative; width: 0.685em; height: 0px;"><span style="position: absolute; font-family: MathJax_Size4; top: -2.788em; left: 0em;">⎡<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; font-family: MathJax_Size4; top: -0.555em; left: 0em;">⎣<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -1.672em; left: 0em;">⎢<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="mtable" id="MathJax-Span-2087" style="padding-right: 0.189em; padding-left: 0.189em;"><span style="display: inline-block; position: relative; width: 6.455em; height: 0px;"><span style="position: absolute; clip: rect(2.547em, 1006.46em, 6.951em, -999.997em); top: -4.96em; left: 0em;"><span style="display: inline-block; position: relative; width: 6.455em; height: 0px;"><span style="position: absolute; clip: rect(3.043em, 1005.4em, 4.408em, -999.997em); top: -5.456em; left: 50%; margin-left: -2.726em;"><span class="mtd" id="MathJax-Span-2088"><span class="mrow" id="MathJax-Span-2089"><span class="mn" id="MathJax-Span-2090" style="font-family: MathJax_Main;">2</span><span class="mo" id="MathJax-Span-2091" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-2092"><span style="display: inline-block; position: relative; width: 0.872em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.44em, 4.346em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-2093" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.437em;"><span class="mn" id="MathJax-Span-2094" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-2095"><span style="display: inline-block; position: relative; width: 0.872em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.44em, 4.346em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-2096" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.437em;"><span class="mn" id="MathJax-Span-2097" style="font-size: 70.7%; font-family: MathJax_Main;">3</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="mo" id="MathJax-Span-2098" style="font-family: MathJax_Main;">–</span><span class="msubsup" id="MathJax-Span-2099" style="padding-left: 0.189em;"><span style="display: inline-block; position: relative; width: 0.872em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.44em, 4.346em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-2100" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.437em;"><span class="mn" id="MathJax-Span-2101" style="font-size: 70.7%; font-family: MathJax_Main;">0</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-2102"><span style="display: inline-block; position: relative; width: 0.872em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.44em, 4.346em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-2103" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.437em;"><span class="mn" id="MathJax-Span-2104" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="mo" id="MathJax-Span-2105" style="font-family: MathJax_Main;">)</span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.043em, 1005.96em, 4.408em, -999.997em); top: -3.967em; left: 50%; margin-left: -3.037em;"><span class="mtd" id="MathJax-Span-2106"><span class="mrow" id="MathJax-Span-2107"><span class="mn" id="MathJax-Span-2108" style="font-family: MathJax_Main;">2</span><span class="mo" id="MathJax-Span-2109" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-2110"><span style="display: inline-block; position: relative; width: 0.872em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.44em, 4.346em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-2111" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.437em;"><span class="mn" id="MathJax-Span-2112" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-2113"><span style="display: inline-block; position: relative; width: 0.872em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.44em, 4.346em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-2114" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.437em;"><span class="mn" id="MathJax-Span-2115" style="font-size: 70.7%; font-family: MathJax_Main;">3</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="mo" id="MathJax-Span-2116" style="font-family: MathJax_Main; padding-left: 0.251em;">+</span><span class="msubsup" id="MathJax-Span-2117" style="padding-left: 0.251em;"><span style="display: inline-block; position: relative; width: 0.872em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.44em, 4.346em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-2118" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.437em;"><span class="mn" id="MathJax-Span-2119" style="font-size: 70.7%; font-family: MathJax_Main;">0</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-2120"><span style="display: inline-block; position: relative; width: 0.872em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.44em, 4.346em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-2121" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.437em;"><span class="mn" id="MathJax-Span-2122" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="mo" id="MathJax-Span-2123" style="font-family: MathJax_Main;">)</span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(2.981em, 1006.46em, 4.47em, -999.997em); top: -2.54em; left: 50%; margin-left: -3.223em;"><span class="mtd" id="MathJax-Span-2124"><span class="mrow" id="MathJax-Span-2125"><span class="msubsup" id="MathJax-Span-2126"><span style="display: inline-block; position: relative; width: 0.934em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.44em, 4.346em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-2127" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.291em, 1000.44em, 4.159em, -999.997em); top: -4.339em; left: 0.499em;"><span class="mn" id="MathJax-Span-2128" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.291em, 1000.44em, 4.159em, -999.997em); top: -3.657em; left: 0.437em;"><span class="mn" id="MathJax-Span-2129" style="font-size: 70.7%; font-family: MathJax_Main;">0</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="mo" id="MathJax-Span-2130" style="font-family: MathJax_Main;">–</span><span class="msubsup" id="MathJax-Span-2131" style="padding-left: 0.189em;"><span style="display: inline-block; position: relative; width: 0.934em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.44em, 4.346em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-2132" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.291em, 1000.44em, 4.159em, -999.997em); top: -4.339em; left: 0.499em;"><span class="mn" id="MathJax-Span-2133" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.291em, 1000.44em, 4.159em, -999.997em); top: -3.657em; left: 0.437em;"><span class="mn" id="MathJax-Span-2134" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="mo" id="MathJax-Span-2135" style="font-family: MathJax_Main;">–</span><span class="msubsup" id="MathJax-Span-2136" style="padding-left: 0.189em;"><span style="display: inline-block; position: relative; width: 0.934em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.44em, 4.346em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-2137" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.291em, 1000.44em, 4.159em, -999.997em); top: -4.339em; left: 0.499em;"><span class="mn" id="MathJax-Span-2138" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.291em, 1000.44em, 4.159em, -999.997em); top: -3.657em; left: 0.437em;"><span class="mn" id="MathJax-Span-2139" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="mo" id="MathJax-Span-2140" style="font-family: MathJax_Main; padding-left: 0.251em;">+</span><span class="msubsup" id="MathJax-Span-2141" style="padding-left: 0.251em;"><span style="display: inline-block; position: relative; width: 0.934em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.44em, 4.346em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-2142" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.291em, 1000.44em, 4.159em, -999.997em); top: -4.339em; left: 0.499em;"><span class="mn" id="MathJax-Span-2143" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.291em, 1000.44em, 4.159em, -999.997em); top: -3.657em; left: 0.437em;"><span class="mn" id="MathJax-Span-2144" style="font-size: 70.7%; font-family: MathJax_Main;">3</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.966em;"></span></span></span></span><span class="mo" id="MathJax-Span-2145" style="vertical-align: 2.298em;"><span style="display: inline-block; position: relative; width: 0.685em; height: 0px;"><span style="position: absolute; font-family: MathJax_Size4; top: -2.788em; left: 0em;">⎤<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; font-family: MathJax_Size4; top: -0.555em; left: 0em;">⎦<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -1.672em; left: 0em;">⎥<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span><span class="mo" id="MathJax-Span-2146" style="font-family: MathJax_Main; padding-left: 0.251em;">+</span><span class="mrow" id="MathJax-Span-2147" style="padding-left: 0.251em;"><span class="mo" id="MathJax-Span-2148" style="vertical-align: 2.298em;"><span style="display: inline-block; position: relative; width: 0.685em; height: 0px;"><span style="position: absolute; font-family: MathJax_Size4; top: -2.788em; left: 0em;">⎡<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; font-family: MathJax_Size4; top: -0.555em; left: 0em;">⎣<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -1.61em; left: 0em;">⎢<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="mtable" id="MathJax-Span-2149" style="padding-right: 0.189em; padding-left: 0.189em;"><span style="display: inline-block; position: relative; width: 1.306em; height: 0px;"><span style="position: absolute; clip: rect(2.547em, 1001.31em, 6.951em, -999.997em); top: -5.022em; left: 0em;"><span style="display: inline-block; position: relative; width: 1.306em; height: 0px;"><span style="position: absolute; clip: rect(2.919em, 1001.31em, 4.346em, -999.997em); top: -5.394em; left: 50%; margin-left: -0.617em;"><span class="mtd" id="MathJax-Span-2150"><span class="mrow" id="MathJax-Span-2151"><span class="msubsup" id="MathJax-Span-2152"><span style="display: inline-block; position: relative; width: 0.375em; height: 0px;"><span style="position: absolute; clip: rect(3.787em, 1000em, 4.159em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-2153"></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -4.339em; left: 0em;"><span class="mi" id="MathJax-Span-2154" style="font-size: 70.7%; font-family: MathJax_Math-italic;">b</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-2155"><span style="display: inline-block; position: relative; width: 0.934em; height: 0px;"><span style="position: absolute; clip: rect(3.105em, 1000.44em, 4.159em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-2156" style="font-family: MathJax_Math-italic;">b</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.437em;"><span class="mi" id="MathJax-Span-2157" style="font-size: 70.7%; font-family: MathJax_Math-italic;">x</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(2.919em, 1001.24em, 4.47em, -999.997em); top: -3.967em; left: 50%; margin-left: -0.617em;"><span class="mtd" id="MathJax-Span-2158"><span class="mrow" id="MathJax-Span-2159"><span class="msubsup" id="MathJax-Span-2160"><span style="display: inline-block; position: relative; width: 0.375em; height: 0px;"><span style="position: absolute; clip: rect(3.787em, 1000em, 4.159em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-2161"></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -4.339em; left: 0em;"><span class="mi" id="MathJax-Span-2162" style="font-size: 70.7%; font-family: MathJax_Math-italic;">b</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-2163"><span style="display: inline-block; position: relative; width: 0.872em; height: 0px;"><span style="position: absolute; clip: rect(3.105em, 1000.44em, 4.159em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-2164" style="font-family: MathJax_Math-italic;">b</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.437em;"><span class="mi" id="MathJax-Span-2165" style="font-size: 70.7%; font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(2.919em, 1001.24em, 4.346em, -999.997em); top: -2.416em; left: 50%; margin-left: -0.617em;"><span class="mtd" id="MathJax-Span-2166"><span class="mrow" id="MathJax-Span-2167"><span class="msubsup" id="MathJax-Span-2168"><span style="display: inline-block; position: relative; width: 0.375em; height: 0px;"><span style="position: absolute; clip: rect(3.787em, 1000em, 4.159em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-2169"></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -4.339em; left: 0em;"><span class="mi" id="MathJax-Span-2170" style="font-size: 70.7%; font-family: MathJax_Math-italic;">b</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-2171"><span style="display: inline-block; position: relative; width: 0.81em; height: 0px;"><span style="position: absolute; clip: rect(3.105em, 1000.44em, 4.159em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-2172" style="font-family: MathJax_Math-italic;">b</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.437em;"><span class="mi" id="MathJax-Span-2173" style="font-size: 70.7%; font-family: MathJax_Math-italic;">z<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span><span style="display: inline-block; width: 0px; height: 5.028em;"></span></span></span></span><span class="mo" id="MathJax-Span-2174" style="vertical-align: 2.298em;"><span style="display: inline-block; position: relative; width: 0.685em; height: 0px;"><span style="position: absolute; font-family: MathJax_Size4; top: -2.788em; left: 0em;">⎤<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; font-family: MathJax_Size4; top: -0.555em; left: 0em;">⎦<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -1.61em; left: 0em;">⎥<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span><span class="mo" id="MathJax-Span-2175" style="font-family: MathJax_Main; padding-left: 0.251em;">+</span><span class="mrow" id="MathJax-Span-2176" style="padding-left: 0.251em;"><span class="mo" id="MathJax-Span-2177" style="vertical-align: 2.298em;"><span style="display: inline-block; position: relative; width: 0.685em; height: 0px;"><span style="position: absolute; font-family: MathJax_Size4; top: -2.788em; left: 0em;">⎡<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; font-family: MathJax_Size4; top: -0.555em; left: 0em;">⎣<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -1.61em; left: 0em;">⎢<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="mtable" id="MathJax-Span-2178" style="padding-right: 0.189em; padding-left: 0.189em;"><span style="display: inline-block; position: relative; width: 1.306em; height: 0px;"><span style="position: absolute; clip: rect(2.547em, 1001.31em, 6.951em, -999.997em); top: -5.022em; left: 0em;"><span style="display: inline-block; position: relative; width: 1.306em; height: 0px;"><span style="position: absolute; clip: rect(2.919em, 1001.31em, 4.346em, -999.997em); top: -5.394em; left: 50%; margin-left: -0.679em;"><span class="mtd" id="MathJax-Span-2179"><span class="mrow" id="MathJax-Span-2180"><span class="msubsup" id="MathJax-Span-2181"><span style="display: inline-block; position: relative; width: 0.375em; height: 0px;"><span style="position: absolute; clip: rect(3.787em, 1000em, 4.159em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-2182"></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -4.339em; left: 0em;"><span class="mi" id="MathJax-Span-2183" style="font-size: 70.7%; font-family: MathJax_Math-italic;">b</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-2184"><span style="display: inline-block; position: relative; width: 0.934em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.44em, 4.159em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-2185" style="font-family: MathJax_Math-italic;">e</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.499em;"><span class="mi" id="MathJax-Span-2186" style="font-size: 70.7%; font-family: MathJax_Math-italic;">x</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(2.919em, 1001.24em, 4.47em, -999.997em); top: -3.967em; left: 50%; margin-left: -0.617em;"><span class="mtd" id="MathJax-Span-2187"><span class="mrow" id="MathJax-Span-2188"><span class="msubsup" id="MathJax-Span-2189"><span style="display: inline-block; position: relative; width: 0.375em; height: 0px;"><span style="position: absolute; clip: rect(3.787em, 1000em, 4.159em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-2190"></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -4.339em; left: 0em;"><span class="mi" id="MathJax-Span-2191" style="font-size: 70.7%; font-family: MathJax_Math-italic;">b</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-2192"><span style="display: inline-block; position: relative; width: 0.872em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.44em, 4.159em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-2193" style="font-family: MathJax_Math-italic;">e</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.499em;"><span class="mi" id="MathJax-Span-2194" style="font-size: 70.7%; font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(2.919em, 1001.24em, 4.346em, -999.997em); top: -2.416em; left: 50%; margin-left: -0.617em;"><span class="mtd" id="MathJax-Span-2195"><span class="mrow" id="MathJax-Span-2196"><span class="msubsup" id="MathJax-Span-2197"><span style="display: inline-block; position: relative; width: 0.375em; height: 0px;"><span style="position: absolute; clip: rect(3.787em, 1000em, 4.159em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-2198"></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -4.339em; left: 0em;"><span class="mi" id="MathJax-Span-2199" style="font-size: 70.7%; font-family: MathJax_Math-italic;">b</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-2200"><span style="display: inline-block; position: relative; width: 0.872em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.44em, 4.159em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-2201" style="font-family: MathJax_Math-italic;">e</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.499em;"><span class="mi" id="MathJax-Span-2202" style="font-size: 70.7%; font-family: MathJax_Math-italic;">z<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span><span style="display: inline-block; width: 0px; height: 5.028em;"></span></span></span></span><span class="mo" id="MathJax-Span-2203" style="vertical-align: 2.298em;"><span style="display: inline-block; position: relative; width: 0.685em; height: 0px;"><span style="position: absolute; font-family: MathJax_Size4; top: -2.788em; left: 0em;">⎤<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; font-family: MathJax_Size4; top: -0.555em; left: 0em;">⎦<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -1.61em; left: 0em;">⎥<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.656em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -2.304em; border-left: 0px solid; width: 0px; height: 5.158em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mo>[</mo><mtable rowspacing="4pt" columnspacing="1em"><mtr><mtd><msup><mi></mi><mi>b</mi></msup><msub><mi>a</mi><mi>x</mi></msub></mtd></mtr><mtr><mtd><msup><mi></mi><mi>b</mi></msup><msub><mi>a</mi><mi>y</mi></msub></mtd></mtr><mtr><mtd><msup><mi></mi><mi>b</mi></msup><msub><mi>a</mi><mi>z</mi></msub></mtd></mtr></mtable><mo>]</mo></mrow><mo>=</mo><mo>−</mo><mrow><mo>[</mo><mtable rowspacing="4pt" columnspacing="1em"><mtr><mtd><mn>2</mn><mo stretchy="false">(</mo><msub><mi>q</mi><mn>1</mn></msub><msub><mi>q</mi><mn>3</mn></msub><mo>–</mo><msub><mi>q</mi><mn>0</mn></msub><msub><mi>q</mi><mn>2</mn></msub><mo stretchy="false">)</mo></mtd></mtr><mtr><mtd><mn>2</mn><mo stretchy="false">(</mo><msub><mi>q</mi><mn>2</mn></msub><msub><mi>q</mi><mn>3</mn></msub><mo>+</mo><msub><mi>q</mi><mn>0</mn></msub><msub><mi>q</mi><mn>1</mn></msub><mo stretchy="false">)</mo></mtd></mtr><mtr><mtd><msubsup><mi>q</mi><mn>0</mn><mn>2</mn></msubsup><mo>–</mo><msubsup><mi>q</mi><mn>1</mn><mn>2</mn></msubsup><mo>–</mo><msubsup><mi>q</mi><mn>2</mn><mn>2</mn></msubsup><mo>+</mo><msubsup><mi>q</mi><mn>3</mn><mn>2</mn></msubsup></mtd></mtr></mtable><mo>]</mo></mrow><mo>+</mo><mrow><mo>[</mo><mtable rowspacing="4pt" columnspacing="1em"><mtr><mtd><msup><mi></mi><mi>b</mi></msup><msub><mi>b</mi><mi>x</mi></msub></mtd></mtr><mtr><mtd><msup><mi></mi><mi>b</mi></msup><msub><mi>b</mi><mi>y</mi></msub></mtd></mtr><mtr><mtd><msup><mi></mi><mi>b</mi></msup><msub><mi>b</mi><mi>z</mi></msub></mtd></mtr></mtable><mo>]</mo></mrow><mo>+</mo><mrow><mo>[</mo><mtable rowspacing="4pt" columnspacing="1em"><mtr><mtd><msup><mi></mi><mi>b</mi></msup><msub><mi>e</mi><mi>x</mi></msub></mtd></mtr><mtr><mtd><msup><mi></mi><mi>b</mi></msup><msub><mi>e</mi><mi>y</mi></msub></mtd></mtr><mtr><mtd><msup><mi></mi><mi>b</mi></msup><msub><mi>e</mi><mi>z</mi></msub></mtd></mtr></mtable><mo>]</mo></mrow></math></span></span><script type="math/tex" id="MathJax-Element-33">\begin{bmatrix} ^ba_x \\ ^ba_y \\ ^ba_z \end{bmatrix} = -\begin{bmatrix} 2(q_1q_3 – q_0q_2) \\ 2(q_2q_3 + q_0q_1) \\ q_0^2 – q_1^2 – q_2^2 + q_3^2 \end{bmatrix} + \begin{bmatrix} ^bb_x \\ ^bb_y \\ ^bb_z \end{bmatrix} + \begin{bmatrix} ^be_x \\ ^be_y \\ ^be_z \end{bmatrix} </script>&nbsp; &nbsp; &nbsp;——————–&nbsp; &nbsp; &nbsp;(10)</p>
<p>*take note that in the above equation (10), <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-34-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;g&lt;/mi&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2204" style="width: 0.623em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.499em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(1.74em, 1000.5em, 2.733em, -999.997em); top: -2.354em; left: 0em;"><span class="mrow" id="MathJax-Span-2205"><span class="mi" id="MathJax-Span-2206" style="font-family: MathJax_Math-italic;">g<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.36em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.304em; border-left: 0px solid; width: 0px; height: 0.927em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>g</mi></math></span></span><script type="math/tex" id="MathJax-Element-34">g</script> is a scalar.</p>
<p>Notice in equation (10) that the matrix with quaternion terms is non-linear. In order to use the Kalman Filter, we have to write equation (10) in the form of <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-35-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;C&lt;/mi&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mi&gt;D&lt;/mi&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2207" style="width: 6.455em; display: inline-block;"><span style="display: inline-block; position: relative; width: 5.214em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(1.492em, 1005.21em, 2.733em, -999.997em); top: -2.354em; left: 0em;"><span class="mrow" id="MathJax-Span-2208"><span class="mi" id="MathJax-Span-2209" style="font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-2210" style="font-family: MathJax_Main; padding-left: 0.251em;">=</span><span class="mi" id="MathJax-Span-2211" style="font-family: MathJax_Math-italic; padding-left: 0.251em;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.065em;"></span></span><span class="mi" id="MathJax-Span-2212" style="font-family: MathJax_Math-italic;">x</span><span class="mo" id="MathJax-Span-2213" style="font-family: MathJax_Main; padding-left: 0.251em;">+</span><span class="mi" id="MathJax-Span-2214" style="font-family: MathJax_Math-italic; padding-left: 0.251em;">D</span></span><span style="display: inline-block; width: 0px; height: 2.36em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.304em; border-left: 0px solid; width: 0px; height: 1.312em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>y</mi><mo>=</mo><mi>C</mi><mi>x</mi><mo>+</mo><mi>D</mi></math></span></span><script type="math/tex" id="MathJax-Element-35">y=Cx+D</script> where <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-36-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2215" style="width: 0.685em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.561em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(1.74em, 1000.5em, 2.547em, -999.997em); top: -2.354em; left: 0em;"><span class="mrow" id="MathJax-Span-2216"><span class="mi" id="MathJax-Span-2217" style="font-family: MathJax_Math-italic;">x</span></span><span style="display: inline-block; width: 0px; height: 2.36em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.073em; border-left: 0px solid; width: 0px; height: 0.696em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>x</mi></math></span></span><script type="math/tex" id="MathJax-Element-36">x</script> is the state matrix as shown in equation (1) and <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-37-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2218" style="width: 0.623em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.499em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(1.74em, 1000.5em, 2.733em, -999.997em); top: -2.354em; left: 0em;"><span class="mrow" id="MathJax-Span-2219"><span class="mi" id="MathJax-Span-2220" style="font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.36em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.304em; border-left: 0px solid; width: 0px; height: 0.927em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>y</mi></math></span></span><script type="math/tex" id="MathJax-Element-37">y</script> is the term on the left hand side of equation (10). You will realize that this is not possible because of the non-linearity. One possible solution is that we can linearize equation (10) near its “operating point”. This is exactly what the Extended Kalman Filter is doing, and also why you need to use the extended form of the Kalman Filter when working with rotation matrices because they are mostly non-linear.</p>
<p>So, how do we go about linearizing equation (10)? We can rewrite equation (8), the unexpanded form of equation (10), evaluated at time <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-38-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2221" style="width: 0.499em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.375em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(1.554em, 1000.38em, 2.547em, -999.997em); top: -2.354em; left: 0em;"><span class="mrow" id="MathJax-Span-2222"><span class="mi" id="MathJax-Span-2223" style="font-family: MathJax_Math-italic;">t</span></span><span style="display: inline-block; width: 0px; height: 2.36em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.073em; border-left: 0px solid; width: 0px; height: 0.927em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>t</mi></math></span></span><script type="math/tex" id="MathJax-Element-38">t</script> as shown below.</p>
<p style="text-align: center;"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-39-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msup&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;/msup&gt;&lt;msub&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mi&gt;m&lt;/mi&gt;&lt;/msub&gt;&lt;msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mi&gt;g&lt;/mi&gt;&lt;msub&gt;&lt;mi&gt;h&lt;/mi&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;C&lt;/mi&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2224" style="width: 13.092em; display: inline-block;"><span style="display: inline-block; position: relative; width: 10.549em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(1.306em, 1010.55em, 2.795em, -999.997em); top: -2.354em; left: 0em;"><span class="mrow" id="MathJax-Span-2225"><span class="msubsup" id="MathJax-Span-2226"><span style="display: inline-block; position: relative; width: 0.748em; height: 0px;"><span style="position: absolute; clip: rect(3.043em, 1000.31em, 4.408em, -999.997em); top: -3.967em; left: 0em;"><span class="mo" id="MathJax-Span-2227" style="font-family: MathJax_Main;">(</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -4.339em; left: 0.375em;"><span class="mi" id="MathJax-Span-2228" style="font-size: 70.7%; font-family: MathJax_Math-italic;">b</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-2229"><span style="display: inline-block; position: relative; width: 1.244em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.5em, 4.159em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-2230" style="font-family: MathJax_Math-italic;">a</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.561em;"><span class="mi" id="MathJax-Span-2231" style="font-size: 70.7%; font-family: MathJax_Math-italic;">m</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-2232"><span style="display: inline-block; position: relative; width: 0.81em; height: 0px;"><span style="position: absolute; clip: rect(3.043em, 1000.31em, 4.408em, -999.997em); top: -3.967em; left: 0em;"><span class="mo" id="MathJax-Span-2233" style="font-family: MathJax_Main;">)</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.375em;"><span class="mi" id="MathJax-Span-2234" style="font-size: 70.7%; font-family: MathJax_Math-italic;">k</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="mo" id="MathJax-Span-2235" style="font-family: MathJax_Main; padding-left: 0.251em;">=</span><span class="mo" id="MathJax-Span-2236" style="font-family: MathJax_Main; padding-left: 0.251em;">−</span><span class="mi" id="MathJax-Span-2237" style="font-family: MathJax_Math-italic;">g<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="msubsup" id="MathJax-Span-2238"><span style="display: inline-block; position: relative; width: 1.058em; height: 0px;"><span style="position: absolute; clip: rect(3.105em, 1000.56em, 4.159em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-2239" style="font-family: MathJax_Math-italic;">h</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.561em;"><span class="mi" id="MathJax-Span-2240" style="font-size: 70.7%; font-family: MathJax_Math-italic;">a</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="mo" id="MathJax-Span-2241" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-2242"><span style="display: inline-block; position: relative; width: 0.872em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.44em, 4.346em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-2243" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.437em;"><span class="mi" id="MathJax-Span-2244" style="font-size: 70.7%; font-family: MathJax_Math-italic;">k</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="mo" id="MathJax-Span-2245" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-2246" style="font-family: MathJax_Main; padding-left: 0.251em;">+</span><span class="msubsup" id="MathJax-Span-2247" style="padding-left: 0.251em;"><span style="display: inline-block; position: relative; width: 1.182em; height: 0px;"><span style="position: absolute; clip: rect(3.105em, 1000.75em, 4.159em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-2248" style="font-family: MathJax_Math-italic;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.065em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.748em;"><span class="mi" id="MathJax-Span-2249" style="font-size: 70.7%; font-family: MathJax_Math-italic;">k</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.36em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.381em; border-left: 0px solid; width: 0px; height: 1.542em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup><mo stretchy="false">(</mo><mi>b</mi></msup><msub><mi>a</mi><mi>m</mi></msub><msub><mo stretchy="false">)</mo><mi>k</mi></msub><mo>=</mo><mo>−</mo><mi>g</mi><msub><mi>h</mi><mi>a</mi></msub><mo stretchy="false">(</mo><msub><mi>q</mi><mi>k</mi></msub><mo stretchy="false">)</mo><mo>+</mo><msub><mi>C</mi><mi>k</mi></msub></math></span></span><script type="math/tex" id="MathJax-Element-39">(^ba_m)_k = -gh_a(q_k) + C_k</script>&nbsp; &nbsp; &nbsp;——————–&nbsp; &nbsp; &nbsp;(11)</p>
<p>where</p>
<p><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-40-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msup&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;/msup&gt;&lt;msub&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mi&gt;m&lt;/mi&gt;&lt;/msub&gt;&lt;msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2250" style="width: 3.477em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.795em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(1.306em, 1002.79em, 2.795em, -999.997em); top: -2.354em; left: 0em;"><span class="mrow" id="MathJax-Span-2251"><span class="msubsup" id="MathJax-Span-2252"><span style="display: inline-block; position: relative; width: 0.748em; height: 0px;"><span style="position: absolute; clip: rect(3.043em, 1000.31em, 4.408em, -999.997em); top: -3.967em; left: 0em;"><span class="mo" id="MathJax-Span-2253" style="font-family: MathJax_Main;">(</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -4.339em; left: 0.375em;"><span class="mi" id="MathJax-Span-2254" style="font-size: 70.7%; font-family: MathJax_Math-italic;">b</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-2255"><span style="display: inline-block; position: relative; width: 1.244em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.5em, 4.159em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-2256" style="font-family: MathJax_Math-italic;">a</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.561em;"><span class="mi" id="MathJax-Span-2257" style="font-size: 70.7%; font-family: MathJax_Math-italic;">m</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-2258"><span style="display: inline-block; position: relative; width: 0.81em; height: 0px;"><span style="position: absolute; clip: rect(3.043em, 1000.31em, 4.408em, -999.997em); top: -3.967em; left: 0em;"><span class="mo" id="MathJax-Span-2259" style="font-family: MathJax_Main;">)</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.375em;"><span class="mi" id="MathJax-Span-2260" style="font-size: 70.7%; font-family: MathJax_Math-italic;">k</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.36em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.381em; border-left: 0px solid; width: 0px; height: 1.542em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup><mo stretchy="false">(</mo><mi>b</mi></msup><msub><mi>a</mi><mi>m</mi></msub><msub><mo stretchy="false">)</mo><mi>k</mi></msub></math></span></span><script type="math/tex" id="MathJax-Element-40">(^ba_m)_k</script> is the measured acceleration in the body frame by the accelerometer at time step <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-41-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2261" style="width: 0.623em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.499em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(1.492em, 1000.5em, 2.547em, -999.997em); top: -2.354em; left: 0em;"><span class="mrow" id="MathJax-Span-2262"><span class="mi" id="MathJax-Span-2263" style="font-family: MathJax_Math-italic;">k</span></span><span style="display: inline-block; width: 0px; height: 2.36em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.073em; border-left: 0px solid; width: 0px; height: 1.004em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>k</mi></math></span></span><script type="math/tex" id="MathJax-Element-41">k</script><br>
<span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-42-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;g&lt;/mi&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2264" style="width: 0.623em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.499em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(1.74em, 1000.5em, 2.733em, -999.997em); top: -2.354em; left: 0em;"><span class="mrow" id="MathJax-Span-2265"><span class="mi" id="MathJax-Span-2266" style="font-family: MathJax_Math-italic;">g<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.36em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.304em; border-left: 0px solid; width: 0px; height: 0.927em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>g</mi></math></span></span><script type="math/tex" id="MathJax-Element-42">g</script> is the gravitational constant (take note that <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-43-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;g&lt;/mi&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2267" style="width: 0.623em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.499em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(1.74em, 1000.5em, 2.733em, -999.997em); top: -2.354em; left: 0em;"><span class="mrow" id="MathJax-Span-2268"><span class="mi" id="MathJax-Span-2269" style="font-family: MathJax_Math-italic;">g<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.36em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.304em; border-left: 0px solid; width: 0px; height: 0.927em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>g</mi></math></span></span><script type="math/tex" id="MathJax-Element-43">g</script> is a scalar here)<br>
<span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-44-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;h&lt;/mi&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2270" style="width: 3.415em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.733em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(1.43em, 1002.61em, 2.795em, -999.997em); top: -2.354em; left: 0em;"><span class="mrow" id="MathJax-Span-2271"><span class="msubsup" id="MathJax-Span-2272"><span style="display: inline-block; position: relative; width: 1.058em; height: 0px;"><span style="position: absolute; clip: rect(3.105em, 1000.56em, 4.159em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-2273" style="font-family: MathJax_Math-italic;">h</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.561em;"><span class="mi" id="MathJax-Span-2274" style="font-size: 70.7%; font-family: MathJax_Math-italic;">a</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="mo" id="MathJax-Span-2275" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-2276"><span style="display: inline-block; position: relative; width: 0.872em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.44em, 4.346em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-2277" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.437em;"><span class="mi" id="MathJax-Span-2278" style="font-size: 70.7%; font-family: MathJax_Math-italic;">k</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="mo" id="MathJax-Span-2279" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.36em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.381em; border-left: 0px solid; width: 0px; height: 1.388em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>h</mi><mi>a</mi></msub><mo stretchy="false">(</mo><msub><mi>q</mi><mi>k</mi></msub><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-44">h_a(q_k) </script> represents a non-linear function in <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-45-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2280" style="width: 1.12em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.872em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(1.74em, 1000.87em, 2.733em, -999.997em); top: -2.354em; left: 0em;"><span class="mrow" id="MathJax-Span-2281"><span class="msubsup" id="MathJax-Span-2282"><span style="display: inline-block; position: relative; width: 0.872em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.44em, 4.346em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-2283" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.437em;"><span class="mi" id="MathJax-Span-2284" style="font-size: 70.7%; font-family: MathJax_Math-italic;">k</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.36em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.304em; border-left: 0px solid; width: 0px; height: 0.927em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>q</mi><mi>k</mi></msub></math></span></span><script type="math/tex" id="MathJax-Element-45">q_k</script>, where <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-46-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2285" style="width: 1.12em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.872em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(1.74em, 1000.87em, 2.733em, -999.997em); top: -2.354em; left: 0em;"><span class="mrow" id="MathJax-Span-2286"><span class="msubsup" id="MathJax-Span-2287"><span style="display: inline-block; position: relative; width: 0.872em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.44em, 4.346em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-2288" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.437em;"><span class="mi" id="MathJax-Span-2289" style="font-size: 70.7%; font-family: MathJax_Math-italic;">k</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.36em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.304em; border-left: 0px solid; width: 0px; height: 0.927em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>q</mi><mi>k</mi></msub></math></span></span><script type="math/tex" id="MathJax-Element-46">q_k</script> is the quaternion at time step <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-47-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2290" style="width: 0.623em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.499em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(1.492em, 1000.5em, 2.547em, -999.997em); top: -2.354em; left: 0em;"><span class="mrow" id="MathJax-Span-2291"><span class="mi" id="MathJax-Span-2292" style="font-family: MathJax_Math-italic;">k</span></span><span style="display: inline-block; width: 0px; height: 2.36em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.073em; border-left: 0px solid; width: 0px; height: 1.004em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>k</mi></math></span></span><script type="math/tex" id="MathJax-Element-47">k</script><br>
<span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-48-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;C&lt;/mi&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2293" style="width: 1.492em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.182em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(1.492em, 1001.18em, 2.733em, -999.997em); top: -2.354em; left: 0em;"><span class="mrow" id="MathJax-Span-2294"><span class="msubsup" id="MathJax-Span-2295"><span style="display: inline-block; position: relative; width: 1.182em; height: 0px;"><span style="position: absolute; clip: rect(3.105em, 1000.75em, 4.159em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-2296" style="font-family: MathJax_Math-italic;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.065em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.748em;"><span class="mi" id="MathJax-Span-2297" style="font-size: 70.7%; font-family: MathJax_Math-italic;">k</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.36em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.304em; border-left: 0px solid; width: 0px; height: 1.235em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>C</mi><mi>k</mi></msub></math></span></span><script type="math/tex" id="MathJax-Element-48">C_k</script> represents the other terms in equation (8), <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-49-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msup&gt;&lt;mi&gt;&lt;/mi&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;/msup&gt;&lt;msub&gt;&lt;mi&gt;e&lt;/mi&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;/msub&gt;&lt;msup&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;/msup&gt;&lt;msub&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2298" style="width: 4.78em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.849em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(1.306em, 1003.85em, 2.733em, -999.997em); top: -2.354em; left: 0em;"><span class="mrow" id="MathJax-Span-2299"><span class="msubsup" id="MathJax-Span-2300"><span style="display: inline-block; position: relative; width: 0.375em; height: 0px;"><span style="position: absolute; clip: rect(3.787em, 1000em, 4.159em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-2301"></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -4.339em; left: 0em;"><span class="mi" id="MathJax-Span-2302" style="font-size: 70.7%; font-family: MathJax_Math-italic;">b</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-2303"><span style="display: inline-block; position: relative; width: 0.934em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.44em, 4.159em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-2304" style="font-family: MathJax_Math-italic;">e</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.499em;"><span class="mi" id="MathJax-Span-2305" style="font-size: 70.7%; font-family: MathJax_Math-italic;">a</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-2306" style="padding-left: 0.251em;"><span style="display: inline-block; position: relative; width: 1.182em; height: 0px;"><span style="position: absolute; clip: rect(3.229em, 1000.75em, 4.221em, -999.997em); top: -3.967em; left: 0em;"><span class="mo" id="MathJax-Span-2307" style="font-family: MathJax_Main;">+</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -4.339em; left: 0.81em;"><span class="mi" id="MathJax-Span-2308" style="font-size: 70.7%; font-family: MathJax_Math-italic;">b</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-2309" style="padding-left: 0.251em;"><span style="display: inline-block; position: relative; width: 0.872em; height: 0px;"><span style="position: absolute; clip: rect(3.105em, 1000.44em, 4.159em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-2310" style="font-family: MathJax_Math-italic;">b</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.437em;"><span class="mi" id="MathJax-Span-2311" style="font-size: 70.7%; font-family: MathJax_Math-italic;">a</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.36em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.304em; border-left: 0px solid; width: 0px; height: 1.388em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup><mi></mi><mi>b</mi></msup><msub><mi>e</mi><mi>a</mi></msub><msup><mo>+</mo><mi>b</mi></msup><msub><mi>b</mi><mi>a</mi></msub></math></span></span><script type="math/tex" id="MathJax-Element-49">^be_a + ^bb_a</script>, evaluated at time step <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-50-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2312" style="width: 0.623em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.499em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(1.492em, 1000.5em, 2.547em, -999.997em); top: -2.354em; left: 0em;"><span class="mrow" id="MathJax-Span-2313"><span class="mi" id="MathJax-Span-2314" style="font-family: MathJax_Math-italic;">k</span></span><span style="display: inline-block; width: 0px; height: 2.36em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.073em; border-left: 0px solid; width: 0px; height: 1.004em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>k</mi></math></span></span><script type="math/tex" id="MathJax-Element-50">k</script>.</p>
<p>Just for clarity, I am going to write the values of&nbsp;<span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-51-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;h&lt;/mi&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2315" style="width: 3.415em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.733em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(1.43em, 1002.61em, 2.795em, -999.997em); top: -2.354em; left: 0em;"><span class="mrow" id="MathJax-Span-2316"><span class="msubsup" id="MathJax-Span-2317"><span style="display: inline-block; position: relative; width: 1.058em; height: 0px;"><span style="position: absolute; clip: rect(3.105em, 1000.56em, 4.159em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-2318" style="font-family: MathJax_Math-italic;">h</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.561em;"><span class="mi" id="MathJax-Span-2319" style="font-size: 70.7%; font-family: MathJax_Math-italic;">a</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="mo" id="MathJax-Span-2320" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-2321"><span style="display: inline-block; position: relative; width: 0.872em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.44em, 4.346em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-2322" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.437em;"><span class="mi" id="MathJax-Span-2323" style="font-size: 70.7%; font-family: MathJax_Math-italic;">k</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="mo" id="MathJax-Span-2324" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.36em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.381em; border-left: 0px solid; width: 0px; height: 1.388em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>h</mi><mi>a</mi></msub><mo stretchy="false">(</mo><msub><mi>q</mi><mi>k</mi></msub><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-51">h_a(q_k) </script> below so that there will be no misunderstandings.</p>
<p><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-52-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;h&lt;/mi&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;msub&gt;&lt;mrow&gt;&lt;mo&gt;[&lt;/mo&gt;&lt;mtable rowspacing=&quot;4pt&quot; columnspacing=&quot;1em&quot;&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;msub&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mn&gt;3&lt;/mn&gt;&lt;/msub&gt;&lt;mo&gt;&amp;#x2013;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/msub&gt;&lt;msub&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msub&gt;&lt;msub&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mn&gt;3&lt;/mn&gt;&lt;/msub&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/msub&gt;&lt;msub&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;msubsup&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msubsup&gt;&lt;mo&gt;&amp;#x2013;&lt;/mo&gt;&lt;msubsup&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msubsup&gt;&lt;mo&gt;&amp;#x2013;&lt;/mo&gt;&lt;msubsup&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msubsup&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;msubsup&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mn&gt;3&lt;/mn&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msubsup&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;/mtable&gt;&lt;mo&gt;]&lt;/mo&gt;&lt;/mrow&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2325" style="width: 15.574em; display: inline-block;"><span style="display: inline-block; position: relative; width: 12.534em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(-0.121em, 1012.53em, 4.346em, -999.997em); top: -2.354em; left: 0em;"><span class="mrow" id="MathJax-Span-2326"><span class="msubsup" id="MathJax-Span-2327"><span style="display: inline-block; position: relative; width: 1.058em; height: 0px;"><span style="position: absolute; clip: rect(3.105em, 1000.56em, 4.159em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-2328" style="font-family: MathJax_Math-italic;">h</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.561em;"><span class="mi" id="MathJax-Span-2329" style="font-size: 70.7%; font-family: MathJax_Math-italic;">a</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="mo" id="MathJax-Span-2330" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-2331"><span style="display: inline-block; position: relative; width: 0.872em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.44em, 4.346em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-2332" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.437em;"><span class="mi" id="MathJax-Span-2333" style="font-size: 70.7%; font-family: MathJax_Math-italic;">k</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="mo" id="MathJax-Span-2334" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-2335" style="font-family: MathJax_Main; padding-left: 0.251em;">=</span><span class="msubsup" id="MathJax-Span-2336" style="padding-left: 0.251em;"><span style="display: inline-block; position: relative; width: 8.564em; height: 0px;"><span style="position: absolute; clip: rect(2.547em, 1007.82em, 7.013em, -999.997em); top: -5.022em; left: 0em;"><span class="mrow" id="MathJax-Span-2337"><span class="mo" id="MathJax-Span-2338" style="vertical-align: 2.298em;"><span style="display: inline-block; position: relative; width: 0.685em; height: 0px;"><span style="position: absolute; font-family: MathJax_Size4; top: -2.788em; left: 0em;">⎡<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; font-family: MathJax_Size4; top: -0.555em; left: 0em;">⎣<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -1.672em; left: 0em;">⎢<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="mtable" id="MathJax-Span-2339" style="padding-right: 0.189em; padding-left: 0.189em;"><span style="display: inline-block; position: relative; width: 6.455em; height: 0px;"><span style="position: absolute; clip: rect(2.547em, 1006.46em, 6.951em, -999.997em); top: -4.96em; left: 0em;"><span style="display: inline-block; position: relative; width: 6.455em; height: 0px;"><span style="position: absolute; clip: rect(3.043em, 1005.4em, 4.408em, -999.997em); top: -5.456em; left: 50%; margin-left: -2.726em;"><span class="mtd" id="MathJax-Span-2340"><span class="mrow" id="MathJax-Span-2341"><span class="mn" id="MathJax-Span-2342" style="font-family: MathJax_Main;">2</span><span class="mo" id="MathJax-Span-2343" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-2344"><span style="display: inline-block; position: relative; width: 0.872em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.44em, 4.346em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-2345" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.437em;"><span class="mn" id="MathJax-Span-2346" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-2347"><span style="display: inline-block; position: relative; width: 0.872em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.44em, 4.346em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-2348" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.437em;"><span class="mn" id="MathJax-Span-2349" style="font-size: 70.7%; font-family: MathJax_Main;">3</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="mo" id="MathJax-Span-2350" style="font-family: MathJax_Main;">–</span><span class="msubsup" id="MathJax-Span-2351" style="padding-left: 0.189em;"><span style="display: inline-block; position: relative; width: 0.872em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.44em, 4.346em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-2352" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.437em;"><span class="mn" id="MathJax-Span-2353" style="font-size: 70.7%; font-family: MathJax_Main;">0</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-2354"><span style="display: inline-block; position: relative; width: 0.872em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.44em, 4.346em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-2355" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.437em;"><span class="mn" id="MathJax-Span-2356" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="mo" id="MathJax-Span-2357" style="font-family: MathJax_Main;">)</span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.043em, 1005.96em, 4.408em, -999.997em); top: -3.967em; left: 50%; margin-left: -3.037em;"><span class="mtd" id="MathJax-Span-2358"><span class="mrow" id="MathJax-Span-2359"><span class="mn" id="MathJax-Span-2360" style="font-family: MathJax_Main;">2</span><span class="mo" id="MathJax-Span-2361" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-2362"><span style="display: inline-block; position: relative; width: 0.872em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.44em, 4.346em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-2363" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.437em;"><span class="mn" id="MathJax-Span-2364" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-2365"><span style="display: inline-block; position: relative; width: 0.872em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.44em, 4.346em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-2366" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.437em;"><span class="mn" id="MathJax-Span-2367" style="font-size: 70.7%; font-family: MathJax_Main;">3</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="mo" id="MathJax-Span-2368" style="font-family: MathJax_Main; padding-left: 0.251em;">+</span><span class="msubsup" id="MathJax-Span-2369" style="padding-left: 0.251em;"><span style="display: inline-block; position: relative; width: 0.872em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.44em, 4.346em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-2370" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.437em;"><span class="mn" id="MathJax-Span-2371" style="font-size: 70.7%; font-family: MathJax_Main;">0</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-2372"><span style="display: inline-block; position: relative; width: 0.872em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.44em, 4.346em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-2373" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.437em;"><span class="mn" id="MathJax-Span-2374" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="mo" id="MathJax-Span-2375" style="font-family: MathJax_Main;">)</span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(2.981em, 1006.46em, 4.47em, -999.997em); top: -2.54em; left: 50%; margin-left: -3.223em;"><span class="mtd" id="MathJax-Span-2376"><span class="mrow" id="MathJax-Span-2377"><span class="msubsup" id="MathJax-Span-2378"><span style="display: inline-block; position: relative; width: 0.934em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.44em, 4.346em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-2379" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.291em, 1000.44em, 4.159em, -999.997em); top: -4.339em; left: 0.499em;"><span class="mn" id="MathJax-Span-2380" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.291em, 1000.44em, 4.159em, -999.997em); top: -3.657em; left: 0.437em;"><span class="mn" id="MathJax-Span-2381" style="font-size: 70.7%; font-family: MathJax_Main;">0</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="mo" id="MathJax-Span-2382" style="font-family: MathJax_Main;">–</span><span class="msubsup" id="MathJax-Span-2383" style="padding-left: 0.189em;"><span style="display: inline-block; position: relative; width: 0.934em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.44em, 4.346em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-2384" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.291em, 1000.44em, 4.159em, -999.997em); top: -4.339em; left: 0.499em;"><span class="mn" id="MathJax-Span-2385" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.291em, 1000.44em, 4.159em, -999.997em); top: -3.657em; left: 0.437em;"><span class="mn" id="MathJax-Span-2386" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="mo" id="MathJax-Span-2387" style="font-family: MathJax_Main;">–</span><span class="msubsup" id="MathJax-Span-2388" style="padding-left: 0.189em;"><span style="display: inline-block; position: relative; width: 0.934em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.44em, 4.346em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-2389" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.291em, 1000.44em, 4.159em, -999.997em); top: -4.339em; left: 0.499em;"><span class="mn" id="MathJax-Span-2390" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.291em, 1000.44em, 4.159em, -999.997em); top: -3.657em; left: 0.437em;"><span class="mn" id="MathJax-Span-2391" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="mo" id="MathJax-Span-2392" style="font-family: MathJax_Main; padding-left: 0.251em;">+</span><span class="msubsup" id="MathJax-Span-2393" style="padding-left: 0.251em;"><span style="display: inline-block; position: relative; width: 0.934em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.44em, 4.346em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-2394" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.291em, 1000.44em, 4.159em, -999.997em); top: -4.339em; left: 0.499em;"><span class="mn" id="MathJax-Span-2395" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.291em, 1000.44em, 4.159em, -999.997em); top: -3.657em; left: 0.437em;"><span class="mn" id="MathJax-Span-2396" style="font-size: 70.7%; font-family: MathJax_Main;">3</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.966em;"></span></span></span></span><span class="mo" id="MathJax-Span-2397" style="vertical-align: 2.298em;"><span style="display: inline-block; position: relative; width: 0.685em; height: 0px;"><span style="position: absolute; font-family: MathJax_Size4; top: -2.788em; left: 0em;">⎤<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; font-family: MathJax_Size4; top: -0.555em; left: 0em;">⎦<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -1.672em; left: 0em;">⎥<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 5.028em;"></span></span><span style="position: absolute; top: -2.168em; left: 8.13em;"><span class="mi" id="MathJax-Span-2398" style="font-size: 70.7%; font-family: MathJax_Math-italic;">k</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.36em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -2.304em; border-left: 0px solid; width: 0px; height: 5.235em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>h</mi><mi>a</mi></msub><mo stretchy="false">(</mo><msub><mi>q</mi><mi>k</mi></msub><mo stretchy="false">)</mo><mo>=</mo><msub><mrow><mo>[</mo><mtable rowspacing="4pt" columnspacing="1em"><mtr><mtd><mn>2</mn><mo stretchy="false">(</mo><msub><mi>q</mi><mn>1</mn></msub><msub><mi>q</mi><mn>3</mn></msub><mo>–</mo><msub><mi>q</mi><mn>0</mn></msub><msub><mi>q</mi><mn>2</mn></msub><mo stretchy="false">)</mo></mtd></mtr><mtr><mtd><mn>2</mn><mo stretchy="false">(</mo><msub><mi>q</mi><mn>2</mn></msub><msub><mi>q</mi><mn>3</mn></msub><mo>+</mo><msub><mi>q</mi><mn>0</mn></msub><msub><mi>q</mi><mn>1</mn></msub><mo stretchy="false">)</mo></mtd></mtr><mtr><mtd><msubsup><mi>q</mi><mn>0</mn><mn>2</mn></msubsup><mo>–</mo><msubsup><mi>q</mi><mn>1</mn><mn>2</mn></msubsup><mo>–</mo><msubsup><mi>q</mi><mn>2</mn><mn>2</mn></msubsup><mo>+</mo><msubsup><mi>q</mi><mn>3</mn><mn>2</mn></msubsup></mtd></mtr></mtable><mo>]</mo></mrow><mi>k</mi></msub></math></span></span><script type="math/tex" id="MathJax-Element-52">h_a(q_k) = \begin{bmatrix} 2(q_1q_3 – q_0q_2) \\ 2(q_2q_3 + q_0q_1) \\ q_0^2 – q_1^2 – q_2^2 + q_3^2 \end{bmatrix}_k</script></p>
<p>With this, what we need to do now becomes much clearer. We have to linearize the non-linear function&nbsp;<span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-53-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;h&lt;/mi&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2399" style="width: 3.415em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.733em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(1.43em, 1002.61em, 2.795em, -999.997em); top: -2.354em; left: 0em;"><span class="mrow" id="MathJax-Span-2400"><span class="msubsup" id="MathJax-Span-2401"><span style="display: inline-block; position: relative; width: 1.058em; height: 0px;"><span style="position: absolute; clip: rect(3.105em, 1000.56em, 4.159em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-2402" style="font-family: MathJax_Math-italic;">h</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.561em;"><span class="mi" id="MathJax-Span-2403" style="font-size: 70.7%; font-family: MathJax_Math-italic;">a</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="mo" id="MathJax-Span-2404" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-2405"><span style="display: inline-block; position: relative; width: 0.872em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.44em, 4.346em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-2406" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.437em;"><span class="mi" id="MathJax-Span-2407" style="font-size: 70.7%; font-family: MathJax_Math-italic;">k</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="mo" id="MathJax-Span-2408" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.36em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.381em; border-left: 0px solid; width: 0px; height: 1.388em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>h</mi><mi>a</mi></msub><mo stretchy="false">(</mo><msub><mi>q</mi><mi>k</mi></msub><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-53">h_a(q_k) </script>, and one way of doing so is to find its Jacobian (gradient) at time <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-54-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2409" style="width: 2.857em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.298em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(1.492em, 1002.24em, 2.609em, -999.997em); top: -2.354em; left: 0em;"><span class="mrow" id="MathJax-Span-2410"><span class="mi" id="MathJax-Span-2411" style="font-family: MathJax_Math-italic;">k</span><span class="mo" id="MathJax-Span-2412" style="font-family: MathJax_Main; padding-left: 0.251em;">−</span><span class="mn" id="MathJax-Span-2413" style="font-family: MathJax_Main; padding-left: 0.251em;">1</span></span><span style="display: inline-block; width: 0px; height: 2.36em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.15em; border-left: 0px solid; width: 0px; height: 1.158em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>k</mi><mo>−</mo><mn>1</mn></math></span></span><script type="math/tex" id="MathJax-Element-54">k-1</script>. In doing so, we are assuming that the non-linear function is approximately linear between 2 points adjacent in time. This also means that the approximation will be better if you have a shorter time-step between your iterations.</p>
<p>In order to linearize a function, we will call upon the mighty <a href="https://en.wikipedia.org/wiki/Taylor_series">Taylor Expansion</a>&nbsp;as shown below.</p>
<p><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-55-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;f&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;msub&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;|&lt;/mo&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;f&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;msup&gt;&lt;mi&gt;f&lt;/mi&gt;&lt;mo&gt;&amp;#x2032;&lt;/mo&gt;&lt;/msup&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mfrac&gt;&lt;mrow&gt;&lt;mi&gt;f&lt;/mi&gt;&lt;mo&gt;&amp;#x201D;&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/mfrac&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;msup&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msup&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mo&gt;&amp;#x2026;&lt;/mo&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2414" style="width: 28.167em; display: inline-block;"><span style="display: inline-block; position: relative; width: 22.708em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(1.058em, 1022.65em, 2.919em, -999.997em); top: -2.354em; left: 0em;"><span class="mrow" id="MathJax-Span-2415"><span class="mi" id="MathJax-Span-2416" style="font-family: MathJax_Math-italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.065em;"></span></span><span class="mo" id="MathJax-Span-2417" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-2418" style="font-family: MathJax_Math-italic;">x</span><span class="mo" id="MathJax-Span-2419" style="font-family: MathJax_Main;">)</span><span class="msubsup" id="MathJax-Span-2420"><span style="display: inline-block; position: relative; width: 1.678em; height: 0px;"><span style="position: absolute; clip: rect(3.043em, 1000.19em, 4.408em, -999.997em); top: -3.967em; left: 0em;"><span class="texatom" id="MathJax-Span-2421"><span class="mrow" id="MathJax-Span-2422"><span class="mo" id="MathJax-Span-2423" style="font-family: MathJax_Main;">|</span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.657em; left: 0.251em;"><span class="texatom" id="MathJax-Span-2424"><span class="mrow" id="MathJax-Span-2425"><span class="mi" id="MathJax-Span-2426" style="font-size: 70.7%; font-family: MathJax_Math-italic;">x</span><span class="mo" id="MathJax-Span-2427" style="font-size: 70.7%; font-family: MathJax_Main;">=</span><span class="mi" id="MathJax-Span-2428" style="font-size: 70.7%; font-family: MathJax_Math-italic;">a</span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="mo" id="MathJax-Span-2429" style="font-family: MathJax_Main; padding-left: 0.251em;">=</span><span class="mi" id="MathJax-Span-2430" style="font-family: MathJax_Math-italic; padding-left: 0.251em;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.065em;"></span></span><span class="mo" id="MathJax-Span-2431" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-2432" style="font-family: MathJax_Math-italic;">a</span><span class="mo" id="MathJax-Span-2433" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-2434" style="font-family: MathJax_Main; padding-left: 0.251em;">+</span><span class="msup" id="MathJax-Span-2435" style="padding-left: 0.251em;"><span style="display: inline-block; position: relative; width: 0.872em; height: 0px;"><span style="position: absolute; clip: rect(3.105em, 1000.56em, 4.346em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-2436" style="font-family: MathJax_Math-italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.065em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -4.339em; left: 0.623em;"><span class="mo" id="MathJax-Span-2437" style="font-size: 70.7%; font-family: MathJax_Main;">′</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="mo" id="MathJax-Span-2438" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-2439" style="font-family: MathJax_Math-italic;">a</span><span class="mo" id="MathJax-Span-2440" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-2441" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-2442" style="font-family: MathJax_Math-italic;">x</span><span class="mo" id="MathJax-Span-2443" style="font-family: MathJax_Main; padding-left: 0.251em;">−</span><span class="mi" id="MathJax-Span-2444" style="font-family: MathJax_Math-italic; padding-left: 0.251em;">a</span><span class="mo" id="MathJax-Span-2445" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-2446" style="font-family: MathJax_Main; padding-left: 0.251em;">+</span><span class="mfrac" id="MathJax-Span-2447" style="padding-left: 0.251em;"><span style="display: inline-block; position: relative; width: 1.802em; height: 0px; margin-right: 0.127em; margin-left: 0.127em;"><span style="position: absolute; clip: rect(3.229em, 1001.62em, 4.346em, -999.997em); top: -4.587em; left: 50%; margin-left: -0.803em;"><span class="mrow" id="MathJax-Span-2448"><span class="mi" id="MathJax-Span-2449" style="font-size: 70.7%; font-family: MathJax_Math-italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.065em;"></span></span><span class="mo" id="MathJax-Span-2450" style="font-size: 70.7%; font-family: MathJax_Main;">”</span><span class="mo" id="MathJax-Span-2451" style="font-size: 70.7%; font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-2452" style="font-size: 70.7%; font-family: MathJax_Math-italic;">a</span><span class="mo" id="MathJax-Span-2453" style="font-size: 70.7%; font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.291em, 1000.31em, 4.159em, -999.997em); top: -3.595em; left: 50%; margin-left: -0.183em;"><span class="mn" id="MathJax-Span-2454" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(0.81em, 1001.8em, 1.244em, -999.997em); top: -1.3em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 1.802em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.058em;"></span></span></span></span><span class="mo" id="MathJax-Span-2455" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-2456" style="font-family: MathJax_Math-italic;">x</span><span class="mo" id="MathJax-Span-2457" style="font-family: MathJax_Main; padding-left: 0.251em;">−</span><span class="mi" id="MathJax-Span-2458" style="font-family: MathJax_Math-italic; padding-left: 0.251em;">a</span><span class="msubsup" id="MathJax-Span-2459"><span style="display: inline-block; position: relative; width: 0.81em; height: 0px;"><span style="position: absolute; clip: rect(3.043em, 1000.31em, 4.408em, -999.997em); top: -3.967em; left: 0em;"><span class="mo" id="MathJax-Span-2460" style="font-family: MathJax_Main;">)</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -4.339em; left: 0.375em;"><span class="mn" id="MathJax-Span-2461" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="mo" id="MathJax-Span-2462" style="font-family: MathJax_Main; padding-left: 0.251em;">+</span><span class="mo" id="MathJax-Span-2463" style="font-family: MathJax_Main; padding-left: 0.251em;">…</span></span><span style="display: inline-block; width: 0px; height: 2.36em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.535em; border-left: 0px solid; width: 0px; height: 2.081em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>f</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><msub><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><mrow class="MJX-TeXAtom-ORD"><mi>x</mi><mo>=</mo><mi>a</mi></mrow></msub><mo>=</mo><mi>f</mi><mo stretchy="false">(</mo><mi>a</mi><mo stretchy="false">)</mo><mo>+</mo><msup><mi>f</mi><mo>′</mo></msup><mo stretchy="false">(</mo><mi>a</mi><mo stretchy="false">)</mo><mo stretchy="false">(</mo><mi>x</mi><mo>−</mo><mi>a</mi><mo stretchy="false">)</mo><mo>+</mo><mfrac><mrow><mi>f</mi><mo>”</mo><mo stretchy="false">(</mo><mi>a</mi><mo stretchy="false">)</mo></mrow><mn>2</mn></mfrac><mo stretchy="false">(</mo><mi>x</mi><mo>−</mo><mi>a</mi><msup><mo stretchy="false">)</mo><mn>2</mn></msup><mo>+</mo><mo>…</mo></math></span></span><script type="math/tex" id="MathJax-Element-55">f(x)|_{x=a} = f(a) + f'(a)(x-a) + \frac{f”(a)}{2}(x-a)^2 + …</script></p>
<p>where <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-56-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;f&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2464" style="width: 2.422em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.926em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(1.43em, 1001.8em, 2.795em, -999.997em); top: -2.354em; left: 0em;"><span class="mrow" id="MathJax-Span-2465"><span class="mi" id="MathJax-Span-2466" style="font-family: MathJax_Math-italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.065em;"></span></span><span class="mo" id="MathJax-Span-2467" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-2468" style="font-family: MathJax_Math-italic;">x</span><span class="mo" id="MathJax-Span-2469" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.36em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.381em; border-left: 0px solid; width: 0px; height: 1.388em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>f</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-56">f(x)</script> is a non-linear function in <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-57-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2470" style="width: 0.685em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.561em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(1.74em, 1000.5em, 2.547em, -999.997em); top: -2.354em; left: 0em;"><span class="mrow" id="MathJax-Span-2471"><span class="mi" id="MathJax-Span-2472" style="font-family: MathJax_Math-italic;">x</span></span><span style="display: inline-block; width: 0px; height: 2.36em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.073em; border-left: 0px solid; width: 0px; height: 0.696em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>x</mi></math></span></span><script type="math/tex" id="MathJax-Element-57">x</script>.</p>
<p>Applying the above to our non-linear function, we will get the following equation.</p>
<p><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-58-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;h&lt;/mi&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;msub&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;|&lt;/mo&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;msub&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;h&lt;/mi&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;msubsup&gt;&lt;mi&gt;h&lt;/mi&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mo&gt;&amp;#x2032;&lt;/mo&gt;&lt;/msubsup&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;&amp;#x2013;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mo&gt;&amp;#x2026;&lt;/mo&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2473" style="width: 27.236em; display: inline-block;"><span style="display: inline-block; position: relative; width: 21.963em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(1.43em, 1021.9em, 3.043em, -999.997em); top: -2.354em; left: 0em;"><span class="mrow" id="MathJax-Span-2474"><span class="msubsup" id="MathJax-Span-2475"><span style="display: inline-block; position: relative; width: 1.058em; height: 0px;"><span style="position: absolute; clip: rect(3.105em, 1000.56em, 4.159em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-2476" style="font-family: MathJax_Math-italic;">h</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.561em;"><span class="mi" id="MathJax-Span-2477" style="font-size: 70.7%; font-family: MathJax_Math-italic;">a</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="mo" id="MathJax-Span-2478" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-2479"><span style="display: inline-block; position: relative; width: 0.872em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.44em, 4.346em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-2480" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.437em;"><span class="mi" id="MathJax-Span-2481" style="font-size: 70.7%; font-family: MathJax_Math-italic;">k</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="mo" id="MathJax-Span-2482" style="font-family: MathJax_Main;">)</span><span class="msubsup" id="MathJax-Span-2483"><span style="display: inline-block; position: relative; width: 2.795em; height: 0px;"><span style="position: absolute; clip: rect(3.043em, 1000.19em, 4.408em, -999.997em); top: -3.967em; left: 0em;"><span class="texatom" id="MathJax-Span-2484"><span class="mrow" id="MathJax-Span-2485"><span class="mo" id="MathJax-Span-2486" style="font-family: MathJax_Main;">|</span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.657em; left: 0.251em;"><span class="texatom" id="MathJax-Span-2487"><span class="mrow" id="MathJax-Span-2488"><span class="msubsup" id="MathJax-Span-2489"><span style="display: inline-block; position: relative; width: 0.623em; height: 0px;"><span style="position: absolute; clip: rect(3.477em, 1000.31em, 4.283em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-2490" style="font-size: 70.7%; font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.781em; left: 0.313em;"><span class="mi" id="MathJax-Span-2491" style="font-size: 50%; font-family: MathJax_Math-italic;">k</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="mo" id="MathJax-Span-2492" style="font-size: 70.7%; font-family: MathJax_Main;">=</span><span class="msubsup" id="MathJax-Span-2493"><span style="display: inline-block; position: relative; width: 1.244em; height: 0px;"><span style="position: absolute; clip: rect(3.477em, 1000.31em, 4.283em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-2494" style="font-size: 70.7%; font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.781em; left: 0.313em;"><span class="texatom" id="MathJax-Span-2495"><span class="mrow" id="MathJax-Span-2496"><span class="mi" id="MathJax-Span-2497" style="font-size: 50%; font-family: MathJax_Math-italic;">k</span><span class="mo" id="MathJax-Span-2498" style="font-size: 50%; font-family: MathJax_Main;">−</span><span class="mn" id="MathJax-Span-2499" style="font-size: 50%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="mo" id="MathJax-Span-2500" style="font-family: MathJax_Main; padding-left: 0.251em;">=</span><span class="msubsup" id="MathJax-Span-2501" style="padding-left: 0.251em;"><span style="display: inline-block; position: relative; width: 1.058em; height: 0px;"><span style="position: absolute; clip: rect(3.105em, 1000.56em, 4.159em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-2502" style="font-family: MathJax_Math-italic;">h</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.561em;"><span class="mi" id="MathJax-Span-2503" style="font-size: 70.7%; font-family: MathJax_Math-italic;">a</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="mo" id="MathJax-Span-2504" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-2505"><span style="display: inline-block; position: relative; width: 1.802em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.44em, 4.346em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-2506" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.437em;"><span class="texatom" id="MathJax-Span-2507"><span class="mrow" id="MathJax-Span-2508"><span class="mi" id="MathJax-Span-2509" style="font-size: 70.7%; font-family: MathJax_Math-italic;">k</span><span class="mo" id="MathJax-Span-2510" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="mn" id="MathJax-Span-2511" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="mo" id="MathJax-Span-2512" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-2513" style="font-family: MathJax_Main; padding-left: 0.251em;">+</span><span class="msubsup" id="MathJax-Span-2514" style="padding-left: 0.251em;"><span style="display: inline-block; position: relative; width: 1.058em; height: 0px;"><span style="position: absolute; clip: rect(3.105em, 1000.56em, 4.159em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-2515" style="font-family: MathJax_Math-italic;">h</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.415em, 1000.25em, 4.159em, -999.997em); top: -4.277em; left: 0.561em;"><span class="mo" id="MathJax-Span-2516" style="font-size: 70.7%; font-family: MathJax_Main;">′</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.477em, 1000.44em, 4.159em, -999.997em); top: -3.843em; left: 0.561em;"><span class="mi" id="MathJax-Span-2517" style="font-size: 70.7%; font-family: MathJax_Math-italic;">a</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="mo" id="MathJax-Span-2518" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-2519"><span style="display: inline-block; position: relative; width: 1.802em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.44em, 4.346em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-2520" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.437em;"><span class="texatom" id="MathJax-Span-2521"><span class="mrow" id="MathJax-Span-2522"><span class="mi" id="MathJax-Span-2523" style="font-size: 70.7%; font-family: MathJax_Math-italic;">k</span><span class="mo" id="MathJax-Span-2524" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="mn" id="MathJax-Span-2525" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="mo" id="MathJax-Span-2526" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-2527" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-2528"><span style="display: inline-block; position: relative; width: 0.872em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.44em, 4.346em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-2529" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.437em;"><span class="mi" id="MathJax-Span-2530" style="font-size: 70.7%; font-family: MathJax_Math-italic;">k</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="mo" id="MathJax-Span-2531" style="font-family: MathJax_Main;">–</span><span class="msubsup" id="MathJax-Span-2532" style="padding-left: 0.189em;"><span style="display: inline-block; position: relative; width: 1.802em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.44em, 4.346em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-2533" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.437em;"><span class="texatom" id="MathJax-Span-2534"><span class="mrow" id="MathJax-Span-2535"><span class="mi" id="MathJax-Span-2536" style="font-size: 70.7%; font-family: MathJax_Math-italic;">k</span><span class="mo" id="MathJax-Span-2537" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="mn" id="MathJax-Span-2538" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="mo" id="MathJax-Span-2539" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-2540" style="font-family: MathJax_Main; padding-left: 0.251em;">+</span><span class="mo" id="MathJax-Span-2541" style="font-family: MathJax_Main; padding-left: 0.251em;">…</span></span><span style="display: inline-block; width: 0px; height: 2.36em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.688em; border-left: 0px solid; width: 0px; height: 1.696em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>h</mi><mi>a</mi></msub><mo stretchy="false">(</mo><msub><mi>q</mi><mi>k</mi></msub><mo stretchy="false">)</mo><msub><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><mrow class="MJX-TeXAtom-ORD"><msub><mi>q</mi><mi>k</mi></msub><mo>=</mo><msub><mi>q</mi><mrow class="MJX-TeXAtom-ORD"><mi>k</mi><mo>−</mo><mn>1</mn></mrow></msub></mrow></msub><mo>=</mo><msub><mi>h</mi><mi>a</mi></msub><mo stretchy="false">(</mo><msub><mi>q</mi><mrow class="MJX-TeXAtom-ORD"><mi>k</mi><mo>−</mo><mn>1</mn></mrow></msub><mo stretchy="false">)</mo><mo>+</mo><msubsup><mi>h</mi><mi>a</mi><mo>′</mo></msubsup><mo stretchy="false">(</mo><msub><mi>q</mi><mrow class="MJX-TeXAtom-ORD"><mi>k</mi><mo>−</mo><mn>1</mn></mrow></msub><mo stretchy="false">)</mo><mo stretchy="false">(</mo><msub><mi>q</mi><mi>k</mi></msub><mo>–</mo><msub><mi>q</mi><mrow class="MJX-TeXAtom-ORD"><mi>k</mi><mo>−</mo><mn>1</mn></mrow></msub><mo stretchy="false">)</mo><mo>+</mo><mo>…</mo></math></span></span><script type="math/tex" id="MathJax-Element-58">h_a(q_k)|_{q_k=q_{k-1}} = h_a(q_{k-1}) + h’_a(q_{k-1})(q_k – q_{k-1}) + …</script>&nbsp; &nbsp; &nbsp;——————–&nbsp; &nbsp; &nbsp;(12)</p>
<p>where</p>
<p><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-59-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msubsup&gt;&lt;mi&gt;h&lt;/mi&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mo&gt;&amp;#x2032;&lt;/mo&gt;&lt;/msubsup&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mstyle mathsize=&quot;1.44em&quot;&gt;&lt;msub&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mfrac&gt;&lt;mrow&gt;&lt;mi&gt;&amp;#x03B4;&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;msub&gt;&lt;mi&gt;h&lt;/mi&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;/mrow&gt;&lt;mrow&gt;&lt;mi&gt;&amp;#x03B4;&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;/mrow&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;msub&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;|&lt;/mo&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mrow&gt;&lt;mo&gt;[&lt;/mo&gt;&lt;mtable rowspacing=&quot;4pt&quot; columnspacing=&quot;1em&quot;&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mfrac&gt;&lt;mrow&gt;&lt;mi&gt;&amp;#x03B4;&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;msub&gt;&lt;mi&gt;h&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;/mrow&gt;&lt;mrow&gt;&lt;mi&gt;&amp;#x03B4;&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;msub&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mfrac&gt;&lt;mrow&gt;&lt;mi&gt;&amp;#x03B4;&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;msub&gt;&lt;mi&gt;h&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;/mrow&gt;&lt;mrow&gt;&lt;mi&gt;&amp;#x03B4;&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;msub&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mfrac&gt;&lt;mrow&gt;&lt;mi&gt;&amp;#x03B4;&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;msub&gt;&lt;mi&gt;h&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;/mrow&gt;&lt;mrow&gt;&lt;mi&gt;&amp;#x03B4;&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;msub&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mfrac&gt;&lt;mrow&gt;&lt;mi&gt;&amp;#x03B4;&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;msub&gt;&lt;mi&gt;h&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;/mrow&gt;&lt;mrow&gt;&lt;mi&gt;&amp;#x03B4;&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;msub&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mn&gt;3&lt;/mn&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mfrac&gt;&lt;mrow&gt;&lt;mi&gt;&amp;#x03B4;&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;msub&gt;&lt;mi&gt;h&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;/mrow&gt;&lt;mrow&gt;&lt;mi&gt;&amp;#x03B4;&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;msub&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mfrac&gt;&lt;mrow&gt;&lt;mi&gt;&amp;#x03B4;&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;msub&gt;&lt;mi&gt;h&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;/mrow&gt;&lt;mrow&gt;&lt;mi&gt;&amp;#x03B4;&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;msub&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mfrac&gt;&lt;mrow&gt;&lt;mi&gt;&amp;#x03B4;&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;msub&gt;&lt;mi&gt;h&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;/mrow&gt;&lt;mrow&gt;&lt;mi&gt;&amp;#x03B4;&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;msub&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mfrac&gt;&lt;mrow&gt;&lt;mi&gt;&amp;#x03B4;&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;msub&gt;&lt;mi&gt;h&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;/mrow&gt;&lt;mrow&gt;&lt;mi&gt;&amp;#x03B4;&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;msub&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mn&gt;3&lt;/mn&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mfrac&gt;&lt;mrow&gt;&lt;mi&gt;&amp;#x03B4;&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;msub&gt;&lt;mi&gt;h&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mn&gt;3&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;/mrow&gt;&lt;mrow&gt;&lt;mi&gt;&amp;#x03B4;&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;msub&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mfrac&gt;&lt;mrow&gt;&lt;mi&gt;&amp;#x03B4;&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;msub&gt;&lt;mi&gt;h&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mn&gt;3&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;/mrow&gt;&lt;mrow&gt;&lt;mi&gt;&amp;#x03B4;&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;msub&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mfrac&gt;&lt;mrow&gt;&lt;mi&gt;&amp;#x03B4;&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;msub&gt;&lt;mi&gt;h&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mn&gt;3&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;/mrow&gt;&lt;mrow&gt;&lt;mi&gt;&amp;#x03B4;&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;msub&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mfrac&gt;&lt;mrow&gt;&lt;mi&gt;&amp;#x03B4;&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;msub&gt;&lt;mi&gt;h&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mn&gt;3&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;/mrow&gt;&lt;mrow&gt;&lt;mi&gt;&amp;#x03B4;&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;msub&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mn&gt;3&lt;/mn&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;/mtable&gt;&lt;mo&gt;]&lt;/mo&gt;&lt;/mrow&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mstyle&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2542" style="width: 37.782em; display: inline-block;"><span style="display: inline-block; position: relative; width: 30.462em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(-1.982em, 1030.46em, 6.145em, -999.997em); top: -2.354em; left: 0em;"><span class="mrow" id="MathJax-Span-2543"><span class="msubsup" id="MathJax-Span-2544"><span style="display: inline-block; position: relative; width: 1.058em; height: 0px;"><span style="position: absolute; clip: rect(3.105em, 1000.56em, 4.159em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-2545" style="font-family: MathJax_Math-italic;">h</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.415em, 1000.25em, 4.159em, -999.997em); top: -4.277em; left: 0.561em;"><span class="mo" id="MathJax-Span-2546" style="font-size: 70.7%; font-family: MathJax_Main;">′</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.477em, 1000.44em, 4.159em, -999.997em); top: -3.843em; left: 0.561em;"><span class="mi" id="MathJax-Span-2547" style="font-size: 70.7%; font-family: MathJax_Math-italic;">a</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="mo" id="MathJax-Span-2548" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-2549"><span style="display: inline-block; position: relative; width: 1.802em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.44em, 4.346em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-2550" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.437em;"><span class="texatom" id="MathJax-Span-2551"><span class="mrow" id="MathJax-Span-2552"><span class="mi" id="MathJax-Span-2553" style="font-size: 70.7%; font-family: MathJax_Math-italic;">k</span><span class="mo" id="MathJax-Span-2554" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="mn" id="MathJax-Span-2555" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="mo" id="MathJax-Span-2556" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-2557" style="font-family: MathJax_Main; padding-left: 0.251em;">=</span><span class="mstyle" id="MathJax-Span-2558" style="padding-left: 0.251em;"><span class="mrow" id="MathJax-Span-2559"><span class="msubsup" id="MathJax-Span-2560"><span style="display: inline-block; position: relative; width: 25.499em; height: 0px;"><span style="position: absolute; clip: rect(4.283em, 1023.08em, 12.286em, -999.997em); top: -8.62em; left: 0em;"><span class="texatom" id="MathJax-Span-2561"><span class="mrow" id="MathJax-Span-2562"><span class="mfrac" id="MathJax-Span-2563"><span style="display: inline-block; position: relative; width: 2.919em; height: 0px; margin-right: 0.189em; margin-left: 0.189em;"><span style="position: absolute; clip: rect(3.043em, 1002.67em, 4.408em, -999.997em); top: -4.774em; left: 50%; margin-left: -1.362em;"><span class="mrow" id="MathJax-Span-2564"><span class="mi" id="MathJax-Span-2565" style="font-size: 101.8%; font-family: MathJax_Math-italic;">δ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="texatom" id="MathJax-Span-2566"><span class="mrow" id="MathJax-Span-2567"><span class="msubsup" id="MathJax-Span-2568"><span style="display: inline-block; position: relative; width: 1.058em; height: 0px;"><span style="position: absolute; clip: rect(3.105em, 1000.56em, 4.159em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-2569" style="font-size: 101.8%; font-family: MathJax_Math-italic;">h</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.561em;"><span class="mi" id="MathJax-Span-2570" style="font-size: 72%; font-family: MathJax_Math-italic;">a</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="mo" id="MathJax-Span-2571" style="font-size: 101.8%; font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-2572" style="font-size: 101.8%; font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-2573" style="font-size: 101.8%; font-family: MathJax_Main;">)</span></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.043em, 1000.93em, 4.346em, -999.997em); top: -3.409em; left: 50%; margin-left: -0.431em;"><span class="mrow" id="MathJax-Span-2574"><span class="mi" id="MathJax-Span-2575" style="font-size: 101.8%; font-family: MathJax_Math-italic;">δ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="texatom" id="MathJax-Span-2576"><span class="mrow" id="MathJax-Span-2577"><span class="mi" id="MathJax-Span-2578" style="font-size: 101.8%; font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(0.872em, 1002.92em, 1.306em, -999.997em); top: -1.424em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.4px solid; width: 2.919em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.12em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-2579"><span style="display: inline-block; position: relative; width: 3.601em; height: 0px;"><span style="position: absolute; clip: rect(2.733em, 1000.25em, 4.532em, -999.997em); top: -3.967em; left: 0em;"><span class="texatom" id="MathJax-Span-2580"><span class="mrow" id="MathJax-Span-2581"><span class="mo" id="MathJax-Span-2582" style="font-size: 144%; font-family: MathJax_Main;">|</span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.533em; left: 0.375em;"><span class="texatom" id="MathJax-Span-2583"><span class="mrow" id="MathJax-Span-2584"><span class="mi" id="MathJax-Span-2585" style="font-size: 101.8%; font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-2586" style="font-size: 101.8%; font-family: MathJax_Main;">=</span><span class="msubsup" id="MathJax-Span-2587"><span style="display: inline-block; position: relative; width: 1.802em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.5em, 4.346em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-2588" style="font-size: 101.8%; font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.719em; left: 0.437em;"><span class="texatom" id="MathJax-Span-2589"><span class="mrow" id="MathJax-Span-2590"><span class="mi" id="MathJax-Span-2591" style="font-size: 72%; font-family: MathJax_Math-italic;">k</span><span class="mo" id="MathJax-Span-2592" style="font-size: 72%; font-family: MathJax_Main;">−</span><span class="mn" id="MathJax-Span-2593" style="font-size: 72%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="mo" id="MathJax-Span-2594" style="font-size: 144%; font-family: MathJax_Main; padding-left: 0.251em;">=</span><span class="mrow" id="MathJax-Span-2595" style="padding-left: 0.375em;"><span class="mo" id="MathJax-Span-2596" style="vertical-align: 4.159em;"><span style="display: inline-block; position: relative; width: 0.934em; height: 0px;"><span style="position: absolute; top: -2.292em; left: 0em;"><span style="font-size: 144%; font-family: MathJax_Size4;">⎡</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: 2.733em; left: 0em;"><span style="font-size: 144%; font-family: MathJax_Size4;">⎣</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -0.741em; left: 0em;"><span style="font-size: 144%; font-family: MathJax_Size4;">⎢</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -0.059em; left: 0em;"><span style="font-size: 144%; font-family: MathJax_Size4;">⎢</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: 0.623em; left: 0em;"><span style="font-size: 144%; font-family: MathJax_Size4;">⎢</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: 1.306em; left: 0em;"><span style="font-size: 144%; font-family: MathJax_Size4;">⎢</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="mtable" id="MathJax-Span-2597" style="padding-right: 0.189em; padding-left: 0.189em;"><span style="display: inline-block; position: relative; width: 12.534em; height: 0px;"><span style="position: absolute; clip: rect(4.283em, 1002.36em, 12.286em, -999.997em); top: -8.62em; left: 0em;"><span style="display: inline-block; position: relative; width: 2.36em; height: 0px;"><span style="position: absolute; clip: rect(2.36em, 1002.36em, 4.966em, -999.997em); top: -6.697em; left: 50%; margin-left: -1.176em;"><span class="mtd" id="MathJax-Span-2598"><span class="mrow" id="MathJax-Span-2599"><span class="mfrac" id="MathJax-Span-2600"><span style="display: inline-block; position: relative; width: 2.05em; height: 0px; margin-right: 0.189em; margin-left: 0.189em;"><span style="position: absolute; clip: rect(3.043em, 1001.86em, 4.346em, -999.997em); top: -4.712em; left: 50%; margin-left: -0.927em;"><span class="mrow" id="MathJax-Span-2601"><span class="mi" id="MathJax-Span-2602" style="font-size: 101.8%; font-family: MathJax_Math-italic;">δ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="texatom" id="MathJax-Span-2603"><span class="mrow" id="MathJax-Span-2604"><span class="msubsup" id="MathJax-Span-2605"><span style="display: inline-block; position: relative; width: 1.43em; height: 0px;"><span style="position: absolute; clip: rect(3.105em, 1000.56em, 4.159em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-2606" style="font-size: 101.8%; font-family: MathJax_Math-italic;">h</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.561em;"><span class="texatom" id="MathJax-Span-2607"><span class="mrow" id="MathJax-Span-2608"><span class="mi" id="MathJax-Span-2609" style="font-size: 72%; font-family: MathJax_Math-italic;">a</span><span class="mn" id="MathJax-Span-2610" style="font-size: 72%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.043em, 1001.37em, 4.408em, -999.997em); top: -3.409em; left: 50%; margin-left: -0.679em;"><span class="mrow" id="MathJax-Span-2611"><span class="mi" id="MathJax-Span-2612" style="font-size: 101.8%; font-family: MathJax_Math-italic;">δ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="texatom" id="MathJax-Span-2613"><span class="mrow" id="MathJax-Span-2614"><span class="msubsup" id="MathJax-Span-2615"><span style="display: inline-block; position: relative; width: 0.872em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.5em, 4.346em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-2616" style="font-size: 101.8%; font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.719em; left: 0.437em;"><span class="mn" id="MathJax-Span-2617" style="font-size: 72%; font-family: MathJax_Main;">0</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(0.872em, 1002.05em, 1.306em, -999.997em); top: -1.424em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.4px solid; width: 2.05em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.12em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(2.36em, 1002.36em, 4.966em, -999.997em); top: -4.029em; left: 50%; margin-left: -1.176em;"><span class="mtd" id="MathJax-Span-2678"><span class="mrow" id="MathJax-Span-2679"><span class="mfrac" id="MathJax-Span-2680"><span style="display: inline-block; position: relative; width: 2.05em; height: 0px; margin-right: 0.189em; margin-left: 0.189em;"><span style="position: absolute; clip: rect(3.043em, 1001.86em, 4.346em, -999.997em); top: -4.712em; left: 50%; margin-left: -0.927em;"><span class="mrow" id="MathJax-Span-2681"><span class="mi" id="MathJax-Span-2682" style="font-size: 101.8%; font-family: MathJax_Math-italic;">δ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="texatom" id="MathJax-Span-2683"><span class="mrow" id="MathJax-Span-2684"><span class="msubsup" id="MathJax-Span-2685"><span style="display: inline-block; position: relative; width: 1.43em; height: 0px;"><span style="position: absolute; clip: rect(3.105em, 1000.56em, 4.159em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-2686" style="font-size: 101.8%; font-family: MathJax_Math-italic;">h</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.561em;"><span class="texatom" id="MathJax-Span-2687"><span class="mrow" id="MathJax-Span-2688"><span class="mi" id="MathJax-Span-2689" style="font-size: 72%; font-family: MathJax_Math-italic;">a</span><span class="mn" id="MathJax-Span-2690" style="font-size: 72%; font-family: MathJax_Main;">2</span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.043em, 1001.37em, 4.408em, -999.997em); top: -3.409em; left: 50%; margin-left: -0.679em;"><span class="mrow" id="MathJax-Span-2691"><span class="mi" id="MathJax-Span-2692" style="font-size: 101.8%; font-family: MathJax_Math-italic;">δ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="texatom" id="MathJax-Span-2693"><span class="mrow" id="MathJax-Span-2694"><span class="msubsup" id="MathJax-Span-2695"><span style="display: inline-block; position: relative; width: 0.872em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.5em, 4.346em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-2696" style="font-size: 101.8%; font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.719em; left: 0.437em;"><span class="mn" id="MathJax-Span-2697" style="font-size: 72%; font-family: MathJax_Main;">0</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(0.872em, 1002.05em, 1.306em, -999.997em); top: -1.424em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.4px solid; width: 2.05em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.12em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(2.298em, 1002.36em, 4.966em, -999.997em); top: -1.362em; left: 50%; margin-left: -1.176em;"><span class="mtd" id="MathJax-Span-2758"><span class="mrow" id="MathJax-Span-2759"><span class="mfrac" id="MathJax-Span-2760"><span style="display: inline-block; position: relative; width: 2.05em; height: 0px; margin-right: 0.189em; margin-left: 0.189em;"><span style="position: absolute; clip: rect(3.043em, 1001.86em, 4.346em, -999.997em); top: -4.712em; left: 50%; margin-left: -0.927em;"><span class="mrow" id="MathJax-Span-2761"><span class="mi" id="MathJax-Span-2762" style="font-size: 101.8%; font-family: MathJax_Math-italic;">δ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="texatom" id="MathJax-Span-2763"><span class="mrow" id="MathJax-Span-2764"><span class="msubsup" id="MathJax-Span-2765"><span style="display: inline-block; position: relative; width: 1.43em; height: 0px;"><span style="position: absolute; clip: rect(3.105em, 1000.56em, 4.159em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-2766" style="font-size: 101.8%; font-family: MathJax_Math-italic;">h</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.561em;"><span class="texatom" id="MathJax-Span-2767"><span class="mrow" id="MathJax-Span-2768"><span class="mi" id="MathJax-Span-2769" style="font-size: 72%; font-family: MathJax_Math-italic;">a</span><span class="mn" id="MathJax-Span-2770" style="font-size: 72%; font-family: MathJax_Main;">3</span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.043em, 1001.37em, 4.408em, -999.997em); top: -3.409em; left: 50%; margin-left: -0.679em;"><span class="mrow" id="MathJax-Span-2771"><span class="mi" id="MathJax-Span-2772" style="font-size: 101.8%; font-family: MathJax_Math-italic;">δ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="texatom" id="MathJax-Span-2773"><span class="mrow" id="MathJax-Span-2774"><span class="msubsup" id="MathJax-Span-2775"><span style="display: inline-block; position: relative; width: 0.872em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.5em, 4.346em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-2776" style="font-size: 101.8%; font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.719em; left: 0.437em;"><span class="mn" id="MathJax-Span-2777" style="font-size: 72%; font-family: MathJax_Main;">0</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(0.872em, 1002.05em, 1.306em, -999.997em); top: -1.424em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.4px solid; width: 2.05em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.12em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span><span style="display: inline-block; width: 0px; height: 8.626em;"></span></span><span style="position: absolute; clip: rect(4.283em, 1002.36em, 12.224em, -999.997em); top: -8.62em; left: 3.415em;"><span style="display: inline-block; position: relative; width: 2.36em; height: 0px;"><span style="position: absolute; clip: rect(2.36em, 1002.36em, 4.966em, -999.997em); top: -6.697em; left: 50%; margin-left: -1.176em;"><span class="mtd" id="MathJax-Span-2618"><span class="mrow" id="MathJax-Span-2619"><span class="mfrac" id="MathJax-Span-2620"><span style="display: inline-block; position: relative; width: 2.05em; height: 0px; margin-right: 0.189em; margin-left: 0.189em;"><span style="position: absolute; clip: rect(3.043em, 1001.86em, 4.346em, -999.997em); top: -4.712em; left: 50%; margin-left: -0.927em;"><span class="mrow" id="MathJax-Span-2621"><span class="mi" id="MathJax-Span-2622" style="font-size: 101.8%; font-family: MathJax_Math-italic;">δ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="texatom" id="MathJax-Span-2623"><span class="mrow" id="MathJax-Span-2624"><span class="msubsup" id="MathJax-Span-2625"><span style="display: inline-block; position: relative; width: 1.43em; height: 0px;"><span style="position: absolute; clip: rect(3.105em, 1000.56em, 4.159em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-2626" style="font-size: 101.8%; font-family: MathJax_Math-italic;">h</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.561em;"><span class="texatom" id="MathJax-Span-2627"><span class="mrow" id="MathJax-Span-2628"><span class="mi" id="MathJax-Span-2629" style="font-size: 72%; font-family: MathJax_Math-italic;">a</span><span class="mn" id="MathJax-Span-2630" style="font-size: 72%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.043em, 1001.37em, 4.408em, -999.997em); top: -3.409em; left: 50%; margin-left: -0.679em;"><span class="mrow" id="MathJax-Span-2631"><span class="mi" id="MathJax-Span-2632" style="font-size: 101.8%; font-family: MathJax_Math-italic;">δ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="texatom" id="MathJax-Span-2633"><span class="mrow" id="MathJax-Span-2634"><span class="msubsup" id="MathJax-Span-2635"><span style="display: inline-block; position: relative; width: 0.872em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.5em, 4.346em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-2636" style="font-size: 101.8%; font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.719em; left: 0.437em;"><span class="mn" id="MathJax-Span-2637" style="font-size: 72%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(0.872em, 1002.05em, 1.306em, -999.997em); top: -1.424em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.4px solid; width: 2.05em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.12em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(2.36em, 1002.36em, 4.966em, -999.997em); top: -4.029em; left: 50%; margin-left: -1.176em;"><span class="mtd" id="MathJax-Span-2698"><span class="mrow" id="MathJax-Span-2699"><span class="mfrac" id="MathJax-Span-2700"><span style="display: inline-block; position: relative; width: 2.05em; height: 0px; margin-right: 0.189em; margin-left: 0.189em;"><span style="position: absolute; clip: rect(3.043em, 1001.86em, 4.346em, -999.997em); top: -4.712em; left: 50%; margin-left: -0.927em;"><span class="mrow" id="MathJax-Span-2701"><span class="mi" id="MathJax-Span-2702" style="font-size: 101.8%; font-family: MathJax_Math-italic;">δ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="texatom" id="MathJax-Span-2703"><span class="mrow" id="MathJax-Span-2704"><span class="msubsup" id="MathJax-Span-2705"><span style="display: inline-block; position: relative; width: 1.43em; height: 0px;"><span style="position: absolute; clip: rect(3.105em, 1000.56em, 4.159em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-2706" style="font-size: 101.8%; font-family: MathJax_Math-italic;">h</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.561em;"><span class="texatom" id="MathJax-Span-2707"><span class="mrow" id="MathJax-Span-2708"><span class="mi" id="MathJax-Span-2709" style="font-size: 72%; font-family: MathJax_Math-italic;">a</span><span class="mn" id="MathJax-Span-2710" style="font-size: 72%; font-family: MathJax_Main;">2</span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.043em, 1001.37em, 4.408em, -999.997em); top: -3.409em; left: 50%; margin-left: -0.679em;"><span class="mrow" id="MathJax-Span-2711"><span class="mi" id="MathJax-Span-2712" style="font-size: 101.8%; font-family: MathJax_Math-italic;">δ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="texatom" id="MathJax-Span-2713"><span class="mrow" id="MathJax-Span-2714"><span class="msubsup" id="MathJax-Span-2715"><span style="display: inline-block; position: relative; width: 0.872em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.5em, 4.346em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-2716" style="font-size: 101.8%; font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.719em; left: 0.437em;"><span class="mn" id="MathJax-Span-2717" style="font-size: 72%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(0.872em, 1002.05em, 1.306em, -999.997em); top: -1.424em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.4px solid; width: 2.05em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.12em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(2.298em, 1002.36em, 4.966em, -999.997em); top: -1.362em; left: 50%; margin-left: -1.176em;"><span class="mtd" id="MathJax-Span-2778"><span class="mrow" id="MathJax-Span-2779"><span class="mfrac" id="MathJax-Span-2780"><span style="display: inline-block; position: relative; width: 2.05em; height: 0px; margin-right: 0.189em; margin-left: 0.189em;"><span style="position: absolute; clip: rect(3.043em, 1001.86em, 4.346em, -999.997em); top: -4.712em; left: 50%; margin-left: -0.927em;"><span class="mrow" id="MathJax-Span-2781"><span class="mi" id="MathJax-Span-2782" style="font-size: 101.8%; font-family: MathJax_Math-italic;">δ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="texatom" id="MathJax-Span-2783"><span class="mrow" id="MathJax-Span-2784"><span class="msubsup" id="MathJax-Span-2785"><span style="display: inline-block; position: relative; width: 1.43em; height: 0px;"><span style="position: absolute; clip: rect(3.105em, 1000.56em, 4.159em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-2786" style="font-size: 101.8%; font-family: MathJax_Math-italic;">h</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.561em;"><span class="texatom" id="MathJax-Span-2787"><span class="mrow" id="MathJax-Span-2788"><span class="mi" id="MathJax-Span-2789" style="font-size: 72%; font-family: MathJax_Math-italic;">a</span><span class="mn" id="MathJax-Span-2790" style="font-size: 72%; font-family: MathJax_Main;">3</span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.043em, 1001.37em, 4.408em, -999.997em); top: -3.409em; left: 50%; margin-left: -0.679em;"><span class="mrow" id="MathJax-Span-2791"><span class="mi" id="MathJax-Span-2792" style="font-size: 101.8%; font-family: MathJax_Math-italic;">δ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="texatom" id="MathJax-Span-2793"><span class="mrow" id="MathJax-Span-2794"><span class="msubsup" id="MathJax-Span-2795"><span style="display: inline-block; position: relative; width: 0.872em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.5em, 4.346em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-2796" style="font-size: 101.8%; font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.719em; left: 0.437em;"><span class="mn" id="MathJax-Span-2797" style="font-size: 72%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(0.872em, 1002.05em, 1.306em, -999.997em); top: -1.424em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.4px solid; width: 2.05em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.12em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span><span style="display: inline-block; width: 0px; height: 8.626em;"></span></span><span style="position: absolute; clip: rect(4.283em, 1002.36em, 12.224em, -999.997em); top: -8.62em; left: 6.765em;"><span style="display: inline-block; position: relative; width: 2.36em; height: 0px;"><span style="position: absolute; clip: rect(2.36em, 1002.36em, 4.966em, -999.997em); top: -6.697em; left: 50%; margin-left: -1.176em;"><span class="mtd" id="MathJax-Span-2638"><span class="mrow" id="MathJax-Span-2639"><span class="mfrac" id="MathJax-Span-2640"><span style="display: inline-block; position: relative; width: 2.05em; height: 0px; margin-right: 0.189em; margin-left: 0.189em;"><span style="position: absolute; clip: rect(3.043em, 1001.86em, 4.346em, -999.997em); top: -4.712em; left: 50%; margin-left: -0.927em;"><span class="mrow" id="MathJax-Span-2641"><span class="mi" id="MathJax-Span-2642" style="font-size: 101.8%; font-family: MathJax_Math-italic;">δ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="texatom" id="MathJax-Span-2643"><span class="mrow" id="MathJax-Span-2644"><span class="msubsup" id="MathJax-Span-2645"><span style="display: inline-block; position: relative; width: 1.43em; height: 0px;"><span style="position: absolute; clip: rect(3.105em, 1000.56em, 4.159em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-2646" style="font-size: 101.8%; font-family: MathJax_Math-italic;">h</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.561em;"><span class="texatom" id="MathJax-Span-2647"><span class="mrow" id="MathJax-Span-2648"><span class="mi" id="MathJax-Span-2649" style="font-size: 72%; font-family: MathJax_Math-italic;">a</span><span class="mn" id="MathJax-Span-2650" style="font-size: 72%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.043em, 1001.37em, 4.408em, -999.997em); top: -3.409em; left: 50%; margin-left: -0.679em;"><span class="mrow" id="MathJax-Span-2651"><span class="mi" id="MathJax-Span-2652" style="font-size: 101.8%; font-family: MathJax_Math-italic;">δ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="texatom" id="MathJax-Span-2653"><span class="mrow" id="MathJax-Span-2654"><span class="msubsup" id="MathJax-Span-2655"><span style="display: inline-block; position: relative; width: 0.872em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.5em, 4.346em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-2656" style="font-size: 101.8%; font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.719em; left: 0.437em;"><span class="mn" id="MathJax-Span-2657" style="font-size: 72%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(0.872em, 1002.05em, 1.306em, -999.997em); top: -1.424em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.4px solid; width: 2.05em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.12em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(2.36em, 1002.36em, 4.966em, -999.997em); top: -4.029em; left: 50%; margin-left: -1.176em;"><span class="mtd" id="MathJax-Span-2718"><span class="mrow" id="MathJax-Span-2719"><span class="mfrac" id="MathJax-Span-2720"><span style="display: inline-block; position: relative; width: 2.05em; height: 0px; margin-right: 0.189em; margin-left: 0.189em;"><span style="position: absolute; clip: rect(3.043em, 1001.86em, 4.346em, -999.997em); top: -4.712em; left: 50%; margin-left: -0.927em;"><span class="mrow" id="MathJax-Span-2721"><span class="mi" id="MathJax-Span-2722" style="font-size: 101.8%; font-family: MathJax_Math-italic;">δ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="texatom" id="MathJax-Span-2723"><span class="mrow" id="MathJax-Span-2724"><span class="msubsup" id="MathJax-Span-2725"><span style="display: inline-block; position: relative; width: 1.43em; height: 0px;"><span style="position: absolute; clip: rect(3.105em, 1000.56em, 4.159em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-2726" style="font-size: 101.8%; font-family: MathJax_Math-italic;">h</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.561em;"><span class="texatom" id="MathJax-Span-2727"><span class="mrow" id="MathJax-Span-2728"><span class="mi" id="MathJax-Span-2729" style="font-size: 72%; font-family: MathJax_Math-italic;">a</span><span class="mn" id="MathJax-Span-2730" style="font-size: 72%; font-family: MathJax_Main;">2</span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.043em, 1001.37em, 4.408em, -999.997em); top: -3.409em; left: 50%; margin-left: -0.679em;"><span class="mrow" id="MathJax-Span-2731"><span class="mi" id="MathJax-Span-2732" style="font-size: 101.8%; font-family: MathJax_Math-italic;">δ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="texatom" id="MathJax-Span-2733"><span class="mrow" id="MathJax-Span-2734"><span class="msubsup" id="MathJax-Span-2735"><span style="display: inline-block; position: relative; width: 0.872em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.5em, 4.346em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-2736" style="font-size: 101.8%; font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.719em; left: 0.437em;"><span class="mn" id="MathJax-Span-2737" style="font-size: 72%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(0.872em, 1002.05em, 1.306em, -999.997em); top: -1.424em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.4px solid; width: 2.05em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.12em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(2.298em, 1002.36em, 4.966em, -999.997em); top: -1.362em; left: 50%; margin-left: -1.176em;"><span class="mtd" id="MathJax-Span-2798"><span class="mrow" id="MathJax-Span-2799"><span class="mfrac" id="MathJax-Span-2800"><span style="display: inline-block; position: relative; width: 2.05em; height: 0px; margin-right: 0.189em; margin-left: 0.189em;"><span style="position: absolute; clip: rect(3.043em, 1001.86em, 4.346em, -999.997em); top: -4.712em; left: 50%; margin-left: -0.927em;"><span class="mrow" id="MathJax-Span-2801"><span class="mi" id="MathJax-Span-2802" style="font-size: 101.8%; font-family: MathJax_Math-italic;">δ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="texatom" id="MathJax-Span-2803"><span class="mrow" id="MathJax-Span-2804"><span class="msubsup" id="MathJax-Span-2805"><span style="display: inline-block; position: relative; width: 1.43em; height: 0px;"><span style="position: absolute; clip: rect(3.105em, 1000.56em, 4.159em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-2806" style="font-size: 101.8%; font-family: MathJax_Math-italic;">h</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.561em;"><span class="texatom" id="MathJax-Span-2807"><span class="mrow" id="MathJax-Span-2808"><span class="mi" id="MathJax-Span-2809" style="font-size: 72%; font-family: MathJax_Math-italic;">a</span><span class="mn" id="MathJax-Span-2810" style="font-size: 72%; font-family: MathJax_Main;">3</span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.043em, 1001.37em, 4.408em, -999.997em); top: -3.409em; left: 50%; margin-left: -0.679em;"><span class="mrow" id="MathJax-Span-2811"><span class="mi" id="MathJax-Span-2812" style="font-size: 101.8%; font-family: MathJax_Math-italic;">δ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="texatom" id="MathJax-Span-2813"><span class="mrow" id="MathJax-Span-2814"><span class="msubsup" id="MathJax-Span-2815"><span style="display: inline-block; position: relative; width: 0.872em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.5em, 4.346em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-2816" style="font-size: 101.8%; font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.719em; left: 0.437em;"><span class="mn" id="MathJax-Span-2817" style="font-size: 72%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(0.872em, 1002.05em, 1.306em, -999.997em); top: -1.424em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.4px solid; width: 2.05em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.12em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span><span style="display: inline-block; width: 0px; height: 8.626em;"></span></span><span style="position: absolute; clip: rect(4.283em, 1002.36em, 12.286em, -999.997em); top: -8.62em; left: 10.177em;"><span style="display: inline-block; position: relative; width: 2.36em; height: 0px;"><span style="position: absolute; clip: rect(2.36em, 1002.36em, 4.966em, -999.997em); top: -6.697em; left: 50%; margin-left: -1.176em;"><span class="mtd" id="MathJax-Span-2658"><span class="mrow" id="MathJax-Span-2659"><span class="mfrac" id="MathJax-Span-2660"><span style="display: inline-block; position: relative; width: 2.05em; height: 0px; margin-right: 0.189em; margin-left: 0.189em;"><span style="position: absolute; clip: rect(3.043em, 1001.86em, 4.346em, -999.997em); top: -4.712em; left: 50%; margin-left: -0.927em;"><span class="mrow" id="MathJax-Span-2661"><span class="mi" id="MathJax-Span-2662" style="font-size: 101.8%; font-family: MathJax_Math-italic;">δ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="texatom" id="MathJax-Span-2663"><span class="mrow" id="MathJax-Span-2664"><span class="msubsup" id="MathJax-Span-2665"><span style="display: inline-block; position: relative; width: 1.43em; height: 0px;"><span style="position: absolute; clip: rect(3.105em, 1000.56em, 4.159em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-2666" style="font-size: 101.8%; font-family: MathJax_Math-italic;">h</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.561em;"><span class="texatom" id="MathJax-Span-2667"><span class="mrow" id="MathJax-Span-2668"><span class="mi" id="MathJax-Span-2669" style="font-size: 72%; font-family: MathJax_Math-italic;">a</span><span class="mn" id="MathJax-Span-2670" style="font-size: 72%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.043em, 1001.37em, 4.408em, -999.997em); top: -3.409em; left: 50%; margin-left: -0.679em;"><span class="mrow" id="MathJax-Span-2671"><span class="mi" id="MathJax-Span-2672" style="font-size: 101.8%; font-family: MathJax_Math-italic;">δ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="texatom" id="MathJax-Span-2673"><span class="mrow" id="MathJax-Span-2674"><span class="msubsup" id="MathJax-Span-2675"><span style="display: inline-block; position: relative; width: 0.872em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.5em, 4.346em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-2676" style="font-size: 101.8%; font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.719em; left: 0.437em;"><span class="mn" id="MathJax-Span-2677" style="font-size: 72%; font-family: MathJax_Main;">3</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(0.872em, 1002.05em, 1.306em, -999.997em); top: -1.424em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.4px solid; width: 2.05em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.12em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(2.36em, 1002.36em, 4.966em, -999.997em); top: -4.029em; left: 50%; margin-left: -1.176em;"><span class="mtd" id="MathJax-Span-2738"><span class="mrow" id="MathJax-Span-2739"><span class="mfrac" id="MathJax-Span-2740"><span style="display: inline-block; position: relative; width: 2.05em; height: 0px; margin-right: 0.189em; margin-left: 0.189em;"><span style="position: absolute; clip: rect(3.043em, 1001.86em, 4.346em, -999.997em); top: -4.712em; left: 50%; margin-left: -0.927em;"><span class="mrow" id="MathJax-Span-2741"><span class="mi" id="MathJax-Span-2742" style="font-size: 101.8%; font-family: MathJax_Math-italic;">δ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="texatom" id="MathJax-Span-2743"><span class="mrow" id="MathJax-Span-2744"><span class="msubsup" id="MathJax-Span-2745"><span style="display: inline-block; position: relative; width: 1.43em; height: 0px;"><span style="position: absolute; clip: rect(3.105em, 1000.56em, 4.159em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-2746" style="font-size: 101.8%; font-family: MathJax_Math-italic;">h</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.561em;"><span class="texatom" id="MathJax-Span-2747"><span class="mrow" id="MathJax-Span-2748"><span class="mi" id="MathJax-Span-2749" style="font-size: 72%; font-family: MathJax_Math-italic;">a</span><span class="mn" id="MathJax-Span-2750" style="font-size: 72%; font-family: MathJax_Main;">2</span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.043em, 1001.37em, 4.408em, -999.997em); top: -3.409em; left: 50%; margin-left: -0.679em;"><span class="mrow" id="MathJax-Span-2751"><span class="mi" id="MathJax-Span-2752" style="font-size: 101.8%; font-family: MathJax_Math-italic;">δ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="texatom" id="MathJax-Span-2753"><span class="mrow" id="MathJax-Span-2754"><span class="msubsup" id="MathJax-Span-2755"><span style="display: inline-block; position: relative; width: 0.872em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.5em, 4.346em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-2756" style="font-size: 101.8%; font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.719em; left: 0.437em;"><span class="mn" id="MathJax-Span-2757" style="font-size: 72%; font-family: MathJax_Main;">3</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(0.872em, 1002.05em, 1.306em, -999.997em); top: -1.424em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.4px solid; width: 2.05em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.12em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(2.298em, 1002.36em, 4.966em, -999.997em); top: -1.362em; left: 50%; margin-left: -1.176em;"><span class="mtd" id="MathJax-Span-2818"><span class="mrow" id="MathJax-Span-2819"><span class="mfrac" id="MathJax-Span-2820"><span style="display: inline-block; position: relative; width: 2.05em; height: 0px; margin-right: 0.189em; margin-left: 0.189em;"><span style="position: absolute; clip: rect(3.043em, 1001.86em, 4.346em, -999.997em); top: -4.712em; left: 50%; margin-left: -0.927em;"><span class="mrow" id="MathJax-Span-2821"><span class="mi" id="MathJax-Span-2822" style="font-size: 101.8%; font-family: MathJax_Math-italic;">δ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="texatom" id="MathJax-Span-2823"><span class="mrow" id="MathJax-Span-2824"><span class="msubsup" id="MathJax-Span-2825"><span style="display: inline-block; position: relative; width: 1.43em; height: 0px;"><span style="position: absolute; clip: rect(3.105em, 1000.56em, 4.159em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-2826" style="font-size: 101.8%; font-family: MathJax_Math-italic;">h</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.561em;"><span class="texatom" id="MathJax-Span-2827"><span class="mrow" id="MathJax-Span-2828"><span class="mi" id="MathJax-Span-2829" style="font-size: 72%; font-family: MathJax_Math-italic;">a</span><span class="mn" id="MathJax-Span-2830" style="font-size: 72%; font-family: MathJax_Main;">3</span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.043em, 1001.37em, 4.408em, -999.997em); top: -3.409em; left: 50%; margin-left: -0.679em;"><span class="mrow" id="MathJax-Span-2831"><span class="mi" id="MathJax-Span-2832" style="font-size: 101.8%; font-family: MathJax_Math-italic;">δ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="texatom" id="MathJax-Span-2833"><span class="mrow" id="MathJax-Span-2834"><span class="msubsup" id="MathJax-Span-2835"><span style="display: inline-block; position: relative; width: 0.872em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.5em, 4.346em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-2836" style="font-size: 101.8%; font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.719em; left: 0.437em;"><span class="mn" id="MathJax-Span-2837" style="font-size: 72%; font-family: MathJax_Main;">3</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(0.872em, 1002.05em, 1.306em, -999.997em); top: -1.424em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.4px solid; width: 2.05em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.12em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span><span style="display: inline-block; width: 0px; height: 8.626em;"></span></span></span></span><span class="mo" id="MathJax-Span-2838" style="vertical-align: 4.159em;"><span style="display: inline-block; position: relative; width: 0.934em; height: 0px;"><span style="position: absolute; top: -2.292em; left: 0em;"><span style="font-size: 144%; font-family: MathJax_Size4;">⎤</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: 2.733em; left: 0em;"><span style="font-size: 144%; font-family: MathJax_Size4;">⎦</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -0.741em; left: 0em;"><span style="font-size: 144%; font-family: MathJax_Size4;">⎥</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -0.059em; left: 0em;"><span style="font-size: 144%; font-family: MathJax_Size4;">⎥</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: 0.623em; left: 0em;"><span style="font-size: 144%; font-family: MathJax_Size4;">⎥</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: 1.306em; left: 0em;"><span style="font-size: 144%; font-family: MathJax_Size4;">⎥</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 8.626em;"></span></span><span style="position: absolute; top: -0.431em; left: 23.576em;"><span class="texatom" id="MathJax-Span-2839"><span class="mrow" id="MathJax-Span-2840"><span class="mi" id="MathJax-Span-2841" style="font-size: 101.8%; font-family: MathJax_Math-italic;">k</span><span class="mo" id="MathJax-Span-2842" style="font-size: 101.8%; font-family: MathJax_Main;">−</span><span class="mn" id="MathJax-Span-2843" style="font-size: 101.8%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.36em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -4.535em; border-left: 0px solid; width: 0px; height: 9.773em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msubsup><mi>h</mi><mi>a</mi><mo>′</mo></msubsup><mo stretchy="false">(</mo><msub><mi>q</mi><mrow class="MJX-TeXAtom-ORD"><mi>k</mi><mo>−</mo><mn>1</mn></mrow></msub><mo stretchy="false">)</mo><mo>=</mo><mstyle mathsize="1.44em"><msub><mrow class="MJX-TeXAtom-ORD"><mfrac><mrow><mi>δ</mi><mrow class="MJX-TeXAtom-ORD"><msub><mi>h</mi><mi>a</mi></msub><mo stretchy="false">(</mo><mi>q</mi><mo stretchy="false">)</mo></mrow></mrow><mrow><mi>δ</mi><mrow class="MJX-TeXAtom-ORD"><mi>q</mi></mrow></mrow></mfrac><msub><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><mrow class="MJX-TeXAtom-ORD"><mi>q</mi><mo>=</mo><msub><mi>q</mi><mrow class="MJX-TeXAtom-ORD"><mi>k</mi><mo>−</mo><mn>1</mn></mrow></msub></mrow></msub><mo>=</mo><mrow><mo>[</mo><mtable rowspacing="4pt" columnspacing="1em"><mtr><mtd><mfrac><mrow><mi>δ</mi><mrow class="MJX-TeXAtom-ORD"><msub><mi>h</mi><mrow class="MJX-TeXAtom-ORD"><mi>a</mi><mn>1</mn></mrow></msub></mrow></mrow><mrow><mi>δ</mi><mrow class="MJX-TeXAtom-ORD"><msub><mi>q</mi><mn>0</mn></msub></mrow></mrow></mfrac></mtd><mtd><mfrac><mrow><mi>δ</mi><mrow class="MJX-TeXAtom-ORD"><msub><mi>h</mi><mrow class="MJX-TeXAtom-ORD"><mi>a</mi><mn>1</mn></mrow></msub></mrow></mrow><mrow><mi>δ</mi><mrow class="MJX-TeXAtom-ORD"><msub><mi>q</mi><mn>1</mn></msub></mrow></mrow></mfrac></mtd><mtd><mfrac><mrow><mi>δ</mi><mrow class="MJX-TeXAtom-ORD"><msub><mi>h</mi><mrow class="MJX-TeXAtom-ORD"><mi>a</mi><mn>1</mn></mrow></msub></mrow></mrow><mrow><mi>δ</mi><mrow class="MJX-TeXAtom-ORD"><msub><mi>q</mi><mn>2</mn></msub></mrow></mrow></mfrac></mtd><mtd><mfrac><mrow><mi>δ</mi><mrow class="MJX-TeXAtom-ORD"><msub><mi>h</mi><mrow class="MJX-TeXAtom-ORD"><mi>a</mi><mn>1</mn></mrow></msub></mrow></mrow><mrow><mi>δ</mi><mrow class="MJX-TeXAtom-ORD"><msub><mi>q</mi><mn>3</mn></msub></mrow></mrow></mfrac></mtd></mtr><mtr><mtd><mfrac><mrow><mi>δ</mi><mrow class="MJX-TeXAtom-ORD"><msub><mi>h</mi><mrow class="MJX-TeXAtom-ORD"><mi>a</mi><mn>2</mn></mrow></msub></mrow></mrow><mrow><mi>δ</mi><mrow class="MJX-TeXAtom-ORD"><msub><mi>q</mi><mn>0</mn></msub></mrow></mrow></mfrac></mtd><mtd><mfrac><mrow><mi>δ</mi><mrow class="MJX-TeXAtom-ORD"><msub><mi>h</mi><mrow class="MJX-TeXAtom-ORD"><mi>a</mi><mn>2</mn></mrow></msub></mrow></mrow><mrow><mi>δ</mi><mrow class="MJX-TeXAtom-ORD"><msub><mi>q</mi><mn>1</mn></msub></mrow></mrow></mfrac></mtd><mtd><mfrac><mrow><mi>δ</mi><mrow class="MJX-TeXAtom-ORD"><msub><mi>h</mi><mrow class="MJX-TeXAtom-ORD"><mi>a</mi><mn>2</mn></mrow></msub></mrow></mrow><mrow><mi>δ</mi><mrow class="MJX-TeXAtom-ORD"><msub><mi>q</mi><mn>2</mn></msub></mrow></mrow></mfrac></mtd><mtd><mfrac><mrow><mi>δ</mi><mrow class="MJX-TeXAtom-ORD"><msub><mi>h</mi><mrow class="MJX-TeXAtom-ORD"><mi>a</mi><mn>2</mn></mrow></msub></mrow></mrow><mrow><mi>δ</mi><mrow class="MJX-TeXAtom-ORD"><msub><mi>q</mi><mn>3</mn></msub></mrow></mrow></mfrac></mtd></mtr><mtr><mtd><mfrac><mrow><mi>δ</mi><mrow class="MJX-TeXAtom-ORD"><msub><mi>h</mi><mrow class="MJX-TeXAtom-ORD"><mi>a</mi><mn>3</mn></mrow></msub></mrow></mrow><mrow><mi>δ</mi><mrow class="MJX-TeXAtom-ORD"><msub><mi>q</mi><mn>0</mn></msub></mrow></mrow></mfrac></mtd><mtd><mfrac><mrow><mi>δ</mi><mrow class="MJX-TeXAtom-ORD"><msub><mi>h</mi><mrow class="MJX-TeXAtom-ORD"><mi>a</mi><mn>3</mn></mrow></msub></mrow></mrow><mrow><mi>δ</mi><mrow class="MJX-TeXAtom-ORD"><msub><mi>q</mi><mn>1</mn></msub></mrow></mrow></mfrac></mtd><mtd><mfrac><mrow><mi>δ</mi><mrow class="MJX-TeXAtom-ORD"><msub><mi>h</mi><mrow class="MJX-TeXAtom-ORD"><mi>a</mi><mn>3</mn></mrow></msub></mrow></mrow><mrow><mi>δ</mi><mrow class="MJX-TeXAtom-ORD"><msub><mi>q</mi><mn>2</mn></msub></mrow></mrow></mfrac></mtd><mtd><mfrac><mrow><mi>δ</mi><mrow class="MJX-TeXAtom-ORD"><msub><mi>h</mi><mrow class="MJX-TeXAtom-ORD"><mi>a</mi><mn>3</mn></mrow></msub></mrow></mrow><mrow><mi>δ</mi><mrow class="MJX-TeXAtom-ORD"><msub><mi>q</mi><mn>3</mn></msub></mrow></mrow></mfrac></mtd></mtr></mtable><mo>]</mo></mrow></mrow><mrow class="MJX-TeXAtom-ORD"><mi>k</mi><mo>−</mo><mn>1</mn></mrow></msub></mstyle></math></span></span><script type="math/tex" id="MathJax-Element-59">h’_a(q_{k-1}) = \Large{\frac{\delta{h_a(q)}}{\delta{q}}|_{q=q_{k-1}} = \begin{bmatrix} \frac{\delta{h_{a1}}}{\delta{q_0}} & \frac{\delta{h_{a1}}}{\delta{q_1}} & \frac{\delta{h_{a1}}}{\delta{q_2}} & \frac{\delta{h_{a1}}}{\delta{q_3}} \\ \frac{\delta{h_{a2}}}{\delta{q_0}} & \frac{\delta{h_{a2}}}{\delta{q_1}} & \frac{\delta{h_{a2}}}{\delta{q_2}} & \frac{\delta{h_{a2}}}{\delta{q_3}} \\ \frac{\delta{h_{a3}}}{\delta{q_0}} & \frac{\delta{h_{a3}}}{\delta{q_1}} & \frac{\delta{h_{a3}}}{\delta{q_2}} & \frac{\delta{h_{a3}}}{\delta{q_3}} \end{bmatrix}}_{k-1}</script></p>
<p><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-60-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msubsup&gt;&lt;mi&gt;h&lt;/mi&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mo&gt;&amp;#x2032;&lt;/mo&gt;&lt;/msubsup&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;msub&gt;&lt;mrow&gt;&lt;mo&gt;[&lt;/mo&gt;&lt;mtable rowspacing=&quot;4pt&quot; columnspacing=&quot;1em&quot;&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mn&gt;3&lt;/mn&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mn&gt;3&lt;/mn&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mn&gt;3&lt;/mn&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;/mtable&gt;&lt;mo&gt;]&lt;/mo&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2844" style="width: 21.591em; display: inline-block;"><span style="display: inline-block; position: relative; width: 17.373em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(0.003em, 1017.37em, 4.283em, -999.997em); top: -2.354em; left: 0em;"><span class="mrow" id="MathJax-Span-2845"><span class="msubsup" id="MathJax-Span-2846"><span style="display: inline-block; position: relative; width: 1.058em; height: 0px;"><span style="position: absolute; clip: rect(3.105em, 1000.56em, 4.159em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-2847" style="font-family: MathJax_Math-italic;">h</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.415em, 1000.25em, 4.159em, -999.997em); top: -4.277em; left: 0.561em;"><span class="mo" id="MathJax-Span-2848" style="font-size: 70.7%; font-family: MathJax_Main;">′</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.477em, 1000.44em, 4.159em, -999.997em); top: -3.843em; left: 0.561em;"><span class="mi" id="MathJax-Span-2849" style="font-size: 70.7%; font-family: MathJax_Math-italic;">a</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="mo" id="MathJax-Span-2850" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-2851"><span style="display: inline-block; position: relative; width: 1.802em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.44em, 4.346em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-2852" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.437em;"><span class="texatom" id="MathJax-Span-2853"><span class="mrow" id="MathJax-Span-2854"><span class="mi" id="MathJax-Span-2855" style="font-size: 70.7%; font-family: MathJax_Math-italic;">k</span><span class="mo" id="MathJax-Span-2856" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="mn" id="MathJax-Span-2857" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="mo" id="MathJax-Span-2858" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-2859" style="font-family: MathJax_Main; padding-left: 0.251em;">=</span><span class="mn" id="MathJax-Span-2860" style="font-family: MathJax_Main; padding-left: 0.251em;">2</span><span class="msubsup" id="MathJax-Span-2861"><span style="display: inline-block; position: relative; width: 11.914em; height: 0px;"><span style="position: absolute; clip: rect(2.422em, 1010.24em, 6.641em, -999.997em); top: -4.774em; left: 0em;"><span class="mrow" id="MathJax-Span-2862"><span class="mo" id="MathJax-Span-2863" style="vertical-align: 2.174em;"><span style="display: inline-block; position: relative; width: 0.685em; height: 0px;"><span style="position: absolute; font-family: MathJax_Size4; top: -2.788em; left: 0em;">⎡<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; font-family: MathJax_Size4; top: -0.803em; left: 0em;">⎣<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -1.796em; left: 0em;">⎢<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="mtable" id="MathJax-Span-2864" style="padding-right: 0.189em; padding-left: 0.189em;"><span style="display: inline-block; position: relative; width: 8.812em; height: 0px;"><span style="position: absolute; clip: rect(2.484em, 1001.68em, 6.455em, -999.997em); top: -4.587em; left: 0em;"><span style="display: inline-block; position: relative; width: 1.678em; height: 0px;"><span style="position: absolute; clip: rect(3.229em, 1001.68em, 4.346em, -999.997em); top: -5.332em; left: 50%; margin-left: -0.803em;"><span class="mtd" id="MathJax-Span-2865"><span class="mrow" id="MathJax-Span-2866"><span class="mo" id="MathJax-Span-2867" style="font-family: MathJax_Main;">−</span><span class="msubsup" id="MathJax-Span-2868"><span style="display: inline-block; position: relative; width: 0.872em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.44em, 4.346em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-2869" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.437em;"><span class="mn" id="MathJax-Span-2870" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.353em, 1000.87em, 4.346em, -999.997em); top: -3.905em; left: 50%; margin-left: -0.431em;"><span class="mtd" id="MathJax-Span-2887"><span class="mrow" id="MathJax-Span-2888"><span class="msubsup" id="MathJax-Span-2889"><span style="display: inline-block; position: relative; width: 0.872em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.44em, 4.346em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-2890" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.437em;"><span class="mn" id="MathJax-Span-2891" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.353em, 1000.87em, 4.346em, -999.997em); top: -2.54em; left: 50%; margin-left: -0.431em;"><span class="mtd" id="MathJax-Span-2907"><span class="mrow" id="MathJax-Span-2908"><span class="msubsup" id="MathJax-Span-2909"><span style="display: inline-block; position: relative; width: 0.872em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.44em, 4.346em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-2910" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.437em;"><span class="mn" id="MathJax-Span-2911" style="font-size: 70.7%; font-family: MathJax_Main;">0</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.594em;"></span></span><span style="position: absolute; clip: rect(2.484em, 1001.68em, 6.331em, -999.997em); top: -4.463em; left: 2.671em;"><span style="display: inline-block; position: relative; width: 1.678em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.87em, 4.346em, -999.997em); top: -5.332em; left: 50%; margin-left: -0.431em;"><span class="mtd" id="MathJax-Span-2871"><span class="mrow" id="MathJax-Span-2872"><span class="msubsup" id="MathJax-Span-2873"><span style="display: inline-block; position: relative; width: 0.872em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.44em, 4.346em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-2874" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.437em;"><span class="mn" id="MathJax-Span-2875" style="font-size: 70.7%; font-family: MathJax_Main;">3</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.353em, 1000.87em, 4.346em, -999.997em); top: -3.905em; left: 50%; margin-left: -0.431em;"><span class="mtd" id="MathJax-Span-2892"><span class="mrow" id="MathJax-Span-2893"><span class="msubsup" id="MathJax-Span-2894"><span style="display: inline-block; position: relative; width: 0.872em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.44em, 4.346em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-2895" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.437em;"><span class="mn" id="MathJax-Span-2896" style="font-size: 70.7%; font-family: MathJax_Main;">0</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.229em, 1001.68em, 4.346em, -999.997em); top: -2.54em; left: 50%; margin-left: -0.803em;"><span class="mtd" id="MathJax-Span-2912"><span class="mrow" id="MathJax-Span-2913"><span class="mo" id="MathJax-Span-2914" style="font-family: MathJax_Main;">−</span><span class="msubsup" id="MathJax-Span-2915"><span style="display: inline-block; position: relative; width: 0.872em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.44em, 4.346em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-2916" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.437em;"><span class="mn" id="MathJax-Span-2917" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.47em;"></span></span><span style="position: absolute; clip: rect(2.484em, 1001.68em, 6.455em, -999.997em); top: -4.587em; left: 5.338em;"><span style="display: inline-block; position: relative; width: 1.678em; height: 0px;"><span style="position: absolute; clip: rect(3.229em, 1001.68em, 4.346em, -999.997em); top: -5.332em; left: 50%; margin-left: -0.803em;"><span class="mtd" id="MathJax-Span-2876"><span class="mrow" id="MathJax-Span-2877"><span class="mo" id="MathJax-Span-2878" style="font-family: MathJax_Main;">−</span><span class="msubsup" id="MathJax-Span-2879"><span style="display: inline-block; position: relative; width: 0.872em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.44em, 4.346em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-2880" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.437em;"><span class="mn" id="MathJax-Span-2881" style="font-size: 70.7%; font-family: MathJax_Main;">0</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.353em, 1000.87em, 4.346em, -999.997em); top: -3.905em; left: 50%; margin-left: -0.431em;"><span class="mtd" id="MathJax-Span-2897"><span class="mrow" id="MathJax-Span-2898"><span class="msubsup" id="MathJax-Span-2899"><span style="display: inline-block; position: relative; width: 0.872em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.44em, 4.346em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-2900" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.437em;"><span class="mn" id="MathJax-Span-2901" style="font-size: 70.7%; font-family: MathJax_Main;">3</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.229em, 1001.68em, 4.346em, -999.997em); top: -2.54em; left: 50%; margin-left: -0.803em;"><span class="mtd" id="MathJax-Span-2918"><span class="mrow" id="MathJax-Span-2919"><span class="mo" id="MathJax-Span-2920" style="font-family: MathJax_Main;">−</span><span class="msubsup" id="MathJax-Span-2921"><span style="display: inline-block; position: relative; width: 0.872em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.44em, 4.346em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-2922" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.437em;"><span class="mn" id="MathJax-Span-2923" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.594em;"></span></span><span style="position: absolute; clip: rect(2.484em, 1000.87em, 6.331em, -999.997em); top: -4.463em; left: 7.944em;"><span style="display: inline-block; position: relative; width: 0.872em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.87em, 4.346em, -999.997em); top: -5.332em; left: 50%; margin-left: -0.431em;"><span class="mtd" id="MathJax-Span-2882"><span class="mrow" id="MathJax-Span-2883"><span class="msubsup" id="MathJax-Span-2884"><span style="display: inline-block; position: relative; width: 0.872em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.44em, 4.346em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-2885" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.437em;"><span class="mn" id="MathJax-Span-2886" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.353em, 1000.87em, 4.346em, -999.997em); top: -3.905em; left: 50%; margin-left: -0.431em;"><span class="mtd" id="MathJax-Span-2902"><span class="mrow" id="MathJax-Span-2903"><span class="msubsup" id="MathJax-Span-2904"><span style="display: inline-block; position: relative; width: 0.872em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.44em, 4.346em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-2905" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.437em;"><span class="mn" id="MathJax-Span-2906" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.353em, 1000.87em, 4.346em, -999.997em); top: -2.54em; left: 50%; margin-left: -0.431em;"><span class="mtd" id="MathJax-Span-2924"><span class="mrow" id="MathJax-Span-2925"><span class="msubsup" id="MathJax-Span-2926"><span style="display: inline-block; position: relative; width: 0.872em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.44em, 4.346em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-2927" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.437em;"><span class="mn" id="MathJax-Span-2928" style="font-size: 70.7%; font-family: MathJax_Main;">3</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.47em;"></span></span></span></span><span class="mo" id="MathJax-Span-2929" style="vertical-align: 2.174em;"><span style="display: inline-block; position: relative; width: 0.685em; height: 0px;"><span style="position: absolute; font-family: MathJax_Size4; top: -2.788em; left: 0em;">⎤<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; font-family: MathJax_Size4; top: -0.803em; left: 0em;">⎦<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -1.796em; left: 0em;">⎥<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.78em;"></span></span><span style="position: absolute; top: -2.292em; left: 10.549em;"><span class="texatom" id="MathJax-Span-2930"><span class="mrow" id="MathJax-Span-2931"><span class="mi" id="MathJax-Span-2932" style="font-size: 70.7%; font-family: MathJax_Math-italic;">k</span><span class="mo" id="MathJax-Span-2933" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="mn" id="MathJax-Span-2934" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.36em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -2.227em; border-left: 0px solid; width: 0px; height: 5.004em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msubsup><mi>h</mi><mi>a</mi><mo>′</mo></msubsup><mo stretchy="false">(</mo><msub><mi>q</mi><mrow class="MJX-TeXAtom-ORD"><mi>k</mi><mo>−</mo><mn>1</mn></mrow></msub><mo stretchy="false">)</mo><mo>=</mo><mn>2</mn><msub><mrow><mo>[</mo><mtable rowspacing="4pt" columnspacing="1em"><mtr><mtd><mo>−</mo><msub><mi>q</mi><mn>2</mn></msub></mtd><mtd><msub><mi>q</mi><mn>3</mn></msub></mtd><mtd><mo>−</mo><msub><mi>q</mi><mn>0</mn></msub></mtd><mtd><msub><mi>q</mi><mn>1</mn></msub></mtd></mtr><mtr><mtd><msub><mi>q</mi><mn>1</mn></msub></mtd><mtd><msub><mi>q</mi><mn>0</mn></msub></mtd><mtd><msub><mi>q</mi><mn>3</mn></msub></mtd><mtd><msub><mi>q</mi><mn>2</mn></msub></mtd></mtr><mtr><mtd><msub><mi>q</mi><mn>0</mn></msub></mtd><mtd><mo>−</mo><msub><mi>q</mi><mn>1</mn></msub></mtd><mtd><mo>−</mo><msub><mi>q</mi><mn>2</mn></msub></mtd><mtd><msub><mi>q</mi><mn>3</mn></msub></mtd></mtr></mtable><mo>]</mo></mrow><mrow class="MJX-TeXAtom-ORD"><mi>k</mi><mo>−</mo><mn>1</mn></mrow></msub></math></span></span><script type="math/tex" id="MathJax-Element-60">h’_a(q_{k-1}) = 2\begin{bmatrix} -q_2 & q_3 & -q_0 & q_1 \\ q_1 & q_0 & q_3 & q_2 \\ q_0 & -q_1 & -q_2 & q_3 \end{bmatrix}_{k-1}</script>&nbsp; &nbsp; &nbsp;——————–&nbsp; &nbsp; &nbsp;(13)</p>
<p>And there we have it! Let us now substitute equation (13) into equation (12).</p>
<p><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-61-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;h&lt;/mi&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;msub&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;|&lt;/mo&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;msub&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;msub&gt;&lt;mrow&gt;&lt;mo&gt;[&lt;/mo&gt;&lt;mtable rowspacing=&quot;4pt&quot; columnspacing=&quot;1em&quot;&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;msub&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mn&gt;3&lt;/mn&gt;&lt;/msub&gt;&lt;mo&gt;&amp;#x2013;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/msub&gt;&lt;msub&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msub&gt;&lt;msub&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mn&gt;3&lt;/mn&gt;&lt;/msub&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/msub&gt;&lt;msub&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;msubsup&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msubsup&gt;&lt;mo&gt;&amp;#x2013;&lt;/mo&gt;&lt;msubsup&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msubsup&gt;&lt;mo&gt;&amp;#x2013;&lt;/mo&gt;&lt;msubsup&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msubsup&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;msubsup&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mn&gt;3&lt;/mn&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msubsup&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;/mtable&gt;&lt;mo&gt;]&lt;/mo&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;msub&gt;&lt;mrow&gt;&lt;mo&gt;[&lt;/mo&gt;&lt;mtable rowspacing=&quot;4pt&quot; columnspacing=&quot;1em&quot;&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mn&gt;3&lt;/mn&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mn&gt;3&lt;/mn&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mn&gt;3&lt;/mn&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;/mtable&gt;&lt;mo&gt;]&lt;/mo&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mrow&gt;&lt;mo&gt;(&lt;/mo&gt;&lt;mrow&gt;&lt;msub&gt;&lt;mrow&gt;&lt;mo&gt;[&lt;/mo&gt;&lt;mtable rowspacing=&quot;4pt&quot; columnspacing=&quot;1em&quot;&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mn&gt;3&lt;/mn&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;/mtable&gt;&lt;mo&gt;]&lt;/mo&gt;&lt;/mrow&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;&amp;#x2013;&lt;/mo&gt;&lt;msub&gt;&lt;mrow&gt;&lt;mo&gt;[&lt;/mo&gt;&lt;mtable rowspacing=&quot;4pt&quot; columnspacing=&quot;1em&quot;&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mn&gt;3&lt;/mn&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;/mtable&gt;&lt;mo&gt;]&lt;/mo&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;mo&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2935" style="width: 49.073em; display: inline-block;"><span style="display: inline-block; position: relative; width: 39.581em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(2.174em, 1039.27em, 7.882em, -999.997em); top: -5.27em; left: 0em;"><span class="mrow" id="MathJax-Span-2936"><span class="msubsup" id="MathJax-Span-2937"><span style="display: inline-block; position: relative; width: 1.058em; height: 0px;"><span style="position: absolute; clip: rect(3.105em, 1000.56em, 4.159em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-2938" style="font-family: MathJax_Math-italic;">h</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.561em;"><span class="mi" id="MathJax-Span-2939" style="font-size: 70.7%; font-family: MathJax_Math-italic;">a</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="mo" id="MathJax-Span-2940" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-2941"><span style="display: inline-block; position: relative; width: 0.872em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.44em, 4.346em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-2942" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.437em;"><span class="mi" id="MathJax-Span-2943" style="font-size: 70.7%; font-family: MathJax_Math-italic;">k</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="mo" id="MathJax-Span-2944" style="font-family: MathJax_Main;">)</span><span class="msubsup" id="MathJax-Span-2945"><span style="display: inline-block; position: relative; width: 2.795em; height: 0px;"><span style="position: absolute; clip: rect(3.043em, 1000.19em, 4.408em, -999.997em); top: -3.967em; left: 0em;"><span class="texatom" id="MathJax-Span-2946"><span class="mrow" id="MathJax-Span-2947"><span class="mo" id="MathJax-Span-2948" style="font-family: MathJax_Main;">|</span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.657em; left: 0.251em;"><span class="texatom" id="MathJax-Span-2949"><span class="mrow" id="MathJax-Span-2950"><span class="msubsup" id="MathJax-Span-2951"><span style="display: inline-block; position: relative; width: 0.623em; height: 0px;"><span style="position: absolute; clip: rect(3.477em, 1000.31em, 4.283em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-2952" style="font-size: 70.7%; font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.781em; left: 0.313em;"><span class="mi" id="MathJax-Span-2953" style="font-size: 50%; font-family: MathJax_Math-italic;">k</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="mo" id="MathJax-Span-2954" style="font-size: 70.7%; font-family: MathJax_Main;">=</span><span class="msubsup" id="MathJax-Span-2955"><span style="display: inline-block; position: relative; width: 1.244em; height: 0px;"><span style="position: absolute; clip: rect(3.477em, 1000.31em, 4.283em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-2956" style="font-size: 70.7%; font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.781em; left: 0.313em;"><span class="texatom" id="MathJax-Span-2957"><span class="mrow" id="MathJax-Span-2958"><span class="mi" id="MathJax-Span-2959" style="font-size: 50%; font-family: MathJax_Math-italic;">k</span><span class="mo" id="MathJax-Span-2960" style="font-size: 50%; font-family: MathJax_Main;">−</span><span class="mn" id="MathJax-Span-2961" style="font-size: 50%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="mo" id="MathJax-Span-2962" style="font-family: MathJax_Main; padding-left: 0.251em;">=</span><span class="msubsup" id="MathJax-Span-2963" style="padding-left: 0.251em;"><span style="display: inline-block; position: relative; width: 9.494em; height: 0px;"><span style="position: absolute; clip: rect(2.547em, 1007.82em, 7.013em, -999.997em); top: -5.022em; left: 0em;"><span class="mrow" id="MathJax-Span-2964"><span class="mo" id="MathJax-Span-2965" style="vertical-align: 2.298em;"><span style="display: inline-block; position: relative; width: 0.685em; height: 0px;"><span style="position: absolute; font-family: MathJax_Size4; top: -2.788em; left: 0em;">⎡<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; font-family: MathJax_Size4; top: -0.555em; left: 0em;">⎣<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -1.672em; left: 0em;">⎢<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="mtable" id="MathJax-Span-2966" style="padding-right: 0.189em; padding-left: 0.189em;"><span style="display: inline-block; position: relative; width: 6.455em; height: 0px;"><span style="position: absolute; clip: rect(2.547em, 1006.46em, 6.951em, -999.997em); top: -4.96em; left: 0em;"><span style="display: inline-block; position: relative; width: 6.455em; height: 0px;"><span style="position: absolute; clip: rect(3.043em, 1005.4em, 4.408em, -999.997em); top: -5.456em; left: 50%; margin-left: -2.726em;"><span class="mtd" id="MathJax-Span-2967"><span class="mrow" id="MathJax-Span-2968"><span class="mn" id="MathJax-Span-2969" style="font-family: MathJax_Main;">2</span><span class="mo" id="MathJax-Span-2970" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-2971"><span style="display: inline-block; position: relative; width: 0.872em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.44em, 4.346em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-2972" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.437em;"><span class="mn" id="MathJax-Span-2973" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-2974"><span style="display: inline-block; position: relative; width: 0.872em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.44em, 4.346em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-2975" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.437em;"><span class="mn" id="MathJax-Span-2976" style="font-size: 70.7%; font-family: MathJax_Main;">3</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="mo" id="MathJax-Span-2977" style="font-family: MathJax_Main;">–</span><span class="msubsup" id="MathJax-Span-2978" style="padding-left: 0.189em;"><span style="display: inline-block; position: relative; width: 0.872em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.44em, 4.346em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-2979" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.437em;"><span class="mn" id="MathJax-Span-2980" style="font-size: 70.7%; font-family: MathJax_Main;">0</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-2981"><span style="display: inline-block; position: relative; width: 0.872em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.44em, 4.346em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-2982" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.437em;"><span class="mn" id="MathJax-Span-2983" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="mo" id="MathJax-Span-2984" style="font-family: MathJax_Main;">)</span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.043em, 1005.96em, 4.408em, -999.997em); top: -3.967em; left: 50%; margin-left: -3.037em;"><span class="mtd" id="MathJax-Span-2985"><span class="mrow" id="MathJax-Span-2986"><span class="mn" id="MathJax-Span-2987" style="font-family: MathJax_Main;">2</span><span class="mo" id="MathJax-Span-2988" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-2989"><span style="display: inline-block; position: relative; width: 0.872em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.44em, 4.346em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-2990" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.437em;"><span class="mn" id="MathJax-Span-2991" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-2992"><span style="display: inline-block; position: relative; width: 0.872em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.44em, 4.346em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-2993" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.437em;"><span class="mn" id="MathJax-Span-2994" style="font-size: 70.7%; font-family: MathJax_Main;">3</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="mo" id="MathJax-Span-2995" style="font-family: MathJax_Main; padding-left: 0.251em;">+</span><span class="msubsup" id="MathJax-Span-2996" style="padding-left: 0.251em;"><span style="display: inline-block; position: relative; width: 0.872em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.44em, 4.346em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-2997" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.437em;"><span class="mn" id="MathJax-Span-2998" style="font-size: 70.7%; font-family: MathJax_Main;">0</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-2999"><span style="display: inline-block; position: relative; width: 0.872em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.44em, 4.346em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-3000" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.437em;"><span class="mn" id="MathJax-Span-3001" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="mo" id="MathJax-Span-3002" style="font-family: MathJax_Main;">)</span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(2.981em, 1006.46em, 4.47em, -999.997em); top: -2.54em; left: 50%; margin-left: -3.223em;"><span class="mtd" id="MathJax-Span-3003"><span class="mrow" id="MathJax-Span-3004"><span class="msubsup" id="MathJax-Span-3005"><span style="display: inline-block; position: relative; width: 0.934em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.44em, 4.346em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-3006" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.291em, 1000.44em, 4.159em, -999.997em); top: -4.339em; left: 0.499em;"><span class="mn" id="MathJax-Span-3007" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.291em, 1000.44em, 4.159em, -999.997em); top: -3.657em; left: 0.437em;"><span class="mn" id="MathJax-Span-3008" style="font-size: 70.7%; font-family: MathJax_Main;">0</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="mo" id="MathJax-Span-3009" style="font-family: MathJax_Main;">–</span><span class="msubsup" id="MathJax-Span-3010" style="padding-left: 0.189em;"><span style="display: inline-block; position: relative; width: 0.934em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.44em, 4.346em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-3011" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.291em, 1000.44em, 4.159em, -999.997em); top: -4.339em; left: 0.499em;"><span class="mn" id="MathJax-Span-3012" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.291em, 1000.44em, 4.159em, -999.997em); top: -3.657em; left: 0.437em;"><span class="mn" id="MathJax-Span-3013" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="mo" id="MathJax-Span-3014" style="font-family: MathJax_Main;">–</span><span class="msubsup" id="MathJax-Span-3015" style="padding-left: 0.189em;"><span style="display: inline-block; position: relative; width: 0.934em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.44em, 4.346em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-3016" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.291em, 1000.44em, 4.159em, -999.997em); top: -4.339em; left: 0.499em;"><span class="mn" id="MathJax-Span-3017" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.291em, 1000.44em, 4.159em, -999.997em); top: -3.657em; left: 0.437em;"><span class="mn" id="MathJax-Span-3018" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="mo" id="MathJax-Span-3019" style="font-family: MathJax_Main; padding-left: 0.251em;">+</span><span class="msubsup" id="MathJax-Span-3020" style="padding-left: 0.251em;"><span style="display: inline-block; position: relative; width: 0.934em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.44em, 4.346em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-3021" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.291em, 1000.44em, 4.159em, -999.997em); top: -4.339em; left: 0.499em;"><span class="mn" id="MathJax-Span-3022" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.291em, 1000.44em, 4.159em, -999.997em); top: -3.657em; left: 0.437em;"><span class="mn" id="MathJax-Span-3023" style="font-size: 70.7%; font-family: MathJax_Main;">3</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.966em;"></span></span></span></span><span class="mo" id="MathJax-Span-3024" style="vertical-align: 2.298em;"><span style="display: inline-block; position: relative; width: 0.685em; height: 0px;"><span style="position: absolute; font-family: MathJax_Size4; top: -2.788em; left: 0em;">⎤<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; font-family: MathJax_Size4; top: -0.555em; left: 0em;">⎦<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -1.672em; left: 0em;">⎥<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 5.028em;"></span></span><span style="position: absolute; top: -2.168em; left: 8.13em;"><span class="texatom" id="MathJax-Span-3025"><span class="mrow" id="MathJax-Span-3026"><span class="mi" id="MathJax-Span-3027" style="font-size: 70.7%; font-family: MathJax_Math-italic;">k</span><span class="mo" id="MathJax-Span-3028" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="mn" id="MathJax-Span-3029" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="mo" id="MathJax-Span-3030" style="font-family: MathJax_Main; padding-left: 0.251em;">+</span><span class="mn" id="MathJax-Span-3031" style="font-family: MathJax_Main; padding-left: 0.251em;">2</span><span class="msubsup" id="MathJax-Span-3032"><span style="display: inline-block; position: relative; width: 11.914em; height: 0px;"><span style="position: absolute; clip: rect(2.422em, 1010.24em, 6.641em, -999.997em); top: -4.774em; left: 0em;"><span class="mrow" id="MathJax-Span-3033"><span class="mo" id="MathJax-Span-3034" style="vertical-align: 2.174em;"><span style="display: inline-block; position: relative; width: 0.685em; height: 0px;"><span style="position: absolute; font-family: MathJax_Size4; top: -2.788em; left: 0em;">⎡<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; font-family: MathJax_Size4; top: -0.803em; left: 0em;">⎣<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -1.796em; left: 0em;">⎢<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="mtable" id="MathJax-Span-3035" style="padding-right: 0.189em; padding-left: 0.189em;"><span style="display: inline-block; position: relative; width: 8.812em; height: 0px;"><span style="position: absolute; clip: rect(2.484em, 1001.68em, 6.455em, -999.997em); top: -4.587em; left: 0em;"><span style="display: inline-block; position: relative; width: 1.678em; height: 0px;"><span style="position: absolute; clip: rect(3.229em, 1001.68em, 4.346em, -999.997em); top: -5.332em; left: 50%; margin-left: -0.803em;"><span class="mtd" id="MathJax-Span-3036"><span class="mrow" id="MathJax-Span-3037"><span class="mo" id="MathJax-Span-3038" style="font-family: MathJax_Main;">−</span><span class="msubsup" id="MathJax-Span-3039"><span style="display: inline-block; position: relative; width: 0.872em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.44em, 4.346em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-3040" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.437em;"><span class="mn" id="MathJax-Span-3041" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.353em, 1000.87em, 4.346em, -999.997em); top: -3.905em; left: 50%; margin-left: -0.431em;"><span class="mtd" id="MathJax-Span-3058"><span class="mrow" id="MathJax-Span-3059"><span class="msubsup" id="MathJax-Span-3060"><span style="display: inline-block; position: relative; width: 0.872em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.44em, 4.346em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-3061" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.437em;"><span class="mn" id="MathJax-Span-3062" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.353em, 1000.87em, 4.346em, -999.997em); top: -2.54em; left: 50%; margin-left: -0.431em;"><span class="mtd" id="MathJax-Span-3078"><span class="mrow" id="MathJax-Span-3079"><span class="msubsup" id="MathJax-Span-3080"><span style="display: inline-block; position: relative; width: 0.872em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.44em, 4.346em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-3081" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.437em;"><span class="mn" id="MathJax-Span-3082" style="font-size: 70.7%; font-family: MathJax_Main;">0</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.594em;"></span></span><span style="position: absolute; clip: rect(2.484em, 1001.68em, 6.331em, -999.997em); top: -4.463em; left: 2.671em;"><span style="display: inline-block; position: relative; width: 1.678em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.87em, 4.346em, -999.997em); top: -5.332em; left: 50%; margin-left: -0.431em;"><span class="mtd" id="MathJax-Span-3042"><span class="mrow" id="MathJax-Span-3043"><span class="msubsup" id="MathJax-Span-3044"><span style="display: inline-block; position: relative; width: 0.872em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.44em, 4.346em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-3045" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.437em;"><span class="mn" id="MathJax-Span-3046" style="font-size: 70.7%; font-family: MathJax_Main;">3</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.353em, 1000.87em, 4.346em, -999.997em); top: -3.905em; left: 50%; margin-left: -0.431em;"><span class="mtd" id="MathJax-Span-3063"><span class="mrow" id="MathJax-Span-3064"><span class="msubsup" id="MathJax-Span-3065"><span style="display: inline-block; position: relative; width: 0.872em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.44em, 4.346em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-3066" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.437em;"><span class="mn" id="MathJax-Span-3067" style="font-size: 70.7%; font-family: MathJax_Main;">0</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.229em, 1001.68em, 4.346em, -999.997em); top: -2.54em; left: 50%; margin-left: -0.803em;"><span class="mtd" id="MathJax-Span-3083"><span class="mrow" id="MathJax-Span-3084"><span class="mo" id="MathJax-Span-3085" style="font-family: MathJax_Main;">−</span><span class="msubsup" id="MathJax-Span-3086"><span style="display: inline-block; position: relative; width: 0.872em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.44em, 4.346em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-3087" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.437em;"><span class="mn" id="MathJax-Span-3088" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.47em;"></span></span><span style="position: absolute; clip: rect(2.484em, 1001.68em, 6.455em, -999.997em); top: -4.587em; left: 5.338em;"><span style="display: inline-block; position: relative; width: 1.678em; height: 0px;"><span style="position: absolute; clip: rect(3.229em, 1001.68em, 4.346em, -999.997em); top: -5.332em; left: 50%; margin-left: -0.803em;"><span class="mtd" id="MathJax-Span-3047"><span class="mrow" id="MathJax-Span-3048"><span class="mo" id="MathJax-Span-3049" style="font-family: MathJax_Main;">−</span><span class="msubsup" id="MathJax-Span-3050"><span style="display: inline-block; position: relative; width: 0.872em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.44em, 4.346em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-3051" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.437em;"><span class="mn" id="MathJax-Span-3052" style="font-size: 70.7%; font-family: MathJax_Main;">0</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.353em, 1000.87em, 4.346em, -999.997em); top: -3.905em; left: 50%; margin-left: -0.431em;"><span class="mtd" id="MathJax-Span-3068"><span class="mrow" id="MathJax-Span-3069"><span class="msubsup" id="MathJax-Span-3070"><span style="display: inline-block; position: relative; width: 0.872em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.44em, 4.346em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-3071" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.437em;"><span class="mn" id="MathJax-Span-3072" style="font-size: 70.7%; font-family: MathJax_Main;">3</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.229em, 1001.68em, 4.346em, -999.997em); top: -2.54em; left: 50%; margin-left: -0.803em;"><span class="mtd" id="MathJax-Span-3089"><span class="mrow" id="MathJax-Span-3090"><span class="mo" id="MathJax-Span-3091" style="font-family: MathJax_Main;">−</span><span class="msubsup" id="MathJax-Span-3092"><span style="display: inline-block; position: relative; width: 0.872em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.44em, 4.346em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-3093" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.437em;"><span class="mn" id="MathJax-Span-3094" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.594em;"></span></span><span style="position: absolute; clip: rect(2.484em, 1000.87em, 6.331em, -999.997em); top: -4.463em; left: 7.944em;"><span style="display: inline-block; position: relative; width: 0.872em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.87em, 4.346em, -999.997em); top: -5.332em; left: 50%; margin-left: -0.431em;"><span class="mtd" id="MathJax-Span-3053"><span class="mrow" id="MathJax-Span-3054"><span class="msubsup" id="MathJax-Span-3055"><span style="display: inline-block; position: relative; width: 0.872em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.44em, 4.346em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-3056" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.437em;"><span class="mn" id="MathJax-Span-3057" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.353em, 1000.87em, 4.346em, -999.997em); top: -3.905em; left: 50%; margin-left: -0.431em;"><span class="mtd" id="MathJax-Span-3073"><span class="mrow" id="MathJax-Span-3074"><span class="msubsup" id="MathJax-Span-3075"><span style="display: inline-block; position: relative; width: 0.872em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.44em, 4.346em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-3076" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.437em;"><span class="mn" id="MathJax-Span-3077" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.353em, 1000.87em, 4.346em, -999.997em); top: -2.54em; left: 50%; margin-left: -0.431em;"><span class="mtd" id="MathJax-Span-3095"><span class="mrow" id="MathJax-Span-3096"><span class="msubsup" id="MathJax-Span-3097"><span style="display: inline-block; position: relative; width: 0.872em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.44em, 4.346em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-3098" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.437em;"><span class="mn" id="MathJax-Span-3099" style="font-size: 70.7%; font-family: MathJax_Main;">3</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.47em;"></span></span></span></span><span class="mo" id="MathJax-Span-3100" style="vertical-align: 2.174em;"><span style="display: inline-block; position: relative; width: 0.685em; height: 0px;"><span style="position: absolute; font-family: MathJax_Size4; top: -2.788em; left: 0em;">⎤<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; font-family: MathJax_Size4; top: -0.803em; left: 0em;">⎦<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -1.796em; left: 0em;">⎥<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.78em;"></span></span><span style="position: absolute; top: -2.292em; left: 10.549em;"><span class="texatom" id="MathJax-Span-3101"><span class="mrow" id="MathJax-Span-3102"><span class="mi" id="MathJax-Span-3103" style="font-size: 70.7%; font-family: MathJax_Math-italic;">k</span><span class="mo" id="MathJax-Span-3104" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="mn" id="MathJax-Span-3105" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="mrow" id="MathJax-Span-3106" style="padding-left: 0.189em;"><span class="mo" id="MathJax-Span-3107" style="vertical-align: 2.919em;"><span style="display: inline-block; position: relative; width: 0.872em; height: 0px;"><span style="position: absolute; font-family: MathJax_Size4; top: -2.788em; left: 0em;">⎛<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; font-family: MathJax_Size4; top: 0.748em; left: 0em;">⎝<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -1.672em; left: 0em;">⎜<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -1.238em; left: 0em;">⎜<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -0.741em; left: 0em;">⎜<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -0.245em; left: 0em;">⎜<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="mrow" id="MathJax-Span-3108"><span class="msubsup" id="MathJax-Span-3109"><span style="display: inline-block; position: relative; width: 3.043em; height: 0px;"><span style="position: absolute; clip: rect(3.167em, 1002.3em, 8.75em, -999.997em); top: -6.2em; left: 0em;"><span class="mrow" id="MathJax-Span-3110"><span class="mo" id="MathJax-Span-3111" style="vertical-align: 2.857em;"><span style="display: inline-block; position: relative; width: 0.685em; height: 0px;"><span style="position: absolute; font-family: MathJax_Size4; top: -2.788em; left: 0em;">⎡<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; font-family: MathJax_Size4; top: 0.561em; left: 0em;">⎣<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -1.61em; left: 0em;">⎢<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -1.051em; left: 0em;">⎢<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -0.493em; left: 0em;">⎢<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="mtable" id="MathJax-Span-3112" style="padding-right: 0.189em; padding-left: 0.189em;"><span style="display: inline-block; position: relative; width: 0.872em; height: 0px;"><span style="position: absolute; clip: rect(3.167em, 1000.87em, 8.378em, -999.997em); top: -5.828em; left: 0em;"><span style="display: inline-block; position: relative; width: 0.872em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.87em, 4.346em, -999.997em); top: -6.014em; left: 50%; margin-left: -0.431em;"><span class="mtd" id="MathJax-Span-3113"><span class="mrow" id="MathJax-Span-3114"><span class="msubsup" id="MathJax-Span-3115"><span style="display: inline-block; position: relative; width: 0.872em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.44em, 4.346em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-3116" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.437em;"><span class="mn" id="MathJax-Span-3117" style="font-size: 70.7%; font-family: MathJax_Main;">0</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.353em, 1000.87em, 4.346em, -999.997em); top: -4.587em; left: 50%; margin-left: -0.431em;"><span class="mtd" id="MathJax-Span-3118"><span class="mrow" id="MathJax-Span-3119"><span class="msubsup" id="MathJax-Span-3120"><span style="display: inline-block; position: relative; width: 0.872em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.44em, 4.346em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-3121" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.437em;"><span class="mn" id="MathJax-Span-3122" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.353em, 1000.87em, 4.346em, -999.997em); top: -3.223em; left: 50%; margin-left: -0.431em;"><span class="mtd" id="MathJax-Span-3123"><span class="mrow" id="MathJax-Span-3124"><span class="msubsup" id="MathJax-Span-3125"><span style="display: inline-block; position: relative; width: 0.872em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.44em, 4.346em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-3126" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.437em;"><span class="mn" id="MathJax-Span-3127" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.353em, 1000.87em, 4.346em, -999.997em); top: -1.796em; left: 50%; margin-left: -0.431em;"><span class="mtd" id="MathJax-Span-3128"><span class="mrow" id="MathJax-Span-3129"><span class="msubsup" id="MathJax-Span-3130"><span style="display: inline-block; position: relative; width: 0.872em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.44em, 4.346em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-3131" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.437em;"><span class="mn" id="MathJax-Span-3132" style="font-size: 70.7%; font-family: MathJax_Main;">3</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span><span style="display: inline-block; width: 0px; height: 5.834em;"></span></span></span></span><span class="mo" id="MathJax-Span-3133" style="vertical-align: 2.857em;"><span style="display: inline-block; position: relative; width: 0.685em; height: 0px;"><span style="position: absolute; font-family: MathJax_Size4; top: -2.788em; left: 0em;">⎤<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; font-family: MathJax_Size4; top: 0.561em; left: 0em;">⎦<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -1.61em; left: 0em;">⎥<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -1.051em; left: 0em;">⎥<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -0.493em; left: 0em;">⎥<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 6.207em;"></span></span><span style="position: absolute; top: -1.61em; left: 2.609em;"><span class="mi" id="MathJax-Span-3134" style="font-size: 70.7%; font-family: MathJax_Math-italic;">k</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="mo" id="MathJax-Span-3135" style="font-family: MathJax_Main;">–</span><span class="msubsup" id="MathJax-Span-3136" style="padding-left: 0.189em;"><span style="display: inline-block; position: relative; width: 3.911em; height: 0px;"><span style="position: absolute; clip: rect(3.167em, 1002.3em, 8.75em, -999.997em); top: -6.2em; left: 0em;"><span class="mrow" id="MathJax-Span-3137"><span class="mo" id="MathJax-Span-3138" style="vertical-align: 2.857em;"><span style="display: inline-block; position: relative; width: 0.685em; height: 0px;"><span style="position: absolute; font-family: MathJax_Size4; top: -2.788em; left: 0em;">⎡<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; font-family: MathJax_Size4; top: 0.561em; left: 0em;">⎣<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -1.61em; left: 0em;">⎢<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -1.051em; left: 0em;">⎢<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -0.493em; left: 0em;">⎢<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="mtable" id="MathJax-Span-3139" style="padding-right: 0.189em; padding-left: 0.189em;"><span style="display: inline-block; position: relative; width: 0.872em; height: 0px;"><span style="position: absolute; clip: rect(3.167em, 1000.87em, 8.378em, -999.997em); top: -5.828em; left: 0em;"><span style="display: inline-block; position: relative; width: 0.872em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.87em, 4.346em, -999.997em); top: -6.014em; left: 50%; margin-left: -0.431em;"><span class="mtd" id="MathJax-Span-3140"><span class="mrow" id="MathJax-Span-3141"><span class="msubsup" id="MathJax-Span-3142"><span style="display: inline-block; position: relative; width: 0.872em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.44em, 4.346em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-3143" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.437em;"><span class="mn" id="MathJax-Span-3144" style="font-size: 70.7%; font-family: MathJax_Main;">0</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.353em, 1000.87em, 4.346em, -999.997em); top: -4.587em; left: 50%; margin-left: -0.431em;"><span class="mtd" id="MathJax-Span-3145"><span class="mrow" id="MathJax-Span-3146"><span class="msubsup" id="MathJax-Span-3147"><span style="display: inline-block; position: relative; width: 0.872em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.44em, 4.346em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-3148" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.437em;"><span class="mn" id="MathJax-Span-3149" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.353em, 1000.87em, 4.346em, -999.997em); top: -3.223em; left: 50%; margin-left: -0.431em;"><span class="mtd" id="MathJax-Span-3150"><span class="mrow" id="MathJax-Span-3151"><span class="msubsup" id="MathJax-Span-3152"><span style="display: inline-block; position: relative; width: 0.872em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.44em, 4.346em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-3153" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.437em;"><span class="mn" id="MathJax-Span-3154" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.353em, 1000.87em, 4.346em, -999.997em); top: -1.796em; left: 50%; margin-left: -0.431em;"><span class="mtd" id="MathJax-Span-3155"><span class="mrow" id="MathJax-Span-3156"><span class="msubsup" id="MathJax-Span-3157"><span style="display: inline-block; position: relative; width: 0.872em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.44em, 4.346em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-3158" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.437em;"><span class="mn" id="MathJax-Span-3159" style="font-size: 70.7%; font-family: MathJax_Main;">3</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span><span style="display: inline-block; width: 0px; height: 5.834em;"></span></span></span></span><span class="mo" id="MathJax-Span-3160" style="vertical-align: 2.857em;"><span style="display: inline-block; position: relative; width: 0.685em; height: 0px;"><span style="position: absolute; font-family: MathJax_Size4; top: -2.788em; left: 0em;">⎤<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; font-family: MathJax_Size4; top: 0.561em; left: 0em;">⎦<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -1.61em; left: 0em;">⎥<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -1.051em; left: 0em;">⎥<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -0.493em; left: 0em;">⎥<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 6.207em;"></span></span><span style="position: absolute; top: -1.61em; left: 2.609em;"><span class="texatom" id="MathJax-Span-3161"><span class="mrow" id="MathJax-Span-3162"><span class="mi" id="MathJax-Span-3163" style="font-size: 70.7%; font-family: MathJax_Math-italic;">k</span><span class="mo" id="MathJax-Span-3164" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="mn" id="MathJax-Span-3165" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span><span class="mo" id="MathJax-Span-3166" style="vertical-align: 2.919em;"><span style="display: inline-block; position: relative; width: 0.872em; height: 0px;"><span style="position: absolute; font-family: MathJax_Size4; top: -2.788em; left: 0em;">⎞<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; font-family: MathJax_Size4; top: 0.748em; left: 0em;">⎠<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -1.672em; left: 0em;">⎟<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -1.238em; left: 0em;">⎟<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -0.741em; left: 0em;">⎟<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -0.245em; left: 0em;">⎟<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 5.276em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -3.073em; border-left: 0px solid; width: 0px; height: 6.85em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>h</mi><mi>a</mi></msub><mo stretchy="false">(</mo><msub><mi>q</mi><mi>k</mi></msub><mo stretchy="false">)</mo><msub><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><mrow class="MJX-TeXAtom-ORD"><msub><mi>q</mi><mi>k</mi></msub><mo>=</mo><msub><mi>q</mi><mrow class="MJX-TeXAtom-ORD"><mi>k</mi><mo>−</mo><mn>1</mn></mrow></msub></mrow></msub><mo>=</mo><msub><mrow><mo>[</mo><mtable rowspacing="4pt" columnspacing="1em"><mtr><mtd><mn>2</mn><mo stretchy="false">(</mo><msub><mi>q</mi><mn>1</mn></msub><msub><mi>q</mi><mn>3</mn></msub><mo>–</mo><msub><mi>q</mi><mn>0</mn></msub><msub><mi>q</mi><mn>2</mn></msub><mo stretchy="false">)</mo></mtd></mtr><mtr><mtd><mn>2</mn><mo stretchy="false">(</mo><msub><mi>q</mi><mn>2</mn></msub><msub><mi>q</mi><mn>3</mn></msub><mo>+</mo><msub><mi>q</mi><mn>0</mn></msub><msub><mi>q</mi><mn>1</mn></msub><mo stretchy="false">)</mo></mtd></mtr><mtr><mtd><msubsup><mi>q</mi><mn>0</mn><mn>2</mn></msubsup><mo>–</mo><msubsup><mi>q</mi><mn>1</mn><mn>2</mn></msubsup><mo>–</mo><msubsup><mi>q</mi><mn>2</mn><mn>2</mn></msubsup><mo>+</mo><msubsup><mi>q</mi><mn>3</mn><mn>2</mn></msubsup></mtd></mtr></mtable><mo>]</mo></mrow><mrow class="MJX-TeXAtom-ORD"><mi>k</mi><mo>−</mo><mn>1</mn></mrow></msub><mo>+</mo><mn>2</mn><msub><mrow><mo>[</mo><mtable rowspacing="4pt" columnspacing="1em"><mtr><mtd><mo>−</mo><msub><mi>q</mi><mn>2</mn></msub></mtd><mtd><msub><mi>q</mi><mn>3</mn></msub></mtd><mtd><mo>−</mo><msub><mi>q</mi><mn>0</mn></msub></mtd><mtd><msub><mi>q</mi><mn>1</mn></msub></mtd></mtr><mtr><mtd><msub><mi>q</mi><mn>1</mn></msub></mtd><mtd><msub><mi>q</mi><mn>0</mn></msub></mtd><mtd><msub><mi>q</mi><mn>3</mn></msub></mtd><mtd><msub><mi>q</mi><mn>2</mn></msub></mtd></mtr><mtr><mtd><msub><mi>q</mi><mn>0</mn></msub></mtd><mtd><mo>−</mo><msub><mi>q</mi><mn>1</mn></msub></mtd><mtd><mo>−</mo><msub><mi>q</mi><mn>2</mn></msub></mtd><mtd><msub><mi>q</mi><mn>3</mn></msub></mtd></mtr></mtable><mo>]</mo></mrow><mrow class="MJX-TeXAtom-ORD"><mi>k</mi><mo>−</mo><mn>1</mn></mrow></msub><mrow><mo>(</mo><mrow><msub><mrow><mo>[</mo><mtable rowspacing="4pt" columnspacing="1em"><mtr><mtd><msub><mi>q</mi><mn>0</mn></msub></mtd></mtr><mtr><mtd><msub><mi>q</mi><mn>1</mn></msub></mtd></mtr><mtr><mtd><msub><mi>q</mi><mn>2</mn></msub></mtd></mtr><mtr><mtd><msub><mi>q</mi><mn>3</mn></msub></mtd></mtr></mtable><mo>]</mo></mrow><mi>k</mi></msub><mo>–</mo><msub><mrow><mo>[</mo><mtable rowspacing="4pt" columnspacing="1em"><mtr><mtd><msub><mi>q</mi><mn>0</mn></msub></mtd></mtr><mtr><mtd><msub><mi>q</mi><mn>1</mn></msub></mtd></mtr><mtr><mtd><msub><mi>q</mi><mn>2</mn></msub></mtd></mtr><mtr><mtd><msub><mi>q</mi><mn>3</mn></msub></mtd></mtr></mtable><mo>]</mo></mrow><mrow class="MJX-TeXAtom-ORD"><mi>k</mi><mo>−</mo><mn>1</mn></mrow></msub></mrow><mo>)</mo></mrow></math></span></span><script type="math/tex" id="MathJax-Element-61">h_a(q_k)|_{q_k=q_{k-1}} = \begin{bmatrix} 2(q_1q_3 – q_0q_2) \\ 2(q_2q_3 + q_0q_1) \\ q_0^2 – q_1^2 – q_2^2 + q_3^2 \end{bmatrix}_{k-1} + 2\begin{bmatrix} -q_2 & q_3 & -q_0 & q_1 \\ q_1 & q_0 & q_3 & q_2 \\ q_0 & -q_1 & -q_2 & q_3 \end{bmatrix}_{k-1} \left( \begin{bmatrix} q_0 \\ q_1 \\ q_2 \\ q_3 \end{bmatrix}_k – \begin{bmatrix} q_0 \\ q_1 \\ q_2 \\ q_3 \end{bmatrix}_{k-1} \right)</script><br>
——————–&nbsp; &nbsp; &nbsp;(14)</p>
<p>Now that we have the linearized form of the non-linear equation, let us write out the whole linearized solution of equation (10).</p>
<p><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-62-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mrow&gt;&lt;mo&gt;[&lt;/mo&gt;&lt;mtable rowspacing=&quot;4pt&quot; columnspacing=&quot;1em&quot;&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;msup&gt;&lt;mi&gt;&lt;/mi&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;/msup&gt;&lt;msub&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;msup&gt;&lt;mi&gt;&lt;/mi&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;/msup&gt;&lt;msub&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;msup&gt;&lt;mi&gt;&lt;/mi&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;/msup&gt;&lt;msub&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;/mtable&gt;&lt;mo&gt;]&lt;/mo&gt;&lt;/mrow&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mi&gt;g&lt;/mi&gt;&lt;mrow&gt;&lt;mo&gt;[&lt;/mo&gt;&lt;mrow&gt;&lt;msub&gt;&lt;mrow&gt;&lt;mo&gt;[&lt;/mo&gt;&lt;mtable rowspacing=&quot;4pt&quot; columnspacing=&quot;1em&quot;&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;msub&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mn&gt;3&lt;/mn&gt;&lt;/msub&gt;&lt;mo&gt;&amp;#x2013;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/msub&gt;&lt;msub&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msub&gt;&lt;msub&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mn&gt;3&lt;/mn&gt;&lt;/msub&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/msub&gt;&lt;msub&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;msubsup&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msubsup&gt;&lt;mo&gt;&amp;#x2013;&lt;/mo&gt;&lt;msubsup&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msubsup&gt;&lt;mo&gt;&amp;#x2013;&lt;/mo&gt;&lt;msubsup&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msubsup&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;msubsup&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mn&gt;3&lt;/mn&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msubsup&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;/mtable&gt;&lt;mo&gt;]&lt;/mo&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;msub&gt;&lt;mrow&gt;&lt;mo&gt;[&lt;/mo&gt;&lt;mtable rowspacing=&quot;4pt&quot; columnspacing=&quot;1em&quot;&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mn&gt;3&lt;/mn&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mn&gt;3&lt;/mn&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mn&gt;3&lt;/mn&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;/mtable&gt;&lt;mo&gt;]&lt;/mo&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mrow&gt;&lt;mo&gt;(&lt;/mo&gt;&lt;mrow&gt;&lt;msub&gt;&lt;mrow&gt;&lt;mo&gt;[&lt;/mo&gt;&lt;mtable rowspacing=&quot;4pt&quot; columnspacing=&quot;1em&quot;&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mn&gt;3&lt;/mn&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;/mtable&gt;&lt;mo&gt;]&lt;/mo&gt;&lt;/mrow&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;&amp;#x2013;&lt;/mo&gt;&lt;msub&gt;&lt;mrow&gt;&lt;mo&gt;[&lt;/mo&gt;&lt;mtable rowspacing=&quot;4pt&quot; columnspacing=&quot;1em&quot;&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mn&gt;3&lt;/mn&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;/mtable&gt;&lt;mo&gt;]&lt;/mo&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;mo&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;/mrow&gt;&lt;mo&gt;]&lt;/mo&gt;&lt;/mrow&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;msub&gt;&lt;mrow&gt;&lt;mo&gt;[&lt;/mo&gt;&lt;mtable rowspacing=&quot;4pt&quot; columnspacing=&quot;1em&quot;&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mi&gt;C&lt;/mi&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mi&gt;C&lt;/mi&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mi&gt;C&lt;/mi&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;/mtable&gt;&lt;mo&gt;]&lt;/mo&gt;&lt;/mrow&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-3167" style="width: 55.896em; display: inline-block;"><span style="display: inline-block; position: relative; width: 45.04em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(2.174em, 1045.04em, 7.882em, -999.997em); top: -5.27em; left: 0em;"><span class="mrow" id="MathJax-Span-3168"><span class="msubsup" id="MathJax-Span-3169"><span style="display: inline-block; position: relative; width: 3.539em; height: 0px;"><span style="position: absolute; clip: rect(2.547em, 1002.79em, 7.013em, -999.997em); top: -5.022em; left: 0em;"><span class="mrow" id="MathJax-Span-3170"><span class="mo" id="MathJax-Span-3171" style="vertical-align: 2.298em;"><span style="display: inline-block; position: relative; width: 0.685em; height: 0px;"><span style="position: absolute; font-family: MathJax_Size4; top: -2.788em; left: 0em;">⎡<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; font-family: MathJax_Size4; top: -0.555em; left: 0em;">⎣<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -1.61em; left: 0em;">⎢<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="mtable" id="MathJax-Span-3172" style="padding-right: 0.189em; padding-left: 0.189em;"><span style="display: inline-block; position: relative; width: 1.368em; height: 0px;"><span style="position: absolute; clip: rect(2.547em, 1001.37em, 6.951em, -999.997em); top: -5.022em; left: 0em;"><span style="display: inline-block; position: relative; width: 1.368em; height: 0px;"><span style="position: absolute; clip: rect(2.919em, 1001.37em, 4.346em, -999.997em); top: -5.394em; left: 50%; margin-left: -0.679em;"><span class="mtd" id="MathJax-Span-3173"><span class="mrow" id="MathJax-Span-3174"><span class="msubsup" id="MathJax-Span-3175"><span style="display: inline-block; position: relative; width: 0.375em; height: 0px;"><span style="position: absolute; clip: rect(3.787em, 1000em, 4.159em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-3176"></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -4.339em; left: 0em;"><span class="mi" id="MathJax-Span-3177" style="font-size: 70.7%; font-family: MathJax_Math-italic;">b</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-3178"><span style="display: inline-block; position: relative; width: 0.996em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.5em, 4.159em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-3179" style="font-family: MathJax_Math-italic;">a</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.561em;"><span class="mi" id="MathJax-Span-3180" style="font-size: 70.7%; font-family: MathJax_Math-italic;">x</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(2.919em, 1001.31em, 4.47em, -999.997em); top: -3.967em; left: 50%; margin-left: -0.679em;"><span class="mtd" id="MathJax-Span-3181"><span class="mrow" id="MathJax-Span-3182"><span class="msubsup" id="MathJax-Span-3183"><span style="display: inline-block; position: relative; width: 0.375em; height: 0px;"><span style="position: absolute; clip: rect(3.787em, 1000em, 4.159em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-3184"></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -4.339em; left: 0em;"><span class="mi" id="MathJax-Span-3185" style="font-size: 70.7%; font-family: MathJax_Math-italic;">b</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-3186"><span style="display: inline-block; position: relative; width: 0.934em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.5em, 4.159em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-3187" style="font-family: MathJax_Math-italic;">a</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.561em;"><span class="mi" id="MathJax-Span-3188" style="font-size: 70.7%; font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(2.919em, 1001.31em, 4.346em, -999.997em); top: -2.416em; left: 50%; margin-left: -0.679em;"><span class="mtd" id="MathJax-Span-3189"><span class="mrow" id="MathJax-Span-3190"><span class="msubsup" id="MathJax-Span-3191"><span style="display: inline-block; position: relative; width: 0.375em; height: 0px;"><span style="position: absolute; clip: rect(3.787em, 1000em, 4.159em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-3192"></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -4.339em; left: 0em;"><span class="mi" id="MathJax-Span-3193" style="font-size: 70.7%; font-family: MathJax_Math-italic;">b</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-3194"><span style="display: inline-block; position: relative; width: 0.934em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.5em, 4.159em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-3195" style="font-family: MathJax_Math-italic;">a</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.561em;"><span class="mi" id="MathJax-Span-3196" style="font-size: 70.7%; font-family: MathJax_Math-italic;">z<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span><span style="display: inline-block; width: 0px; height: 5.028em;"></span></span></span></span><span class="mo" id="MathJax-Span-3197" style="vertical-align: 2.298em;"><span style="display: inline-block; position: relative; width: 0.685em; height: 0px;"><span style="position: absolute; font-family: MathJax_Size4; top: -2.788em; left: 0em;">⎤<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; font-family: MathJax_Size4; top: -0.555em; left: 0em;">⎦<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -1.61em; left: 0em;">⎥<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 5.028em;"></span></span><span style="position: absolute; top: -2.168em; left: 3.105em;"><span class="mi" id="MathJax-Span-3198" style="font-size: 70.7%; font-family: MathJax_Math-italic;">k</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="mo" id="MathJax-Span-3199" style="font-family: MathJax_Main; padding-left: 0.251em;">=</span><span class="mo" id="MathJax-Span-3200" style="font-family: MathJax_Main; padding-left: 0.251em;">−</span><span class="mi" id="MathJax-Span-3201" style="font-family: MathJax_Math-italic;">g<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mrow" id="MathJax-Span-3202" style="padding-left: 0.189em;"><span class="mo" id="MathJax-Span-3203" style="vertical-align: 2.919em;"><span style="display: inline-block; position: relative; width: 0.685em; height: 0px;"><span style="position: absolute; font-family: MathJax_Size4; top: -2.788em; left: 0em;">⎡<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; font-family: MathJax_Size4; top: 0.748em; left: 0em;">⎣<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -1.672em; left: 0em;">⎢<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -1.238em; left: 0em;">⎢<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -0.741em; left: 0em;">⎢<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -0.245em; left: 0em;">⎢<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="mrow" id="MathJax-Span-3204"><span class="msubsup" id="MathJax-Span-3205"><span style="display: inline-block; position: relative; width: 9.494em; height: 0px;"><span style="position: absolute; clip: rect(2.547em, 1007.82em, 7.013em, -999.997em); top: -5.022em; left: 0em;"><span class="mrow" id="MathJax-Span-3206"><span class="mo" id="MathJax-Span-3207" style="vertical-align: 2.298em;"><span style="display: inline-block; position: relative; width: 0.685em; height: 0px;"><span style="position: absolute; font-family: MathJax_Size4; top: -2.788em; left: 0em;">⎡<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; font-family: MathJax_Size4; top: -0.555em; left: 0em;">⎣<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -1.672em; left: 0em;">⎢<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="mtable" id="MathJax-Span-3208" style="padding-right: 0.189em; padding-left: 0.189em;"><span style="display: inline-block; position: relative; width: 6.455em; height: 0px;"><span style="position: absolute; clip: rect(2.547em, 1006.46em, 6.951em, -999.997em); top: -4.96em; left: 0em;"><span style="display: inline-block; position: relative; width: 6.455em; height: 0px;"><span style="position: absolute; clip: rect(3.043em, 1005.4em, 4.408em, -999.997em); top: -5.456em; left: 50%; margin-left: -2.726em;"><span class="mtd" id="MathJax-Span-3209"><span class="mrow" id="MathJax-Span-3210"><span class="mn" id="MathJax-Span-3211" style="font-family: MathJax_Main;">2</span><span class="mo" id="MathJax-Span-3212" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-3213"><span style="display: inline-block; position: relative; width: 0.872em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.44em, 4.346em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-3214" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.437em;"><span class="mn" id="MathJax-Span-3215" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-3216"><span style="display: inline-block; position: relative; width: 0.872em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.44em, 4.346em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-3217" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.437em;"><span class="mn" id="MathJax-Span-3218" style="font-size: 70.7%; font-family: MathJax_Main;">3</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="mo" id="MathJax-Span-3219" style="font-family: MathJax_Main;">–</span><span class="msubsup" id="MathJax-Span-3220" style="padding-left: 0.189em;"><span style="display: inline-block; position: relative; width: 0.872em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.44em, 4.346em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-3221" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.437em;"><span class="mn" id="MathJax-Span-3222" style="font-size: 70.7%; font-family: MathJax_Main;">0</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-3223"><span style="display: inline-block; position: relative; width: 0.872em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.44em, 4.346em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-3224" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.437em;"><span class="mn" id="MathJax-Span-3225" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="mo" id="MathJax-Span-3226" style="font-family: MathJax_Main;">)</span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.043em, 1005.96em, 4.408em, -999.997em); top: -3.967em; left: 50%; margin-left: -3.037em;"><span class="mtd" id="MathJax-Span-3227"><span class="mrow" id="MathJax-Span-3228"><span class="mn" id="MathJax-Span-3229" style="font-family: MathJax_Main;">2</span><span class="mo" id="MathJax-Span-3230" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-3231"><span style="display: inline-block; position: relative; width: 0.872em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.44em, 4.346em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-3232" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.437em;"><span class="mn" id="MathJax-Span-3233" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-3234"><span style="display: inline-block; position: relative; width: 0.872em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.44em, 4.346em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-3235" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.437em;"><span class="mn" id="MathJax-Span-3236" style="font-size: 70.7%; font-family: MathJax_Main;">3</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="mo" id="MathJax-Span-3237" style="font-family: MathJax_Main; padding-left: 0.251em;">+</span><span class="msubsup" id="MathJax-Span-3238" style="padding-left: 0.251em;"><span style="display: inline-block; position: relative; width: 0.872em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.44em, 4.346em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-3239" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.437em;"><span class="mn" id="MathJax-Span-3240" style="font-size: 70.7%; font-family: MathJax_Main;">0</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-3241"><span style="display: inline-block; position: relative; width: 0.872em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.44em, 4.346em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-3242" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.437em;"><span class="mn" id="MathJax-Span-3243" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="mo" id="MathJax-Span-3244" style="font-family: MathJax_Main;">)</span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(2.981em, 1006.46em, 4.47em, -999.997em); top: -2.54em; left: 50%; margin-left: -3.223em;"><span class="mtd" id="MathJax-Span-3245"><span class="mrow" id="MathJax-Span-3246"><span class="msubsup" id="MathJax-Span-3247"><span style="display: inline-block; position: relative; width: 0.934em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.44em, 4.346em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-3248" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.291em, 1000.44em, 4.159em, -999.997em); top: -4.339em; left: 0.499em;"><span class="mn" id="MathJax-Span-3249" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.291em, 1000.44em, 4.159em, -999.997em); top: -3.657em; left: 0.437em;"><span class="mn" id="MathJax-Span-3250" style="font-size: 70.7%; font-family: MathJax_Main;">0</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="mo" id="MathJax-Span-3251" style="font-family: MathJax_Main;">–</span><span class="msubsup" id="MathJax-Span-3252" style="padding-left: 0.189em;"><span style="display: inline-block; position: relative; width: 0.934em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.44em, 4.346em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-3253" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.291em, 1000.44em, 4.159em, -999.997em); top: -4.339em; left: 0.499em;"><span class="mn" id="MathJax-Span-3254" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.291em, 1000.44em, 4.159em, -999.997em); top: -3.657em; left: 0.437em;"><span class="mn" id="MathJax-Span-3255" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="mo" id="MathJax-Span-3256" style="font-family: MathJax_Main;">–</span><span class="msubsup" id="MathJax-Span-3257" style="padding-left: 0.189em;"><span style="display: inline-block; position: relative; width: 0.934em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.44em, 4.346em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-3258" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.291em, 1000.44em, 4.159em, -999.997em); top: -4.339em; left: 0.499em;"><span class="mn" id="MathJax-Span-3259" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.291em, 1000.44em, 4.159em, -999.997em); top: -3.657em; left: 0.437em;"><span class="mn" id="MathJax-Span-3260" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="mo" id="MathJax-Span-3261" style="font-family: MathJax_Main; padding-left: 0.251em;">+</span><span class="msubsup" id="MathJax-Span-3262" style="padding-left: 0.251em;"><span style="display: inline-block; position: relative; width: 0.934em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.44em, 4.346em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-3263" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.291em, 1000.44em, 4.159em, -999.997em); top: -4.339em; left: 0.499em;"><span class="mn" id="MathJax-Span-3264" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.291em, 1000.44em, 4.159em, -999.997em); top: -3.657em; left: 0.437em;"><span class="mn" id="MathJax-Span-3265" style="font-size: 70.7%; font-family: MathJax_Main;">3</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.966em;"></span></span></span></span><span class="mo" id="MathJax-Span-3266" style="vertical-align: 2.298em;"><span style="display: inline-block; position: relative; width: 0.685em; height: 0px;"><span style="position: absolute; font-family: MathJax_Size4; top: -2.788em; left: 0em;">⎤<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; font-family: MathJax_Size4; top: -0.555em; left: 0em;">⎦<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -1.672em; left: 0em;">⎥<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 5.028em;"></span></span><span style="position: absolute; top: -2.168em; left: 8.13em;"><span class="texatom" id="MathJax-Span-3267"><span class="mrow" id="MathJax-Span-3268"><span class="mi" id="MathJax-Span-3269" style="font-size: 70.7%; font-family: MathJax_Math-italic;">k</span><span class="mo" id="MathJax-Span-3270" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="mn" id="MathJax-Span-3271" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="mo" id="MathJax-Span-3272" style="font-family: MathJax_Main; padding-left: 0.251em;">+</span><span class="mn" id="MathJax-Span-3273" style="font-family: MathJax_Main; padding-left: 0.251em;">2</span><span class="msubsup" id="MathJax-Span-3274"><span style="display: inline-block; position: relative; width: 11.914em; height: 0px;"><span style="position: absolute; clip: rect(2.422em, 1010.24em, 6.641em, -999.997em); top: -4.774em; left: 0em;"><span class="mrow" id="MathJax-Span-3275"><span class="mo" id="MathJax-Span-3276" style="vertical-align: 2.174em;"><span style="display: inline-block; position: relative; width: 0.685em; height: 0px;"><span style="position: absolute; font-family: MathJax_Size4; top: -2.788em; left: 0em;">⎡<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; font-family: MathJax_Size4; top: -0.803em; left: 0em;">⎣<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -1.796em; left: 0em;">⎢<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="mtable" id="MathJax-Span-3277" style="padding-right: 0.189em; padding-left: 0.189em;"><span style="display: inline-block; position: relative; width: 8.812em; height: 0px;"><span style="position: absolute; clip: rect(2.484em, 1001.68em, 6.455em, -999.997em); top: -4.587em; left: 0em;"><span style="display: inline-block; position: relative; width: 1.678em; height: 0px;"><span style="position: absolute; clip: rect(3.229em, 1001.68em, 4.346em, -999.997em); top: -5.332em; left: 50%; margin-left: -0.803em;"><span class="mtd" id="MathJax-Span-3278"><span class="mrow" id="MathJax-Span-3279"><span class="mo" id="MathJax-Span-3280" style="font-family: MathJax_Main;">−</span><span class="msubsup" id="MathJax-Span-3281"><span style="display: inline-block; position: relative; width: 0.872em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.44em, 4.346em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-3282" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.437em;"><span class="mn" id="MathJax-Span-3283" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.353em, 1000.87em, 4.346em, -999.997em); top: -3.905em; left: 50%; margin-left: -0.431em;"><span class="mtd" id="MathJax-Span-3300"><span class="mrow" id="MathJax-Span-3301"><span class="msubsup" id="MathJax-Span-3302"><span style="display: inline-block; position: relative; width: 0.872em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.44em, 4.346em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-3303" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.437em;"><span class="mn" id="MathJax-Span-3304" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.353em, 1000.87em, 4.346em, -999.997em); top: -2.54em; left: 50%; margin-left: -0.431em;"><span class="mtd" id="MathJax-Span-3320"><span class="mrow" id="MathJax-Span-3321"><span class="msubsup" id="MathJax-Span-3322"><span style="display: inline-block; position: relative; width: 0.872em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.44em, 4.346em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-3323" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.437em;"><span class="mn" id="MathJax-Span-3324" style="font-size: 70.7%; font-family: MathJax_Main;">0</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.594em;"></span></span><span style="position: absolute; clip: rect(2.484em, 1001.68em, 6.331em, -999.997em); top: -4.463em; left: 2.671em;"><span style="display: inline-block; position: relative; width: 1.678em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.87em, 4.346em, -999.997em); top: -5.332em; left: 50%; margin-left: -0.431em;"><span class="mtd" id="MathJax-Span-3284"><span class="mrow" id="MathJax-Span-3285"><span class="msubsup" id="MathJax-Span-3286"><span style="display: inline-block; position: relative; width: 0.872em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.44em, 4.346em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-3287" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.437em;"><span class="mn" id="MathJax-Span-3288" style="font-size: 70.7%; font-family: MathJax_Main;">3</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.353em, 1000.87em, 4.346em, -999.997em); top: -3.905em; left: 50%; margin-left: -0.431em;"><span class="mtd" id="MathJax-Span-3305"><span class="mrow" id="MathJax-Span-3306"><span class="msubsup" id="MathJax-Span-3307"><span style="display: inline-block; position: relative; width: 0.872em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.44em, 4.346em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-3308" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.437em;"><span class="mn" id="MathJax-Span-3309" style="font-size: 70.7%; font-family: MathJax_Main;">0</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.229em, 1001.68em, 4.346em, -999.997em); top: -2.54em; left: 50%; margin-left: -0.803em;"><span class="mtd" id="MathJax-Span-3325"><span class="mrow" id="MathJax-Span-3326"><span class="mo" id="MathJax-Span-3327" style="font-family: MathJax_Main;">−</span><span class="msubsup" id="MathJax-Span-3328"><span style="display: inline-block; position: relative; width: 0.872em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.44em, 4.346em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-3329" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.437em;"><span class="mn" id="MathJax-Span-3330" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.47em;"></span></span><span style="position: absolute; clip: rect(2.484em, 1001.68em, 6.455em, -999.997em); top: -4.587em; left: 5.338em;"><span style="display: inline-block; position: relative; width: 1.678em; height: 0px;"><span style="position: absolute; clip: rect(3.229em, 1001.68em, 4.346em, -999.997em); top: -5.332em; left: 50%; margin-left: -0.803em;"><span class="mtd" id="MathJax-Span-3289"><span class="mrow" id="MathJax-Span-3290"><span class="mo" id="MathJax-Span-3291" style="font-family: MathJax_Main;">−</span><span class="msubsup" id="MathJax-Span-3292"><span style="display: inline-block; position: relative; width: 0.872em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.44em, 4.346em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-3293" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.437em;"><span class="mn" id="MathJax-Span-3294" style="font-size: 70.7%; font-family: MathJax_Main;">0</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.353em, 1000.87em, 4.346em, -999.997em); top: -3.905em; left: 50%; margin-left: -0.431em;"><span class="mtd" id="MathJax-Span-3310"><span class="mrow" id="MathJax-Span-3311"><span class="msubsup" id="MathJax-Span-3312"><span style="display: inline-block; position: relative; width: 0.872em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.44em, 4.346em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-3313" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.437em;"><span class="mn" id="MathJax-Span-3314" style="font-size: 70.7%; font-family: MathJax_Main;">3</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.229em, 1001.68em, 4.346em, -999.997em); top: -2.54em; left: 50%; margin-left: -0.803em;"><span class="mtd" id="MathJax-Span-3331"><span class="mrow" id="MathJax-Span-3332"><span class="mo" id="MathJax-Span-3333" style="font-family: MathJax_Main;">−</span><span class="msubsup" id="MathJax-Span-3334"><span style="display: inline-block; position: relative; width: 0.872em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.44em, 4.346em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-3335" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.437em;"><span class="mn" id="MathJax-Span-3336" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.594em;"></span></span><span style="position: absolute; clip: rect(2.484em, 1000.87em, 6.331em, -999.997em); top: -4.463em; left: 7.944em;"><span style="display: inline-block; position: relative; width: 0.872em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.87em, 4.346em, -999.997em); top: -5.332em; left: 50%; margin-left: -0.431em;"><span class="mtd" id="MathJax-Span-3295"><span class="mrow" id="MathJax-Span-3296"><span class="msubsup" id="MathJax-Span-3297"><span style="display: inline-block; position: relative; width: 0.872em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.44em, 4.346em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-3298" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.437em;"><span class="mn" id="MathJax-Span-3299" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.353em, 1000.87em, 4.346em, -999.997em); top: -3.905em; left: 50%; margin-left: -0.431em;"><span class="mtd" id="MathJax-Span-3315"><span class="mrow" id="MathJax-Span-3316"><span class="msubsup" id="MathJax-Span-3317"><span style="display: inline-block; position: relative; width: 0.872em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.44em, 4.346em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-3318" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.437em;"><span class="mn" id="MathJax-Span-3319" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.353em, 1000.87em, 4.346em, -999.997em); top: -2.54em; left: 50%; margin-left: -0.431em;"><span class="mtd" id="MathJax-Span-3337"><span class="mrow" id="MathJax-Span-3338"><span class="msubsup" id="MathJax-Span-3339"><span style="display: inline-block; position: relative; width: 0.872em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.44em, 4.346em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-3340" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.437em;"><span class="mn" id="MathJax-Span-3341" style="font-size: 70.7%; font-family: MathJax_Main;">3</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.47em;"></span></span></span></span><span class="mo" id="MathJax-Span-3342" style="vertical-align: 2.174em;"><span style="display: inline-block; position: relative; width: 0.685em; height: 0px;"><span style="position: absolute; font-family: MathJax_Size4; top: -2.788em; left: 0em;">⎤<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; font-family: MathJax_Size4; top: -0.803em; left: 0em;">⎦<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -1.796em; left: 0em;">⎥<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.78em;"></span></span><span style="position: absolute; top: -2.292em; left: 10.549em;"><span class="texatom" id="MathJax-Span-3343"><span class="mrow" id="MathJax-Span-3344"><span class="mi" id="MathJax-Span-3345" style="font-size: 70.7%; font-family: MathJax_Math-italic;">k</span><span class="mo" id="MathJax-Span-3346" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="mn" id="MathJax-Span-3347" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="mrow" id="MathJax-Span-3348" style="padding-left: 0.189em;"><span class="mo" id="MathJax-Span-3349" style="vertical-align: 2.919em;"><span style="display: inline-block; position: relative; width: 0.872em; height: 0px;"><span style="position: absolute; font-family: MathJax_Size4; top: -2.788em; left: 0em;">⎛<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; font-family: MathJax_Size4; top: 0.748em; left: 0em;">⎝<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -1.672em; left: 0em;">⎜<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -1.238em; left: 0em;">⎜<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -0.741em; left: 0em;">⎜<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -0.245em; left: 0em;">⎜<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="mrow" id="MathJax-Span-3350"><span class="msubsup" id="MathJax-Span-3351"><span style="display: inline-block; position: relative; width: 3.043em; height: 0px;"><span style="position: absolute; clip: rect(3.167em, 1002.3em, 8.75em, -999.997em); top: -6.2em; left: 0em;"><span class="mrow" id="MathJax-Span-3352"><span class="mo" id="MathJax-Span-3353" style="vertical-align: 2.857em;"><span style="display: inline-block; position: relative; width: 0.685em; height: 0px;"><span style="position: absolute; font-family: MathJax_Size4; top: -2.788em; left: 0em;">⎡<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; font-family: MathJax_Size4; top: 0.561em; left: 0em;">⎣<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -1.61em; left: 0em;">⎢<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -1.051em; left: 0em;">⎢<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -0.493em; left: 0em;">⎢<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="mtable" id="MathJax-Span-3354" style="padding-right: 0.189em; padding-left: 0.189em;"><span style="display: inline-block; position: relative; width: 0.872em; height: 0px;"><span style="position: absolute; clip: rect(3.167em, 1000.87em, 8.378em, -999.997em); top: -5.828em; left: 0em;"><span style="display: inline-block; position: relative; width: 0.872em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.87em, 4.346em, -999.997em); top: -6.014em; left: 50%; margin-left: -0.431em;"><span class="mtd" id="MathJax-Span-3355"><span class="mrow" id="MathJax-Span-3356"><span class="msubsup" id="MathJax-Span-3357"><span style="display: inline-block; position: relative; width: 0.872em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.44em, 4.346em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-3358" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.437em;"><span class="mn" id="MathJax-Span-3359" style="font-size: 70.7%; font-family: MathJax_Main;">0</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.353em, 1000.87em, 4.346em, -999.997em); top: -4.587em; left: 50%; margin-left: -0.431em;"><span class="mtd" id="MathJax-Span-3360"><span class="mrow" id="MathJax-Span-3361"><span class="msubsup" id="MathJax-Span-3362"><span style="display: inline-block; position: relative; width: 0.872em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.44em, 4.346em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-3363" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.437em;"><span class="mn" id="MathJax-Span-3364" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.353em, 1000.87em, 4.346em, -999.997em); top: -3.223em; left: 50%; margin-left: -0.431em;"><span class="mtd" id="MathJax-Span-3365"><span class="mrow" id="MathJax-Span-3366"><span class="msubsup" id="MathJax-Span-3367"><span style="display: inline-block; position: relative; width: 0.872em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.44em, 4.346em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-3368" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.437em;"><span class="mn" id="MathJax-Span-3369" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.353em, 1000.87em, 4.346em, -999.997em); top: -1.796em; left: 50%; margin-left: -0.431em;"><span class="mtd" id="MathJax-Span-3370"><span class="mrow" id="MathJax-Span-3371"><span class="msubsup" id="MathJax-Span-3372"><span style="display: inline-block; position: relative; width: 0.872em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.44em, 4.346em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-3373" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.437em;"><span class="mn" id="MathJax-Span-3374" style="font-size: 70.7%; font-family: MathJax_Main;">3</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span><span style="display: inline-block; width: 0px; height: 5.834em;"></span></span></span></span><span class="mo" id="MathJax-Span-3375" style="vertical-align: 2.857em;"><span style="display: inline-block; position: relative; width: 0.685em; height: 0px;"><span style="position: absolute; font-family: MathJax_Size4; top: -2.788em; left: 0em;">⎤<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; font-family: MathJax_Size4; top: 0.561em; left: 0em;">⎦<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -1.61em; left: 0em;">⎥<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -1.051em; left: 0em;">⎥<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -0.493em; left: 0em;">⎥<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 6.207em;"></span></span><span style="position: absolute; top: -1.61em; left: 2.609em;"><span class="mi" id="MathJax-Span-3376" style="font-size: 70.7%; font-family: MathJax_Math-italic;">k</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="mo" id="MathJax-Span-3377" style="font-family: MathJax_Main;">–</span><span class="msubsup" id="MathJax-Span-3378" style="padding-left: 0.189em;"><span style="display: inline-block; position: relative; width: 3.911em; height: 0px;"><span style="position: absolute; clip: rect(3.167em, 1002.3em, 8.75em, -999.997em); top: -6.2em; left: 0em;"><span class="mrow" id="MathJax-Span-3379"><span class="mo" id="MathJax-Span-3380" style="vertical-align: 2.857em;"><span style="display: inline-block; position: relative; width: 0.685em; height: 0px;"><span style="position: absolute; font-family: MathJax_Size4; top: -2.788em; left: 0em;">⎡<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; font-family: MathJax_Size4; top: 0.561em; left: 0em;">⎣<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -1.61em; left: 0em;">⎢<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -1.051em; left: 0em;">⎢<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -0.493em; left: 0em;">⎢<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="mtable" id="MathJax-Span-3381" style="padding-right: 0.189em; padding-left: 0.189em;"><span style="display: inline-block; position: relative; width: 0.872em; height: 0px;"><span style="position: absolute; clip: rect(3.167em, 1000.87em, 8.378em, -999.997em); top: -5.828em; left: 0em;"><span style="display: inline-block; position: relative; width: 0.872em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.87em, 4.346em, -999.997em); top: -6.014em; left: 50%; margin-left: -0.431em;"><span class="mtd" id="MathJax-Span-3382"><span class="mrow" id="MathJax-Span-3383"><span class="msubsup" id="MathJax-Span-3384"><span style="display: inline-block; position: relative; width: 0.872em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.44em, 4.346em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-3385" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.437em;"><span class="mn" id="MathJax-Span-3386" style="font-size: 70.7%; font-family: MathJax_Main;">0</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.353em, 1000.87em, 4.346em, -999.997em); top: -4.587em; left: 50%; margin-left: -0.431em;"><span class="mtd" id="MathJax-Span-3387"><span class="mrow" id="MathJax-Span-3388"><span class="msubsup" id="MathJax-Span-3389"><span style="display: inline-block; position: relative; width: 0.872em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.44em, 4.346em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-3390" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.437em;"><span class="mn" id="MathJax-Span-3391" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.353em, 1000.87em, 4.346em, -999.997em); top: -3.223em; left: 50%; margin-left: -0.431em;"><span class="mtd" id="MathJax-Span-3392"><span class="mrow" id="MathJax-Span-3393"><span class="msubsup" id="MathJax-Span-3394"><span style="display: inline-block; position: relative; width: 0.872em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.44em, 4.346em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-3395" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.437em;"><span class="mn" id="MathJax-Span-3396" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.353em, 1000.87em, 4.346em, -999.997em); top: -1.796em; left: 50%; margin-left: -0.431em;"><span class="mtd" id="MathJax-Span-3397"><span class="mrow" id="MathJax-Span-3398"><span class="msubsup" id="MathJax-Span-3399"><span style="display: inline-block; position: relative; width: 0.872em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.44em, 4.346em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-3400" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.437em;"><span class="mn" id="MathJax-Span-3401" style="font-size: 70.7%; font-family: MathJax_Main;">3</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span><span style="display: inline-block; width: 0px; height: 5.834em;"></span></span></span></span><span class="mo" id="MathJax-Span-3402" style="vertical-align: 2.857em;"><span style="display: inline-block; position: relative; width: 0.685em; height: 0px;"><span style="position: absolute; font-family: MathJax_Size4; top: -2.788em; left: 0em;">⎤<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; font-family: MathJax_Size4; top: 0.561em; left: 0em;">⎦<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -1.61em; left: 0em;">⎥<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -1.051em; left: 0em;">⎥<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -0.493em; left: 0em;">⎥<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 6.207em;"></span></span><span style="position: absolute; top: -1.61em; left: 2.609em;"><span class="texatom" id="MathJax-Span-3403"><span class="mrow" id="MathJax-Span-3404"><span class="mi" id="MathJax-Span-3405" style="font-size: 70.7%; font-family: MathJax_Math-italic;">k</span><span class="mo" id="MathJax-Span-3406" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="mn" id="MathJax-Span-3407" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span><span class="mo" id="MathJax-Span-3408" style="vertical-align: 2.919em;"><span style="display: inline-block; position: relative; width: 0.872em; height: 0px;"><span style="position: absolute; font-family: MathJax_Size4; top: -2.788em; left: 0em;">⎞<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; font-family: MathJax_Size4; top: 0.748em; left: 0em;">⎠<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -1.672em; left: 0em;">⎟<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -1.238em; left: 0em;">⎟<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -0.741em; left: 0em;">⎟<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -0.245em; left: 0em;">⎟<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span></span><span class="mo" id="MathJax-Span-3409" style="vertical-align: 2.919em;"><span style="display: inline-block; position: relative; width: 0.685em; height: 0px;"><span style="position: absolute; font-family: MathJax_Size4; top: -2.788em; left: 0em;">⎤<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; font-family: MathJax_Size4; top: 0.748em; left: 0em;">⎦<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -1.672em; left: 0em;">⎥<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -1.238em; left: 0em;">⎥<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -0.741em; left: 0em;">⎥<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -0.245em; left: 0em;">⎥<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span><span class="mo" id="MathJax-Span-3410" style="font-family: MathJax_Main; padding-left: 0.251em;">+</span><span class="msubsup" id="MathJax-Span-3411" style="padding-left: 0.251em;"><span style="display: inline-block; position: relative; width: 3.353em; height: 0px;"><span style="position: absolute; clip: rect(2.547em, 1002.61em, 6.765em, -999.997em); top: -4.898em; left: 0em;"><span class="mrow" id="MathJax-Span-3412"><span class="mo" id="MathJax-Span-3413" style="vertical-align: 2.174em;"><span style="display: inline-block; position: relative; width: 0.685em; height: 0px;"><span style="position: absolute; font-family: MathJax_Size4; top: -2.788em; left: 0em;">⎡<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; font-family: MathJax_Size4; top: -0.741em; left: 0em;">⎣<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -1.734em; left: 0em;">⎢<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="mtable" id="MathJax-Span-3414" style="padding-right: 0.189em; padding-left: 0.189em;"><span style="display: inline-block; position: relative; width: 1.182em; height: 0px;"><span style="position: absolute; clip: rect(2.484em, 1001.18em, 6.641em, -999.997em); top: -4.774em; left: 0em;"><span style="display: inline-block; position: relative; width: 1.182em; height: 0px;"><span style="position: absolute; clip: rect(3.105em, 1001.18em, 4.346em, -999.997em); top: -5.394em; left: 50%; margin-left: -0.617em;"><span class="mtd" id="MathJax-Span-3415"><span class="mrow" id="MathJax-Span-3416"><span class="msubsup" id="MathJax-Span-3417"><span style="display: inline-block; position: relative; width: 1.182em; height: 0px;"><span style="position: absolute; clip: rect(3.105em, 1000.75em, 4.159em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-3418" style="font-family: MathJax_Math-italic;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.065em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.748em;"><span class="mi" id="MathJax-Span-3419" style="font-size: 70.7%; font-family: MathJax_Math-italic;">x</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.105em, 1001.12em, 4.47em, -999.997em); top: -3.967em; left: 50%; margin-left: -0.555em;"><span class="mtd" id="MathJax-Span-3420"><span class="mrow" id="MathJax-Span-3421"><span class="msubsup" id="MathJax-Span-3422"><span style="display: inline-block; position: relative; width: 1.12em; height: 0px;"><span style="position: absolute; clip: rect(3.105em, 1000.75em, 4.159em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-3423" style="font-family: MathJax_Math-italic;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.065em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.748em;"><span class="mi" id="MathJax-Span-3424" style="font-size: 70.7%; font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.105em, 1001.12em, 4.346em, -999.997em); top: -2.478em; left: 50%; margin-left: -0.555em;"><span class="mtd" id="MathJax-Span-3425"><span class="mrow" id="MathJax-Span-3426"><span class="msubsup" id="MathJax-Span-3427"><span style="display: inline-block; position: relative; width: 1.12em; height: 0px;"><span style="position: absolute; clip: rect(3.105em, 1000.75em, 4.159em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-3428" style="font-family: MathJax_Math-italic;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.065em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.748em;"><span class="mi" id="MathJax-Span-3429" style="font-size: 70.7%; font-family: MathJax_Math-italic;">z<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.78em;"></span></span></span></span><span class="mo" id="MathJax-Span-3430" style="vertical-align: 2.174em;"><span style="display: inline-block; position: relative; width: 0.685em; height: 0px;"><span style="position: absolute; font-family: MathJax_Size4; top: -2.788em; left: 0em;">⎤<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; font-family: MathJax_Size4; top: -0.741em; left: 0em;">⎦<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -1.734em; left: 0em;">⎥<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.904em;"></span></span><span style="position: absolute; top: -2.23em; left: 2.919em;"><span class="mi" id="MathJax-Span-3431" style="font-size: 70.7%; font-family: MathJax_Math-italic;">k</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 5.276em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -3.073em; border-left: 0px solid; width: 0px; height: 6.85em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mrow><mo>[</mo><mtable rowspacing="4pt" columnspacing="1em"><mtr><mtd><msup><mi></mi><mi>b</mi></msup><msub><mi>a</mi><mi>x</mi></msub></mtd></mtr><mtr><mtd><msup><mi></mi><mi>b</mi></msup><msub><mi>a</mi><mi>y</mi></msub></mtd></mtr><mtr><mtd><msup><mi></mi><mi>b</mi></msup><msub><mi>a</mi><mi>z</mi></msub></mtd></mtr></mtable><mo>]</mo></mrow><mi>k</mi></msub><mo>=</mo><mo>−</mo><mi>g</mi><mrow><mo>[</mo><mrow><msub><mrow><mo>[</mo><mtable rowspacing="4pt" columnspacing="1em"><mtr><mtd><mn>2</mn><mo stretchy="false">(</mo><msub><mi>q</mi><mn>1</mn></msub><msub><mi>q</mi><mn>3</mn></msub><mo>–</mo><msub><mi>q</mi><mn>0</mn></msub><msub><mi>q</mi><mn>2</mn></msub><mo stretchy="false">)</mo></mtd></mtr><mtr><mtd><mn>2</mn><mo stretchy="false">(</mo><msub><mi>q</mi><mn>2</mn></msub><msub><mi>q</mi><mn>3</mn></msub><mo>+</mo><msub><mi>q</mi><mn>0</mn></msub><msub><mi>q</mi><mn>1</mn></msub><mo stretchy="false">)</mo></mtd></mtr><mtr><mtd><msubsup><mi>q</mi><mn>0</mn><mn>2</mn></msubsup><mo>–</mo><msubsup><mi>q</mi><mn>1</mn><mn>2</mn></msubsup><mo>–</mo><msubsup><mi>q</mi><mn>2</mn><mn>2</mn></msubsup><mo>+</mo><msubsup><mi>q</mi><mn>3</mn><mn>2</mn></msubsup></mtd></mtr></mtable><mo>]</mo></mrow><mrow class="MJX-TeXAtom-ORD"><mi>k</mi><mo>−</mo><mn>1</mn></mrow></msub><mo>+</mo><mn>2</mn><msub><mrow><mo>[</mo><mtable rowspacing="4pt" columnspacing="1em"><mtr><mtd><mo>−</mo><msub><mi>q</mi><mn>2</mn></msub></mtd><mtd><msub><mi>q</mi><mn>3</mn></msub></mtd><mtd><mo>−</mo><msub><mi>q</mi><mn>0</mn></msub></mtd><mtd><msub><mi>q</mi><mn>1</mn></msub></mtd></mtr><mtr><mtd><msub><mi>q</mi><mn>1</mn></msub></mtd><mtd><msub><mi>q</mi><mn>0</mn></msub></mtd><mtd><msub><mi>q</mi><mn>3</mn></msub></mtd><mtd><msub><mi>q</mi><mn>2</mn></msub></mtd></mtr><mtr><mtd><msub><mi>q</mi><mn>0</mn></msub></mtd><mtd><mo>−</mo><msub><mi>q</mi><mn>1</mn></msub></mtd><mtd><mo>−</mo><msub><mi>q</mi><mn>2</mn></msub></mtd><mtd><msub><mi>q</mi><mn>3</mn></msub></mtd></mtr></mtable><mo>]</mo></mrow><mrow class="MJX-TeXAtom-ORD"><mi>k</mi><mo>−</mo><mn>1</mn></mrow></msub><mrow><mo>(</mo><mrow><msub><mrow><mo>[</mo><mtable rowspacing="4pt" columnspacing="1em"><mtr><mtd><msub><mi>q</mi><mn>0</mn></msub></mtd></mtr><mtr><mtd><msub><mi>q</mi><mn>1</mn></msub></mtd></mtr><mtr><mtd><msub><mi>q</mi><mn>2</mn></msub></mtd></mtr><mtr><mtd><msub><mi>q</mi><mn>3</mn></msub></mtd></mtr></mtable><mo>]</mo></mrow><mi>k</mi></msub><mo>–</mo><msub><mrow><mo>[</mo><mtable rowspacing="4pt" columnspacing="1em"><mtr><mtd><msub><mi>q</mi><mn>0</mn></msub></mtd></mtr><mtr><mtd><msub><mi>q</mi><mn>1</mn></msub></mtd></mtr><mtr><mtd><msub><mi>q</mi><mn>2</mn></msub></mtd></mtr><mtr><mtd><msub><mi>q</mi><mn>3</mn></msub></mtd></mtr></mtable><mo>]</mo></mrow><mrow class="MJX-TeXAtom-ORD"><mi>k</mi><mo>−</mo><mn>1</mn></mrow></msub></mrow><mo>)</mo></mrow></mrow><mo>]</mo></mrow><mo>+</mo><msub><mrow><mo>[</mo><mtable rowspacing="4pt" columnspacing="1em"><mtr><mtd><msub><mi>C</mi><mi>x</mi></msub></mtd></mtr><mtr><mtd><msub><mi>C</mi><mi>y</mi></msub></mtd></mtr><mtr><mtd><msub><mi>C</mi><mi>z</mi></msub></mtd></mtr></mtable><mo>]</mo></mrow><mi>k</mi></msub></math></span></span><script type="math/tex" id="MathJax-Element-62">\begin{bmatrix} ^ba_x \\ ^ba_y \\ ^ba_z \end{bmatrix}_k = -g\left[ \begin{bmatrix} 2(q_1q_3 – q_0q_2) \\ 2(q_2q_3 + q_0q_1) \\ q_0^2 – q_1^2 – q_2^2 + q_3^2 \end{bmatrix}_{k-1} + 2\begin{bmatrix} -q_2 & q_3 & -q_0 & q_1 \\ q_1 & q_0 & q_3 & q_2 \\ q_0 & -q_1 & -q_2 & q_3 \end{bmatrix}_{k-1} \left( \begin{bmatrix} q_0 \\ q_1 \\ q_2 \\ q_3 \end{bmatrix}_k – \begin{bmatrix} q_0 \\ q_1 \\ q_2 \\ q_3 \end{bmatrix}_{k-1} \right) \right] + \begin{bmatrix} C_x \\ C_y \\ C_z \end{bmatrix}_k</script><br>
——————–&nbsp; &nbsp; &nbsp;(15)</p>
<p>Take note that <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-63-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;g&lt;/mi&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-3432" style="width: 0.623em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.499em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(1.74em, 1000.5em, 2.733em, -999.997em); top: -2.354em; left: 0em;"><span class="mrow" id="MathJax-Span-3433"><span class="mi" id="MathJax-Span-3434" style="font-family: MathJax_Math-italic;">g<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.36em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.304em; border-left: 0px solid; width: 0px; height: 0.927em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>g</mi></math></span></span><script type="math/tex" id="MathJax-Element-63">g</script> is a scalar term here. In the Python source code, you will notice that the <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-64-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;C&lt;/mi&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-3435" style="width: 1.492em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.182em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(1.492em, 1001.18em, 2.733em, -999.997em); top: -2.354em; left: 0em;"><span class="mrow" id="MathJax-Span-3436"><span class="msubsup" id="MathJax-Span-3437"><span style="display: inline-block; position: relative; width: 1.182em; height: 0px;"><span style="position: absolute; clip: rect(3.105em, 1000.75em, 4.159em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-3438" style="font-family: MathJax_Math-italic;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.065em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.748em;"><span class="mi" id="MathJax-Span-3439" style="font-size: 70.7%; font-family: MathJax_Math-italic;">k</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.36em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.304em; border-left: 0px solid; width: 0px; height: 1.235em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>C</mi><mi>k</mi></msub></math></span></span><script type="math/tex" id="MathJax-Element-64">C_k</script> matrix is missing. This is because I calibrated the accelerometer at first to deal with the bias. In other words, I was working with a 0 bias accelerometer value so the <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-65-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;C&lt;/mi&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-3440" style="width: 1.492em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.182em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(1.492em, 1001.18em, 2.733em, -999.997em); top: -2.354em; left: 0em;"><span class="mrow" id="MathJax-Span-3441"><span class="msubsup" id="MathJax-Span-3442"><span style="display: inline-block; position: relative; width: 1.182em; height: 0px;"><span style="position: absolute; clip: rect(3.105em, 1000.75em, 4.159em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-3443" style="font-family: MathJax_Math-italic;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.065em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.748em;"><span class="mi" id="MathJax-Span-3444" style="font-size: 70.7%; font-family: MathJax_Math-italic;">k</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.36em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.304em; border-left: 0px solid; width: 0px; height: 1.235em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>C</mi><mi>k</mi></msub></math></span></span><script type="math/tex" id="MathJax-Element-65">C_k</script> term becomes 0.</p>
<p>Let us now write equation (15) in a more compact matrix form so that it will be clearer.</p>
<p><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-66-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;C&lt;/mi&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mi&gt;D&lt;/mi&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-3445" style="width: 6.455em; display: inline-block;"><span style="display: inline-block; position: relative; width: 5.214em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(1.492em, 1005.21em, 2.733em, -999.997em); top: -2.354em; left: 0em;"><span class="mrow" id="MathJax-Span-3446"><span class="mi" id="MathJax-Span-3447" style="font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-3448" style="font-family: MathJax_Main; padding-left: 0.251em;">=</span><span class="mi" id="MathJax-Span-3449" style="font-family: MathJax_Math-italic; padding-left: 0.251em;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.065em;"></span></span><span class="mi" id="MathJax-Span-3450" style="font-family: MathJax_Math-italic;">x</span><span class="mo" id="MathJax-Span-3451" style="font-family: MathJax_Main; padding-left: 0.251em;">+</span><span class="mi" id="MathJax-Span-3452" style="font-family: MathJax_Math-italic; padding-left: 0.251em;">D</span></span><span style="display: inline-block; width: 0px; height: 2.36em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.304em; border-left: 0px solid; width: 0px; height: 1.312em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>y</mi><mo>=</mo><mi>C</mi><mi>x</mi><mo>+</mo><mi>D</mi></math></span></span><script type="math/tex" id="MathJax-Element-66">y = Cx + D</script></p>
<p>where</p>
<p><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-67-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;msup&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;/msup&gt;&lt;msub&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mi&gt;m&lt;/mi&gt;&lt;/msub&gt;&lt;msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;msub&gt;&lt;mrow&gt;&lt;mo&gt;[&lt;/mo&gt;&lt;mtable rowspacing=&quot;4pt&quot; columnspacing=&quot;1em&quot;&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;msup&gt;&lt;mi&gt;&lt;/mi&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;/msup&gt;&lt;msub&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;msup&gt;&lt;mi&gt;&lt;/mi&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;/msup&gt;&lt;msub&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;msup&gt;&lt;mi&gt;&lt;/mi&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;/msup&gt;&lt;msub&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;/mtable&gt;&lt;mo&gt;]&lt;/mo&gt;&lt;/mrow&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-3453" style="width: 11.728em; display: inline-block;"><span style="display: inline-block; position: relative; width: 9.432em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(-0.121em, 1009.43em, 4.346em, -999.997em); top: -2.354em; left: 0em;"><span class="mrow" id="MathJax-Span-3454"><span class="mi" id="MathJax-Span-3455" style="font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-3456" style="font-family: MathJax_Main; padding-left: 0.251em;">=</span><span class="msubsup" id="MathJax-Span-3457" style="padding-left: 0.251em;"><span style="display: inline-block; position: relative; width: 0.748em; height: 0px;"><span style="position: absolute; clip: rect(3.043em, 1000.31em, 4.408em, -999.997em); top: -3.967em; left: 0em;"><span class="mo" id="MathJax-Span-3458" style="font-family: MathJax_Main;">(</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -4.339em; left: 0.375em;"><span class="mi" id="MathJax-Span-3459" style="font-size: 70.7%; font-family: MathJax_Math-italic;">b</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-3460"><span style="display: inline-block; position: relative; width: 1.244em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.5em, 4.159em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-3461" style="font-family: MathJax_Math-italic;">a</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.561em;"><span class="mi" id="MathJax-Span-3462" style="font-size: 70.7%; font-family: MathJax_Math-italic;">m</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-3463"><span style="display: inline-block; position: relative; width: 0.81em; height: 0px;"><span style="position: absolute; clip: rect(3.043em, 1000.31em, 4.408em, -999.997em); top: -3.967em; left: 0em;"><span class="mo" id="MathJax-Span-3464" style="font-family: MathJax_Main;">)</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.375em;"><span class="mi" id="MathJax-Span-3465" style="font-size: 70.7%; font-family: MathJax_Math-italic;">k</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="mo" id="MathJax-Span-3466" style="font-family: MathJax_Main; padding-left: 0.251em;">=</span><span class="msubsup" id="MathJax-Span-3467" style="padding-left: 0.251em;"><span style="display: inline-block; position: relative; width: 3.539em; height: 0px;"><span style="position: absolute; clip: rect(2.547em, 1002.79em, 7.013em, -999.997em); top: -5.022em; left: 0em;"><span class="mrow" id="MathJax-Span-3468"><span class="mo" id="MathJax-Span-3469" style="vertical-align: 2.298em;"><span style="display: inline-block; position: relative; width: 0.685em; height: 0px;"><span style="position: absolute; font-family: MathJax_Size4; top: -2.788em; left: 0em;">⎡<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; font-family: MathJax_Size4; top: -0.555em; left: 0em;">⎣<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -1.61em; left: 0em;">⎢<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="mtable" id="MathJax-Span-3470" style="padding-right: 0.189em; padding-left: 0.189em;"><span style="display: inline-block; position: relative; width: 1.368em; height: 0px;"><span style="position: absolute; clip: rect(2.547em, 1001.37em, 6.951em, -999.997em); top: -5.022em; left: 0em;"><span style="display: inline-block; position: relative; width: 1.368em; height: 0px;"><span style="position: absolute; clip: rect(2.919em, 1001.37em, 4.346em, -999.997em); top: -5.394em; left: 50%; margin-left: -0.679em;"><span class="mtd" id="MathJax-Span-3471"><span class="mrow" id="MathJax-Span-3472"><span class="msubsup" id="MathJax-Span-3473"><span style="display: inline-block; position: relative; width: 0.375em; height: 0px;"><span style="position: absolute; clip: rect(3.787em, 1000em, 4.159em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-3474"></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -4.339em; left: 0em;"><span class="mi" id="MathJax-Span-3475" style="font-size: 70.7%; font-family: MathJax_Math-italic;">b</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-3476"><span style="display: inline-block; position: relative; width: 0.996em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.5em, 4.159em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-3477" style="font-family: MathJax_Math-italic;">a</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.561em;"><span class="mi" id="MathJax-Span-3478" style="font-size: 70.7%; font-family: MathJax_Math-italic;">x</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(2.919em, 1001.31em, 4.47em, -999.997em); top: -3.967em; left: 50%; margin-left: -0.679em;"><span class="mtd" id="MathJax-Span-3479"><span class="mrow" id="MathJax-Span-3480"><span class="msubsup" id="MathJax-Span-3481"><span style="display: inline-block; position: relative; width: 0.375em; height: 0px;"><span style="position: absolute; clip: rect(3.787em, 1000em, 4.159em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-3482"></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -4.339em; left: 0em;"><span class="mi" id="MathJax-Span-3483" style="font-size: 70.7%; font-family: MathJax_Math-italic;">b</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-3484"><span style="display: inline-block; position: relative; width: 0.934em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.5em, 4.159em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-3485" style="font-family: MathJax_Math-italic;">a</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.561em;"><span class="mi" id="MathJax-Span-3486" style="font-size: 70.7%; font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(2.919em, 1001.31em, 4.346em, -999.997em); top: -2.416em; left: 50%; margin-left: -0.679em;"><span class="mtd" id="MathJax-Span-3487"><span class="mrow" id="MathJax-Span-3488"><span class="msubsup" id="MathJax-Span-3489"><span style="display: inline-block; position: relative; width: 0.375em; height: 0px;"><span style="position: absolute; clip: rect(3.787em, 1000em, 4.159em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-3490"></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -4.339em; left: 0em;"><span class="mi" id="MathJax-Span-3491" style="font-size: 70.7%; font-family: MathJax_Math-italic;">b</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-3492"><span style="display: inline-block; position: relative; width: 0.934em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.5em, 4.159em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-3493" style="font-family: MathJax_Math-italic;">a</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.561em;"><span class="mi" id="MathJax-Span-3494" style="font-size: 70.7%; font-family: MathJax_Math-italic;">z<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span><span style="display: inline-block; width: 0px; height: 5.028em;"></span></span></span></span><span class="mo" id="MathJax-Span-3495" style="vertical-align: 2.298em;"><span style="display: inline-block; position: relative; width: 0.685em; height: 0px;"><span style="position: absolute; font-family: MathJax_Size4; top: -2.788em; left: 0em;">⎤<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; font-family: MathJax_Size4; top: -0.555em; left: 0em;">⎦<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -1.61em; left: 0em;">⎥<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 5.028em;"></span></span><span style="position: absolute; top: -2.168em; left: 3.105em;"><span class="mi" id="MathJax-Span-3496" style="font-size: 70.7%; font-family: MathJax_Math-italic;">k</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.36em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -2.304em; border-left: 0px solid; width: 0px; height: 5.235em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>y</mi><mo>=</mo><msup><mo stretchy="false">(</mo><mi>b</mi></msup><msub><mi>a</mi><mi>m</mi></msub><msub><mo stretchy="false">)</mo><mi>k</mi></msub><mo>=</mo><msub><mrow><mo>[</mo><mtable rowspacing="4pt" columnspacing="1em"><mtr><mtd><msup><mi></mi><mi>b</mi></msup><msub><mi>a</mi><mi>x</mi></msub></mtd></mtr><mtr><mtd><msup><mi></mi><mi>b</mi></msup><msub><mi>a</mi><mi>y</mi></msub></mtd></mtr><mtr><mtd><msup><mi></mi><mi>b</mi></msup><msub><mi>a</mi><mi>z</mi></msub></mtd></mtr></mtable><mo>]</mo></mrow><mi>k</mi></msub></math></span></span><script type="math/tex" id="MathJax-Element-67">y = (^ba_m)_k =\begin{bmatrix} ^ba_x \\ ^ba_y \\ ^ba_z \end{bmatrix}_k</script><br>
<span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-68-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;C&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mi&gt;g&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;msubsup&gt;&lt;mi&gt;h&lt;/mi&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mo&gt;&amp;#x2032;&lt;/mo&gt;&lt;/msubsup&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;mi&gt;g&lt;/mi&gt;&lt;msub&gt;&lt;mrow&gt;&lt;mo&gt;[&lt;/mo&gt;&lt;mtable rowspacing=&quot;4pt&quot; columnspacing=&quot;1em&quot;&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mn&gt;3&lt;/mn&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mn&gt;3&lt;/mn&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mn&gt;3&lt;/mn&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;/mtable&gt;&lt;mo&gt;]&lt;/mo&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-3497" style="width: 28.477em; display: inline-block;"><span style="display: inline-block; position: relative; width: 22.956em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(0.003em, 1022.96em, 4.283em, -999.997em); top: -2.354em; left: 0em;"><span class="mrow" id="MathJax-Span-3498"><span class="mi" id="MathJax-Span-3499" style="font-family: MathJax_Math-italic;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.065em;"></span></span><span class="mo" id="MathJax-Span-3500" style="font-family: MathJax_Main; padding-left: 0.251em;">=</span><span class="mo" id="MathJax-Span-3501" style="font-family: MathJax_Main; padding-left: 0.251em;">−</span><span class="mi" id="MathJax-Span-3502" style="font-family: MathJax_Math-italic;">g<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-3503" style="font-family: MathJax_Main;">[</span><span class="mn" id="MathJax-Span-3504" style="font-family: MathJax_Main;">2</span><span class="msubsup" id="MathJax-Span-3505"><span style="display: inline-block; position: relative; width: 1.058em; height: 0px;"><span style="position: absolute; clip: rect(3.105em, 1000.56em, 4.159em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-3506" style="font-family: MathJax_Math-italic;">h</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.415em, 1000.25em, 4.159em, -999.997em); top: -4.277em; left: 0.561em;"><span class="mo" id="MathJax-Span-3507" style="font-size: 70.7%; font-family: MathJax_Main;">′</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.477em, 1000.44em, 4.159em, -999.997em); top: -3.843em; left: 0.561em;"><span class="mi" id="MathJax-Span-3508" style="font-size: 70.7%; font-family: MathJax_Math-italic;">a</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="mo" id="MathJax-Span-3509" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-3510"><span style="display: inline-block; position: relative; width: 1.802em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.44em, 4.346em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-3511" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.437em;"><span class="texatom" id="MathJax-Span-3512"><span class="mrow" id="MathJax-Span-3513"><span class="mi" id="MathJax-Span-3514" style="font-size: 70.7%; font-family: MathJax_Math-italic;">k</span><span class="mo" id="MathJax-Span-3515" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="mn" id="MathJax-Span-3516" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="mo" id="MathJax-Span-3517" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-3518" style="font-family: MathJax_Main;">]</span><span class="mo" id="MathJax-Span-3519" style="font-family: MathJax_Main; padding-left: 0.251em;">=</span><span class="mo" id="MathJax-Span-3520" style="font-family: MathJax_Main; padding-left: 0.251em;">−</span><span class="mn" id="MathJax-Span-3521" style="font-family: MathJax_Main;">2</span><span class="mi" id="MathJax-Span-3522" style="font-family: MathJax_Math-italic;">g<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="msubsup" id="MathJax-Span-3523"><span style="display: inline-block; position: relative; width: 11.914em; height: 0px;"><span style="position: absolute; clip: rect(2.422em, 1010.24em, 6.641em, -999.997em); top: -4.774em; left: 0em;"><span class="mrow" id="MathJax-Span-3524"><span class="mo" id="MathJax-Span-3525" style="vertical-align: 2.174em;"><span style="display: inline-block; position: relative; width: 0.685em; height: 0px;"><span style="position: absolute; font-family: MathJax_Size4; top: -2.788em; left: 0em;">⎡<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; font-family: MathJax_Size4; top: -0.803em; left: 0em;">⎣<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -1.796em; left: 0em;">⎢<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="mtable" id="MathJax-Span-3526" style="padding-right: 0.189em; padding-left: 0.189em;"><span style="display: inline-block; position: relative; width: 8.812em; height: 0px;"><span style="position: absolute; clip: rect(2.484em, 1001.68em, 6.455em, -999.997em); top: -4.587em; left: 0em;"><span style="display: inline-block; position: relative; width: 1.678em; height: 0px;"><span style="position: absolute; clip: rect(3.229em, 1001.68em, 4.346em, -999.997em); top: -5.332em; left: 50%; margin-left: -0.803em;"><span class="mtd" id="MathJax-Span-3527"><span class="mrow" id="MathJax-Span-3528"><span class="mo" id="MathJax-Span-3529" style="font-family: MathJax_Main;">−</span><span class="msubsup" id="MathJax-Span-3530"><span style="display: inline-block; position: relative; width: 0.872em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.44em, 4.346em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-3531" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.437em;"><span class="mn" id="MathJax-Span-3532" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.353em, 1000.87em, 4.346em, -999.997em); top: -3.905em; left: 50%; margin-left: -0.431em;"><span class="mtd" id="MathJax-Span-3549"><span class="mrow" id="MathJax-Span-3550"><span class="msubsup" id="MathJax-Span-3551"><span style="display: inline-block; position: relative; width: 0.872em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.44em, 4.346em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-3552" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.437em;"><span class="mn" id="MathJax-Span-3553" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.353em, 1000.87em, 4.346em, -999.997em); top: -2.54em; left: 50%; margin-left: -0.431em;"><span class="mtd" id="MathJax-Span-3569"><span class="mrow" id="MathJax-Span-3570"><span class="msubsup" id="MathJax-Span-3571"><span style="display: inline-block; position: relative; width: 0.872em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.44em, 4.346em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-3572" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.437em;"><span class="mn" id="MathJax-Span-3573" style="font-size: 70.7%; font-family: MathJax_Main;">0</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.594em;"></span></span><span style="position: absolute; clip: rect(2.484em, 1001.68em, 6.331em, -999.997em); top: -4.463em; left: 2.671em;"><span style="display: inline-block; position: relative; width: 1.678em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.87em, 4.346em, -999.997em); top: -5.332em; left: 50%; margin-left: -0.431em;"><span class="mtd" id="MathJax-Span-3533"><span class="mrow" id="MathJax-Span-3534"><span class="msubsup" id="MathJax-Span-3535"><span style="display: inline-block; position: relative; width: 0.872em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.44em, 4.346em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-3536" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.437em;"><span class="mn" id="MathJax-Span-3537" style="font-size: 70.7%; font-family: MathJax_Main;">3</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.353em, 1000.87em, 4.346em, -999.997em); top: -3.905em; left: 50%; margin-left: -0.431em;"><span class="mtd" id="MathJax-Span-3554"><span class="mrow" id="MathJax-Span-3555"><span class="msubsup" id="MathJax-Span-3556"><span style="display: inline-block; position: relative; width: 0.872em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.44em, 4.346em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-3557" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.437em;"><span class="mn" id="MathJax-Span-3558" style="font-size: 70.7%; font-family: MathJax_Main;">0</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.229em, 1001.68em, 4.346em, -999.997em); top: -2.54em; left: 50%; margin-left: -0.803em;"><span class="mtd" id="MathJax-Span-3574"><span class="mrow" id="MathJax-Span-3575"><span class="mo" id="MathJax-Span-3576" style="font-family: MathJax_Main;">−</span><span class="msubsup" id="MathJax-Span-3577"><span style="display: inline-block; position: relative; width: 0.872em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.44em, 4.346em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-3578" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.437em;"><span class="mn" id="MathJax-Span-3579" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.47em;"></span></span><span style="position: absolute; clip: rect(2.484em, 1001.68em, 6.455em, -999.997em); top: -4.587em; left: 5.338em;"><span style="display: inline-block; position: relative; width: 1.678em; height: 0px;"><span style="position: absolute; clip: rect(3.229em, 1001.68em, 4.346em, -999.997em); top: -5.332em; left: 50%; margin-left: -0.803em;"><span class="mtd" id="MathJax-Span-3538"><span class="mrow" id="MathJax-Span-3539"><span class="mo" id="MathJax-Span-3540" style="font-family: MathJax_Main;">−</span><span class="msubsup" id="MathJax-Span-3541"><span style="display: inline-block; position: relative; width: 0.872em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.44em, 4.346em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-3542" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.437em;"><span class="mn" id="MathJax-Span-3543" style="font-size: 70.7%; font-family: MathJax_Main;">0</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.353em, 1000.87em, 4.346em, -999.997em); top: -3.905em; left: 50%; margin-left: -0.431em;"><span class="mtd" id="MathJax-Span-3559"><span class="mrow" id="MathJax-Span-3560"><span class="msubsup" id="MathJax-Span-3561"><span style="display: inline-block; position: relative; width: 0.872em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.44em, 4.346em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-3562" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.437em;"><span class="mn" id="MathJax-Span-3563" style="font-size: 70.7%; font-family: MathJax_Main;">3</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.229em, 1001.68em, 4.346em, -999.997em); top: -2.54em; left: 50%; margin-left: -0.803em;"><span class="mtd" id="MathJax-Span-3580"><span class="mrow" id="MathJax-Span-3581"><span class="mo" id="MathJax-Span-3582" style="font-family: MathJax_Main;">−</span><span class="msubsup" id="MathJax-Span-3583"><span style="display: inline-block; position: relative; width: 0.872em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.44em, 4.346em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-3584" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.437em;"><span class="mn" id="MathJax-Span-3585" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.594em;"></span></span><span style="position: absolute; clip: rect(2.484em, 1000.87em, 6.331em, -999.997em); top: -4.463em; left: 7.944em;"><span style="display: inline-block; position: relative; width: 0.872em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.87em, 4.346em, -999.997em); top: -5.332em; left: 50%; margin-left: -0.431em;"><span class="mtd" id="MathJax-Span-3544"><span class="mrow" id="MathJax-Span-3545"><span class="msubsup" id="MathJax-Span-3546"><span style="display: inline-block; position: relative; width: 0.872em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.44em, 4.346em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-3547" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.437em;"><span class="mn" id="MathJax-Span-3548" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.353em, 1000.87em, 4.346em, -999.997em); top: -3.905em; left: 50%; margin-left: -0.431em;"><span class="mtd" id="MathJax-Span-3564"><span class="mrow" id="MathJax-Span-3565"><span class="msubsup" id="MathJax-Span-3566"><span style="display: inline-block; position: relative; width: 0.872em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.44em, 4.346em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-3567" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.437em;"><span class="mn" id="MathJax-Span-3568" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.353em, 1000.87em, 4.346em, -999.997em); top: -2.54em; left: 50%; margin-left: -0.431em;"><span class="mtd" id="MathJax-Span-3586"><span class="mrow" id="MathJax-Span-3587"><span class="msubsup" id="MathJax-Span-3588"><span style="display: inline-block; position: relative; width: 0.872em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.44em, 4.346em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-3589" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.437em;"><span class="mn" id="MathJax-Span-3590" style="font-size: 70.7%; font-family: MathJax_Main;">3</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.47em;"></span></span></span></span><span class="mo" id="MathJax-Span-3591" style="vertical-align: 2.174em;"><span style="display: inline-block; position: relative; width: 0.685em; height: 0px;"><span style="position: absolute; font-family: MathJax_Size4; top: -2.788em; left: 0em;">⎤<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; font-family: MathJax_Size4; top: -0.803em; left: 0em;">⎦<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -1.796em; left: 0em;">⎥<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.78em;"></span></span><span style="position: absolute; top: -2.292em; left: 10.549em;"><span class="texatom" id="MathJax-Span-3592"><span class="mrow" id="MathJax-Span-3593"><span class="mi" id="MathJax-Span-3594" style="font-size: 70.7%; font-family: MathJax_Math-italic;">k</span><span class="mo" id="MathJax-Span-3595" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="mn" id="MathJax-Span-3596" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.36em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -2.227em; border-left: 0px solid; width: 0px; height: 5.004em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>C</mi><mo>=</mo><mo>−</mo><mi>g</mi><mo stretchy="false">[</mo><mn>2</mn><msubsup><mi>h</mi><mi>a</mi><mo>′</mo></msubsup><mo stretchy="false">(</mo><msub><mi>q</mi><mrow class="MJX-TeXAtom-ORD"><mi>k</mi><mo>−</mo><mn>1</mn></mrow></msub><mo stretchy="false">)</mo><mo stretchy="false">]</mo><mo>=</mo><mo>−</mo><mn>2</mn><mi>g</mi><msub><mrow><mo>[</mo><mtable rowspacing="4pt" columnspacing="1em"><mtr><mtd><mo>−</mo><msub><mi>q</mi><mn>2</mn></msub></mtd><mtd><msub><mi>q</mi><mn>3</mn></msub></mtd><mtd><mo>−</mo><msub><mi>q</mi><mn>0</mn></msub></mtd><mtd><msub><mi>q</mi><mn>1</mn></msub></mtd></mtr><mtr><mtd><msub><mi>q</mi><mn>1</mn></msub></mtd><mtd><msub><mi>q</mi><mn>0</mn></msub></mtd><mtd><msub><mi>q</mi><mn>3</mn></msub></mtd><mtd><msub><mi>q</mi><mn>2</mn></msub></mtd></mtr><mtr><mtd><msub><mi>q</mi><mn>0</mn></msub></mtd><mtd><mo>−</mo><msub><mi>q</mi><mn>1</mn></msub></mtd><mtd><mo>−</mo><msub><mi>q</mi><mn>2</mn></msub></mtd><mtd><msub><mi>q</mi><mn>3</mn></msub></mtd></mtr></mtable><mo>]</mo></mrow><mrow class="MJX-TeXAtom-ORD"><mi>k</mi><mo>−</mo><mn>1</mn></mrow></msub></math></span></span><script type="math/tex" id="MathJax-Element-68">C= -g[2h’_a(q_{k-1})] =-2g\begin{bmatrix} -q_2 & q_3 & -q_0 & q_1 \\ q_1 & q_0 & q_3 & q_2 \\ q_0 & -q_1 & -q_2 & q_3 \end{bmatrix}_{k-1}</script><br>
<span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-69-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;msub&gt;&lt;mrow&gt;&lt;mo&gt;[&lt;/mo&gt;&lt;mtable rowspacing=&quot;4pt&quot; columnspacing=&quot;1em&quot;&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mn&gt;3&lt;/mn&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;/mtable&gt;&lt;mo&gt;]&lt;/mo&gt;&lt;/mrow&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-3597" style="width: 8.812em; display: inline-block;"><span style="display: inline-block; position: relative; width: 7.075em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(-0.679em, 1007.08em, 4.966em, -999.997em); top: -2.354em; left: 0em;"><span class="mrow" id="MathJax-Span-3598"><span class="mi" id="MathJax-Span-3599" style="font-family: MathJax_Math-italic;">x</span><span class="mo" id="MathJax-Span-3600" style="font-family: MathJax_Main; padding-left: 0.251em;">=</span><span class="msubsup" id="MathJax-Span-3601" style="padding-left: 0.251em;"><span style="display: inline-block; position: relative; width: 0.872em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.44em, 4.346em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-3602" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.437em;"><span class="mi" id="MathJax-Span-3603" style="font-size: 70.7%; font-family: MathJax_Math-italic;">k</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="mo" id="MathJax-Span-3604" style="font-family: MathJax_Main; padding-left: 0.251em;">=</span><span class="msubsup" id="MathJax-Span-3605" style="padding-left: 0.251em;"><span style="display: inline-block; position: relative; width: 3.043em; height: 0px;"><span style="position: absolute; clip: rect(3.167em, 1002.3em, 8.75em, -999.997em); top: -6.2em; left: 0em;"><span class="mrow" id="MathJax-Span-3606"><span class="mo" id="MathJax-Span-3607" style="vertical-align: 2.857em;"><span style="display: inline-block; position: relative; width: 0.685em; height: 0px;"><span style="position: absolute; font-family: MathJax_Size4; top: -2.788em; left: 0em;">⎡<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; font-family: MathJax_Size4; top: 0.561em; left: 0em;">⎣<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -1.61em; left: 0em;">⎢<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -1.051em; left: 0em;">⎢<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -0.493em; left: 0em;">⎢<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="mtable" id="MathJax-Span-3608" style="padding-right: 0.189em; padding-left: 0.189em;"><span style="display: inline-block; position: relative; width: 0.872em; height: 0px;"><span style="position: absolute; clip: rect(3.167em, 1000.87em, 8.378em, -999.997em); top: -5.828em; left: 0em;"><span style="display: inline-block; position: relative; width: 0.872em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.87em, 4.346em, -999.997em); top: -6.014em; left: 50%; margin-left: -0.431em;"><span class="mtd" id="MathJax-Span-3609"><span class="mrow" id="MathJax-Span-3610"><span class="msubsup" id="MathJax-Span-3611"><span style="display: inline-block; position: relative; width: 0.872em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.44em, 4.346em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-3612" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.437em;"><span class="mn" id="MathJax-Span-3613" style="font-size: 70.7%; font-family: MathJax_Main;">0</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.353em, 1000.87em, 4.346em, -999.997em); top: -4.587em; left: 50%; margin-left: -0.431em;"><span class="mtd" id="MathJax-Span-3614"><span class="mrow" id="MathJax-Span-3615"><span class="msubsup" id="MathJax-Span-3616"><span style="display: inline-block; position: relative; width: 0.872em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.44em, 4.346em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-3617" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.437em;"><span class="mn" id="MathJax-Span-3618" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.353em, 1000.87em, 4.346em, -999.997em); top: -3.223em; left: 50%; margin-left: -0.431em;"><span class="mtd" id="MathJax-Span-3619"><span class="mrow" id="MathJax-Span-3620"><span class="msubsup" id="MathJax-Span-3621"><span style="display: inline-block; position: relative; width: 0.872em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.44em, 4.346em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-3622" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.437em;"><span class="mn" id="MathJax-Span-3623" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.353em, 1000.87em, 4.346em, -999.997em); top: -1.796em; left: 50%; margin-left: -0.431em;"><span class="mtd" id="MathJax-Span-3624"><span class="mrow" id="MathJax-Span-3625"><span class="msubsup" id="MathJax-Span-3626"><span style="display: inline-block; position: relative; width: 0.872em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.44em, 4.346em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-3627" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.437em;"><span class="mn" id="MathJax-Span-3628" style="font-size: 70.7%; font-family: MathJax_Main;">3</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span><span style="display: inline-block; width: 0px; height: 5.834em;"></span></span></span></span><span class="mo" id="MathJax-Span-3629" style="vertical-align: 2.857em;"><span style="display: inline-block; position: relative; width: 0.685em; height: 0px;"><span style="position: absolute; font-family: MathJax_Size4; top: -2.788em; left: 0em;">⎤<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; font-family: MathJax_Size4; top: 0.561em; left: 0em;">⎦<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -1.61em; left: 0em;">⎥<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -1.051em; left: 0em;">⎥<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -0.493em; left: 0em;">⎥<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 6.207em;"></span></span><span style="position: absolute; top: -1.61em; left: 2.609em;"><span class="mi" id="MathJax-Span-3630" style="font-size: 70.7%; font-family: MathJax_Math-italic;">k</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.36em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -3.073em; border-left: 0px solid; width: 0px; height: 6.696em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>x</mi><mo>=</mo><msub><mi>q</mi><mi>k</mi></msub><mo>=</mo><msub><mrow><mo>[</mo><mtable rowspacing="4pt" columnspacing="1em"><mtr><mtd><msub><mi>q</mi><mn>0</mn></msub></mtd></mtr><mtr><mtd><msub><mi>q</mi><mn>1</mn></msub></mtd></mtr><mtr><mtd><msub><mi>q</mi><mn>2</mn></msub></mtd></mtr><mtr><mtd><msub><mi>q</mi><mn>3</mn></msub></mtd></mtr></mtable><mo>]</mo></mrow><mi>k</mi></msub></math></span></span><script type="math/tex" id="MathJax-Element-69">x = q_k =\begin{bmatrix} q_0 \\ q_1 \\ q_2 \\ q_3 \end{bmatrix}_k</script> (here, the bias terms in equation (1) are treated as zeros)<br>
<span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-70-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;D&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mi&gt;g&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;h&lt;/mi&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;&amp;#x2013;&lt;/mo&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;msubsup&gt;&lt;mi&gt;h&lt;/mi&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mo&gt;&amp;#x2032;&lt;/mo&gt;&lt;/msubsup&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;C&lt;/mi&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mi&gt;g&lt;/mi&gt;&lt;mrow&gt;&lt;mo&gt;[&lt;/mo&gt;&lt;mrow&gt;&lt;msub&gt;&lt;mrow&gt;&lt;mo&gt;[&lt;/mo&gt;&lt;mtable rowspacing=&quot;4pt&quot; columnspacing=&quot;1em&quot;&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;msub&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mn&gt;3&lt;/mn&gt;&lt;/msub&gt;&lt;mo&gt;&amp;#x2013;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/msub&gt;&lt;msub&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msub&gt;&lt;msub&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mn&gt;3&lt;/mn&gt;&lt;/msub&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/msub&gt;&lt;msub&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;msubsup&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msubsup&gt;&lt;mo&gt;&amp;#x2013;&lt;/mo&gt;&lt;msubsup&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msubsup&gt;&lt;mo&gt;&amp;#x2013;&lt;/mo&gt;&lt;msubsup&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msubsup&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;msubsup&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mn&gt;3&lt;/mn&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msubsup&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;/mtable&gt;&lt;mo&gt;]&lt;/mo&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo&gt;&amp;#x2013;&lt;/mo&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;msub&gt;&lt;mrow&gt;&lt;mo&gt;[&lt;/mo&gt;&lt;mtable rowspacing=&quot;4pt&quot; columnspacing=&quot;1em&quot;&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mn&gt;3&lt;/mn&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mn&gt;3&lt;/mn&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mn&gt;3&lt;/mn&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;/mtable&gt;&lt;mo&gt;]&lt;/mo&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;msub&gt;&lt;mrow&gt;&lt;mo&gt;[&lt;/mo&gt;&lt;mtable rowspacing=&quot;4pt&quot; columnspacing=&quot;1em&quot;&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mn&gt;3&lt;/mn&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;/mtable&gt;&lt;mo&gt;]&lt;/mo&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;msub&gt;&lt;mrow&gt;&lt;mo&gt;[&lt;/mo&gt;&lt;mtable rowspacing=&quot;4pt&quot; columnspacing=&quot;1em&quot;&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mi&gt;C&lt;/mi&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mi&gt;C&lt;/mi&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mi&gt;C&lt;/mi&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;/mtable&gt;&lt;mo&gt;]&lt;/mo&gt;&lt;/mrow&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;mo&gt;]&lt;/mo&gt;&lt;/mrow&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-3631" style="width: 65.326em; display: inline-block;"><span style="display: inline-block; position: relative; width: 52.671em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(2.174em, 1052.36em, 7.882em, -999.997em); top: -5.27em; left: 0em;"><span class="mrow" id="MathJax-Span-3632"><span class="mi" id="MathJax-Span-3633" style="font-family: MathJax_Math-italic;">D</span><span class="mo" id="MathJax-Span-3634" style="font-family: MathJax_Main; padding-left: 0.251em;">=</span><span class="mo" id="MathJax-Span-3635" style="font-family: MathJax_Main; padding-left: 0.251em;">−</span><span class="mi" id="MathJax-Span-3636" style="font-family: MathJax_Math-italic;">g<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-3637" style="font-family: MathJax_Main;">[</span><span class="msubsup" id="MathJax-Span-3638"><span style="display: inline-block; position: relative; width: 1.058em; height: 0px;"><span style="position: absolute; clip: rect(3.105em, 1000.56em, 4.159em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-3639" style="font-family: MathJax_Math-italic;">h</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.561em;"><span class="mi" id="MathJax-Span-3640" style="font-size: 70.7%; font-family: MathJax_Math-italic;">a</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="mo" id="MathJax-Span-3641" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-3642"><span style="display: inline-block; position: relative; width: 1.802em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.44em, 4.346em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-3643" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.437em;"><span class="texatom" id="MathJax-Span-3644"><span class="mrow" id="MathJax-Span-3645"><span class="mi" id="MathJax-Span-3646" style="font-size: 70.7%; font-family: MathJax_Math-italic;">k</span><span class="mo" id="MathJax-Span-3647" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="mn" id="MathJax-Span-3648" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="mo" id="MathJax-Span-3649" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-3650" style="font-family: MathJax_Main;">–</span><span class="mn" id="MathJax-Span-3651" style="font-family: MathJax_Main; padding-left: 0.189em;">2</span><span class="msubsup" id="MathJax-Span-3652"><span style="display: inline-block; position: relative; width: 1.058em; height: 0px;"><span style="position: absolute; clip: rect(3.105em, 1000.56em, 4.159em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-3653" style="font-family: MathJax_Math-italic;">h</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.415em, 1000.25em, 4.159em, -999.997em); top: -4.277em; left: 0.561em;"><span class="mo" id="MathJax-Span-3654" style="font-size: 70.7%; font-family: MathJax_Main;">′</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.477em, 1000.44em, 4.159em, -999.997em); top: -3.843em; left: 0.561em;"><span class="mi" id="MathJax-Span-3655" style="font-size: 70.7%; font-family: MathJax_Math-italic;">a</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="mo" id="MathJax-Span-3656" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-3657"><span style="display: inline-block; position: relative; width: 1.802em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.44em, 4.346em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-3658" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.437em;"><span class="texatom" id="MathJax-Span-3659"><span class="mrow" id="MathJax-Span-3660"><span class="mi" id="MathJax-Span-3661" style="font-size: 70.7%; font-family: MathJax_Math-italic;">k</span><span class="mo" id="MathJax-Span-3662" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="mn" id="MathJax-Span-3663" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="mo" id="MathJax-Span-3664" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-3665" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-3666"><span style="display: inline-block; position: relative; width: 1.802em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.44em, 4.346em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-3667" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.437em;"><span class="texatom" id="MathJax-Span-3668"><span class="mrow" id="MathJax-Span-3669"><span class="mi" id="MathJax-Span-3670" style="font-size: 70.7%; font-family: MathJax_Math-italic;">k</span><span class="mo" id="MathJax-Span-3671" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="mn" id="MathJax-Span-3672" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="mo" id="MathJax-Span-3673" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-3674" style="font-family: MathJax_Main; padding-left: 0.251em;">+</span><span class="msubsup" id="MathJax-Span-3675" style="padding-left: 0.251em;"><span style="display: inline-block; position: relative; width: 1.182em; height: 0px;"><span style="position: absolute; clip: rect(3.105em, 1000.75em, 4.159em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-3676" style="font-family: MathJax_Math-italic;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.065em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.748em;"><span class="mi" id="MathJax-Span-3677" style="font-size: 70.7%; font-family: MathJax_Math-italic;">k</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="mo" id="MathJax-Span-3678" style="font-family: MathJax_Main;">]</span><span class="mo" id="MathJax-Span-3679" style="font-family: MathJax_Main; padding-left: 0.251em;">=</span><span class="mo" id="MathJax-Span-3680" style="font-family: MathJax_Main; padding-left: 0.251em;">−</span><span class="mi" id="MathJax-Span-3681" style="font-family: MathJax_Math-italic;">g<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mrow" id="MathJax-Span-3682" style="padding-left: 0.189em;"><span class="mo" id="MathJax-Span-3683" style="vertical-align: 2.919em;"><span style="display: inline-block; position: relative; width: 0.685em; height: 0px;"><span style="position: absolute; font-family: MathJax_Size4; top: -2.788em; left: 0em;">⎡<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; font-family: MathJax_Size4; top: 0.748em; left: 0em;">⎣<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -1.672em; left: 0em;">⎢<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -1.238em; left: 0em;">⎢<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -0.741em; left: 0em;">⎢<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -0.245em; left: 0em;">⎢<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="mrow" id="MathJax-Span-3684"><span class="msubsup" id="MathJax-Span-3685"><span style="display: inline-block; position: relative; width: 9.494em; height: 0px;"><span style="position: absolute; clip: rect(2.547em, 1007.82em, 7.013em, -999.997em); top: -5.022em; left: 0em;"><span class="mrow" id="MathJax-Span-3686"><span class="mo" id="MathJax-Span-3687" style="vertical-align: 2.298em;"><span style="display: inline-block; position: relative; width: 0.685em; height: 0px;"><span style="position: absolute; font-family: MathJax_Size4; top: -2.788em; left: 0em;">⎡<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; font-family: MathJax_Size4; top: -0.555em; left: 0em;">⎣<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -1.672em; left: 0em;">⎢<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="mtable" id="MathJax-Span-3688" style="padding-right: 0.189em; padding-left: 0.189em;"><span style="display: inline-block; position: relative; width: 6.455em; height: 0px;"><span style="position: absolute; clip: rect(2.547em, 1006.46em, 6.951em, -999.997em); top: -4.96em; left: 0em;"><span style="display: inline-block; position: relative; width: 6.455em; height: 0px;"><span style="position: absolute; clip: rect(3.043em, 1005.4em, 4.408em, -999.997em); top: -5.456em; left: 50%; margin-left: -2.726em;"><span class="mtd" id="MathJax-Span-3689"><span class="mrow" id="MathJax-Span-3690"><span class="mn" id="MathJax-Span-3691" style="font-family: MathJax_Main;">2</span><span class="mo" id="MathJax-Span-3692" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-3693"><span style="display: inline-block; position: relative; width: 0.872em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.44em, 4.346em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-3694" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.437em;"><span class="mn" id="MathJax-Span-3695" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-3696"><span style="display: inline-block; position: relative; width: 0.872em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.44em, 4.346em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-3697" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.437em;"><span class="mn" id="MathJax-Span-3698" style="font-size: 70.7%; font-family: MathJax_Main;">3</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="mo" id="MathJax-Span-3699" style="font-family: MathJax_Main;">–</span><span class="msubsup" id="MathJax-Span-3700" style="padding-left: 0.189em;"><span style="display: inline-block; position: relative; width: 0.872em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.44em, 4.346em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-3701" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.437em;"><span class="mn" id="MathJax-Span-3702" style="font-size: 70.7%; font-family: MathJax_Main;">0</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-3703"><span style="display: inline-block; position: relative; width: 0.872em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.44em, 4.346em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-3704" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.437em;"><span class="mn" id="MathJax-Span-3705" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="mo" id="MathJax-Span-3706" style="font-family: MathJax_Main;">)</span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.043em, 1005.96em, 4.408em, -999.997em); top: -3.967em; left: 50%; margin-left: -3.037em;"><span class="mtd" id="MathJax-Span-3707"><span class="mrow" id="MathJax-Span-3708"><span class="mn" id="MathJax-Span-3709" style="font-family: MathJax_Main;">2</span><span class="mo" id="MathJax-Span-3710" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-3711"><span style="display: inline-block; position: relative; width: 0.872em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.44em, 4.346em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-3712" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.437em;"><span class="mn" id="MathJax-Span-3713" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-3714"><span style="display: inline-block; position: relative; width: 0.872em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.44em, 4.346em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-3715" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.437em;"><span class="mn" id="MathJax-Span-3716" style="font-size: 70.7%; font-family: MathJax_Main;">3</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="mo" id="MathJax-Span-3717" style="font-family: MathJax_Main; padding-left: 0.251em;">+</span><span class="msubsup" id="MathJax-Span-3718" style="padding-left: 0.251em;"><span style="display: inline-block; position: relative; width: 0.872em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.44em, 4.346em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-3719" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.437em;"><span class="mn" id="MathJax-Span-3720" style="font-size: 70.7%; font-family: MathJax_Main;">0</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-3721"><span style="display: inline-block; position: relative; width: 0.872em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.44em, 4.346em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-3722" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.437em;"><span class="mn" id="MathJax-Span-3723" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="mo" id="MathJax-Span-3724" style="font-family: MathJax_Main;">)</span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(2.981em, 1006.46em, 4.47em, -999.997em); top: -2.54em; left: 50%; margin-left: -3.223em;"><span class="mtd" id="MathJax-Span-3725"><span class="mrow" id="MathJax-Span-3726"><span class="msubsup" id="MathJax-Span-3727"><span style="display: inline-block; position: relative; width: 0.934em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.44em, 4.346em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-3728" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.291em, 1000.44em, 4.159em, -999.997em); top: -4.339em; left: 0.499em;"><span class="mn" id="MathJax-Span-3729" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.291em, 1000.44em, 4.159em, -999.997em); top: -3.657em; left: 0.437em;"><span class="mn" id="MathJax-Span-3730" style="font-size: 70.7%; font-family: MathJax_Main;">0</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="mo" id="MathJax-Span-3731" style="font-family: MathJax_Main;">–</span><span class="msubsup" id="MathJax-Span-3732" style="padding-left: 0.189em;"><span style="display: inline-block; position: relative; width: 0.934em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.44em, 4.346em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-3733" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.291em, 1000.44em, 4.159em, -999.997em); top: -4.339em; left: 0.499em;"><span class="mn" id="MathJax-Span-3734" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.291em, 1000.44em, 4.159em, -999.997em); top: -3.657em; left: 0.437em;"><span class="mn" id="MathJax-Span-3735" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="mo" id="MathJax-Span-3736" style="font-family: MathJax_Main;">–</span><span class="msubsup" id="MathJax-Span-3737" style="padding-left: 0.189em;"><span style="display: inline-block; position: relative; width: 0.934em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.44em, 4.346em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-3738" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.291em, 1000.44em, 4.159em, -999.997em); top: -4.339em; left: 0.499em;"><span class="mn" id="MathJax-Span-3739" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.291em, 1000.44em, 4.159em, -999.997em); top: -3.657em; left: 0.437em;"><span class="mn" id="MathJax-Span-3740" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="mo" id="MathJax-Span-3741" style="font-family: MathJax_Main; padding-left: 0.251em;">+</span><span class="msubsup" id="MathJax-Span-3742" style="padding-left: 0.251em;"><span style="display: inline-block; position: relative; width: 0.934em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.44em, 4.346em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-3743" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.291em, 1000.44em, 4.159em, -999.997em); top: -4.339em; left: 0.499em;"><span class="mn" id="MathJax-Span-3744" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.291em, 1000.44em, 4.159em, -999.997em); top: -3.657em; left: 0.437em;"><span class="mn" id="MathJax-Span-3745" style="font-size: 70.7%; font-family: MathJax_Main;">3</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.966em;"></span></span></span></span><span class="mo" id="MathJax-Span-3746" style="vertical-align: 2.298em;"><span style="display: inline-block; position: relative; width: 0.685em; height: 0px;"><span style="position: absolute; font-family: MathJax_Size4; top: -2.788em; left: 0em;">⎤<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; font-family: MathJax_Size4; top: -0.555em; left: 0em;">⎦<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -1.672em; left: 0em;">⎥<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 5.028em;"></span></span><span style="position: absolute; top: -2.168em; left: 8.13em;"><span class="texatom" id="MathJax-Span-3747"><span class="mrow" id="MathJax-Span-3748"><span class="mi" id="MathJax-Span-3749" style="font-size: 70.7%; font-family: MathJax_Math-italic;">k</span><span class="mo" id="MathJax-Span-3750" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="mn" id="MathJax-Span-3751" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="mo" id="MathJax-Span-3752" style="font-family: MathJax_Main;">–</span><span class="mn" id="MathJax-Span-3753" style="font-family: MathJax_Main; padding-left: 0.189em;">2</span><span class="msubsup" id="MathJax-Span-3754"><span style="display: inline-block; position: relative; width: 11.914em; height: 0px;"><span style="position: absolute; clip: rect(2.422em, 1010.24em, 6.641em, -999.997em); top: -4.774em; left: 0em;"><span class="mrow" id="MathJax-Span-3755"><span class="mo" id="MathJax-Span-3756" style="vertical-align: 2.174em;"><span style="display: inline-block; position: relative; width: 0.685em; height: 0px;"><span style="position: absolute; font-family: MathJax_Size4; top: -2.788em; left: 0em;">⎡<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; font-family: MathJax_Size4; top: -0.803em; left: 0em;">⎣<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -1.796em; left: 0em;">⎢<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="mtable" id="MathJax-Span-3757" style="padding-right: 0.189em; padding-left: 0.189em;"><span style="display: inline-block; position: relative; width: 8.812em; height: 0px;"><span style="position: absolute; clip: rect(2.484em, 1001.68em, 6.455em, -999.997em); top: -4.587em; left: 0em;"><span style="display: inline-block; position: relative; width: 1.678em; height: 0px;"><span style="position: absolute; clip: rect(3.229em, 1001.68em, 4.346em, -999.997em); top: -5.332em; left: 50%; margin-left: -0.803em;"><span class="mtd" id="MathJax-Span-3758"><span class="mrow" id="MathJax-Span-3759"><span class="mo" id="MathJax-Span-3760" style="font-family: MathJax_Main;">−</span><span class="msubsup" id="MathJax-Span-3761"><span style="display: inline-block; position: relative; width: 0.872em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.44em, 4.346em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-3762" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.437em;"><span class="mn" id="MathJax-Span-3763" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.353em, 1000.87em, 4.346em, -999.997em); top: -3.905em; left: 50%; margin-left: -0.431em;"><span class="mtd" id="MathJax-Span-3780"><span class="mrow" id="MathJax-Span-3781"><span class="msubsup" id="MathJax-Span-3782"><span style="display: inline-block; position: relative; width: 0.872em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.44em, 4.346em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-3783" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.437em;"><span class="mn" id="MathJax-Span-3784" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.353em, 1000.87em, 4.346em, -999.997em); top: -2.54em; left: 50%; margin-left: -0.431em;"><span class="mtd" id="MathJax-Span-3800"><span class="mrow" id="MathJax-Span-3801"><span class="msubsup" id="MathJax-Span-3802"><span style="display: inline-block; position: relative; width: 0.872em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.44em, 4.346em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-3803" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.437em;"><span class="mn" id="MathJax-Span-3804" style="font-size: 70.7%; font-family: MathJax_Main;">0</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.594em;"></span></span><span style="position: absolute; clip: rect(2.484em, 1001.68em, 6.331em, -999.997em); top: -4.463em; left: 2.671em;"><span style="display: inline-block; position: relative; width: 1.678em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.87em, 4.346em, -999.997em); top: -5.332em; left: 50%; margin-left: -0.431em;"><span class="mtd" id="MathJax-Span-3764"><span class="mrow" id="MathJax-Span-3765"><span class="msubsup" id="MathJax-Span-3766"><span style="display: inline-block; position: relative; width: 0.872em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.44em, 4.346em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-3767" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.437em;"><span class="mn" id="MathJax-Span-3768" style="font-size: 70.7%; font-family: MathJax_Main;">3</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.353em, 1000.87em, 4.346em, -999.997em); top: -3.905em; left: 50%; margin-left: -0.431em;"><span class="mtd" id="MathJax-Span-3785"><span class="mrow" id="MathJax-Span-3786"><span class="msubsup" id="MathJax-Span-3787"><span style="display: inline-block; position: relative; width: 0.872em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.44em, 4.346em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-3788" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.437em;"><span class="mn" id="MathJax-Span-3789" style="font-size: 70.7%; font-family: MathJax_Main;">0</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.229em, 1001.68em, 4.346em, -999.997em); top: -2.54em; left: 50%; margin-left: -0.803em;"><span class="mtd" id="MathJax-Span-3805"><span class="mrow" id="MathJax-Span-3806"><span class="mo" id="MathJax-Span-3807" style="font-family: MathJax_Main;">−</span><span class="msubsup" id="MathJax-Span-3808"><span style="display: inline-block; position: relative; width: 0.872em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.44em, 4.346em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-3809" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.437em;"><span class="mn" id="MathJax-Span-3810" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.47em;"></span></span><span style="position: absolute; clip: rect(2.484em, 1001.68em, 6.455em, -999.997em); top: -4.587em; left: 5.338em;"><span style="display: inline-block; position: relative; width: 1.678em; height: 0px;"><span style="position: absolute; clip: rect(3.229em, 1001.68em, 4.346em, -999.997em); top: -5.332em; left: 50%; margin-left: -0.803em;"><span class="mtd" id="MathJax-Span-3769"><span class="mrow" id="MathJax-Span-3770"><span class="mo" id="MathJax-Span-3771" style="font-family: MathJax_Main;">−</span><span class="msubsup" id="MathJax-Span-3772"><span style="display: inline-block; position: relative; width: 0.872em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.44em, 4.346em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-3773" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.437em;"><span class="mn" id="MathJax-Span-3774" style="font-size: 70.7%; font-family: MathJax_Main;">0</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.353em, 1000.87em, 4.346em, -999.997em); top: -3.905em; left: 50%; margin-left: -0.431em;"><span class="mtd" id="MathJax-Span-3790"><span class="mrow" id="MathJax-Span-3791"><span class="msubsup" id="MathJax-Span-3792"><span style="display: inline-block; position: relative; width: 0.872em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.44em, 4.346em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-3793" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.437em;"><span class="mn" id="MathJax-Span-3794" style="font-size: 70.7%; font-family: MathJax_Main;">3</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.229em, 1001.68em, 4.346em, -999.997em); top: -2.54em; left: 50%; margin-left: -0.803em;"><span class="mtd" id="MathJax-Span-3811"><span class="mrow" id="MathJax-Span-3812"><span class="mo" id="MathJax-Span-3813" style="font-family: MathJax_Main;">−</span><span class="msubsup" id="MathJax-Span-3814"><span style="display: inline-block; position: relative; width: 0.872em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.44em, 4.346em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-3815" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.437em;"><span class="mn" id="MathJax-Span-3816" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.594em;"></span></span><span style="position: absolute; clip: rect(2.484em, 1000.87em, 6.331em, -999.997em); top: -4.463em; left: 7.944em;"><span style="display: inline-block; position: relative; width: 0.872em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.87em, 4.346em, -999.997em); top: -5.332em; left: 50%; margin-left: -0.431em;"><span class="mtd" id="MathJax-Span-3775"><span class="mrow" id="MathJax-Span-3776"><span class="msubsup" id="MathJax-Span-3777"><span style="display: inline-block; position: relative; width: 0.872em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.44em, 4.346em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-3778" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.437em;"><span class="mn" id="MathJax-Span-3779" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.353em, 1000.87em, 4.346em, -999.997em); top: -3.905em; left: 50%; margin-left: -0.431em;"><span class="mtd" id="MathJax-Span-3795"><span class="mrow" id="MathJax-Span-3796"><span class="msubsup" id="MathJax-Span-3797"><span style="display: inline-block; position: relative; width: 0.872em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.44em, 4.346em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-3798" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.437em;"><span class="mn" id="MathJax-Span-3799" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.353em, 1000.87em, 4.346em, -999.997em); top: -2.54em; left: 50%; margin-left: -0.431em;"><span class="mtd" id="MathJax-Span-3817"><span class="mrow" id="MathJax-Span-3818"><span class="msubsup" id="MathJax-Span-3819"><span style="display: inline-block; position: relative; width: 0.872em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.44em, 4.346em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-3820" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.437em;"><span class="mn" id="MathJax-Span-3821" style="font-size: 70.7%; font-family: MathJax_Main;">3</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.47em;"></span></span></span></span><span class="mo" id="MathJax-Span-3822" style="vertical-align: 2.174em;"><span style="display: inline-block; position: relative; width: 0.685em; height: 0px;"><span style="position: absolute; font-family: MathJax_Size4; top: -2.788em; left: 0em;">⎤<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; font-family: MathJax_Size4; top: -0.803em; left: 0em;">⎦<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -1.796em; left: 0em;">⎥<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.78em;"></span></span><span style="position: absolute; top: -2.292em; left: 10.549em;"><span class="texatom" id="MathJax-Span-3823"><span class="mrow" id="MathJax-Span-3824"><span class="mi" id="MathJax-Span-3825" style="font-size: 70.7%; font-family: MathJax_Math-italic;">k</span><span class="mo" id="MathJax-Span-3826" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="mn" id="MathJax-Span-3827" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-3828"><span style="display: inline-block; position: relative; width: 3.911em; height: 0px;"><span style="position: absolute; clip: rect(3.167em, 1002.3em, 8.75em, -999.997em); top: -6.2em; left: 0em;"><span class="mrow" id="MathJax-Span-3829"><span class="mo" id="MathJax-Span-3830" style="vertical-align: 2.857em;"><span style="display: inline-block; position: relative; width: 0.685em; height: 0px;"><span style="position: absolute; font-family: MathJax_Size4; top: -2.788em; left: 0em;">⎡<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; font-family: MathJax_Size4; top: 0.561em; left: 0em;">⎣<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -1.61em; left: 0em;">⎢<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -1.051em; left: 0em;">⎢<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -0.493em; left: 0em;">⎢<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="mtable" id="MathJax-Span-3831" style="padding-right: 0.189em; padding-left: 0.189em;"><span style="display: inline-block; position: relative; width: 0.872em; height: 0px;"><span style="position: absolute; clip: rect(3.167em, 1000.87em, 8.378em, -999.997em); top: -5.828em; left: 0em;"><span style="display: inline-block; position: relative; width: 0.872em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.87em, 4.346em, -999.997em); top: -6.014em; left: 50%; margin-left: -0.431em;"><span class="mtd" id="MathJax-Span-3832"><span class="mrow" id="MathJax-Span-3833"><span class="msubsup" id="MathJax-Span-3834"><span style="display: inline-block; position: relative; width: 0.872em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.44em, 4.346em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-3835" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.437em;"><span class="mn" id="MathJax-Span-3836" style="font-size: 70.7%; font-family: MathJax_Main;">0</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.353em, 1000.87em, 4.346em, -999.997em); top: -4.587em; left: 50%; margin-left: -0.431em;"><span class="mtd" id="MathJax-Span-3837"><span class="mrow" id="MathJax-Span-3838"><span class="msubsup" id="MathJax-Span-3839"><span style="display: inline-block; position: relative; width: 0.872em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.44em, 4.346em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-3840" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.437em;"><span class="mn" id="MathJax-Span-3841" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.353em, 1000.87em, 4.346em, -999.997em); top: -3.223em; left: 50%; margin-left: -0.431em;"><span class="mtd" id="MathJax-Span-3842"><span class="mrow" id="MathJax-Span-3843"><span class="msubsup" id="MathJax-Span-3844"><span style="display: inline-block; position: relative; width: 0.872em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.44em, 4.346em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-3845" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.437em;"><span class="mn" id="MathJax-Span-3846" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.353em, 1000.87em, 4.346em, -999.997em); top: -1.796em; left: 50%; margin-left: -0.431em;"><span class="mtd" id="MathJax-Span-3847"><span class="mrow" id="MathJax-Span-3848"><span class="msubsup" id="MathJax-Span-3849"><span style="display: inline-block; position: relative; width: 0.872em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.44em, 4.346em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-3850" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.437em;"><span class="mn" id="MathJax-Span-3851" style="font-size: 70.7%; font-family: MathJax_Main;">3</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span><span style="display: inline-block; width: 0px; height: 5.834em;"></span></span></span></span><span class="mo" id="MathJax-Span-3852" style="vertical-align: 2.857em;"><span style="display: inline-block; position: relative; width: 0.685em; height: 0px;"><span style="position: absolute; font-family: MathJax_Size4; top: -2.788em; left: 0em;">⎤<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; font-family: MathJax_Size4; top: 0.561em; left: 0em;">⎦<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -1.61em; left: 0em;">⎥<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -1.051em; left: 0em;">⎥<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -0.493em; left: 0em;">⎥<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 6.207em;"></span></span><span style="position: absolute; top: -1.61em; left: 2.609em;"><span class="texatom" id="MathJax-Span-3853"><span class="mrow" id="MathJax-Span-3854"><span class="mi" id="MathJax-Span-3855" style="font-size: 70.7%; font-family: MathJax_Math-italic;">k</span><span class="mo" id="MathJax-Span-3856" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="mn" id="MathJax-Span-3857" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="mo" id="MathJax-Span-3858" style="font-family: MathJax_Main; padding-left: 0.251em;">+</span><span class="msubsup" id="MathJax-Span-3859" style="padding-left: 0.251em;"><span style="display: inline-block; position: relative; width: 3.353em; height: 0px;"><span style="position: absolute; clip: rect(2.547em, 1002.61em, 6.765em, -999.997em); top: -4.898em; left: 0em;"><span class="mrow" id="MathJax-Span-3860"><span class="mo" id="MathJax-Span-3861" style="vertical-align: 2.174em;"><span style="display: inline-block; position: relative; width: 0.685em; height: 0px;"><span style="position: absolute; font-family: MathJax_Size4; top: -2.788em; left: 0em;">⎡<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; font-family: MathJax_Size4; top: -0.741em; left: 0em;">⎣<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -1.734em; left: 0em;">⎢<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="mtable" id="MathJax-Span-3862" style="padding-right: 0.189em; padding-left: 0.189em;"><span style="display: inline-block; position: relative; width: 1.182em; height: 0px;"><span style="position: absolute; clip: rect(2.484em, 1001.18em, 6.641em, -999.997em); top: -4.774em; left: 0em;"><span style="display: inline-block; position: relative; width: 1.182em; height: 0px;"><span style="position: absolute; clip: rect(3.105em, 1001.18em, 4.346em, -999.997em); top: -5.394em; left: 50%; margin-left: -0.617em;"><span class="mtd" id="MathJax-Span-3863"><span class="mrow" id="MathJax-Span-3864"><span class="msubsup" id="MathJax-Span-3865"><span style="display: inline-block; position: relative; width: 1.182em; height: 0px;"><span style="position: absolute; clip: rect(3.105em, 1000.75em, 4.159em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-3866" style="font-family: MathJax_Math-italic;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.065em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.748em;"><span class="mi" id="MathJax-Span-3867" style="font-size: 70.7%; font-family: MathJax_Math-italic;">x</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.105em, 1001.12em, 4.47em, -999.997em); top: -3.967em; left: 50%; margin-left: -0.555em;"><span class="mtd" id="MathJax-Span-3868"><span class="mrow" id="MathJax-Span-3869"><span class="msubsup" id="MathJax-Span-3870"><span style="display: inline-block; position: relative; width: 1.12em; height: 0px;"><span style="position: absolute; clip: rect(3.105em, 1000.75em, 4.159em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-3871" style="font-family: MathJax_Math-italic;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.065em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.748em;"><span class="mi" id="MathJax-Span-3872" style="font-size: 70.7%; font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.105em, 1001.12em, 4.346em, -999.997em); top: -2.478em; left: 50%; margin-left: -0.555em;"><span class="mtd" id="MathJax-Span-3873"><span class="mrow" id="MathJax-Span-3874"><span class="msubsup" id="MathJax-Span-3875"><span style="display: inline-block; position: relative; width: 1.12em; height: 0px;"><span style="position: absolute; clip: rect(3.105em, 1000.75em, 4.159em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-3876" style="font-family: MathJax_Math-italic;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.065em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.748em;"><span class="mi" id="MathJax-Span-3877" style="font-size: 70.7%; font-family: MathJax_Math-italic;">z<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.78em;"></span></span></span></span><span class="mo" id="MathJax-Span-3878" style="vertical-align: 2.174em;"><span style="display: inline-block; position: relative; width: 0.685em; height: 0px;"><span style="position: absolute; font-family: MathJax_Size4; top: -2.788em; left: 0em;">⎤<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; font-family: MathJax_Size4; top: -0.741em; left: 0em;">⎦<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -1.734em; left: 0em;">⎥<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.904em;"></span></span><span style="position: absolute; top: -2.23em; left: 2.919em;"><span class="mi" id="MathJax-Span-3879" style="font-size: 70.7%; font-family: MathJax_Math-italic;">k</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span><span class="mo" id="MathJax-Span-3880" style="vertical-align: 2.919em;"><span style="display: inline-block; position: relative; width: 0.685em; height: 0px;"><span style="position: absolute; font-family: MathJax_Size4; top: -2.788em; left: 0em;">⎤<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; font-family: MathJax_Size4; top: 0.748em; left: 0em;">⎦<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -1.672em; left: 0em;">⎥<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -1.238em; left: 0em;">⎥<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -0.741em; left: 0em;">⎥<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -0.245em; left: 0em;">⎥<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 5.276em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -3.073em; border-left: 0px solid; width: 0px; height: 6.85em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>D</mi><mo>=</mo><mo>−</mo><mi>g</mi><mo stretchy="false">[</mo><msub><mi>h</mi><mi>a</mi></msub><mo stretchy="false">(</mo><msub><mi>q</mi><mrow class="MJX-TeXAtom-ORD"><mi>k</mi><mo>−</mo><mn>1</mn></mrow></msub><mo stretchy="false">)</mo><mo>–</mo><mn>2</mn><msubsup><mi>h</mi><mi>a</mi><mo>′</mo></msubsup><mo stretchy="false">(</mo><msub><mi>q</mi><mrow class="MJX-TeXAtom-ORD"><mi>k</mi><mo>−</mo><mn>1</mn></mrow></msub><mo stretchy="false">)</mo><mo stretchy="false">(</mo><msub><mi>q</mi><mrow class="MJX-TeXAtom-ORD"><mi>k</mi><mo>−</mo><mn>1</mn></mrow></msub><mo stretchy="false">)</mo><mo>+</mo><msub><mi>C</mi><mi>k</mi></msub><mo stretchy="false">]</mo><mo>=</mo><mo>−</mo><mi>g</mi><mrow><mo>[</mo><mrow><msub><mrow><mo>[</mo><mtable rowspacing="4pt" columnspacing="1em"><mtr><mtd><mn>2</mn><mo stretchy="false">(</mo><msub><mi>q</mi><mn>1</mn></msub><msub><mi>q</mi><mn>3</mn></msub><mo>–</mo><msub><mi>q</mi><mn>0</mn></msub><msub><mi>q</mi><mn>2</mn></msub><mo stretchy="false">)</mo></mtd></mtr><mtr><mtd><mn>2</mn><mo stretchy="false">(</mo><msub><mi>q</mi><mn>2</mn></msub><msub><mi>q</mi><mn>3</mn></msub><mo>+</mo><msub><mi>q</mi><mn>0</mn></msub><msub><mi>q</mi><mn>1</mn></msub><mo stretchy="false">)</mo></mtd></mtr><mtr><mtd><msubsup><mi>q</mi><mn>0</mn><mn>2</mn></msubsup><mo>–</mo><msubsup><mi>q</mi><mn>1</mn><mn>2</mn></msubsup><mo>–</mo><msubsup><mi>q</mi><mn>2</mn><mn>2</mn></msubsup><mo>+</mo><msubsup><mi>q</mi><mn>3</mn><mn>2</mn></msubsup></mtd></mtr></mtable><mo>]</mo></mrow><mrow class="MJX-TeXAtom-ORD"><mi>k</mi><mo>−</mo><mn>1</mn></mrow></msub><mo>–</mo><mn>2</mn><msub><mrow><mo>[</mo><mtable rowspacing="4pt" columnspacing="1em"><mtr><mtd><mo>−</mo><msub><mi>q</mi><mn>2</mn></msub></mtd><mtd><msub><mi>q</mi><mn>3</mn></msub></mtd><mtd><mo>−</mo><msub><mi>q</mi><mn>0</mn></msub></mtd><mtd><msub><mi>q</mi><mn>1</mn></msub></mtd></mtr><mtr><mtd><msub><mi>q</mi><mn>1</mn></msub></mtd><mtd><msub><mi>q</mi><mn>0</mn></msub></mtd><mtd><msub><mi>q</mi><mn>3</mn></msub></mtd><mtd><msub><mi>q</mi><mn>2</mn></msub></mtd></mtr><mtr><mtd><msub><mi>q</mi><mn>0</mn></msub></mtd><mtd><mo>−</mo><msub><mi>q</mi><mn>1</mn></msub></mtd><mtd><mo>−</mo><msub><mi>q</mi><mn>2</mn></msub></mtd><mtd><msub><mi>q</mi><mn>3</mn></msub></mtd></mtr></mtable><mo>]</mo></mrow><mrow class="MJX-TeXAtom-ORD"><mi>k</mi><mo>−</mo><mn>1</mn></mrow></msub><msub><mrow><mo>[</mo><mtable rowspacing="4pt" columnspacing="1em"><mtr><mtd><msub><mi>q</mi><mn>0</mn></msub></mtd></mtr><mtr><mtd><msub><mi>q</mi><mn>1</mn></msub></mtd></mtr><mtr><mtd><msub><mi>q</mi><mn>2</mn></msub></mtd></mtr><mtr><mtd><msub><mi>q</mi><mn>3</mn></msub></mtd></mtr></mtable><mo>]</mo></mrow><mrow class="MJX-TeXAtom-ORD"><mi>k</mi><mo>−</mo><mn>1</mn></mrow></msub><mo>+</mo><msub><mrow><mo>[</mo><mtable rowspacing="4pt" columnspacing="1em"><mtr><mtd><msub><mi>C</mi><mi>x</mi></msub></mtd></mtr><mtr><mtd><msub><mi>C</mi><mi>y</mi></msub></mtd></mtr><mtr><mtd><msub><mi>C</mi><mi>z</mi></msub></mtd></mtr></mtable><mo>]</mo></mrow><mi>k</mi></msub></mrow><mo>]</mo></mrow></math></span></span><script type="math/tex" id="MathJax-Element-70">D = -g[h_a(q_{k-1}) – 2h’_a(q_{k-1})(q_{k-1}) + C_k] = -g\left[\begin{bmatrix} 2(q_1q_3 – q_0q_2) \\ 2(q_2q_3 + q_0q_1) \\ q_0^2 – q_1^2 – q_2^2 + q_3^2 \end{bmatrix}_{k-1} – 2\begin{bmatrix} -q_2 & q_3 & -q_0 & q_1 \\ q_1 & q_0 & q_3 & q_2 \\ q_0 & -q_1 & -q_2 & q_3 \end{bmatrix}_{k-1}\begin{bmatrix} q_0 \\ q_1 \\ q_2 \\ q_3 \end{bmatrix}_{k-1} +\begin{bmatrix} C_x \\ C_y \\ C_z \end{bmatrix}_k \right]</script></p>
<p>We now have a system of linear equations, albeit being a little ugly. Actually, in the kalman filter implementation, we are only going to use matrix <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-71-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;C&lt;/mi&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-3881" style="width: 0.996em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.81em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(1.492em, 1000.81em, 2.547em, -999.997em); top: -2.354em; left: 0em;"><span class="mrow" id="MathJax-Span-3882"><span class="mi" id="MathJax-Span-3883" style="font-family: MathJax_Math-italic;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.065em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.36em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.073em; border-left: 0px solid; width: 0px; height: 1.081em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>C</mi></math></span></span><script type="math/tex" id="MathJax-Element-71">C</script> (the Jacobian matrix) thus the rest of the terms are actually not needed. There are some mathematical proofs for this, but that is beyond the scope of this tutorial. We are now finally done with the accelerometer section.</p>
<div id="MagData"></div>
<hr>
<h2>Magnetometer Data</h2>
<p>The magnetometer provides us with a vector that is always pointing to the magnetic North. This vector changes (elevation of the vector changes depending on the altitude) over the surface of the Earth thus we will need a map of the vectors if we want a reference vector that works across the globe. However, in this project, we will be assuming that the change in the North reference vector is negligible since the sensor will not be moving around much (probably only within the room).</p>
<p>The magnetometer actually gives a 3 directional reference vector instead of a simple North heading in 2 dimensions. Due to this, there are some complications that arise. In this project, I will make the assumption that the accelerometer is accurate in providing the reference vector in the vertical plane, and the magnetometer data is accurate in providing the reference vector in the horizontal place. As a result of this, we do not want the magnetometer data to affect the accelerometer data and vice versa. Therefore, we are going to remove 1 dimension from the magnetometer reference vector.</p>
<p>Firstly, we will calibrate our magnetometer based on my <a href="https://thepoorengineer.com/en/calibrating-the-magnetometer/">previous post</a>&nbsp;so that we can get a 3 dimensional unit vector from the raw magnetometer data. If you follow the method in the <a href="https://thepoorengineer.com/en/calibrating-the-magnetometer/">previous post</a>, you should be able to determine the values of <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-72-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msup&gt;&lt;mi&gt;A&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-3884" style="width: 2.174em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.74em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(1.368em, 1001.74em, 2.547em, -999.997em); top: -2.354em; left: 0em;"><span class="mrow" id="MathJax-Span-3885"><span class="msubsup" id="MathJax-Span-3886"><span style="display: inline-block; position: relative; width: 1.74em; height: 0px;"><span style="position: absolute; clip: rect(3.043em, 1000.75em, 4.159em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-3887" style="font-family: MathJax_Math-italic;">A</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -4.339em; left: 0.748em;"><span class="texatom" id="MathJax-Span-3888"><span class="mrow" id="MathJax-Span-3889"><span class="mo" id="MathJax-Span-3890" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="mn" id="MathJax-Span-3891" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.36em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.073em; border-left: 0px solid; width: 0px; height: 1.158em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup><mi>A</mi><mrow class="MJX-TeXAtom-ORD"><mo>−</mo><mn>1</mn></mrow></msup></math></span></span><script type="math/tex" id="MathJax-Element-72">A^{-1}</script> and <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-73-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-3892" style="width: 0.561em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.437em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(1.492em, 1000.44em, 2.547em, -999.997em); top: -2.354em; left: 0em;"><span class="mrow" id="MathJax-Span-3893"><span class="mi" id="MathJax-Span-3894" style="font-family: MathJax_Math-italic;">b</span></span><span style="display: inline-block; width: 0px; height: 2.36em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.073em; border-left: 0px solid; width: 0px; height: 1.004em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>b</mi></math></span></span><script type="math/tex" id="MathJax-Element-73">b</script> so you can apply the calibration equation as follows.</p>
<p style="text-align: center;"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-74-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;h&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;msup&gt;&lt;mi&gt;A&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;h&lt;/mi&gt;&lt;mi&gt;m&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;&amp;#x2013;&lt;/mo&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-3895" style="width: 8.502em; display: inline-block;"><span style="display: inline-block; position: relative; width: 6.827em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(1.368em, 1006.7em, 2.795em, -999.997em); top: -2.354em; left: 0em;"><span class="mrow" id="MathJax-Span-3896"><span class="mi" id="MathJax-Span-3897" style="font-family: MathJax_Math-italic;">h</span><span class="mo" id="MathJax-Span-3898" style="font-family: MathJax_Main; padding-left: 0.251em;">=</span><span class="msubsup" id="MathJax-Span-3899" style="padding-left: 0.251em;"><span style="display: inline-block; position: relative; width: 1.74em; height: 0px;"><span style="position: absolute; clip: rect(3.043em, 1000.75em, 4.159em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-3900" style="font-family: MathJax_Math-italic;">A</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -4.339em; left: 0.748em;"><span class="texatom" id="MathJax-Span-3901"><span class="mrow" id="MathJax-Span-3902"><span class="mo" id="MathJax-Span-3903" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="mn" id="MathJax-Span-3904" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="mo" id="MathJax-Span-3905" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-3906"><span style="display: inline-block; position: relative; width: 1.306em; height: 0px;"><span style="position: absolute; clip: rect(3.105em, 1000.56em, 4.159em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-3907" style="font-family: MathJax_Math-italic;">h</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.561em;"><span class="mi" id="MathJax-Span-3908" style="font-size: 70.7%; font-family: MathJax_Math-italic;">m</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="mo" id="MathJax-Span-3909" style="font-family: MathJax_Main;">–</span><span class="mi" id="MathJax-Span-3910" style="font-family: MathJax_Math-italic; padding-left: 0.189em;">b</span><span class="mo" id="MathJax-Span-3911" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.36em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.381em; border-left: 0px solid; width: 0px; height: 1.465em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>h</mi><mo>=</mo><msup><mi>A</mi><mrow class="MJX-TeXAtom-ORD"><mo>−</mo><mn>1</mn></mrow></msup><mo stretchy="false">(</mo><msub><mi>h</mi><mi>m</mi></msub><mo>–</mo><mi>b</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-74">h = A^{-1}(h_m – b)</script></p>
<p>where</p>
<p><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-75-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;h&lt;/mi&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-3912" style="width: 0.685em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.561em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(1.492em, 1000.56em, 2.547em, -999.997em); top: -2.354em; left: 0em;"><span class="mrow" id="MathJax-Span-3913"><span class="mi" id="MathJax-Span-3914" style="font-family: MathJax_Math-italic;">h</span></span><span style="display: inline-block; width: 0px; height: 2.36em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.073em; border-left: 0px solid; width: 0px; height: 1.004em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>h</mi></math></span></span><script type="math/tex" id="MathJax-Element-75">h</script> is the actual magnetic field<br>
<span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-76-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;h&lt;/mi&gt;&lt;mi&gt;m&lt;/mi&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-3915" style="width: 1.616em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.306em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(1.492em, 1001.31em, 2.733em, -999.997em); top: -2.354em; left: 0em;"><span class="mrow" id="MathJax-Span-3916"><span class="msubsup" id="MathJax-Span-3917"><span style="display: inline-block; position: relative; width: 1.306em; height: 0px;"><span style="position: absolute; clip: rect(3.105em, 1000.56em, 4.159em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-3918" style="font-family: MathJax_Math-italic;">h</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.561em;"><span class="mi" id="MathJax-Span-3919" style="font-size: 70.7%; font-family: MathJax_Math-italic;">m</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.36em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.304em; border-left: 0px solid; width: 0px; height: 1.235em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>h</mi><mi>m</mi></msub></math></span></span><script type="math/tex" id="MathJax-Element-76">h_m</script> is the measurement reading from the magnetometer with errors</p>
<p>Next, in order to remove 1 dimension (the vertical plane) from the magnetometer vector, we have to transform the coordinates from the body frame (measurements are done in the body frame) to the world frame first (because the vertical plane that we want to remove exist in the world frame). Therefore, we have to get the rotation matrix that converts the body frame to the world frame from our quaternion. This can be done through equation (1) from my <a href="https://thepoorengineer.com/en/quaternion/">previous post</a>&nbsp;which is shown below as well.</p>
<p style="text-align: center;"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-77-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msup&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mo&gt;&amp;#x2032;&lt;/mo&gt;&lt;/msup&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;C&lt;/mi&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-3920" style="width: 4.097em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.291em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(1.43em, 1003.29em, 2.547em, -999.997em); top: -2.354em; left: 0em;"><span class="mrow" id="MathJax-Span-3921"><span class="msup" id="MathJax-Span-3922"><span style="display: inline-block; position: relative; width: 0.748em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.44em, 4.159em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-3923" style="font-family: MathJax_Math-italic;">r</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -4.339em; left: 0.437em;"><span class="mo" id="MathJax-Span-3924" style="font-size: 70.7%; font-family: MathJax_Main;">′</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="mo" id="MathJax-Span-3925" style="font-family: MathJax_Main; padding-left: 0.251em;">=</span><span class="mi" id="MathJax-Span-3926" style="font-family: MathJax_Math-italic; padding-left: 0.251em;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.065em;"></span></span><span class="mi" id="MathJax-Span-3927" style="font-family: MathJax_Math-italic;">r</span></span><span style="display: inline-block; width: 0px; height: 2.36em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.073em; border-left: 0px solid; width: 0px; height: 1.158em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup><mi>r</mi><mo>′</mo></msup><mo>=</mo><mi>C</mi><mi>r</mi></math></span></span><script type="math/tex" id="MathJax-Element-77">r’=Cr</script></p>
<p>where</p>
<p style="text-align: left;"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-78-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;C&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mrow&gt;&lt;mo&gt;[&lt;/mo&gt;&lt;mtable rowspacing=&quot;4pt&quot; columnspacing=&quot;1em&quot;&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;msubsup&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msubsup&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;msubsup&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msubsup&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;msubsup&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msubsup&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;msubsup&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mn&gt;3&lt;/mn&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msubsup&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;msub&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msub&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/msub&gt;&lt;msub&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mn&gt;3&lt;/mn&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;msub&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mn&gt;3&lt;/mn&gt;&lt;/msub&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/msub&gt;&lt;msub&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;msub&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msub&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/msub&gt;&lt;msub&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mn&gt;3&lt;/mn&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;msubsup&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msubsup&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;msubsup&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msubsup&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;msubsup&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msubsup&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;msubsup&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mn&gt;3&lt;/mn&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msubsup&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msub&gt;&lt;msub&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mn&gt;3&lt;/mn&gt;&lt;/msub&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/msub&gt;&lt;msub&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;msub&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mn&gt;3&lt;/mn&gt;&lt;/msub&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/msub&gt;&lt;msub&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msub&gt;&lt;msub&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mn&gt;3&lt;/mn&gt;&lt;/msub&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/msub&gt;&lt;msub&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;msubsup&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msubsup&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;msubsup&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msubsup&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;msubsup&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msubsup&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;msubsup&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mn&gt;3&lt;/mn&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msubsup&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;/mtable&gt;&lt;mo&gt;]&lt;/mo&gt;&lt;/mrow&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-3928" style="width: 35.549em; display: inline-block;"><span style="display: inline-block; position: relative; width: 28.663em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(2.174em, 1028.35em, 6.765em, -999.997em); top: -4.712em; left: 0em;"><span class="mrow" id="MathJax-Span-3929"><span class="mi" id="MathJax-Span-3930" style="font-family: MathJax_Math-italic;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.065em;"></span></span><span class="mo" id="MathJax-Span-3931" style="font-family: MathJax_Main; padding-left: 0.251em;">=</span><span class="mrow" id="MathJax-Span-3932" style="padding-left: 0.251em;"><span class="mo" id="MathJax-Span-3933" style="vertical-align: 2.36em;"><span style="display: inline-block; position: relative; width: 0.685em; height: 0px;"><span style="position: absolute; font-family: MathJax_Size4; top: -2.788em; left: 0em;">⎡<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; font-family: MathJax_Size4; top: -0.369em; left: 0em;">⎣<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -1.734em; left: 0em;">⎢<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -1.362em; left: 0em;">⎢<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="mtable" id="MathJax-Span-3934" style="padding-right: 0.189em; padding-left: 0.189em;"><span style="display: inline-block; position: relative; width: 24.817em; height: 0px;"><span style="position: absolute; clip: rect(2.609em, 1007.63em, 7.137em, -999.997em); top: -5.146em; left: 0em;"><span style="display: inline-block; position: relative; width: 7.633em; height: 0px;"><span style="position: absolute; clip: rect(2.981em, 1007.63em, 4.47em, -999.997em); top: -5.518em; left: 50%; margin-left: -3.781em;"><span class="mtd" id="MathJax-Span-3935"><span class="mrow" id="MathJax-Span-3936"><span class="msubsup" id="MathJax-Span-3937"><span style="display: inline-block; position: relative; width: 0.934em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.44em, 4.346em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-3938" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.291em, 1000.44em, 4.159em, -999.997em); top: -4.339em; left: 0.499em;"><span class="mn" id="MathJax-Span-3939" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.291em, 1000.44em, 4.159em, -999.997em); top: -3.657em; left: 0.437em;"><span class="mn" id="MathJax-Span-3940" style="font-size: 70.7%; font-family: MathJax_Main;">0</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="mo" id="MathJax-Span-3941" style="font-family: MathJax_Main; padding-left: 0.251em;">+</span><span class="msubsup" id="MathJax-Span-3942" style="padding-left: 0.251em;"><span style="display: inline-block; position: relative; width: 0.934em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.44em, 4.346em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-3943" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.291em, 1000.44em, 4.159em, -999.997em); top: -4.339em; left: 0.499em;"><span class="mn" id="MathJax-Span-3944" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.291em, 1000.44em, 4.159em, -999.997em); top: -3.657em; left: 0.437em;"><span class="mn" id="MathJax-Span-3945" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="mo" id="MathJax-Span-3946" style="font-family: MathJax_Main; padding-left: 0.251em;">−</span><span class="msubsup" id="MathJax-Span-3947" style="padding-left: 0.251em;"><span style="display: inline-block; position: relative; width: 0.934em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.44em, 4.346em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-3948" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.291em, 1000.44em, 4.159em, -999.997em); top: -4.339em; left: 0.499em;"><span class="mn" id="MathJax-Span-3949" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.291em, 1000.44em, 4.159em, -999.997em); top: -3.657em; left: 0.437em;"><span class="mn" id="MathJax-Span-3950" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="mo" id="MathJax-Span-3951" style="font-family: MathJax_Main; padding-left: 0.251em;">−</span><span class="msubsup" id="MathJax-Span-3952" style="padding-left: 0.251em;"><span style="display: inline-block; position: relative; width: 0.934em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.44em, 4.346em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-3953" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.291em, 1000.44em, 4.159em, -999.997em); top: -4.339em; left: 0.499em;"><span class="mn" id="MathJax-Span-3954" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.291em, 1000.44em, 4.159em, -999.997em); top: -3.657em; left: 0.437em;"><span class="mn" id="MathJax-Span-3955" style="font-size: 70.7%; font-family: MathJax_Main;">3</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.043em, 1005.96em, 4.408em, -999.997em); top: -3.967em; left: 50%; margin-left: -3.037em;"><span class="mtd" id="MathJax-Span-3992"><span class="mrow" id="MathJax-Span-3993"><span class="mn" id="MathJax-Span-3994" style="font-family: MathJax_Main;">2</span><span class="mo" id="MathJax-Span-3995" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-3996"><span style="display: inline-block; position: relative; width: 0.872em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.44em, 4.346em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-3997" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.437em;"><span class="mn" id="MathJax-Span-3998" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-3999"><span style="display: inline-block; position: relative; width: 0.872em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.44em, 4.346em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-4000" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.437em;"><span class="mn" id="MathJax-Span-4001" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="mo" id="MathJax-Span-4002" style="font-family: MathJax_Main; padding-left: 0.251em;">+</span><span class="msubsup" id="MathJax-Span-4003" style="padding-left: 0.251em;"><span style="display: inline-block; position: relative; width: 0.872em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.44em, 4.346em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-4004" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.437em;"><span class="mn" id="MathJax-Span-4005" style="font-size: 70.7%; font-family: MathJax_Main;">0</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-4006"><span style="display: inline-block; position: relative; width: 0.872em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.44em, 4.346em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-4007" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.437em;"><span class="mn" id="MathJax-Span-4008" style="font-size: 70.7%; font-family: MathJax_Main;">3</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="mo" id="MathJax-Span-4009" style="font-family: MathJax_Main;">)</span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.043em, 1005.96em, 4.408em, -999.997em); top: -2.416em; left: 50%; margin-left: -3.037em;"><span class="mtd" id="MathJax-Span-4049"><span class="mrow" id="MathJax-Span-4050"><span class="mn" id="MathJax-Span-4051" style="font-family: MathJax_Main;">2</span><span class="mo" id="MathJax-Span-4052" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-4053"><span style="display: inline-block; position: relative; width: 0.872em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.44em, 4.346em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-4054" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.437em;"><span class="mn" id="MathJax-Span-4055" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-4056"><span style="display: inline-block; position: relative; width: 0.872em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.44em, 4.346em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-4057" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.437em;"><span class="mn" id="MathJax-Span-4058" style="font-size: 70.7%; font-family: MathJax_Main;">3</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="mo" id="MathJax-Span-4059" style="font-family: MathJax_Main; padding-left: 0.251em;">−</span><span class="msubsup" id="MathJax-Span-4060" style="padding-left: 0.251em;"><span style="display: inline-block; position: relative; width: 0.872em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.44em, 4.346em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-4061" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.437em;"><span class="mn" id="MathJax-Span-4062" style="font-size: 70.7%; font-family: MathJax_Main;">0</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-4063"><span style="display: inline-block; position: relative; width: 0.872em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.44em, 4.346em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-4064" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.437em;"><span class="mn" id="MathJax-Span-4065" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="mo" id="MathJax-Span-4066" style="font-family: MathJax_Main;">)</span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span><span style="display: inline-block; width: 0px; height: 5.152em;"></span></span><span style="position: absolute; clip: rect(2.609em, 1007.63em, 7.075em, -999.997em); top: -5.084em; left: 8.626em;"><span style="display: inline-block; position: relative; width: 7.633em; height: 0px;"><span style="position: absolute; clip: rect(3.043em, 1005.96em, 4.408em, -999.997em); top: -5.518em; left: 50%; margin-left: -3.037em;"><span class="mtd" id="MathJax-Span-3956"><span class="mrow" id="MathJax-Span-3957"><span class="mn" id="MathJax-Span-3958" style="font-family: MathJax_Main;">2</span><span class="mo" id="MathJax-Span-3959" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-3960"><span style="display: inline-block; position: relative; width: 0.872em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.44em, 4.346em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-3961" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.437em;"><span class="mn" id="MathJax-Span-3962" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-3963"><span style="display: inline-block; position: relative; width: 0.872em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.44em, 4.346em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-3964" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.437em;"><span class="mn" id="MathJax-Span-3965" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="mo" id="MathJax-Span-3966" style="font-family: MathJax_Main; padding-left: 0.251em;">−</span><span class="msubsup" id="MathJax-Span-3967" style="padding-left: 0.251em;"><span style="display: inline-block; position: relative; width: 0.872em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.44em, 4.346em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-3968" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.437em;"><span class="mn" id="MathJax-Span-3969" style="font-size: 70.7%; font-family: MathJax_Main;">0</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-3970"><span style="display: inline-block; position: relative; width: 0.872em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.44em, 4.346em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-3971" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.437em;"><span class="mn" id="MathJax-Span-3972" style="font-size: 70.7%; font-family: MathJax_Main;">3</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="mo" id="MathJax-Span-3973" style="font-family: MathJax_Main;">)</span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(2.981em, 1007.63em, 4.47em, -999.997em); top: -3.967em; left: 50%; margin-left: -3.781em;"><span class="mtd" id="MathJax-Span-4010"><span class="mrow" id="MathJax-Span-4011"><span class="msubsup" id="MathJax-Span-4012"><span style="display: inline-block; position: relative; width: 0.934em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.44em, 4.346em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-4013" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.291em, 1000.44em, 4.159em, -999.997em); top: -4.339em; left: 0.499em;"><span class="mn" id="MathJax-Span-4014" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.291em, 1000.44em, 4.159em, -999.997em); top: -3.657em; left: 0.437em;"><span class="mn" id="MathJax-Span-4015" style="font-size: 70.7%; font-family: MathJax_Main;">0</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="mo" id="MathJax-Span-4016" style="font-family: MathJax_Main; padding-left: 0.251em;">−</span><span class="msubsup" id="MathJax-Span-4017" style="padding-left: 0.251em;"><span style="display: inline-block; position: relative; width: 0.934em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.44em, 4.346em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-4018" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.291em, 1000.44em, 4.159em, -999.997em); top: -4.339em; left: 0.499em;"><span class="mn" id="MathJax-Span-4019" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.291em, 1000.44em, 4.159em, -999.997em); top: -3.657em; left: 0.437em;"><span class="mn" id="MathJax-Span-4020" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="mo" id="MathJax-Span-4021" style="font-family: MathJax_Main; padding-left: 0.251em;">+</span><span class="msubsup" id="MathJax-Span-4022" style="padding-left: 0.251em;"><span style="display: inline-block; position: relative; width: 0.934em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.44em, 4.346em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-4023" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.291em, 1000.44em, 4.159em, -999.997em); top: -4.339em; left: 0.499em;"><span class="mn" id="MathJax-Span-4024" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.291em, 1000.44em, 4.159em, -999.997em); top: -3.657em; left: 0.437em;"><span class="mn" id="MathJax-Span-4025" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="mo" id="MathJax-Span-4026" style="font-family: MathJax_Main; padding-left: 0.251em;">−</span><span class="msubsup" id="MathJax-Span-4027" style="padding-left: 0.251em;"><span style="display: inline-block; position: relative; width: 0.934em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.44em, 4.346em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-4028" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.291em, 1000.44em, 4.159em, -999.997em); top: -4.339em; left: 0.499em;"><span class="mn" id="MathJax-Span-4029" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.291em, 1000.44em, 4.159em, -999.997em); top: -3.657em; left: 0.437em;"><span class="mn" id="MathJax-Span-4030" style="font-size: 70.7%; font-family: MathJax_Main;">3</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.043em, 1005.96em, 4.408em, -999.997em); top: -2.416em; left: 50%; margin-left: -3.037em;"><span class="mtd" id="MathJax-Span-4067"><span class="mrow" id="MathJax-Span-4068"><span class="mn" id="MathJax-Span-4069" style="font-family: MathJax_Main;">2</span><span class="mo" id="MathJax-Span-4070" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-4071"><span style="display: inline-block; position: relative; width: 0.872em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.44em, 4.346em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-4072" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.437em;"><span class="mn" id="MathJax-Span-4073" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-4074"><span style="display: inline-block; position: relative; width: 0.872em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.44em, 4.346em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-4075" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.437em;"><span class="mn" id="MathJax-Span-4076" style="font-size: 70.7%; font-family: MathJax_Main;">3</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="mo" id="MathJax-Span-4077" style="font-family: MathJax_Main; padding-left: 0.251em;">+</span><span class="msubsup" id="MathJax-Span-4078" style="padding-left: 0.251em;"><span style="display: inline-block; position: relative; width: 0.872em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.44em, 4.346em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-4079" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.437em;"><span class="mn" id="MathJax-Span-4080" style="font-size: 70.7%; font-family: MathJax_Main;">0</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-4081"><span style="display: inline-block; position: relative; width: 0.872em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.44em, 4.346em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-4082" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.437em;"><span class="mn" id="MathJax-Span-4083" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="mo" id="MathJax-Span-4084" style="font-family: MathJax_Main;">)</span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span><span style="display: inline-block; width: 0px; height: 5.09em;"></span></span><span style="position: absolute; clip: rect(2.671em, 1007.63em, 7.199em, -999.997em); top: -5.146em; left: 17.249em;"><span style="display: inline-block; position: relative; width: 7.633em; height: 0px;"><span style="position: absolute; clip: rect(3.043em, 1005.96em, 4.408em, -999.997em); top: -5.518em; left: 50%; margin-left: -3.037em;"><span class="mtd" id="MathJax-Span-3974"><span class="mrow" id="MathJax-Span-3975"><span class="mn" id="MathJax-Span-3976" style="font-family: MathJax_Main;">2</span><span class="mo" id="MathJax-Span-3977" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-3978"><span style="display: inline-block; position: relative; width: 0.872em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.44em, 4.346em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-3979" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.437em;"><span class="mn" id="MathJax-Span-3980" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-3981"><span style="display: inline-block; position: relative; width: 0.872em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.44em, 4.346em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-3982" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.437em;"><span class="mn" id="MathJax-Span-3983" style="font-size: 70.7%; font-family: MathJax_Main;">3</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="mo" id="MathJax-Span-3984" style="font-family: MathJax_Main; padding-left: 0.251em;">+</span><span class="msubsup" id="MathJax-Span-3985" style="padding-left: 0.251em;"><span style="display: inline-block; position: relative; width: 0.872em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.44em, 4.346em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-3986" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.437em;"><span class="mn" id="MathJax-Span-3987" style="font-size: 70.7%; font-family: MathJax_Main;">0</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-3988"><span style="display: inline-block; position: relative; width: 0.872em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.44em, 4.346em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-3989" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.437em;"><span class="mn" id="MathJax-Span-3990" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="mo" id="MathJax-Span-3991" style="font-family: MathJax_Main;">)</span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.043em, 1005.96em, 4.408em, -999.997em); top: -3.967em; left: 50%; margin-left: -3.037em;"><span class="mtd" id="MathJax-Span-4031"><span class="mrow" id="MathJax-Span-4032"><span class="mn" id="MathJax-Span-4033" style="font-family: MathJax_Main;">2</span><span class="mo" id="MathJax-Span-4034" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-4035"><span style="display: inline-block; position: relative; width: 0.872em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.44em, 4.346em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-4036" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.437em;"><span class="mn" id="MathJax-Span-4037" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-4038"><span style="display: inline-block; position: relative; width: 0.872em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.44em, 4.346em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-4039" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.437em;"><span class="mn" id="MathJax-Span-4040" style="font-size: 70.7%; font-family: MathJax_Main;">3</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="mo" id="MathJax-Span-4041" style="font-family: MathJax_Main; padding-left: 0.251em;">−</span><span class="msubsup" id="MathJax-Span-4042" style="padding-left: 0.251em;"><span style="display: inline-block; position: relative; width: 0.872em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.44em, 4.346em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-4043" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.437em;"><span class="mn" id="MathJax-Span-4044" style="font-size: 70.7%; font-family: MathJax_Main;">0</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-4045"><span style="display: inline-block; position: relative; width: 0.872em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.44em, 4.346em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-4046" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.437em;"><span class="mn" id="MathJax-Span-4047" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="mo" id="MathJax-Span-4048" style="font-family: MathJax_Main;">)</span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(2.981em, 1007.63em, 4.47em, -999.997em); top: -2.416em; left: 50%; margin-left: -3.781em;"><span class="mtd" id="MathJax-Span-4085"><span class="mrow" id="MathJax-Span-4086"><span class="msubsup" id="MathJax-Span-4087"><span style="display: inline-block; position: relative; width: 0.934em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.44em, 4.346em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-4088" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.291em, 1000.44em, 4.159em, -999.997em); top: -4.339em; left: 0.499em;"><span class="mn" id="MathJax-Span-4089" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.291em, 1000.44em, 4.159em, -999.997em); top: -3.657em; left: 0.437em;"><span class="mn" id="MathJax-Span-4090" style="font-size: 70.7%; font-family: MathJax_Main;">0</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="mo" id="MathJax-Span-4091" style="font-family: MathJax_Main; padding-left: 0.251em;">−</span><span class="msubsup" id="MathJax-Span-4092" style="padding-left: 0.251em;"><span style="display: inline-block; position: relative; width: 0.934em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.44em, 4.346em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-4093" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.291em, 1000.44em, 4.159em, -999.997em); top: -4.339em; left: 0.499em;"><span class="mn" id="MathJax-Span-4094" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.291em, 1000.44em, 4.159em, -999.997em); top: -3.657em; left: 0.437em;"><span class="mn" id="MathJax-Span-4095" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="mo" id="MathJax-Span-4096" style="font-family: MathJax_Main; padding-left: 0.251em;">−</span><span class="msubsup" id="MathJax-Span-4097" style="padding-left: 0.251em;"><span style="display: inline-block; position: relative; width: 0.934em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.44em, 4.346em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-4098" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.291em, 1000.44em, 4.159em, -999.997em); top: -4.339em; left: 0.499em;"><span class="mn" id="MathJax-Span-4099" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.291em, 1000.44em, 4.159em, -999.997em); top: -3.657em; left: 0.437em;"><span class="mn" id="MathJax-Span-4100" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="mo" id="MathJax-Span-4101" style="font-family: MathJax_Main; padding-left: 0.251em;">+</span><span class="msubsup" id="MathJax-Span-4102" style="padding-left: 0.251em;"><span style="display: inline-block; position: relative; width: 0.934em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.44em, 4.346em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-4103" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.291em, 1000.44em, 4.159em, -999.997em); top: -4.339em; left: 0.499em;"><span class="mn" id="MathJax-Span-4104" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.291em, 1000.44em, 4.159em, -999.997em); top: -3.657em; left: 0.437em;"><span class="mn" id="MathJax-Span-4105" style="font-size: 70.7%; font-family: MathJax_Main;">3</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span><span style="display: inline-block; width: 0px; height: 5.152em;"></span></span></span></span><span class="mo" id="MathJax-Span-4106" style="vertical-align: 2.36em;"><span style="display: inline-block; position: relative; width: 0.685em; height: 0px;"><span style="position: absolute; font-family: MathJax_Size4; top: -2.788em; left: 0em;">⎤<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; font-family: MathJax_Size4; top: -0.369em; left: 0em;">⎦<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -1.734em; left: 0em;">⎥<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -1.362em; left: 0em;">⎥<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.718em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -2.381em; border-left: 0px solid; width: 0px; height: 5.388em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>C</mi><mo>=</mo><mrow><mo>[</mo><mtable rowspacing="4pt" columnspacing="1em"><mtr><mtd><msubsup><mi>q</mi><mn>0</mn><mn>2</mn></msubsup><mo>+</mo><msubsup><mi>q</mi><mn>1</mn><mn>2</mn></msubsup><mo>−</mo><msubsup><mi>q</mi><mn>2</mn><mn>2</mn></msubsup><mo>−</mo><msubsup><mi>q</mi><mn>3</mn><mn>2</mn></msubsup></mtd><mtd><mn>2</mn><mo stretchy="false">(</mo><msub><mi>q</mi><mn>1</mn></msub><msub><mi>q</mi><mn>2</mn></msub><mo>−</mo><msub><mi>q</mi><mn>0</mn></msub><msub><mi>q</mi><mn>3</mn></msub><mo stretchy="false">)</mo></mtd><mtd><mn>2</mn><mo stretchy="false">(</mo><msub><mi>q</mi><mn>1</mn></msub><msub><mi>q</mi><mn>3</mn></msub><mo>+</mo><msub><mi>q</mi><mn>0</mn></msub><msub><mi>q</mi><mn>2</mn></msub><mo stretchy="false">)</mo></mtd></mtr><mtr><mtd><mn>2</mn><mo stretchy="false">(</mo><msub><mi>q</mi><mn>1</mn></msub><msub><mi>q</mi><mn>2</mn></msub><mo>+</mo><msub><mi>q</mi><mn>0</mn></msub><msub><mi>q</mi><mn>3</mn></msub><mo stretchy="false">)</mo></mtd><mtd><msubsup><mi>q</mi><mn>0</mn><mn>2</mn></msubsup><mo>−</mo><msubsup><mi>q</mi><mn>1</mn><mn>2</mn></msubsup><mo>+</mo><msubsup><mi>q</mi><mn>2</mn><mn>2</mn></msubsup><mo>−</mo><msubsup><mi>q</mi><mn>3</mn><mn>2</mn></msubsup></mtd><mtd><mn>2</mn><mo stretchy="false">(</mo><msub><mi>q</mi><mn>2</mn></msub><msub><mi>q</mi><mn>3</mn></msub><mo>−</mo><msub><mi>q</mi><mn>0</mn></msub><msub><mi>q</mi><mn>1</mn></msub><mo stretchy="false">)</mo></mtd></mtr><mtr><mtd><mn>2</mn><mo stretchy="false">(</mo><msub><mi>q</mi><mn>1</mn></msub><msub><mi>q</mi><mn>3</mn></msub><mo>−</mo><msub><mi>q</mi><mn>0</mn></msub><msub><mi>q</mi><mn>2</mn></msub><mo stretchy="false">)</mo></mtd><mtd><mn>2</mn><mo stretchy="false">(</mo><msub><mi>q</mi><mn>2</mn></msub><msub><mi>q</mi><mn>3</mn></msub><mo>+</mo><msub><mi>q</mi><mn>0</mn></msub><msub><mi>q</mi><mn>1</mn></msub><mo stretchy="false">)</mo></mtd><mtd><msubsup><mi>q</mi><mn>0</mn><mn>2</mn></msubsup><mo>−</mo><msubsup><mi>q</mi><mn>1</mn><mn>2</mn></msubsup><mo>−</mo><msubsup><mi>q</mi><mn>2</mn><mn>2</mn></msubsup><mo>+</mo><msubsup><mi>q</mi><mn>3</mn><mn>2</mn></msubsup></mtd></mtr></mtable><mo>]</mo></mrow></math></span></span><script type="math/tex" id="MathJax-Element-78">C=\begin{bmatrix} q_0^2+q_1^2-q_2^2-q_3^2 & 2(q_1q_2-q_0q_3) & 2(q_1q_3+q_0q_2) \\ 2(q_1q_2+q_0q_3) & q_0^2-q_1^2+q_2^2-q_3^2 & 2(q_2q_3-q_0q_1) \\ 2(q_1q_3-q_0q_2) & 2(q_2q_3+q_0q_1) & q_0^2-q_1^2-q_2^2+q_3^2 \end{bmatrix}</script></p>
<p>In this case, <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-79-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-4107" style="width: 0.561em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.437em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(1.74em, 1000.44em, 2.547em, -999.997em); top: -2.354em; left: 0em;"><span class="mrow" id="MathJax-Span-4108"><span class="mi" id="MathJax-Span-4109" style="font-family: MathJax_Math-italic;">r</span></span><span style="display: inline-block; width: 0px; height: 2.36em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.073em; border-left: 0px solid; width: 0px; height: 0.696em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>r</mi></math></span></span><script type="math/tex" id="MathJax-Element-79">r</script> will be the unit vector calibrated magnetometer data in the body frame. Therefore,</p>
<p style="text-align: left;"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-80-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mrow&gt;&lt;mo&gt;[&lt;/mo&gt;&lt;mtable rowspacing=&quot;4pt&quot; columnspacing=&quot;1em&quot;&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;msup&gt;&lt;mi&gt;&lt;/mi&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;/msup&gt;&lt;msub&gt;&lt;mi&gt;m&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;msup&gt;&lt;mi&gt;&lt;/mi&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;/msup&gt;&lt;msub&gt;&lt;mi&gt;m&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;msup&gt;&lt;mi&gt;&lt;/mi&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;/msup&gt;&lt;msub&gt;&lt;mi&gt;m&lt;/mi&gt;&lt;mn&gt;3&lt;/mn&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;/mtable&gt;&lt;mo&gt;]&lt;/mo&gt;&lt;/mrow&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-4110" style="width: 6.393em; display: inline-block;"><span style="display: inline-block; position: relative; width: 5.152em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(2.174em, 1004.84em, 6.517em, -999.997em); top: -4.587em; left: 0em;"><span class="mrow" id="MathJax-Span-4111"><span class="mi" id="MathJax-Span-4112" style="font-family: MathJax_Math-italic;">r</span><span class="mo" id="MathJax-Span-4113" style="font-family: MathJax_Main; padding-left: 0.251em;">=</span><span class="mrow" id="MathJax-Span-4114" style="padding-left: 0.251em;"><span class="mo" id="MathJax-Span-4115" style="vertical-align: 2.236em;"><span style="display: inline-block; position: relative; width: 0.685em; height: 0px;"><span style="position: absolute; font-family: MathJax_Size4; top: -2.788em; left: 0em;">⎡<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; font-family: MathJax_Size4; top: -0.679em; left: 0em;">⎣<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -1.672em; left: 0em;">⎢<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="mtable" id="MathJax-Span-4116" style="padding-right: 0.189em; padding-left: 0.189em;"><span style="display: inline-block; position: relative; width: 1.678em; height: 0px;"><span style="position: absolute; clip: rect(2.484em, 1001.68em, 6.765em, -999.997em); top: -4.898em; left: 0em;"><span style="display: inline-block; position: relative; width: 1.678em; height: 0px;"><span style="position: absolute; clip: rect(2.919em, 1001.68em, 4.283em, -999.997em); top: -5.332em; left: 50%; margin-left: -0.865em;"><span class="mtd" id="MathJax-Span-4117"><span class="mrow" id="MathJax-Span-4118"><span class="msubsup" id="MathJax-Span-4119"><span style="display: inline-block; position: relative; width: 0.375em; height: 0px;"><span style="position: absolute; clip: rect(3.787em, 1000em, 4.159em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-4120"></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -4.339em; left: 0em;"><span class="mi" id="MathJax-Span-4121" style="font-size: 70.7%; font-family: MathJax_Math-italic;">b</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-4122"><span style="display: inline-block; position: relative; width: 1.306em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.87em, 4.159em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-4123" style="font-family: MathJax_Math-italic;">m</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.872em;"><span class="mn" id="MathJax-Span-4124" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(2.919em, 1001.68em, 4.283em, -999.997em); top: -3.905em; left: 50%; margin-left: -0.865em;"><span class="mtd" id="MathJax-Span-4125"><span class="mrow" id="MathJax-Span-4126"><span class="msubsup" id="MathJax-Span-4127"><span style="display: inline-block; position: relative; width: 0.375em; height: 0px;"><span style="position: absolute; clip: rect(3.787em, 1000em, 4.159em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-4128"></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -4.339em; left: 0em;"><span class="mi" id="MathJax-Span-4129" style="font-size: 70.7%; font-family: MathJax_Math-italic;">b</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-4130"><span style="display: inline-block; position: relative; width: 1.306em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.87em, 4.159em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-4131" style="font-family: MathJax_Math-italic;">m</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.872em;"><span class="mn" id="MathJax-Span-4132" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(2.919em, 1001.68em, 4.346em, -999.997em); top: -2.416em; left: 50%; margin-left: -0.865em;"><span class="mtd" id="MathJax-Span-4133"><span class="mrow" id="MathJax-Span-4134"><span class="msubsup" id="MathJax-Span-4135"><span style="display: inline-block; position: relative; width: 0.375em; height: 0px;"><span style="position: absolute; clip: rect(3.787em, 1000em, 4.159em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-4136"></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -4.339em; left: 0em;"><span class="mi" id="MathJax-Span-4137" style="font-size: 70.7%; font-family: MathJax_Math-italic;">b</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-4138"><span style="display: inline-block; position: relative; width: 1.306em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.87em, 4.159em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-4139" style="font-family: MathJax_Math-italic;">m</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.872em;"><span class="mn" id="MathJax-Span-4140" style="font-size: 70.7%; font-family: MathJax_Main;">3</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.904em;"></span></span></span></span><span class="mo" id="MathJax-Span-4141" style="vertical-align: 2.236em;"><span style="display: inline-block; position: relative; width: 0.685em; height: 0px;"><span style="position: absolute; font-family: MathJax_Size4; top: -2.788em; left: 0em;">⎤<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; font-family: MathJax_Size4; top: -0.679em; left: 0em;">⎦<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -1.672em; left: 0em;">⎥<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.594em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -2.227em; border-left: 0px solid; width: 0px; height: 5.081em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>r</mi><mo>=</mo><mrow><mo>[</mo><mtable rowspacing="4pt" columnspacing="1em"><mtr><mtd><msup><mi></mi><mi>b</mi></msup><msub><mi>m</mi><mn>1</mn></msub></mtd></mtr><mtr><mtd><msup><mi></mi><mi>b</mi></msup><msub><mi>m</mi><mn>2</mn></msub></mtd></mtr><mtr><mtd><msup><mi></mi><mi>b</mi></msup><msub><mi>m</mi><mn>3</mn></msub></mtd></mtr></mtable><mo>]</mo></mrow></math></span></span><script type="math/tex" id="MathJax-Element-80">r = \begin{bmatrix} ^bm_1 \\ ^bm_2 \\ ^bm_3 \end{bmatrix}</script></p>
<p><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-81-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msup&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mo&gt;&amp;#x2032;&lt;/mo&gt;&lt;/msup&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mrow&gt;&lt;mo&gt;[&lt;/mo&gt;&lt;mtable rowspacing=&quot;4pt&quot; columnspacing=&quot;1em&quot;&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;msup&gt;&lt;mi&gt;&lt;/mi&gt;&lt;mi&gt;w&lt;/mi&gt;&lt;/msup&gt;&lt;msub&gt;&lt;mi&gt;m&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;msup&gt;&lt;mi&gt;&lt;/mi&gt;&lt;mi&gt;w&lt;/mi&gt;&lt;/msup&gt;&lt;msub&gt;&lt;mi&gt;m&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;msup&gt;&lt;mi&gt;&lt;/mi&gt;&lt;mi&gt;w&lt;/mi&gt;&lt;/msup&gt;&lt;msub&gt;&lt;mi&gt;m&lt;/mi&gt;&lt;mn&gt;3&lt;/mn&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;/mtable&gt;&lt;mo&gt;]&lt;/mo&gt;&lt;/mrow&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-4142" style="width: 7.013em; display: inline-block;"><span style="display: inline-block; position: relative; width: 5.648em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(2.174em, 1005.34em, 6.393em, -999.997em); top: -4.525em; left: 0em;"><span class="mrow" id="MathJax-Span-4143"><span class="msup" id="MathJax-Span-4144"><span style="display: inline-block; position: relative; width: 0.748em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.44em, 4.159em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-4145" style="font-family: MathJax_Math-italic;">r</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -4.339em; left: 0.437em;"><span class="mo" id="MathJax-Span-4146" style="font-size: 70.7%; font-family: MathJax_Main;">′</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="mo" id="MathJax-Span-4147" style="font-family: MathJax_Main; padding-left: 0.251em;">=</span><span class="mrow" id="MathJax-Span-4148" style="padding-left: 0.251em;"><span class="mo" id="MathJax-Span-4149" style="vertical-align: 2.174em;"><span style="display: inline-block; position: relative; width: 0.685em; height: 0px;"><span style="position: absolute; font-family: MathJax_Size4; top: -2.788em; left: 0em;">⎡<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; font-family: MathJax_Size4; top: -0.803em; left: 0em;">⎣<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -1.796em; left: 0em;">⎢<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="mtable" id="MathJax-Span-4150" style="padding-right: 0.189em; padding-left: 0.189em;"><span style="display: inline-block; position: relative; width: 1.864em; height: 0px;"><span style="position: absolute; clip: rect(2.422em, 1001.86em, 6.455em, -999.997em); top: -4.65em; left: 0em;"><span style="display: inline-block; position: relative; width: 1.864em; height: 0px;"><span style="position: absolute; clip: rect(3.105em, 1001.86em, 4.283em, -999.997em); top: -5.332em; left: 50%; margin-left: -0.927em;"><span class="mtd" id="MathJax-Span-4151"><span class="mrow" id="MathJax-Span-4152"><span class="msubsup" id="MathJax-Span-4153"><span style="display: inline-block; position: relative; width: 0.561em; height: 0px;"><span style="position: absolute; clip: rect(3.787em, 1000em, 4.159em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-4154"></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -4.339em; left: 0em;"><span class="mi" id="MathJax-Span-4155" style="font-size: 70.7%; font-family: MathJax_Math-italic;">w</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-4156"><span style="display: inline-block; position: relative; width: 1.306em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.87em, 4.159em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-4157" style="font-family: MathJax_Math-italic;">m</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.872em;"><span class="mn" id="MathJax-Span-4158" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.105em, 1001.86em, 4.283em, -999.997em); top: -3.905em; left: 50%; margin-left: -0.927em;"><span class="mtd" id="MathJax-Span-4159"><span class="mrow" id="MathJax-Span-4160"><span class="msubsup" id="MathJax-Span-4161"><span style="display: inline-block; position: relative; width: 0.561em; height: 0px;"><span style="position: absolute; clip: rect(3.787em, 1000em, 4.159em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-4162"></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -4.339em; left: 0em;"><span class="mi" id="MathJax-Span-4163" style="font-size: 70.7%; font-family: MathJax_Math-italic;">w</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-4164"><span style="display: inline-block; position: relative; width: 1.306em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.87em, 4.159em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-4165" style="font-family: MathJax_Math-italic;">m</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.872em;"><span class="mn" id="MathJax-Span-4166" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.105em, 1001.86em, 4.346em, -999.997em); top: -2.54em; left: 50%; margin-left: -0.927em;"><span class="mtd" id="MathJax-Span-4167"><span class="mrow" id="MathJax-Span-4168"><span class="msubsup" id="MathJax-Span-4169"><span style="display: inline-block; position: relative; width: 0.561em; height: 0px;"><span style="position: absolute; clip: rect(3.787em, 1000em, 4.159em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-4170"></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -4.339em; left: 0em;"><span class="mi" id="MathJax-Span-4171" style="font-size: 70.7%; font-family: MathJax_Math-italic;">w</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-4172"><span style="display: inline-block; position: relative; width: 1.306em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.87em, 4.159em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-4173" style="font-family: MathJax_Math-italic;">m</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.872em;"><span class="mn" id="MathJax-Span-4174" style="font-size: 70.7%; font-family: MathJax_Main;">3</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.656em;"></span></span></span></span><span class="mo" id="MathJax-Span-4175" style="vertical-align: 2.174em;"><span style="display: inline-block; position: relative; width: 0.685em; height: 0px;"><span style="position: absolute; font-family: MathJax_Size4; top: -2.788em; left: 0em;">⎤<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; font-family: MathJax_Size4; top: -0.803em; left: 0em;">⎦<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -1.796em; left: 0em;">⎥<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.532em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -2.15em; border-left: 0px solid; width: 0px; height: 4.85em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup><mi>r</mi><mo>′</mo></msup><mo>=</mo><mrow><mo>[</mo><mtable rowspacing="4pt" columnspacing="1em"><mtr><mtd><msup><mi></mi><mi>w</mi></msup><msub><mi>m</mi><mn>1</mn></msub></mtd></mtr><mtr><mtd><msup><mi></mi><mi>w</mi></msup><msub><mi>m</mi><mn>2</mn></msub></mtd></mtr><mtr><mtd><msup><mi></mi><mi>w</mi></msup><msub><mi>m</mi><mn>3</mn></msub></mtd></mtr></mtable><mo>]</mo></mrow></math></span></span><script type="math/tex" id="MathJax-Element-81">r’ = \begin{bmatrix} ^wm_1 \\ ^wm_2 \\ ^wm_3 \end{bmatrix}</script></p>
<p>where</p>
<p><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-82-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msup&gt;&lt;mi&gt;&lt;/mi&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;/msup&gt;&lt;msub&gt;&lt;mi&gt;m&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;msup&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;/msup&gt;&lt;msub&gt;&lt;mi&gt;m&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msub&gt;&lt;msup&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;/msup&gt;&lt;msub&gt;&lt;mi&gt;m&lt;/mi&gt;&lt;mn&gt;3&lt;/mn&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-4176" style="width: 7.509em; display: inline-block;"><span style="display: inline-block; position: relative; width: 6.02em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(1.306em, 1006.02em, 2.733em, -999.997em); top: -2.354em; left: 0em;"><span class="mrow" id="MathJax-Span-4177"><span class="msubsup" id="MathJax-Span-4178"><span style="display: inline-block; position: relative; width: 0.375em; height: 0px;"><span style="position: absolute; clip: rect(3.787em, 1000em, 4.159em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-4179"></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -4.339em; left: 0em;"><span class="mi" id="MathJax-Span-4180" style="font-size: 70.7%; font-family: MathJax_Math-italic;">b</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-4181"><span style="display: inline-block; position: relative; width: 1.306em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.87em, 4.159em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-4182" style="font-family: MathJax_Math-italic;">m</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.872em;"><span class="mn" id="MathJax-Span-4183" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-4184"><span style="display: inline-block; position: relative; width: 0.685em; height: 0px;"><span style="position: absolute; clip: rect(3.663em, 1000.19em, 4.346em, -999.997em); top: -3.967em; left: 0em;"><span class="mo" id="MathJax-Span-4185" style="font-family: MathJax_Main;">,</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -4.339em; left: 0.251em;"><span class="mi" id="MathJax-Span-4186" style="font-size: 70.7%; font-family: MathJax_Math-italic;">b</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-4187" style="padding-left: 0.189em;"><span style="display: inline-block; position: relative; width: 1.306em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.87em, 4.159em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-4188" style="font-family: MathJax_Math-italic;">m</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.872em;"><span class="mn" id="MathJax-Span-4189" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-4190"><span style="display: inline-block; position: relative; width: 0.685em; height: 0px;"><span style="position: absolute; clip: rect(3.663em, 1000.19em, 4.346em, -999.997em); top: -3.967em; left: 0em;"><span class="mo" id="MathJax-Span-4191" style="font-family: MathJax_Main;">,</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -4.339em; left: 0.251em;"><span class="mi" id="MathJax-Span-4192" style="font-size: 70.7%; font-family: MathJax_Math-italic;">b</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-4193" style="padding-left: 0.189em;"><span style="display: inline-block; position: relative; width: 1.306em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.87em, 4.159em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-4194" style="font-family: MathJax_Math-italic;">m</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.872em;"><span class="mn" id="MathJax-Span-4195" style="font-size: 70.7%; font-family: MathJax_Main;">3</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.36em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.304em; border-left: 0px solid; width: 0px; height: 1.465em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup><mi></mi><mi>b</mi></msup><msub><mi>m</mi><mn>1</mn></msub><msup><mo>,</mo><mi>b</mi></msup><msub><mi>m</mi><mn>2</mn></msub><msup><mo>,</mo><mi>b</mi></msup><msub><mi>m</mi><mn>3</mn></msub></math></span></span><script type="math/tex" id="MathJax-Element-82">^bm_1, ^bm_2, ^bm_3</script> is the calibrated magnetometer data in the body frame’s x, y, z direction respectively.<br>
<span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-83-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msup&gt;&lt;mi&gt;&lt;/mi&gt;&lt;mi&gt;w&lt;/mi&gt;&lt;/msup&gt;&lt;msub&gt;&lt;mi&gt;m&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;msup&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;w&lt;/mi&gt;&lt;/msup&gt;&lt;msub&gt;&lt;mi&gt;m&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msub&gt;&lt;msup&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;w&lt;/mi&gt;&lt;/msup&gt;&lt;msub&gt;&lt;mi&gt;m&lt;/mi&gt;&lt;mn&gt;3&lt;/mn&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-4196" style="width: 8.192em; display: inline-block;"><span style="display: inline-block; position: relative; width: 6.579em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(1.492em, 1006.58em, 2.733em, -999.997em); top: -2.354em; left: 0em;"><span class="mrow" id="MathJax-Span-4197"><span class="msubsup" id="MathJax-Span-4198"><span style="display: inline-block; position: relative; width: 0.561em; height: 0px;"><span style="position: absolute; clip: rect(3.787em, 1000em, 4.159em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-4199"></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -4.339em; left: 0em;"><span class="mi" id="MathJax-Span-4200" style="font-size: 70.7%; font-family: MathJax_Math-italic;">w</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-4201"><span style="display: inline-block; position: relative; width: 1.306em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.87em, 4.159em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-4202" style="font-family: MathJax_Math-italic;">m</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.872em;"><span class="mn" id="MathJax-Span-4203" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-4204"><span style="display: inline-block; position: relative; width: 0.872em; height: 0px;"><span style="position: absolute; clip: rect(3.663em, 1000.19em, 4.346em, -999.997em); top: -3.967em; left: 0em;"><span class="mo" id="MathJax-Span-4205" style="font-family: MathJax_Main;">,</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -4.339em; left: 0.251em;"><span class="mi" id="MathJax-Span-4206" style="font-size: 70.7%; font-family: MathJax_Math-italic;">w</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-4207" style="padding-left: 0.189em;"><span style="display: inline-block; position: relative; width: 1.306em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.87em, 4.159em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-4208" style="font-family: MathJax_Math-italic;">m</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.872em;"><span class="mn" id="MathJax-Span-4209" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-4210"><span style="display: inline-block; position: relative; width: 0.872em; height: 0px;"><span style="position: absolute; clip: rect(3.663em, 1000.19em, 4.346em, -999.997em); top: -3.967em; left: 0em;"><span class="mo" id="MathJax-Span-4211" style="font-family: MathJax_Main;">,</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -4.339em; left: 0.251em;"><span class="mi" id="MathJax-Span-4212" style="font-size: 70.7%; font-family: MathJax_Math-italic;">w</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-4213" style="padding-left: 0.189em;"><span style="display: inline-block; position: relative; width: 1.306em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.87em, 4.159em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-4214" style="font-family: MathJax_Math-italic;">m</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.872em;"><span class="mn" id="MathJax-Span-4215" style="font-size: 70.7%; font-family: MathJax_Main;">3</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.36em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.304em; border-left: 0px solid; width: 0px; height: 1.235em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup><mi></mi><mi>w</mi></msup><msub><mi>m</mi><mn>1</mn></msub><msup><mo>,</mo><mi>w</mi></msup><msub><mi>m</mi><mn>2</mn></msub><msup><mo>,</mo><mi>w</mi></msup><msub><mi>m</mi><mn>3</mn></msub></math></span></span><script type="math/tex" id="MathJax-Element-83">^wm_1, ^wm_2, ^wm_3</script> is the calibrated magnetometer data in the world frame’s x, y, z direction respectively.</p>
<p>Now, we can safely remove the z-axis from our data by letting <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-84-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msup&gt;&lt;mi&gt;&lt;/mi&gt;&lt;mi&gt;w&lt;/mi&gt;&lt;/msup&gt;&lt;msub&gt;&lt;mi&gt;m&lt;/mi&gt;&lt;mn&gt;3&lt;/mn&gt;&lt;/msub&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-4216" style="width: 4.532em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.663em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(1.492em, 1003.6em, 2.733em, -999.997em); top: -2.354em; left: 0em;"><span class="mrow" id="MathJax-Span-4217"><span class="msubsup" id="MathJax-Span-4218"><span style="display: inline-block; position: relative; width: 0.561em; height: 0px;"><span style="position: absolute; clip: rect(3.787em, 1000em, 4.159em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-4219"></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -4.339em; left: 0em;"><span class="mi" id="MathJax-Span-4220" style="font-size: 70.7%; font-family: MathJax_Math-italic;">w</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-4221"><span style="display: inline-block; position: relative; width: 1.306em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.87em, 4.159em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-4222" style="font-family: MathJax_Math-italic;">m</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.872em;"><span class="mn" id="MathJax-Span-4223" style="font-size: 70.7%; font-family: MathJax_Main;">3</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="mo" id="MathJax-Span-4224" style="font-family: MathJax_Main; padding-left: 0.251em;">=</span><span class="mn" id="MathJax-Span-4225" style="font-family: MathJax_Main; padding-left: 0.251em;">0</span></span><span style="display: inline-block; width: 0px; height: 2.36em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.304em; border-left: 0px solid; width: 0px; height: 1.235em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup><mi></mi><mi>w</mi></msup><msub><mi>m</mi><mn>3</mn></msub><mo>=</mo><mn>0</mn></math></span></span><script type="math/tex" id="MathJax-Element-84">^wm_3 = 0</script>, then re-normalizing the vector such that it stays as a unit vector but only in 2 dimensions now. We will then rotate it back to the body frame and use the resulting vector (in place of the actual calibrated measured data) for our kalman filter update section later on. On a side note, you will find that even without doing all these, the kalman filter algorithm will work. However, whether it works better with or without is another story to be told another day.</p>
<p>In the accelerometer section, we have the gravity vector as our reference vector. On the other hand, we have the North vector as a reference for our magnetometer. For me, since the North vector points exactly in the direction of the negative y-axis when I placed the sensor parallel to my table, I simply took the negative y-axis (in the world frame) as my reference vector. A better approach would be perhaps to have a period of time for the initialization process to set the current North vector as the reference vector. In this way, all we have to do is place the object in the desired direction for it to use the direction as a reference for calculation.</p>
<p>As a result of setting the y-axis to be the reference vector, in place of&nbsp;<span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-85-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;g&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;msup&gt;&lt;mrow&gt;&lt;mo&gt;[&lt;/mo&gt;&lt;mtable rowspacing=&quot;4pt&quot; columnspacing=&quot;1em&quot;&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;/mtable&gt;&lt;mo&gt;]&lt;/mo&gt;&lt;/mrow&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;/msup&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-4226" style="width: 8.378em; display: inline-block;"><span style="display: inline-block; position: relative; width: 6.765em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(1.244em, 1006.76em, 2.795em, -999.997em); top: -2.354em; left: 0em;"><span class="mrow" id="MathJax-Span-4227"><span class="mi" id="MathJax-Span-4228" style="font-family: MathJax_Math-italic;">g<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-4229" style="font-family: MathJax_Main; padding-left: 0.251em;">=</span><span class="msubsup" id="MathJax-Span-4230" style="padding-left: 0.251em;"><span style="display: inline-block; position: relative; width: 5.028em; height: 0px;"><span style="position: absolute; clip: rect(3.043em, 1004.35em, 4.408em, -999.997em); top: -3.967em; left: 0em;"><span class="mrow" id="MathJax-Span-4231"><span class="mo" id="MathJax-Span-4232" style="font-family: MathJax_Main;">[</span><span class="mtable" id="MathJax-Span-4233" style="padding-right: 0.189em; padding-left: 0.189em;"><span style="display: inline-block; position: relative; width: 3.477em; height: 0px;"><span style="position: absolute; clip: rect(3.167em, 1000.44em, 4.221em, -999.997em); top: -3.967em; left: 0em;"><span style="display: inline-block; position: relative; width: 0.499em; height: 0px;"><span style="position: absolute; clip: rect(3.105em, 1000.44em, 4.159em, -999.997em); top: -3.905em; left: 50%; margin-left: -0.245em;"><span class="mtd" id="MathJax-Span-4234"><span class="mrow" id="MathJax-Span-4235"><span class="mn" id="MathJax-Span-4236" style="font-family: MathJax_Main;">0</span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.167em, 1000.44em, 4.221em, -999.997em); top: -3.967em; left: 1.492em;"><span style="display: inline-block; position: relative; width: 0.499em; height: 0px;"><span style="position: absolute; clip: rect(3.105em, 1000.44em, 4.159em, -999.997em); top: -3.905em; left: 50%; margin-left: -0.245em;"><span class="mtd" id="MathJax-Span-4237"><span class="mrow" id="MathJax-Span-4238"><span class="mn" id="MathJax-Span-4239" style="font-family: MathJax_Main;">0</span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.167em, 1000.44em, 4.221em, -999.997em); top: -3.967em; left: 2.981em;"><span style="display: inline-block; position: relative; width: 0.499em; height: 0px;"><span style="position: absolute; clip: rect(3.105em, 1000.44em, 4.159em, -999.997em); top: -3.905em; left: 50%; margin-left: -0.245em;"><span class="mtd" id="MathJax-Span-4240"><span class="mrow" id="MathJax-Span-4241"><span class="mn" id="MathJax-Span-4242" style="font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="mo" id="MathJax-Span-4243" style="font-family: MathJax_Main;">]</span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -4.463em; left: 4.408em;"><span class="mi" id="MathJax-Span-4244" style="font-size: 70.7%; font-family: MathJax_Math-italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.065em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.36em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.381em; border-left: 0px solid; width: 0px; height: 1.619em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>g</mi><mo>=</mo><msup><mrow><mo>[</mo><mtable rowspacing="4pt" columnspacing="1em"><mtr><mtd><mn>0</mn></mtd><mtd><mn>0</mn></mtd><mtd><mn>1</mn></mtd></mtr></mtable><mo>]</mo></mrow><mi>T</mi></msup></math></span></span><script type="math/tex" id="MathJax-Element-85">g = \begin{bmatrix} 0 & 0 & 1 \end{bmatrix}^T</script>, I have&nbsp;<span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-86-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;m&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;msup&gt;&lt;mrow&gt;&lt;mo&gt;[&lt;/mo&gt;&lt;mtable rowspacing=&quot;4pt&quot; columnspacing=&quot;1em&quot;&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;/mtable&gt;&lt;mo&gt;]&lt;/mo&gt;&lt;/mrow&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;/msup&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-4245" style="width: 9.867em; display: inline-block;"><span style="display: inline-block; position: relative; width: 7.944em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(1.244em, 1007.94em, 2.795em, -999.997em); top: -2.354em; left: 0em;"><span class="mrow" id="MathJax-Span-4246"><span class="mi" id="MathJax-Span-4247" style="font-family: MathJax_Math-italic;">m</span><span class="mo" id="MathJax-Span-4248" style="font-family: MathJax_Main; padding-left: 0.251em;">=</span><span class="msubsup" id="MathJax-Span-4249" style="padding-left: 0.251em;"><span style="display: inline-block; position: relative; width: 5.772em; height: 0px;"><span style="position: absolute; clip: rect(3.043em, 1005.09em, 4.408em, -999.997em); top: -3.967em; left: 0em;"><span class="mrow" id="MathJax-Span-4250"><span class="mo" id="MathJax-Span-4251" style="font-family: MathJax_Main;">[</span><span class="mtable" id="MathJax-Span-4252" style="padding-right: 0.189em; padding-left: 0.189em;"><span style="display: inline-block; position: relative; width: 4.283em; height: 0px;"><span style="position: absolute; clip: rect(3.167em, 1000.44em, 4.221em, -999.997em); top: -3.967em; left: 0em;"><span style="display: inline-block; position: relative; width: 0.499em; height: 0px;"><span style="position: absolute; clip: rect(3.105em, 1000.44em, 4.159em, -999.997em); top: -3.905em; left: 50%; margin-left: -0.245em;"><span class="mtd" id="MathJax-Span-4253"><span class="mrow" id="MathJax-Span-4254"><span class="mn" id="MathJax-Span-4255" style="font-family: MathJax_Main;">0</span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.167em, 1001.18em, 4.283em, -999.997em); top: -3.967em; left: 1.492em;"><span style="display: inline-block; position: relative; width: 1.306em; height: 0px;"><span style="position: absolute; clip: rect(3.105em, 1001.18em, 4.221em, -999.997em); top: -3.905em; left: 50%; margin-left: -0.617em;"><span class="mtd" id="MathJax-Span-4256"><span class="mrow" id="MathJax-Span-4257"><span class="mo" id="MathJax-Span-4258" style="font-family: MathJax_Main;">−</span><span class="mn" id="MathJax-Span-4259" style="font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.167em, 1000.44em, 4.221em, -999.997em); top: -3.967em; left: 3.787em;"><span style="display: inline-block; position: relative; width: 0.499em; height: 0px;"><span style="position: absolute; clip: rect(3.105em, 1000.44em, 4.159em, -999.997em); top: -3.905em; left: 50%; margin-left: -0.245em;"><span class="mtd" id="MathJax-Span-4260"><span class="mrow" id="MathJax-Span-4261"><span class="mn" id="MathJax-Span-4262" style="font-family: MathJax_Main;">0</span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="mo" id="MathJax-Span-4263" style="font-family: MathJax_Main;">]</span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -4.463em; left: 5.214em;"><span class="mi" id="MathJax-Span-4264" style="font-size: 70.7%; font-family: MathJax_Math-italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.065em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.36em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.381em; border-left: 0px solid; width: 0px; height: 1.619em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>m</mi><mo>=</mo><msup><mrow><mo>[</mo><mtable rowspacing="4pt" columnspacing="1em"><mtr><mtd><mn>0</mn></mtd><mtd><mo>−</mo><mn>1</mn></mtd><mtd><mn>0</mn></mtd></mtr></mtable><mo>]</mo></mrow><mi>T</mi></msup></math></span></span><script type="math/tex" id="MathJax-Element-86">m = \begin{bmatrix} 0 & -1 & 0 \end{bmatrix}^T</script>. (in the python code, i added in the negative sign into the gravity reference vector)</p>
<p>Moving on, once again, we need a linear equation for the output of our system in order for us to use the kalman filter. The output that we want to get here is the predicted accelerometer and magnetometer data from our kalman filter states (quaternion). One way of doing so is through the rotation matrix which can be derived from a quaternion. Similar to the accelerometer, we can use the following equation to convert the magnetometer reading from the world frame to the body frame (so that we can compare it to the actual measured magnetometer value).</p>
<p style="text-align: center;"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-87-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msup&gt;&lt;mi&gt;&lt;/mi&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;/msup&gt;&lt;msub&gt;&lt;mi&gt;m&lt;/mi&gt;&lt;mi&gt;m&lt;/mi&gt;&lt;/msub&gt;&lt;msup&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;/msup&gt;&lt;msub&gt;&lt;mi&gt;R&lt;/mi&gt;&lt;mi&gt;w&lt;/mi&gt;&lt;/msub&gt;&lt;msup&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;w&lt;/mi&gt;&lt;/msup&gt;&lt;msub&gt;&lt;mi&gt;m&lt;/mi&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;msup&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;/msup&gt;&lt;msub&gt;&lt;mi&gt;e&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;m&lt;/mi&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mi&gt;g&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;msup&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;/msup&gt;&lt;msub&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;m&lt;/mi&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mi&gt;g&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-4265" style="width: 18.303em; display: inline-block;"><span style="display: inline-block; position: relative; width: 14.767em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(1.306em, 1014.77em, 2.857em, -999.997em); top: -2.354em; left: 0em;"><span class="mrow" id="MathJax-Span-4266"><span class="msubsup" id="MathJax-Span-4267"><span style="display: inline-block; position: relative; width: 0.375em; height: 0px;"><span style="position: absolute; clip: rect(3.787em, 1000em, 4.159em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-4268"></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -4.339em; left: 0em;"><span class="mi" id="MathJax-Span-4269" style="font-size: 70.7%; font-family: MathJax_Math-italic;">b</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-4270"><span style="display: inline-block; position: relative; width: 1.554em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.87em, 4.159em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-4271" style="font-family: MathJax_Math-italic;">m</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.872em;"><span class="mi" id="MathJax-Span-4272" style="font-size: 70.7%; font-family: MathJax_Math-italic;">m</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-4273" style="padding-left: 0.251em;"><span style="display: inline-block; position: relative; width: 1.182em; height: 0px;"><span style="position: absolute; clip: rect(3.415em, 1000.75em, 4.035em, -999.997em); top: -3.967em; left: 0em;"><span class="mo" id="MathJax-Span-4274" style="font-family: MathJax_Main;">=</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -4.339em; left: 0.81em;"><span class="mi" id="MathJax-Span-4275" style="font-size: 70.7%; font-family: MathJax_Math-italic;">b</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-4276" style="padding-left: 0.251em;"><span style="display: inline-block; position: relative; width: 1.368em; height: 0px;"><span style="position: absolute; clip: rect(3.105em, 1000.75em, 4.159em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-4277" style="font-family: MathJax_Math-italic;">R</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.748em;"><span class="mi" id="MathJax-Span-4278" style="font-size: 70.7%; font-family: MathJax_Math-italic;">w</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-4279"><span style="display: inline-block; position: relative; width: 0.996em; height: 0px;"><span style="position: absolute; clip: rect(3.043em, 1000.31em, 4.408em, -999.997em); top: -3.967em; left: 0em;"><span class="mo" id="MathJax-Span-4280" style="font-family: MathJax_Main;">(</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -4.339em; left: 0.375em;"><span class="mi" id="MathJax-Span-4281" style="font-size: 70.7%; font-family: MathJax_Math-italic;">w</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-4282"><span style="display: inline-block; position: relative; width: 1.306em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.87em, 4.159em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-4283" style="font-family: MathJax_Math-italic;">m</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.872em;"><span class="mi" id="MathJax-Span-4284" style="font-size: 70.7%; font-family: MathJax_Math-italic;">r</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="mo" id="MathJax-Span-4285" style="font-family: MathJax_Main;">)</span><span class="msubsup" id="MathJax-Span-4286" style="padding-left: 0.251em;"><span style="display: inline-block; position: relative; width: 1.182em; height: 0px;"><span style="position: absolute; clip: rect(3.229em, 1000.75em, 4.221em, -999.997em); top: -3.967em; left: 0em;"><span class="mo" id="MathJax-Span-4287" style="font-family: MathJax_Main;">+</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -4.339em; left: 0.81em;"><span class="mi" id="MathJax-Span-4288" style="font-size: 70.7%; font-family: MathJax_Math-italic;">b</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-4289" style="padding-left: 0.251em;"><span style="display: inline-block; position: relative; width: 1.864em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.44em, 4.159em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-4290" style="font-family: MathJax_Math-italic;">e</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.499em;"><span class="texatom" id="MathJax-Span-4291"><span class="mrow" id="MathJax-Span-4292"><span class="mi" id="MathJax-Span-4293" style="font-size: 70.7%; font-family: MathJax_Math-italic;">m</span><span class="mi" id="MathJax-Span-4294" style="font-size: 70.7%; font-family: MathJax_Math-italic;">a</span><span class="mi" id="MathJax-Span-4295" style="font-size: 70.7%; font-family: MathJax_Math-italic;">g<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-4296" style="padding-left: 0.251em;"><span style="display: inline-block; position: relative; width: 1.182em; height: 0px;"><span style="position: absolute; clip: rect(3.229em, 1000.75em, 4.221em, -999.997em); top: -3.967em; left: 0em;"><span class="mo" id="MathJax-Span-4297" style="font-family: MathJax_Main;">+</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -4.339em; left: 0.81em;"><span class="mi" id="MathJax-Span-4298" style="font-size: 70.7%; font-family: MathJax_Math-italic;">b</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-4299" style="padding-left: 0.251em;"><span style="display: inline-block; position: relative; width: 1.864em; height: 0px;"><span style="position: absolute; clip: rect(3.105em, 1000.44em, 4.159em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-4300" style="font-family: MathJax_Math-italic;">b</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.437em;"><span class="texatom" id="MathJax-Span-4301"><span class="mrow" id="MathJax-Span-4302"><span class="mi" id="MathJax-Span-4303" style="font-size: 70.7%; font-family: MathJax_Math-italic;">m</span><span class="mi" id="MathJax-Span-4304" style="font-size: 70.7%; font-family: MathJax_Math-italic;">a</span><span class="mi" id="MathJax-Span-4305" style="font-size: 70.7%; font-family: MathJax_Math-italic;">g<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.36em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.458em; border-left: 0px solid; width: 0px; height: 1.619em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup><mi></mi><mi>b</mi></msup><msub><mi>m</mi><mi>m</mi></msub><msup><mo>=</mo><mi>b</mi></msup><msub><mi>R</mi><mi>w</mi></msub><msup><mo stretchy="false">(</mo><mi>w</mi></msup><msub><mi>m</mi><mi>r</mi></msub><mo stretchy="false">)</mo><msup><mo>+</mo><mi>b</mi></msup><msub><mi>e</mi><mrow class="MJX-TeXAtom-ORD"><mi>m</mi><mi>a</mi><mi>g</mi></mrow></msub><msup><mo>+</mo><mi>b</mi></msup><msub><mi>b</mi><mrow class="MJX-TeXAtom-ORD"><mi>m</mi><mi>a</mi><mi>g</mi></mrow></msub></math></span></span><script type="math/tex" id="MathJax-Element-87">^bm_m = ^bR_w(^wm_r) + ^be_{mag} + ^bb_{mag}</script>&nbsp; &nbsp; &nbsp;——————–&nbsp; &nbsp; &nbsp;(16)</p>
<p>where</p>
<p><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-88-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msup&gt;&lt;mi&gt;&lt;/mi&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;/msup&gt;&lt;msub&gt;&lt;mi&gt;m&lt;/mi&gt;&lt;mi&gt;m&lt;/mi&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-4306" style="width: 2.422em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.926em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(1.306em, 1001.93em, 2.733em, -999.997em); top: -2.354em; left: 0em;"><span class="mrow" id="MathJax-Span-4307"><span class="msubsup" id="MathJax-Span-4308"><span style="display: inline-block; position: relative; width: 0.375em; height: 0px;"><span style="position: absolute; clip: rect(3.787em, 1000em, 4.159em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-4309"></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -4.339em; left: 0em;"><span class="mi" id="MathJax-Span-4310" style="font-size: 70.7%; font-family: MathJax_Math-italic;">b</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-4311"><span style="display: inline-block; position: relative; width: 1.554em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.87em, 4.159em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-4312" style="font-family: MathJax_Math-italic;">m</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.872em;"><span class="mi" id="MathJax-Span-4313" style="font-size: 70.7%; font-family: MathJax_Math-italic;">m</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.36em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.304em; border-left: 0px solid; width: 0px; height: 1.388em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup><mi></mi><mi>b</mi></msup><msub><mi>m</mi><mi>m</mi></msub></math></span></span><script type="math/tex" id="MathJax-Element-88">^bm_m</script> is the measured magnetic field in the body frame by the magnetometer<br>
<span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-89-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msup&gt;&lt;mi&gt;&lt;/mi&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;/msup&gt;&lt;msub&gt;&lt;mi&gt;R&lt;/mi&gt;&lt;mi&gt;w&lt;/mi&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-4314" style="width: 2.174em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.74em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(1.306em, 1001.74em, 2.733em, -999.997em); top: -2.354em; left: 0em;"><span class="mrow" id="MathJax-Span-4315"><span class="msubsup" id="MathJax-Span-4316"><span style="display: inline-block; position: relative; width: 0.375em; height: 0px;"><span style="position: absolute; clip: rect(3.787em, 1000em, 4.159em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-4317"></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -4.339em; left: 0em;"><span class="mi" id="MathJax-Span-4318" style="font-size: 70.7%; font-family: MathJax_Math-italic;">b</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-4319"><span style="display: inline-block; position: relative; width: 1.368em; height: 0px;"><span style="position: absolute; clip: rect(3.105em, 1000.75em, 4.159em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-4320" style="font-family: MathJax_Math-italic;">R</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.748em;"><span class="mi" id="MathJax-Span-4321" style="font-size: 70.7%; font-family: MathJax_Math-italic;">w</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.36em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.304em; border-left: 0px solid; width: 0px; height: 1.388em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup><mi></mi><mi>b</mi></msup><msub><mi>R</mi><mi>w</mi></msub></math></span></span><script type="math/tex" id="MathJax-Element-89">^bR_w</script> is the rotation matrix for world frame to body frame<br>
<span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-90-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msup&gt;&lt;mi&gt;&lt;/mi&gt;&lt;mi&gt;w&lt;/mi&gt;&lt;/msup&gt;&lt;msub&gt;&lt;mi&gt;m&lt;/mi&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-4322" style="width: 2.36em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.864em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(1.492em, 1001.86em, 2.733em, -999.997em); top: -2.354em; left: 0em;"><span class="mrow" id="MathJax-Span-4323"><span class="msubsup" id="MathJax-Span-4324"><span style="display: inline-block; position: relative; width: 0.561em; height: 0px;"><span style="position: absolute; clip: rect(3.787em, 1000em, 4.159em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-4325"></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -4.339em; left: 0em;"><span class="mi" id="MathJax-Span-4326" style="font-size: 70.7%; font-family: MathJax_Math-italic;">w</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-4327"><span style="display: inline-block; position: relative; width: 1.306em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.87em, 4.159em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-4328" style="font-family: MathJax_Math-italic;">m</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.872em;"><span class="mi" id="MathJax-Span-4329" style="font-size: 70.7%; font-family: MathJax_Math-italic;">r</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.36em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.304em; border-left: 0px solid; width: 0px; height: 1.158em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup><mi></mi><mi>w</mi></msup><msub><mi>m</mi><mi>r</mi></msub></math></span></span><script type="math/tex" id="MathJax-Element-90">^wm_r</script> is the reference magnetic North vector in the world frame, where in my case <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-91-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msup&gt;&lt;mi&gt;&lt;/mi&gt;&lt;mi&gt;w&lt;/mi&gt;&lt;/msup&gt;&lt;msub&gt;&lt;mi&gt;m&lt;/mi&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;msup&gt;&lt;mrow&gt;&lt;mo&gt;[&lt;/mo&gt;&lt;mtable rowspacing=&quot;4pt&quot; columnspacing=&quot;1em&quot;&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;/mtable&gt;&lt;mo&gt;]&lt;/mo&gt;&lt;/mrow&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;/msup&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-4330" style="width: 11.107em; display: inline-block;"><span style="display: inline-block; position: relative; width: 8.936em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(1.244em, 1008.94em, 2.795em, -999.997em); top: -2.354em; left: 0em;"><span class="mrow" id="MathJax-Span-4331"><span class="msubsup" id="MathJax-Span-4332"><span style="display: inline-block; position: relative; width: 0.561em; height: 0px;"><span style="position: absolute; clip: rect(3.787em, 1000em, 4.159em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-4333"></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -4.339em; left: 0em;"><span class="mi" id="MathJax-Span-4334" style="font-size: 70.7%; font-family: MathJax_Math-italic;">w</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-4335"><span style="display: inline-block; position: relative; width: 1.306em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.87em, 4.159em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-4336" style="font-family: MathJax_Math-italic;">m</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.872em;"><span class="mi" id="MathJax-Span-4337" style="font-size: 70.7%; font-family: MathJax_Math-italic;">r</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="mo" id="MathJax-Span-4338" style="font-family: MathJax_Main; padding-left: 0.251em;">=</span><span class="msubsup" id="MathJax-Span-4339" style="padding-left: 0.251em;"><span style="display: inline-block; position: relative; width: 5.772em; height: 0px;"><span style="position: absolute; clip: rect(3.043em, 1005.09em, 4.408em, -999.997em); top: -3.967em; left: 0em;"><span class="mrow" id="MathJax-Span-4340"><span class="mo" id="MathJax-Span-4341" style="font-family: MathJax_Main;">[</span><span class="mtable" id="MathJax-Span-4342" style="padding-right: 0.189em; padding-left: 0.189em;"><span style="display: inline-block; position: relative; width: 4.283em; height: 0px;"><span style="position: absolute; clip: rect(3.167em, 1000.44em, 4.221em, -999.997em); top: -3.967em; left: 0em;"><span style="display: inline-block; position: relative; width: 0.499em; height: 0px;"><span style="position: absolute; clip: rect(3.105em, 1000.44em, 4.159em, -999.997em); top: -3.905em; left: 50%; margin-left: -0.245em;"><span class="mtd" id="MathJax-Span-4343"><span class="mrow" id="MathJax-Span-4344"><span class="mn" id="MathJax-Span-4345" style="font-family: MathJax_Main;">0</span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.167em, 1001.18em, 4.283em, -999.997em); top: -3.967em; left: 1.492em;"><span style="display: inline-block; position: relative; width: 1.306em; height: 0px;"><span style="position: absolute; clip: rect(3.105em, 1001.18em, 4.221em, -999.997em); top: -3.905em; left: 50%; margin-left: -0.617em;"><span class="mtd" id="MathJax-Span-4346"><span class="mrow" id="MathJax-Span-4347"><span class="mo" id="MathJax-Span-4348" style="font-family: MathJax_Main;">−</span><span class="mn" id="MathJax-Span-4349" style="font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.167em, 1000.44em, 4.221em, -999.997em); top: -3.967em; left: 3.787em;"><span style="display: inline-block; position: relative; width: 0.499em; height: 0px;"><span style="position: absolute; clip: rect(3.105em, 1000.44em, 4.159em, -999.997em); top: -3.905em; left: 50%; margin-left: -0.245em;"><span class="mtd" id="MathJax-Span-4350"><span class="mrow" id="MathJax-Span-4351"><span class="mn" id="MathJax-Span-4352" style="font-family: MathJax_Main;">0</span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="mo" id="MathJax-Span-4353" style="font-family: MathJax_Main;">]</span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -4.463em; left: 5.214em;"><span class="mi" id="MathJax-Span-4354" style="font-size: 70.7%; font-family: MathJax_Math-italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.065em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.36em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.381em; border-left: 0px solid; width: 0px; height: 1.619em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup><mi></mi><mi>w</mi></msup><msub><mi>m</mi><mi>r</mi></msub><mo>=</mo><msup><mrow><mo>[</mo><mtable rowspacing="4pt" columnspacing="1em"><mtr><mtd><mn>0</mn></mtd><mtd><mo>−</mo><mn>1</mn></mtd><mtd><mn>0</mn></mtd></mtr></mtable><mo>]</mo></mrow><mi>T</mi></msup></math></span></span><script type="math/tex" id="MathJax-Element-91">^wm_r = \begin{bmatrix} 0 & -1 & 0 \end{bmatrix}^T</script><br>
<span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-92-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msup&gt;&lt;mi&gt;&lt;/mi&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;/msup&gt;&lt;msub&gt;&lt;mi&gt;e&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;m&lt;/mi&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mi&gt;g&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-4355" style="width: 2.795em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.236em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(1.306em, 1002.24em, 2.857em, -999.997em); top: -2.354em; left: 0em;"><span class="mrow" id="MathJax-Span-4356"><span class="msubsup" id="MathJax-Span-4357"><span style="display: inline-block; position: relative; width: 0.375em; height: 0px;"><span style="position: absolute; clip: rect(3.787em, 1000em, 4.159em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-4358"></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -4.339em; left: 0em;"><span class="mi" id="MathJax-Span-4359" style="font-size: 70.7%; font-family: MathJax_Math-italic;">b</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-4360"><span style="display: inline-block; position: relative; width: 1.864em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.44em, 4.159em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-4361" style="font-family: MathJax_Math-italic;">e</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.499em;"><span class="texatom" id="MathJax-Span-4362"><span class="mrow" id="MathJax-Span-4363"><span class="mi" id="MathJax-Span-4364" style="font-size: 70.7%; font-family: MathJax_Math-italic;">m</span><span class="mi" id="MathJax-Span-4365" style="font-size: 70.7%; font-family: MathJax_Math-italic;">a</span><span class="mi" id="MathJax-Span-4366" style="font-size: 70.7%; font-family: MathJax_Math-italic;">g<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.36em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.458em; border-left: 0px solid; width: 0px; height: 1.619em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup><mi></mi><mi>b</mi></msup><msub><mi>e</mi><mrow class="MJX-TeXAtom-ORD"><mi>m</mi><mi>a</mi><mi>g</mi></mrow></msub></math></span></span><script type="math/tex" id="MathJax-Element-92">^be_{mag}</script> is the magnetometer noise in the body frame<br>
<span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-93-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msup&gt;&lt;mi&gt;&lt;/mi&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;/msup&gt;&lt;msub&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;m&lt;/mi&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mi&gt;g&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-4367" style="width: 2.795em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.236em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(1.306em, 1002.24em, 2.857em, -999.997em); top: -2.354em; left: 0em;"><span class="mrow" id="MathJax-Span-4368"><span class="msubsup" id="MathJax-Span-4369"><span style="display: inline-block; position: relative; width: 0.375em; height: 0px;"><span style="position: absolute; clip: rect(3.787em, 1000em, 4.159em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-4370"></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -4.339em; left: 0em;"><span class="mi" id="MathJax-Span-4371" style="font-size: 70.7%; font-family: MathJax_Math-italic;">b</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-4372"><span style="display: inline-block; position: relative; width: 1.864em; height: 0px;"><span style="position: absolute; clip: rect(3.105em, 1000.44em, 4.159em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-4373" style="font-family: MathJax_Math-italic;">b</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.437em;"><span class="texatom" id="MathJax-Span-4374"><span class="mrow" id="MathJax-Span-4375"><span class="mi" id="MathJax-Span-4376" style="font-size: 70.7%; font-family: MathJax_Math-italic;">m</span><span class="mi" id="MathJax-Span-4377" style="font-size: 70.7%; font-family: MathJax_Math-italic;">a</span><span class="mi" id="MathJax-Span-4378" style="font-size: 70.7%; font-family: MathJax_Math-italic;">g<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.36em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.458em; border-left: 0px solid; width: 0px; height: 1.619em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup><mi></mi><mi>b</mi></msup><msub><mi>b</mi><mrow class="MJX-TeXAtom-ORD"><mi>m</mi><mi>a</mi><mi>g</mi></mrow></msub></math></span></span><script type="math/tex" id="MathJax-Element-93">^bb_{mag}</script> is the magnetometer bias in the body frame</p>
<p>The rotation matrix <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-94-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msup&gt;&lt;mi&gt;&lt;/mi&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;/msup&gt;&lt;msub&gt;&lt;mi&gt;R&lt;/mi&gt;&lt;mi&gt;w&lt;/mi&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-4379" style="width: 2.174em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.74em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(1.306em, 1001.74em, 2.733em, -999.997em); top: -2.354em; left: 0em;"><span class="mrow" id="MathJax-Span-4380"><span class="msubsup" id="MathJax-Span-4381"><span style="display: inline-block; position: relative; width: 0.375em; height: 0px;"><span style="position: absolute; clip: rect(3.787em, 1000em, 4.159em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-4382"></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -4.339em; left: 0em;"><span class="mi" id="MathJax-Span-4383" style="font-size: 70.7%; font-family: MathJax_Math-italic;">b</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-4384"><span style="display: inline-block; position: relative; width: 1.368em; height: 0px;"><span style="position: absolute; clip: rect(3.105em, 1000.75em, 4.159em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-4385" style="font-family: MathJax_Math-italic;">R</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.748em;"><span class="mi" id="MathJax-Span-4386" style="font-size: 70.7%; font-family: MathJax_Math-italic;">w</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.36em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.304em; border-left: 0px solid; width: 0px; height: 1.388em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup><mi></mi><mi>b</mi></msup><msub><mi>R</mi><mi>w</mi></msub></math></span></span><script type="math/tex" id="MathJax-Element-94">^bR_w</script> is actually the same matrix as what was used in the accelerometer. Below is the exact same equation (9).</p>
<p><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-95-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msup&gt;&lt;mi&gt;&lt;/mi&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;/msup&gt;&lt;msub&gt;&lt;mi&gt;R&lt;/mi&gt;&lt;mi&gt;w&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mrow&gt;&lt;mo&gt;[&lt;/mo&gt;&lt;mtable rowspacing=&quot;4pt&quot; columnspacing=&quot;1em&quot;&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;msubsup&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msubsup&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;msubsup&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msubsup&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;msubsup&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msubsup&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;msubsup&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mn&gt;3&lt;/mn&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msubsup&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;msub&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msub&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/msub&gt;&lt;msub&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mn&gt;3&lt;/mn&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;msub&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mn&gt;3&lt;/mn&gt;&lt;/msub&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/msub&gt;&lt;msub&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;msub&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msub&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/msub&gt;&lt;msub&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mn&gt;3&lt;/mn&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;msubsup&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msubsup&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;msubsup&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msubsup&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;msubsup&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msubsup&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;msubsup&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mn&gt;3&lt;/mn&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msubsup&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msub&gt;&lt;msub&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mn&gt;3&lt;/mn&gt;&lt;/msub&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/msub&gt;&lt;msub&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;msub&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mn&gt;3&lt;/mn&gt;&lt;/msub&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/msub&gt;&lt;msub&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msub&gt;&lt;msub&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mn&gt;3&lt;/mn&gt;&lt;/msub&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/msub&gt;&lt;msub&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;msubsup&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msubsup&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;msubsup&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msubsup&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;msubsup&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msubsup&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;msubsup&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mn&gt;3&lt;/mn&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msubsup&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;/mtable&gt;&lt;mo&gt;]&lt;/mo&gt;&lt;/mrow&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-4387" style="width: 36.728em; display: inline-block;"><span style="display: inline-block; position: relative; width: 29.594em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(2.174em, 1029.28em, 6.765em, -999.997em); top: -4.712em; left: 0em;"><span class="mrow" id="MathJax-Span-4388"><span class="msubsup" id="MathJax-Span-4389"><span style="display: inline-block; position: relative; width: 0.375em; height: 0px;"><span style="position: absolute; clip: rect(3.787em, 1000em, 4.159em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-4390"></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -4.339em; left: 0em;"><span class="mi" id="MathJax-Span-4391" style="font-size: 70.7%; font-family: MathJax_Math-italic;">b</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-4392"><span style="display: inline-block; position: relative; width: 1.368em; height: 0px;"><span style="position: absolute; clip: rect(3.105em, 1000.75em, 4.159em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-4393" style="font-family: MathJax_Math-italic;">R</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.748em;"><span class="mi" id="MathJax-Span-4394" style="font-size: 70.7%; font-family: MathJax_Math-italic;">w</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="mo" id="MathJax-Span-4395" style="font-family: MathJax_Main; padding-left: 0.251em;">=</span><span class="mrow" id="MathJax-Span-4396" style="padding-left: 0.251em;"><span class="mo" id="MathJax-Span-4397" style="vertical-align: 2.36em;"><span style="display: inline-block; position: relative; width: 0.685em; height: 0px;"><span style="position: absolute; font-family: MathJax_Size4; top: -2.788em; left: 0em;">⎡<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; font-family: MathJax_Size4; top: -0.369em; left: 0em;">⎣<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -1.734em; left: 0em;">⎢<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -1.362em; left: 0em;">⎢<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="mtable" id="MathJax-Span-4398" style="padding-right: 0.189em; padding-left: 0.189em;"><span style="display: inline-block; position: relative; width: 24.817em; height: 0px;"><span style="position: absolute; clip: rect(2.609em, 1007.63em, 7.137em, -999.997em); top: -5.146em; left: 0em;"><span style="display: inline-block; position: relative; width: 7.633em; height: 0px;"><span style="position: absolute; clip: rect(2.981em, 1007.63em, 4.47em, -999.997em); top: -5.518em; left: 50%; margin-left: -3.781em;"><span class="mtd" id="MathJax-Span-4399"><span class="mrow" id="MathJax-Span-4400"><span class="msubsup" id="MathJax-Span-4401"><span style="display: inline-block; position: relative; width: 0.934em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.44em, 4.346em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-4402" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.291em, 1000.44em, 4.159em, -999.997em); top: -4.339em; left: 0.499em;"><span class="mn" id="MathJax-Span-4403" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.291em, 1000.44em, 4.159em, -999.997em); top: -3.657em; left: 0.437em;"><span class="mn" id="MathJax-Span-4404" style="font-size: 70.7%; font-family: MathJax_Main;">0</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="mo" id="MathJax-Span-4405" style="font-family: MathJax_Main; padding-left: 0.251em;">+</span><span class="msubsup" id="MathJax-Span-4406" style="padding-left: 0.251em;"><span style="display: inline-block; position: relative; width: 0.934em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.44em, 4.346em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-4407" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.291em, 1000.44em, 4.159em, -999.997em); top: -4.339em; left: 0.499em;"><span class="mn" id="MathJax-Span-4408" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.291em, 1000.44em, 4.159em, -999.997em); top: -3.657em; left: 0.437em;"><span class="mn" id="MathJax-Span-4409" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="mo" id="MathJax-Span-4410" style="font-family: MathJax_Main; padding-left: 0.251em;">−</span><span class="msubsup" id="MathJax-Span-4411" style="padding-left: 0.251em;"><span style="display: inline-block; position: relative; width: 0.934em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.44em, 4.346em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-4412" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.291em, 1000.44em, 4.159em, -999.997em); top: -4.339em; left: 0.499em;"><span class="mn" id="MathJax-Span-4413" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.291em, 1000.44em, 4.159em, -999.997em); top: -3.657em; left: 0.437em;"><span class="mn" id="MathJax-Span-4414" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="mo" id="MathJax-Span-4415" style="font-family: MathJax_Main; padding-left: 0.251em;">−</span><span class="msubsup" id="MathJax-Span-4416" style="padding-left: 0.251em;"><span style="display: inline-block; position: relative; width: 0.934em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.44em, 4.346em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-4417" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.291em, 1000.44em, 4.159em, -999.997em); top: -4.339em; left: 0.499em;"><span class="mn" id="MathJax-Span-4418" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.291em, 1000.44em, 4.159em, -999.997em); top: -3.657em; left: 0.437em;"><span class="mn" id="MathJax-Span-4419" style="font-size: 70.7%; font-family: MathJax_Main;">3</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.043em, 1005.96em, 4.408em, -999.997em); top: -3.967em; left: 50%; margin-left: -3.037em;"><span class="mtd" id="MathJax-Span-4456"><span class="mrow" id="MathJax-Span-4457"><span class="mn" id="MathJax-Span-4458" style="font-family: MathJax_Main;">2</span><span class="mo" id="MathJax-Span-4459" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-4460"><span style="display: inline-block; position: relative; width: 0.872em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.44em, 4.346em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-4461" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.437em;"><span class="mn" id="MathJax-Span-4462" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-4463"><span style="display: inline-block; position: relative; width: 0.872em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.44em, 4.346em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-4464" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.437em;"><span class="mn" id="MathJax-Span-4465" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="mo" id="MathJax-Span-4466" style="font-family: MathJax_Main; padding-left: 0.251em;">−</span><span class="msubsup" id="MathJax-Span-4467" style="padding-left: 0.251em;"><span style="display: inline-block; position: relative; width: 0.872em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.44em, 4.346em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-4468" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.437em;"><span class="mn" id="MathJax-Span-4469" style="font-size: 70.7%; font-family: MathJax_Main;">0</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-4470"><span style="display: inline-block; position: relative; width: 0.872em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.44em, 4.346em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-4471" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.437em;"><span class="mn" id="MathJax-Span-4472" style="font-size: 70.7%; font-family: MathJax_Main;">3</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="mo" id="MathJax-Span-4473" style="font-family: MathJax_Main;">)</span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.043em, 1005.96em, 4.408em, -999.997em); top: -2.416em; left: 50%; margin-left: -3.037em;"><span class="mtd" id="MathJax-Span-4513"><span class="mrow" id="MathJax-Span-4514"><span class="mn" id="MathJax-Span-4515" style="font-family: MathJax_Main;">2</span><span class="mo" id="MathJax-Span-4516" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-4517"><span style="display: inline-block; position: relative; width: 0.872em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.44em, 4.346em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-4518" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.437em;"><span class="mn" id="MathJax-Span-4519" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-4520"><span style="display: inline-block; position: relative; width: 0.872em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.44em, 4.346em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-4521" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.437em;"><span class="mn" id="MathJax-Span-4522" style="font-size: 70.7%; font-family: MathJax_Main;">3</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="mo" id="MathJax-Span-4523" style="font-family: MathJax_Main; padding-left: 0.251em;">+</span><span class="msubsup" id="MathJax-Span-4524" style="padding-left: 0.251em;"><span style="display: inline-block; position: relative; width: 0.872em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.44em, 4.346em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-4525" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.437em;"><span class="mn" id="MathJax-Span-4526" style="font-size: 70.7%; font-family: MathJax_Main;">0</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-4527"><span style="display: inline-block; position: relative; width: 0.872em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.44em, 4.346em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-4528" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.437em;"><span class="mn" id="MathJax-Span-4529" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="mo" id="MathJax-Span-4530" style="font-family: MathJax_Main;">)</span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span><span style="display: inline-block; width: 0px; height: 5.152em;"></span></span><span style="position: absolute; clip: rect(2.609em, 1007.63em, 7.075em, -999.997em); top: -5.084em; left: 8.626em;"><span style="display: inline-block; position: relative; width: 7.633em; height: 0px;"><span style="position: absolute; clip: rect(3.043em, 1005.96em, 4.408em, -999.997em); top: -5.518em; left: 50%; margin-left: -3.037em;"><span class="mtd" id="MathJax-Span-4420"><span class="mrow" id="MathJax-Span-4421"><span class="mn" id="MathJax-Span-4422" style="font-family: MathJax_Main;">2</span><span class="mo" id="MathJax-Span-4423" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-4424"><span style="display: inline-block; position: relative; width: 0.872em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.44em, 4.346em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-4425" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.437em;"><span class="mn" id="MathJax-Span-4426" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-4427"><span style="display: inline-block; position: relative; width: 0.872em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.44em, 4.346em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-4428" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.437em;"><span class="mn" id="MathJax-Span-4429" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="mo" id="MathJax-Span-4430" style="font-family: MathJax_Main; padding-left: 0.251em;">+</span><span class="msubsup" id="MathJax-Span-4431" style="padding-left: 0.251em;"><span style="display: inline-block; position: relative; width: 0.872em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.44em, 4.346em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-4432" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.437em;"><span class="mn" id="MathJax-Span-4433" style="font-size: 70.7%; font-family: MathJax_Main;">0</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-4434"><span style="display: inline-block; position: relative; width: 0.872em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.44em, 4.346em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-4435" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.437em;"><span class="mn" id="MathJax-Span-4436" style="font-size: 70.7%; font-family: MathJax_Main;">3</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="mo" id="MathJax-Span-4437" style="font-family: MathJax_Main;">)</span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(2.981em, 1007.63em, 4.47em, -999.997em); top: -3.967em; left: 50%; margin-left: -3.781em;"><span class="mtd" id="MathJax-Span-4474"><span class="mrow" id="MathJax-Span-4475"><span class="msubsup" id="MathJax-Span-4476"><span style="display: inline-block; position: relative; width: 0.934em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.44em, 4.346em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-4477" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.291em, 1000.44em, 4.159em, -999.997em); top: -4.339em; left: 0.499em;"><span class="mn" id="MathJax-Span-4478" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.291em, 1000.44em, 4.159em, -999.997em); top: -3.657em; left: 0.437em;"><span class="mn" id="MathJax-Span-4479" style="font-size: 70.7%; font-family: MathJax_Main;">0</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="mo" id="MathJax-Span-4480" style="font-family: MathJax_Main; padding-left: 0.251em;">−</span><span class="msubsup" id="MathJax-Span-4481" style="padding-left: 0.251em;"><span style="display: inline-block; position: relative; width: 0.934em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.44em, 4.346em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-4482" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.291em, 1000.44em, 4.159em, -999.997em); top: -4.339em; left: 0.499em;"><span class="mn" id="MathJax-Span-4483" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.291em, 1000.44em, 4.159em, -999.997em); top: -3.657em; left: 0.437em;"><span class="mn" id="MathJax-Span-4484" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="mo" id="MathJax-Span-4485" style="font-family: MathJax_Main; padding-left: 0.251em;">+</span><span class="msubsup" id="MathJax-Span-4486" style="padding-left: 0.251em;"><span style="display: inline-block; position: relative; width: 0.934em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.44em, 4.346em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-4487" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.291em, 1000.44em, 4.159em, -999.997em); top: -4.339em; left: 0.499em;"><span class="mn" id="MathJax-Span-4488" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.291em, 1000.44em, 4.159em, -999.997em); top: -3.657em; left: 0.437em;"><span class="mn" id="MathJax-Span-4489" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="mo" id="MathJax-Span-4490" style="font-family: MathJax_Main; padding-left: 0.251em;">−</span><span class="msubsup" id="MathJax-Span-4491" style="padding-left: 0.251em;"><span style="display: inline-block; position: relative; width: 0.934em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.44em, 4.346em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-4492" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.291em, 1000.44em, 4.159em, -999.997em); top: -4.339em; left: 0.499em;"><span class="mn" id="MathJax-Span-4493" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.291em, 1000.44em, 4.159em, -999.997em); top: -3.657em; left: 0.437em;"><span class="mn" id="MathJax-Span-4494" style="font-size: 70.7%; font-family: MathJax_Main;">3</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.043em, 1005.96em, 4.408em, -999.997em); top: -2.416em; left: 50%; margin-left: -3.037em;"><span class="mtd" id="MathJax-Span-4531"><span class="mrow" id="MathJax-Span-4532"><span class="mn" id="MathJax-Span-4533" style="font-family: MathJax_Main;">2</span><span class="mo" id="MathJax-Span-4534" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-4535"><span style="display: inline-block; position: relative; width: 0.872em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.44em, 4.346em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-4536" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.437em;"><span class="mn" id="MathJax-Span-4537" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-4538"><span style="display: inline-block; position: relative; width: 0.872em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.44em, 4.346em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-4539" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.437em;"><span class="mn" id="MathJax-Span-4540" style="font-size: 70.7%; font-family: MathJax_Main;">3</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="mo" id="MathJax-Span-4541" style="font-family: MathJax_Main; padding-left: 0.251em;">−</span><span class="msubsup" id="MathJax-Span-4542" style="padding-left: 0.251em;"><span style="display: inline-block; position: relative; width: 0.872em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.44em, 4.346em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-4543" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.437em;"><span class="mn" id="MathJax-Span-4544" style="font-size: 70.7%; font-family: MathJax_Main;">0</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-4545"><span style="display: inline-block; position: relative; width: 0.872em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.44em, 4.346em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-4546" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.437em;"><span class="mn" id="MathJax-Span-4547" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="mo" id="MathJax-Span-4548" style="font-family: MathJax_Main;">)</span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span><span style="display: inline-block; width: 0px; height: 5.09em;"></span></span><span style="position: absolute; clip: rect(2.671em, 1007.63em, 7.199em, -999.997em); top: -5.146em; left: 17.249em;"><span style="display: inline-block; position: relative; width: 7.633em; height: 0px;"><span style="position: absolute; clip: rect(3.043em, 1005.96em, 4.408em, -999.997em); top: -5.518em; left: 50%; margin-left: -3.037em;"><span class="mtd" id="MathJax-Span-4438"><span class="mrow" id="MathJax-Span-4439"><span class="mn" id="MathJax-Span-4440" style="font-family: MathJax_Main;">2</span><span class="mo" id="MathJax-Span-4441" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-4442"><span style="display: inline-block; position: relative; width: 0.872em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.44em, 4.346em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-4443" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.437em;"><span class="mn" id="MathJax-Span-4444" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-4445"><span style="display: inline-block; position: relative; width: 0.872em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.44em, 4.346em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-4446" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.437em;"><span class="mn" id="MathJax-Span-4447" style="font-size: 70.7%; font-family: MathJax_Main;">3</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="mo" id="MathJax-Span-4448" style="font-family: MathJax_Main; padding-left: 0.251em;">−</span><span class="msubsup" id="MathJax-Span-4449" style="padding-left: 0.251em;"><span style="display: inline-block; position: relative; width: 0.872em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.44em, 4.346em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-4450" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.437em;"><span class="mn" id="MathJax-Span-4451" style="font-size: 70.7%; font-family: MathJax_Main;">0</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-4452"><span style="display: inline-block; position: relative; width: 0.872em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.44em, 4.346em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-4453" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.437em;"><span class="mn" id="MathJax-Span-4454" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="mo" id="MathJax-Span-4455" style="font-family: MathJax_Main;">)</span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.043em, 1005.96em, 4.408em, -999.997em); top: -3.967em; left: 50%; margin-left: -3.037em;"><span class="mtd" id="MathJax-Span-4495"><span class="mrow" id="MathJax-Span-4496"><span class="mn" id="MathJax-Span-4497" style="font-family: MathJax_Main;">2</span><span class="mo" id="MathJax-Span-4498" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-4499"><span style="display: inline-block; position: relative; width: 0.872em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.44em, 4.346em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-4500" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.437em;"><span class="mn" id="MathJax-Span-4501" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-4502"><span style="display: inline-block; position: relative; width: 0.872em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.44em, 4.346em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-4503" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.437em;"><span class="mn" id="MathJax-Span-4504" style="font-size: 70.7%; font-family: MathJax_Main;">3</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="mo" id="MathJax-Span-4505" style="font-family: MathJax_Main; padding-left: 0.251em;">+</span><span class="msubsup" id="MathJax-Span-4506" style="padding-left: 0.251em;"><span style="display: inline-block; position: relative; width: 0.872em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.44em, 4.346em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-4507" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.437em;"><span class="mn" id="MathJax-Span-4508" style="font-size: 70.7%; font-family: MathJax_Main;">0</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-4509"><span style="display: inline-block; position: relative; width: 0.872em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.44em, 4.346em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-4510" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.437em;"><span class="mn" id="MathJax-Span-4511" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="mo" id="MathJax-Span-4512" style="font-family: MathJax_Main;">)</span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(2.981em, 1007.63em, 4.47em, -999.997em); top: -2.416em; left: 50%; margin-left: -3.781em;"><span class="mtd" id="MathJax-Span-4549"><span class="mrow" id="MathJax-Span-4550"><span class="msubsup" id="MathJax-Span-4551"><span style="display: inline-block; position: relative; width: 0.934em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.44em, 4.346em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-4552" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.291em, 1000.44em, 4.159em, -999.997em); top: -4.339em; left: 0.499em;"><span class="mn" id="MathJax-Span-4553" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.291em, 1000.44em, 4.159em, -999.997em); top: -3.657em; left: 0.437em;"><span class="mn" id="MathJax-Span-4554" style="font-size: 70.7%; font-family: MathJax_Main;">0</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="mo" id="MathJax-Span-4555" style="font-family: MathJax_Main; padding-left: 0.251em;">−</span><span class="msubsup" id="MathJax-Span-4556" style="padding-left: 0.251em;"><span style="display: inline-block; position: relative; width: 0.934em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.44em, 4.346em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-4557" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.291em, 1000.44em, 4.159em, -999.997em); top: -4.339em; left: 0.499em;"><span class="mn" id="MathJax-Span-4558" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.291em, 1000.44em, 4.159em, -999.997em); top: -3.657em; left: 0.437em;"><span class="mn" id="MathJax-Span-4559" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="mo" id="MathJax-Span-4560" style="font-family: MathJax_Main; padding-left: 0.251em;">−</span><span class="msubsup" id="MathJax-Span-4561" style="padding-left: 0.251em;"><span style="display: inline-block; position: relative; width: 0.934em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.44em, 4.346em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-4562" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.291em, 1000.44em, 4.159em, -999.997em); top: -4.339em; left: 0.499em;"><span class="mn" id="MathJax-Span-4563" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.291em, 1000.44em, 4.159em, -999.997em); top: -3.657em; left: 0.437em;"><span class="mn" id="MathJax-Span-4564" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="mo" id="MathJax-Span-4565" style="font-family: MathJax_Main; padding-left: 0.251em;">+</span><span class="msubsup" id="MathJax-Span-4566" style="padding-left: 0.251em;"><span style="display: inline-block; position: relative; width: 0.934em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.44em, 4.346em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-4567" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.291em, 1000.44em, 4.159em, -999.997em); top: -4.339em; left: 0.499em;"><span class="mn" id="MathJax-Span-4568" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.291em, 1000.44em, 4.159em, -999.997em); top: -3.657em; left: 0.437em;"><span class="mn" id="MathJax-Span-4569" style="font-size: 70.7%; font-family: MathJax_Main;">3</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span><span style="display: inline-block; width: 0px; height: 5.152em;"></span></span></span></span><span class="mo" id="MathJax-Span-4570" style="vertical-align: 2.36em;"><span style="display: inline-block; position: relative; width: 0.685em; height: 0px;"><span style="position: absolute; font-family: MathJax_Size4; top: -2.788em; left: 0em;">⎤<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; font-family: MathJax_Size4; top: -0.369em; left: 0em;">⎦<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -1.734em; left: 0em;">⎥<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -1.362em; left: 0em;">⎥<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.718em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -2.381em; border-left: 0px solid; width: 0px; height: 5.388em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup><mi></mi><mi>b</mi></msup><msub><mi>R</mi><mi>w</mi></msub><mo>=</mo><mrow><mo>[</mo><mtable rowspacing="4pt" columnspacing="1em"><mtr><mtd><msubsup><mi>q</mi><mn>0</mn><mn>2</mn></msubsup><mo>+</mo><msubsup><mi>q</mi><mn>1</mn><mn>2</mn></msubsup><mo>−</mo><msubsup><mi>q</mi><mn>2</mn><mn>2</mn></msubsup><mo>−</mo><msubsup><mi>q</mi><mn>3</mn><mn>2</mn></msubsup></mtd><mtd><mn>2</mn><mo stretchy="false">(</mo><msub><mi>q</mi><mn>1</mn></msub><msub><mi>q</mi><mn>2</mn></msub><mo>+</mo><msub><mi>q</mi><mn>0</mn></msub><msub><mi>q</mi><mn>3</mn></msub><mo stretchy="false">)</mo></mtd><mtd><mn>2</mn><mo stretchy="false">(</mo><msub><mi>q</mi><mn>1</mn></msub><msub><mi>q</mi><mn>3</mn></msub><mo>−</mo><msub><mi>q</mi><mn>0</mn></msub><msub><mi>q</mi><mn>2</mn></msub><mo stretchy="false">)</mo></mtd></mtr><mtr><mtd><mn>2</mn><mo stretchy="false">(</mo><msub><mi>q</mi><mn>1</mn></msub><msub><mi>q</mi><mn>2</mn></msub><mo>−</mo><msub><mi>q</mi><mn>0</mn></msub><msub><mi>q</mi><mn>3</mn></msub><mo stretchy="false">)</mo></mtd><mtd><msubsup><mi>q</mi><mn>0</mn><mn>2</mn></msubsup><mo>−</mo><msubsup><mi>q</mi><mn>1</mn><mn>2</mn></msubsup><mo>+</mo><msubsup><mi>q</mi><mn>2</mn><mn>2</mn></msubsup><mo>−</mo><msubsup><mi>q</mi><mn>3</mn><mn>2</mn></msubsup></mtd><mtd><mn>2</mn><mo stretchy="false">(</mo><msub><mi>q</mi><mn>2</mn></msub><msub><mi>q</mi><mn>3</mn></msub><mo>+</mo><msub><mi>q</mi><mn>0</mn></msub><msub><mi>q</mi><mn>1</mn></msub><mo stretchy="false">)</mo></mtd></mtr><mtr><mtd><mn>2</mn><mo stretchy="false">(</mo><msub><mi>q</mi><mn>1</mn></msub><msub><mi>q</mi><mn>3</mn></msub><mo>+</mo><msub><mi>q</mi><mn>0</mn></msub><msub><mi>q</mi><mn>2</mn></msub><mo stretchy="false">)</mo></mtd><mtd><mn>2</mn><mo stretchy="false">(</mo><msub><mi>q</mi><mn>2</mn></msub><msub><mi>q</mi><mn>3</mn></msub><mo>−</mo><msub><mi>q</mi><mn>0</mn></msub><msub><mi>q</mi><mn>1</mn></msub><mo stretchy="false">)</mo></mtd><mtd><msubsup><mi>q</mi><mn>0</mn><mn>2</mn></msubsup><mo>−</mo><msubsup><mi>q</mi><mn>1</mn><mn>2</mn></msubsup><mo>−</mo><msubsup><mi>q</mi><mn>2</mn><mn>2</mn></msubsup><mo>+</mo><msubsup><mi>q</mi><mn>3</mn><mn>2</mn></msubsup></mtd></mtr></mtable><mo>]</mo></mrow></math></span></span><script type="math/tex" id="MathJax-Element-95">^bR_w = \begin{bmatrix} q_0^2+q_1^2-q_2^2-q_3^2 & 2(q_1q_2+q_0q_3) & 2(q_1q_3-q_0q_2) \\ 2(q_1q_2-q_0q_3) & q_0^2-q_1^2+q_2^2-q_3^2 & 2(q_2q_3+q_0q_1) \\ 2(q_1q_3+q_0q_2) & 2(q_2q_3-q_0q_1) & q_0^2-q_1^2-q_2^2+q_3^2 \end{bmatrix}</script>&nbsp; &nbsp; &nbsp;——————–&nbsp; &nbsp; &nbsp;(9)</p>
<p>Since we know that <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-96-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msup&gt;&lt;mi&gt;&lt;/mi&gt;&lt;mi&gt;w&lt;/mi&gt;&lt;/msup&gt;&lt;msub&gt;&lt;mi&gt;m&lt;/mi&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;msup&gt;&lt;mrow&gt;&lt;mo&gt;[&lt;/mo&gt;&lt;mtable rowspacing=&quot;4pt&quot; columnspacing=&quot;1em&quot;&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;/mtable&gt;&lt;mo&gt;]&lt;/mo&gt;&lt;/mrow&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;/msup&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-4571" style="width: 11.107em; display: inline-block;"><span style="display: inline-block; position: relative; width: 8.936em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(1.244em, 1008.94em, 2.795em, -999.997em); top: -2.354em; left: 0em;"><span class="mrow" id="MathJax-Span-4572"><span class="msubsup" id="MathJax-Span-4573"><span style="display: inline-block; position: relative; width: 0.561em; height: 0px;"><span style="position: absolute; clip: rect(3.787em, 1000em, 4.159em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-4574"></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -4.339em; left: 0em;"><span class="mi" id="MathJax-Span-4575" style="font-size: 70.7%; font-family: MathJax_Math-italic;">w</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-4576"><span style="display: inline-block; position: relative; width: 1.306em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.87em, 4.159em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-4577" style="font-family: MathJax_Math-italic;">m</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.872em;"><span class="mi" id="MathJax-Span-4578" style="font-size: 70.7%; font-family: MathJax_Math-italic;">r</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="mo" id="MathJax-Span-4579" style="font-family: MathJax_Main; padding-left: 0.251em;">=</span><span class="msubsup" id="MathJax-Span-4580" style="padding-left: 0.251em;"><span style="display: inline-block; position: relative; width: 5.772em; height: 0px;"><span style="position: absolute; clip: rect(3.043em, 1005.09em, 4.408em, -999.997em); top: -3.967em; left: 0em;"><span class="mrow" id="MathJax-Span-4581"><span class="mo" id="MathJax-Span-4582" style="font-family: MathJax_Main;">[</span><span class="mtable" id="MathJax-Span-4583" style="padding-right: 0.189em; padding-left: 0.189em;"><span style="display: inline-block; position: relative; width: 4.283em; height: 0px;"><span style="position: absolute; clip: rect(3.167em, 1000.44em, 4.221em, -999.997em); top: -3.967em; left: 0em;"><span style="display: inline-block; position: relative; width: 0.499em; height: 0px;"><span style="position: absolute; clip: rect(3.105em, 1000.44em, 4.159em, -999.997em); top: -3.905em; left: 50%; margin-left: -0.245em;"><span class="mtd" id="MathJax-Span-4584"><span class="mrow" id="MathJax-Span-4585"><span class="mn" id="MathJax-Span-4586" style="font-family: MathJax_Main;">0</span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.167em, 1001.18em, 4.283em, -999.997em); top: -3.967em; left: 1.492em;"><span style="display: inline-block; position: relative; width: 1.306em; height: 0px;"><span style="position: absolute; clip: rect(3.105em, 1001.18em, 4.221em, -999.997em); top: -3.905em; left: 50%; margin-left: -0.617em;"><span class="mtd" id="MathJax-Span-4587"><span class="mrow" id="MathJax-Span-4588"><span class="mo" id="MathJax-Span-4589" style="font-family: MathJax_Main;">−</span><span class="mn" id="MathJax-Span-4590" style="font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.167em, 1000.44em, 4.221em, -999.997em); top: -3.967em; left: 3.787em;"><span style="display: inline-block; position: relative; width: 0.499em; height: 0px;"><span style="position: absolute; clip: rect(3.105em, 1000.44em, 4.159em, -999.997em); top: -3.905em; left: 50%; margin-left: -0.245em;"><span class="mtd" id="MathJax-Span-4591"><span class="mrow" id="MathJax-Span-4592"><span class="mn" id="MathJax-Span-4593" style="font-family: MathJax_Main;">0</span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="mo" id="MathJax-Span-4594" style="font-family: MathJax_Main;">]</span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -4.463em; left: 5.214em;"><span class="mi" id="MathJax-Span-4595" style="font-size: 70.7%; font-family: MathJax_Math-italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.065em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.36em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.381em; border-left: 0px solid; width: 0px; height: 1.619em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup><mi></mi><mi>w</mi></msup><msub><mi>m</mi><mi>r</mi></msub><mo>=</mo><msup><mrow><mo>[</mo><mtable rowspacing="4pt" columnspacing="1em"><mtr><mtd><mn>0</mn></mtd><mtd><mo>−</mo><mn>1</mn></mtd><mtd><mn>0</mn></mtd></mtr></mtable><mo>]</mo></mrow><mi>T</mi></msup></math></span></span><script type="math/tex" id="MathJax-Element-96">^wm_r = \begin{bmatrix} 0 & -1 & 0 \end{bmatrix}^T</script>, we can substitute equation (9) into equation (16) and then simplify equation (16) to get the following equation.</p>
<p><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-97-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mrow&gt;&lt;mo&gt;[&lt;/mo&gt;&lt;mtable rowspacing=&quot;4pt&quot; columnspacing=&quot;1em&quot;&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;msup&gt;&lt;mi&gt;&lt;/mi&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;/msup&gt;&lt;msub&gt;&lt;mi&gt;m&lt;/mi&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;msup&gt;&lt;mi&gt;&lt;/mi&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;/msup&gt;&lt;msub&gt;&lt;mi&gt;m&lt;/mi&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;msup&gt;&lt;mi&gt;&lt;/mi&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;/msup&gt;&lt;msub&gt;&lt;mi&gt;m&lt;/mi&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;/mtable&gt;&lt;mo&gt;]&lt;/mo&gt;&lt;/mrow&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mrow&gt;&lt;mo&gt;[&lt;/mo&gt;&lt;mtable rowspacing=&quot;4pt&quot; columnspacing=&quot;1em&quot;&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;msub&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msub&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/msub&gt;&lt;msub&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mn&gt;3&lt;/mn&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;msubsup&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msubsup&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;msubsup&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msubsup&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;msubsup&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msubsup&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;msubsup&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mn&gt;3&lt;/mn&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msubsup&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msub&gt;&lt;msub&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mn&gt;3&lt;/mn&gt;&lt;/msub&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/msub&gt;&lt;msub&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;/mtable&gt;&lt;mo&gt;]&lt;/mo&gt;&lt;/mrow&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mrow&gt;&lt;mo&gt;[&lt;/mo&gt;&lt;mtable rowspacing=&quot;4pt&quot; columnspacing=&quot;1em&quot;&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;msup&gt;&lt;mi&gt;&lt;/mi&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;/msup&gt;&lt;msub&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;msup&gt;&lt;mi&gt;&lt;/mi&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;/msup&gt;&lt;msub&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;msup&gt;&lt;mi&gt;&lt;/mi&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;/msup&gt;&lt;msub&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;/mtable&gt;&lt;mo&gt;]&lt;/mo&gt;&lt;/mrow&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mrow&gt;&lt;mo&gt;[&lt;/mo&gt;&lt;mtable rowspacing=&quot;4pt&quot; columnspacing=&quot;1em&quot;&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;msup&gt;&lt;mi&gt;&lt;/mi&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;/msup&gt;&lt;msub&gt;&lt;mi&gt;e&lt;/mi&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;msup&gt;&lt;mi&gt;&lt;/mi&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;/msup&gt;&lt;msub&gt;&lt;mi&gt;e&lt;/mi&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;msup&gt;&lt;mi&gt;&lt;/mi&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;/msup&gt;&lt;msub&gt;&lt;mi&gt;e&lt;/mi&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;/mtable&gt;&lt;mo&gt;]&lt;/mo&gt;&lt;/mrow&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-4596" style="width: 29.532em; display: inline-block;"><span style="display: inline-block; position: relative; width: 23.824em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(2.174em, 1023.51em, 6.641em, -999.997em); top: -4.65em; left: 0em;"><span class="mrow" id="MathJax-Span-4597"><span class="mrow" id="MathJax-Span-4598"><span class="mo" id="MathJax-Span-4599" style="vertical-align: 2.298em;"><span style="display: inline-block; position: relative; width: 0.685em; height: 0px;"><span style="position: absolute; font-family: MathJax_Size4; top: -2.788em; left: 0em;">⎡<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; font-family: MathJax_Size4; top: -0.555em; left: 0em;">⎣<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -1.61em; left: 0em;">⎢<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="mtable" id="MathJax-Span-4600" style="padding-right: 0.189em; padding-left: 0.189em;"><span style="display: inline-block; position: relative; width: 1.74em; height: 0px;"><span style="position: absolute; clip: rect(2.547em, 1001.74em, 6.951em, -999.997em); top: -5.022em; left: 0em;"><span style="display: inline-block; position: relative; width: 1.74em; height: 0px;"><span style="position: absolute; clip: rect(2.919em, 1001.74em, 4.346em, -999.997em); top: -5.394em; left: 50%; margin-left: -0.865em;"><span class="mtd" id="MathJax-Span-4601"><span class="mrow" id="MathJax-Span-4602"><span class="msubsup" id="MathJax-Span-4603"><span style="display: inline-block; position: relative; width: 0.375em; height: 0px;"><span style="position: absolute; clip: rect(3.787em, 1000em, 4.159em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-4604"></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -4.339em; left: 0em;"><span class="mi" id="MathJax-Span-4605" style="font-size: 70.7%; font-family: MathJax_Math-italic;">b</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-4606"><span style="display: inline-block; position: relative; width: 1.368em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.87em, 4.159em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-4607" style="font-family: MathJax_Math-italic;">m</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.872em;"><span class="mi" id="MathJax-Span-4608" style="font-size: 70.7%; font-family: MathJax_Math-italic;">x</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(2.919em, 1001.68em, 4.47em, -999.997em); top: -3.967em; left: 50%; margin-left: -0.865em;"><span class="mtd" id="MathJax-Span-4609"><span class="mrow" id="MathJax-Span-4610"><span class="msubsup" id="MathJax-Span-4611"><span style="display: inline-block; position: relative; width: 0.375em; height: 0px;"><span style="position: absolute; clip: rect(3.787em, 1000em, 4.159em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-4612"></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -4.339em; left: 0em;"><span class="mi" id="MathJax-Span-4613" style="font-size: 70.7%; font-family: MathJax_Math-italic;">b</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-4614"><span style="display: inline-block; position: relative; width: 1.306em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.87em, 4.159em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-4615" style="font-family: MathJax_Math-italic;">m</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.872em;"><span class="mi" id="MathJax-Span-4616" style="font-size: 70.7%; font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(2.919em, 1001.68em, 4.346em, -999.997em); top: -2.416em; left: 50%; margin-left: -0.803em;"><span class="mtd" id="MathJax-Span-4617"><span class="mrow" id="MathJax-Span-4618"><span class="msubsup" id="MathJax-Span-4619"><span style="display: inline-block; position: relative; width: 0.375em; height: 0px;"><span style="position: absolute; clip: rect(3.787em, 1000em, 4.159em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-4620"></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -4.339em; left: 0em;"><span class="mi" id="MathJax-Span-4621" style="font-size: 70.7%; font-family: MathJax_Math-italic;">b</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-4622"><span style="display: inline-block; position: relative; width: 1.306em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.87em, 4.159em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-4623" style="font-family: MathJax_Math-italic;">m</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.872em;"><span class="mi" id="MathJax-Span-4624" style="font-size: 70.7%; font-family: MathJax_Math-italic;">z<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span><span style="display: inline-block; width: 0px; height: 5.028em;"></span></span></span></span><span class="mo" id="MathJax-Span-4625" style="vertical-align: 2.298em;"><span style="display: inline-block; position: relative; width: 0.685em; height: 0px;"><span style="position: absolute; font-family: MathJax_Size4; top: -2.788em; left: 0em;">⎤<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; font-family: MathJax_Size4; top: -0.555em; left: 0em;">⎦<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -1.61em; left: 0em;">⎥<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span><span class="mo" id="MathJax-Span-4626" style="font-family: MathJax_Main; padding-left: 0.251em;">=</span><span class="mo" id="MathJax-Span-4627" style="font-family: MathJax_Main; padding-left: 0.251em;">−</span><span class="mrow" id="MathJax-Span-4628" style="padding-left: 0.189em;"><span class="mo" id="MathJax-Span-4629" style="vertical-align: 2.298em;"><span style="display: inline-block; position: relative; width: 0.685em; height: 0px;"><span style="position: absolute; font-family: MathJax_Size4; top: -2.788em; left: 0em;">⎡<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; font-family: MathJax_Size4; top: -0.555em; left: 0em;">⎣<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -1.672em; left: 0em;">⎢<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="mtable" id="MathJax-Span-4630" style="padding-right: 0.189em; padding-left: 0.189em;"><span style="display: inline-block; position: relative; width: 7.633em; height: 0px;"><span style="position: absolute; clip: rect(2.547em, 1007.63em, 6.951em, -999.997em); top: -4.96em; left: 0em;"><span style="display: inline-block; position: relative; width: 7.633em; height: 0px;"><span style="position: absolute; clip: rect(3.043em, 1005.96em, 4.408em, -999.997em); top: -5.456em; left: 50%; margin-left: -3.037em;"><span class="mtd" id="MathJax-Span-4631"><span class="mrow" id="MathJax-Span-4632"><span class="mn" id="MathJax-Span-4633" style="font-family: MathJax_Main;">2</span><span class="mo" id="MathJax-Span-4634" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-4635"><span style="display: inline-block; position: relative; width: 0.872em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.44em, 4.346em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-4636" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.437em;"><span class="mn" id="MathJax-Span-4637" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-4638"><span style="display: inline-block; position: relative; width: 0.872em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.44em, 4.346em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-4639" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.437em;"><span class="mn" id="MathJax-Span-4640" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="mo" id="MathJax-Span-4641" style="font-family: MathJax_Main; padding-left: 0.251em;">+</span><span class="msubsup" id="MathJax-Span-4642" style="padding-left: 0.251em;"><span style="display: inline-block; position: relative; width: 0.872em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.44em, 4.346em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-4643" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.437em;"><span class="mn" id="MathJax-Span-4644" style="font-size: 70.7%; font-family: MathJax_Main;">0</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-4645"><span style="display: inline-block; position: relative; width: 0.872em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.44em, 4.346em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-4646" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.437em;"><span class="mn" id="MathJax-Span-4647" style="font-size: 70.7%; font-family: MathJax_Main;">3</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="mo" id="MathJax-Span-4648" style="font-family: MathJax_Main;">)</span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(2.981em, 1007.63em, 4.47em, -999.997em); top: -3.967em; left: 50%; margin-left: -3.781em;"><span class="mtd" id="MathJax-Span-4649"><span class="mrow" id="MathJax-Span-4650"><span class="msubsup" id="MathJax-Span-4651"><span style="display: inline-block; position: relative; width: 0.934em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.44em, 4.346em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-4652" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.291em, 1000.44em, 4.159em, -999.997em); top: -4.339em; left: 0.499em;"><span class="mn" id="MathJax-Span-4653" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.291em, 1000.44em, 4.159em, -999.997em); top: -3.657em; left: 0.437em;"><span class="mn" id="MathJax-Span-4654" style="font-size: 70.7%; font-family: MathJax_Main;">0</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="mo" id="MathJax-Span-4655" style="font-family: MathJax_Main; padding-left: 0.251em;">−</span><span class="msubsup" id="MathJax-Span-4656" style="padding-left: 0.251em;"><span style="display: inline-block; position: relative; width: 0.934em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.44em, 4.346em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-4657" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.291em, 1000.44em, 4.159em, -999.997em); top: -4.339em; left: 0.499em;"><span class="mn" id="MathJax-Span-4658" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.291em, 1000.44em, 4.159em, -999.997em); top: -3.657em; left: 0.437em;"><span class="mn" id="MathJax-Span-4659" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="mo" id="MathJax-Span-4660" style="font-family: MathJax_Main; padding-left: 0.251em;">+</span><span class="msubsup" id="MathJax-Span-4661" style="padding-left: 0.251em;"><span style="display: inline-block; position: relative; width: 0.934em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.44em, 4.346em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-4662" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.291em, 1000.44em, 4.159em, -999.997em); top: -4.339em; left: 0.499em;"><span class="mn" id="MathJax-Span-4663" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.291em, 1000.44em, 4.159em, -999.997em); top: -3.657em; left: 0.437em;"><span class="mn" id="MathJax-Span-4664" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="mo" id="MathJax-Span-4665" style="font-family: MathJax_Main; padding-left: 0.251em;">−</span><span class="msubsup" id="MathJax-Span-4666" style="padding-left: 0.251em;"><span style="display: inline-block; position: relative; width: 0.934em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.44em, 4.346em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-4667" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.291em, 1000.44em, 4.159em, -999.997em); top: -4.339em; left: 0.499em;"><span class="mn" id="MathJax-Span-4668" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.291em, 1000.44em, 4.159em, -999.997em); top: -3.657em; left: 0.437em;"><span class="mn" id="MathJax-Span-4669" style="font-size: 70.7%; font-family: MathJax_Main;">3</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.043em, 1005.96em, 4.408em, -999.997em); top: -2.478em; left: 50%; margin-left: -3.037em;"><span class="mtd" id="MathJax-Span-4670"><span class="mrow" id="MathJax-Span-4671"><span class="mn" id="MathJax-Span-4672" style="font-family: MathJax_Main;">2</span><span class="mo" id="MathJax-Span-4673" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-4674"><span style="display: inline-block; position: relative; width: 0.872em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.44em, 4.346em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-4675" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.437em;"><span class="mn" id="MathJax-Span-4676" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-4677"><span style="display: inline-block; position: relative; width: 0.872em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.44em, 4.346em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-4678" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.437em;"><span class="mn" id="MathJax-Span-4679" style="font-size: 70.7%; font-family: MathJax_Main;">3</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="mo" id="MathJax-Span-4680" style="font-family: MathJax_Main; padding-left: 0.251em;">−</span><span class="msubsup" id="MathJax-Span-4681" style="padding-left: 0.251em;"><span style="display: inline-block; position: relative; width: 0.872em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.44em, 4.346em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-4682" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.437em;"><span class="mn" id="MathJax-Span-4683" style="font-size: 70.7%; font-family: MathJax_Main;">0</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-4684"><span style="display: inline-block; position: relative; width: 0.872em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.44em, 4.346em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-4685" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.437em;"><span class="mn" id="MathJax-Span-4686" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="mo" id="MathJax-Span-4687" style="font-family: MathJax_Main;">)</span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.966em;"></span></span></span></span><span class="mo" id="MathJax-Span-4688" style="vertical-align: 2.298em;"><span style="display: inline-block; position: relative; width: 0.685em; height: 0px;"><span style="position: absolute; font-family: MathJax_Size4; top: -2.788em; left: 0em;">⎤<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; font-family: MathJax_Size4; top: -0.555em; left: 0em;">⎦<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -1.672em; left: 0em;">⎥<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span><span class="mo" id="MathJax-Span-4689" style="font-family: MathJax_Main; padding-left: 0.251em;">+</span><span class="mrow" id="MathJax-Span-4690" style="padding-left: 0.251em;"><span class="mo" id="MathJax-Span-4691" style="vertical-align: 2.298em;"><span style="display: inline-block; position: relative; width: 0.685em; height: 0px;"><span style="position: absolute; font-family: MathJax_Size4; top: -2.788em; left: 0em;">⎡<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; font-family: MathJax_Size4; top: -0.555em; left: 0em;">⎣<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -1.61em; left: 0em;">⎢<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="mtable" id="MathJax-Span-4692" style="padding-right: 0.189em; padding-left: 0.189em;"><span style="display: inline-block; position: relative; width: 1.306em; height: 0px;"><span style="position: absolute; clip: rect(2.547em, 1001.31em, 6.951em, -999.997em); top: -5.022em; left: 0em;"><span style="display: inline-block; position: relative; width: 1.306em; height: 0px;"><span style="position: absolute; clip: rect(2.919em, 1001.31em, 4.346em, -999.997em); top: -5.394em; left: 50%; margin-left: -0.617em;"><span class="mtd" id="MathJax-Span-4693"><span class="mrow" id="MathJax-Span-4694"><span class="msubsup" id="MathJax-Span-4695"><span style="display: inline-block; position: relative; width: 0.375em; height: 0px;"><span style="position: absolute; clip: rect(3.787em, 1000em, 4.159em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-4696"></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -4.339em; left: 0em;"><span class="mi" id="MathJax-Span-4697" style="font-size: 70.7%; font-family: MathJax_Math-italic;">b</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-4698"><span style="display: inline-block; position: relative; width: 0.934em; height: 0px;"><span style="position: absolute; clip: rect(3.105em, 1000.44em, 4.159em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-4699" style="font-family: MathJax_Math-italic;">b</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.437em;"><span class="mi" id="MathJax-Span-4700" style="font-size: 70.7%; font-family: MathJax_Math-italic;">x</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(2.919em, 1001.24em, 4.47em, -999.997em); top: -3.967em; left: 50%; margin-left: -0.617em;"><span class="mtd" id="MathJax-Span-4701"><span class="mrow" id="MathJax-Span-4702"><span class="msubsup" id="MathJax-Span-4703"><span style="display: inline-block; position: relative; width: 0.375em; height: 0px;"><span style="position: absolute; clip: rect(3.787em, 1000em, 4.159em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-4704"></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -4.339em; left: 0em;"><span class="mi" id="MathJax-Span-4705" style="font-size: 70.7%; font-family: MathJax_Math-italic;">b</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-4706"><span style="display: inline-block; position: relative; width: 0.872em; height: 0px;"><span style="position: absolute; clip: rect(3.105em, 1000.44em, 4.159em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-4707" style="font-family: MathJax_Math-italic;">b</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.437em;"><span class="mi" id="MathJax-Span-4708" style="font-size: 70.7%; font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(2.919em, 1001.24em, 4.346em, -999.997em); top: -2.416em; left: 50%; margin-left: -0.617em;"><span class="mtd" id="MathJax-Span-4709"><span class="mrow" id="MathJax-Span-4710"><span class="msubsup" id="MathJax-Span-4711"><span style="display: inline-block; position: relative; width: 0.375em; height: 0px;"><span style="position: absolute; clip: rect(3.787em, 1000em, 4.159em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-4712"></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -4.339em; left: 0em;"><span class="mi" id="MathJax-Span-4713" style="font-size: 70.7%; font-family: MathJax_Math-italic;">b</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-4714"><span style="display: inline-block; position: relative; width: 0.81em; height: 0px;"><span style="position: absolute; clip: rect(3.105em, 1000.44em, 4.159em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-4715" style="font-family: MathJax_Math-italic;">b</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.437em;"><span class="mi" id="MathJax-Span-4716" style="font-size: 70.7%; font-family: MathJax_Math-italic;">z<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span><span style="display: inline-block; width: 0px; height: 5.028em;"></span></span></span></span><span class="mo" id="MathJax-Span-4717" style="vertical-align: 2.298em;"><span style="display: inline-block; position: relative; width: 0.685em; height: 0px;"><span style="position: absolute; font-family: MathJax_Size4; top: -2.788em; left: 0em;">⎤<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; font-family: MathJax_Size4; top: -0.555em; left: 0em;">⎦<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -1.61em; left: 0em;">⎥<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span><span class="mo" id="MathJax-Span-4718" style="font-family: MathJax_Main; padding-left: 0.251em;">+</span><span class="mrow" id="MathJax-Span-4719" style="padding-left: 0.251em;"><span class="mo" id="MathJax-Span-4720" style="vertical-align: 2.298em;"><span style="display: inline-block; position: relative; width: 0.685em; height: 0px;"><span style="position: absolute; font-family: MathJax_Size4; top: -2.788em; left: 0em;">⎡<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; font-family: MathJax_Size4; top: -0.555em; left: 0em;">⎣<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -1.61em; left: 0em;">⎢<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="mtable" id="MathJax-Span-4721" style="padding-right: 0.189em; padding-left: 0.189em;"><span style="display: inline-block; position: relative; width: 1.306em; height: 0px;"><span style="position: absolute; clip: rect(2.547em, 1001.31em, 6.951em, -999.997em); top: -5.022em; left: 0em;"><span style="display: inline-block; position: relative; width: 1.306em; height: 0px;"><span style="position: absolute; clip: rect(2.919em, 1001.31em, 4.346em, -999.997em); top: -5.394em; left: 50%; margin-left: -0.679em;"><span class="mtd" id="MathJax-Span-4722"><span class="mrow" id="MathJax-Span-4723"><span class="msubsup" id="MathJax-Span-4724"><span style="display: inline-block; position: relative; width: 0.375em; height: 0px;"><span style="position: absolute; clip: rect(3.787em, 1000em, 4.159em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-4725"></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -4.339em; left: 0em;"><span class="mi" id="MathJax-Span-4726" style="font-size: 70.7%; font-family: MathJax_Math-italic;">b</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-4727"><span style="display: inline-block; position: relative; width: 0.934em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.44em, 4.159em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-4728" style="font-family: MathJax_Math-italic;">e</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.499em;"><span class="mi" id="MathJax-Span-4729" style="font-size: 70.7%; font-family: MathJax_Math-italic;">x</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(2.919em, 1001.24em, 4.47em, -999.997em); top: -3.967em; left: 50%; margin-left: -0.617em;"><span class="mtd" id="MathJax-Span-4730"><span class="mrow" id="MathJax-Span-4731"><span class="msubsup" id="MathJax-Span-4732"><span style="display: inline-block; position: relative; width: 0.375em; height: 0px;"><span style="position: absolute; clip: rect(3.787em, 1000em, 4.159em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-4733"></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -4.339em; left: 0em;"><span class="mi" id="MathJax-Span-4734" style="font-size: 70.7%; font-family: MathJax_Math-italic;">b</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-4735"><span style="display: inline-block; position: relative; width: 0.872em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.44em, 4.159em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-4736" style="font-family: MathJax_Math-italic;">e</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.499em;"><span class="mi" id="MathJax-Span-4737" style="font-size: 70.7%; font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(2.919em, 1001.24em, 4.346em, -999.997em); top: -2.416em; left: 50%; margin-left: -0.617em;"><span class="mtd" id="MathJax-Span-4738"><span class="mrow" id="MathJax-Span-4739"><span class="msubsup" id="MathJax-Span-4740"><span style="display: inline-block; position: relative; width: 0.375em; height: 0px;"><span style="position: absolute; clip: rect(3.787em, 1000em, 4.159em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-4741"></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -4.339em; left: 0em;"><span class="mi" id="MathJax-Span-4742" style="font-size: 70.7%; font-family: MathJax_Math-italic;">b</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-4743"><span style="display: inline-block; position: relative; width: 0.872em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.44em, 4.159em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-4744" style="font-family: MathJax_Math-italic;">e</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.499em;"><span class="mi" id="MathJax-Span-4745" style="font-size: 70.7%; font-family: MathJax_Math-italic;">z<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span><span style="display: inline-block; width: 0px; height: 5.028em;"></span></span></span></span><span class="mo" id="MathJax-Span-4746" style="vertical-align: 2.298em;"><span style="display: inline-block; position: relative; width: 0.685em; height: 0px;"><span style="position: absolute; font-family: MathJax_Size4; top: -2.788em; left: 0em;">⎤<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; font-family: MathJax_Size4; top: -0.555em; left: 0em;">⎦<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -1.61em; left: 0em;">⎥<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.656em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -2.304em; border-left: 0px solid; width: 0px; height: 5.158em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mo>[</mo><mtable rowspacing="4pt" columnspacing="1em"><mtr><mtd><msup><mi></mi><mi>b</mi></msup><msub><mi>m</mi><mi>x</mi></msub></mtd></mtr><mtr><mtd><msup><mi></mi><mi>b</mi></msup><msub><mi>m</mi><mi>y</mi></msub></mtd></mtr><mtr><mtd><msup><mi></mi><mi>b</mi></msup><msub><mi>m</mi><mi>z</mi></msub></mtd></mtr></mtable><mo>]</mo></mrow><mo>=</mo><mo>−</mo><mrow><mo>[</mo><mtable rowspacing="4pt" columnspacing="1em"><mtr><mtd><mn>2</mn><mo stretchy="false">(</mo><msub><mi>q</mi><mn>1</mn></msub><msub><mi>q</mi><mn>2</mn></msub><mo>+</mo><msub><mi>q</mi><mn>0</mn></msub><msub><mi>q</mi><mn>3</mn></msub><mo stretchy="false">)</mo></mtd></mtr><mtr><mtd><msubsup><mi>q</mi><mn>0</mn><mn>2</mn></msubsup><mo>−</mo><msubsup><mi>q</mi><mn>1</mn><mn>2</mn></msubsup><mo>+</mo><msubsup><mi>q</mi><mn>2</mn><mn>2</mn></msubsup><mo>−</mo><msubsup><mi>q</mi><mn>3</mn><mn>2</mn></msubsup></mtd></mtr><mtr><mtd><mn>2</mn><mo stretchy="false">(</mo><msub><mi>q</mi><mn>2</mn></msub><msub><mi>q</mi><mn>3</mn></msub><mo>−</mo><msub><mi>q</mi><mn>0</mn></msub><msub><mi>q</mi><mn>1</mn></msub><mo stretchy="false">)</mo></mtd></mtr></mtable><mo>]</mo></mrow><mo>+</mo><mrow><mo>[</mo><mtable rowspacing="4pt" columnspacing="1em"><mtr><mtd><msup><mi></mi><mi>b</mi></msup><msub><mi>b</mi><mi>x</mi></msub></mtd></mtr><mtr><mtd><msup><mi></mi><mi>b</mi></msup><msub><mi>b</mi><mi>y</mi></msub></mtd></mtr><mtr><mtd><msup><mi></mi><mi>b</mi></msup><msub><mi>b</mi><mi>z</mi></msub></mtd></mtr></mtable><mo>]</mo></mrow><mo>+</mo><mrow><mo>[</mo><mtable rowspacing="4pt" columnspacing="1em"><mtr><mtd><msup><mi></mi><mi>b</mi></msup><msub><mi>e</mi><mi>x</mi></msub></mtd></mtr><mtr><mtd><msup><mi></mi><mi>b</mi></msup><msub><mi>e</mi><mi>y</mi></msub></mtd></mtr><mtr><mtd><msup><mi></mi><mi>b</mi></msup><msub><mi>e</mi><mi>z</mi></msub></mtd></mtr></mtable><mo>]</mo></mrow></math></span></span><script type="math/tex" id="MathJax-Element-97">\begin{bmatrix} ^bm_x \\ ^bm_y \\ ^bm_z \end{bmatrix} = -\begin{bmatrix} 2(q_1q_2+q_0q_3) \\ q_0^2-q_1^2+q_2^2-q_3^2 \\ 2(q_2q_3-q_0q_1) \end{bmatrix} + \begin{bmatrix} ^bb_x \\ ^bb_y \\ ^bb_z \end{bmatrix} + \begin{bmatrix} ^be_x \\ ^be_y \\ ^be_z \end{bmatrix} </script>&nbsp; &nbsp; &nbsp;——————–&nbsp; &nbsp; &nbsp;(17)</p>
<p>From here, you can see that in order to obtain the Jacobian matrix for use in the Extended Kalman Filter, the steps are exactly the same as that for the accelerometer. As such, I am going to skip the derivations and just write down the value of the <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-98-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;C&lt;/mi&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-4747" style="width: 0.996em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.81em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(1.492em, 1000.81em, 2.547em, -999.997em); top: -2.354em; left: 0em;"><span class="mrow" id="MathJax-Span-4748"><span class="mi" id="MathJax-Span-4749" style="font-family: MathJax_Math-italic;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.065em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.36em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.073em; border-left: 0px solid; width: 0px; height: 1.081em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>C</mi></math></span></span><script type="math/tex" id="MathJax-Element-98">C</script> matrix below here.</p>
<p><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-99-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;C&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;msub&gt;&lt;mrow&gt;&lt;mo&gt;[&lt;/mo&gt;&lt;mtable rowspacing=&quot;4pt&quot; columnspacing=&quot;1em&quot;&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mn&gt;3&lt;/mn&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mn&gt;3&lt;/mn&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mn&gt;3&lt;/mn&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;/mtable&gt;&lt;mo&gt;]&lt;/mo&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-4750" style="width: 18.924em; display: inline-block;"><span style="display: inline-block; position: relative; width: 15.264em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(0.003em, 1015.26em, 4.283em, -999.997em); top: -2.354em; left: 0em;"><span class="mrow" id="MathJax-Span-4751"><span class="mi" id="MathJax-Span-4752" style="font-family: MathJax_Math-italic;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.065em;"></span></span><span class="mo" id="MathJax-Span-4753" style="font-family: MathJax_Main; padding-left: 0.251em;">=</span><span class="mo" id="MathJax-Span-4754" style="font-family: MathJax_Main; padding-left: 0.251em;">−</span><span class="mn" id="MathJax-Span-4755" style="font-family: MathJax_Main;">2</span><span class="msubsup" id="MathJax-Span-4756"><span style="display: inline-block; position: relative; width: 11.914em; height: 0px;"><span style="position: absolute; clip: rect(2.422em, 1010.24em, 6.641em, -999.997em); top: -4.774em; left: 0em;"><span class="mrow" id="MathJax-Span-4757"><span class="mo" id="MathJax-Span-4758" style="vertical-align: 2.174em;"><span style="display: inline-block; position: relative; width: 0.685em; height: 0px;"><span style="position: absolute; font-family: MathJax_Size4; top: -2.788em; left: 0em;">⎡<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; font-family: MathJax_Size4; top: -0.803em; left: 0em;">⎣<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -1.796em; left: 0em;">⎢<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="mtable" id="MathJax-Span-4759" style="padding-right: 0.189em; padding-left: 0.189em;"><span style="display: inline-block; position: relative; width: 8.812em; height: 0px;"><span style="position: absolute; clip: rect(2.484em, 1001.68em, 6.331em, -999.997em); top: -4.463em; left: 0em;"><span style="display: inline-block; position: relative; width: 1.678em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.87em, 4.346em, -999.997em); top: -5.332em; left: 50%; margin-left: -0.431em;"><span class="mtd" id="MathJax-Span-4760"><span class="mrow" id="MathJax-Span-4761"><span class="msubsup" id="MathJax-Span-4762"><span style="display: inline-block; position: relative; width: 0.872em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.44em, 4.346em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-4763" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.437em;"><span class="mn" id="MathJax-Span-4764" style="font-size: 70.7%; font-family: MathJax_Main;">3</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.353em, 1000.87em, 4.346em, -999.997em); top: -3.905em; left: 50%; margin-left: -0.431em;"><span class="mtd" id="MathJax-Span-4780"><span class="mrow" id="MathJax-Span-4781"><span class="msubsup" id="MathJax-Span-4782"><span style="display: inline-block; position: relative; width: 0.872em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.44em, 4.346em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-4783" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.437em;"><span class="mn" id="MathJax-Span-4784" style="font-size: 70.7%; font-family: MathJax_Main;">0</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.229em, 1001.68em, 4.346em, -999.997em); top: -2.54em; left: 50%; margin-left: -0.803em;"><span class="mtd" id="MathJax-Span-4802"><span class="mrow" id="MathJax-Span-4803"><span class="mo" id="MathJax-Span-4804" style="font-family: MathJax_Main;">−</span><span class="msubsup" id="MathJax-Span-4805"><span style="display: inline-block; position: relative; width: 0.872em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.44em, 4.346em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-4806" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.437em;"><span class="mn" id="MathJax-Span-4807" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.47em;"></span></span><span style="position: absolute; clip: rect(2.484em, 1001.68em, 6.331em, -999.997em); top: -4.463em; left: 2.671em;"><span style="display: inline-block; position: relative; width: 1.678em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.87em, 4.346em, -999.997em); top: -5.332em; left: 50%; margin-left: -0.431em;"><span class="mtd" id="MathJax-Span-4765"><span class="mrow" id="MathJax-Span-4766"><span class="msubsup" id="MathJax-Span-4767"><span style="display: inline-block; position: relative; width: 0.872em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.44em, 4.346em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-4768" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.437em;"><span class="mn" id="MathJax-Span-4769" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.229em, 1001.68em, 4.346em, -999.997em); top: -3.905em; left: 50%; margin-left: -0.803em;"><span class="mtd" id="MathJax-Span-4785"><span class="mrow" id="MathJax-Span-4786"><span class="mo" id="MathJax-Span-4787" style="font-family: MathJax_Main;">−</span><span class="msubsup" id="MathJax-Span-4788"><span style="display: inline-block; position: relative; width: 0.872em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.44em, 4.346em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-4789" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.437em;"><span class="mn" id="MathJax-Span-4790" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.229em, 1001.68em, 4.346em, -999.997em); top: -2.54em; left: 50%; margin-left: -0.803em;"><span class="mtd" id="MathJax-Span-4808"><span class="mrow" id="MathJax-Span-4809"><span class="mo" id="MathJax-Span-4810" style="font-family: MathJax_Main;">−</span><span class="msubsup" id="MathJax-Span-4811"><span style="display: inline-block; position: relative; width: 0.872em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.44em, 4.346em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-4812" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.437em;"><span class="mn" id="MathJax-Span-4813" style="font-size: 70.7%; font-family: MathJax_Main;">0</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.47em;"></span></span><span style="position: absolute; clip: rect(2.484em, 1000.87em, 6.331em, -999.997em); top: -4.463em; left: 5.338em;"><span style="display: inline-block; position: relative; width: 0.872em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.87em, 4.346em, -999.997em); top: -5.332em; left: 50%; margin-left: -0.431em;"><span class="mtd" id="MathJax-Span-4770"><span class="mrow" id="MathJax-Span-4771"><span class="msubsup" id="MathJax-Span-4772"><span style="display: inline-block; position: relative; width: 0.872em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.44em, 4.346em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-4773" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.437em;"><span class="mn" id="MathJax-Span-4774" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.353em, 1000.87em, 4.346em, -999.997em); top: -3.905em; left: 50%; margin-left: -0.431em;"><span class="mtd" id="MathJax-Span-4791"><span class="mrow" id="MathJax-Span-4792"><span class="msubsup" id="MathJax-Span-4793"><span style="display: inline-block; position: relative; width: 0.872em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.44em, 4.346em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-4794" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.437em;"><span class="mn" id="MathJax-Span-4795" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.353em, 1000.87em, 4.346em, -999.997em); top: -2.54em; left: 50%; margin-left: -0.431em;"><span class="mtd" id="MathJax-Span-4814"><span class="mrow" id="MathJax-Span-4815"><span class="msubsup" id="MathJax-Span-4816"><span style="display: inline-block; position: relative; width: 0.872em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.44em, 4.346em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-4817" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.437em;"><span class="mn" id="MathJax-Span-4818" style="font-size: 70.7%; font-family: MathJax_Main;">3</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.47em;"></span></span><span style="position: absolute; clip: rect(2.484em, 1001.68em, 6.331em, -999.997em); top: -4.463em; left: 7.199em;"><span style="display: inline-block; position: relative; width: 1.678em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.87em, 4.346em, -999.997em); top: -5.332em; left: 50%; margin-left: -0.431em;"><span class="mtd" id="MathJax-Span-4775"><span class="mrow" id="MathJax-Span-4776"><span class="msubsup" id="MathJax-Span-4777"><span style="display: inline-block; position: relative; width: 0.872em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.44em, 4.346em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-4778" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.437em;"><span class="mn" id="MathJax-Span-4779" style="font-size: 70.7%; font-family: MathJax_Main;">0</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.229em, 1001.68em, 4.346em, -999.997em); top: -3.905em; left: 50%; margin-left: -0.803em;"><span class="mtd" id="MathJax-Span-4796"><span class="mrow" id="MathJax-Span-4797"><span class="mo" id="MathJax-Span-4798" style="font-family: MathJax_Main;">−</span><span class="msubsup" id="MathJax-Span-4799"><span style="display: inline-block; position: relative; width: 0.872em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.44em, 4.346em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-4800" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.437em;"><span class="mn" id="MathJax-Span-4801" style="font-size: 70.7%; font-family: MathJax_Main;">3</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.353em, 1000.87em, 4.346em, -999.997em); top: -2.54em; left: 50%; margin-left: -0.431em;"><span class="mtd" id="MathJax-Span-4819"><span class="mrow" id="MathJax-Span-4820"><span class="msubsup" id="MathJax-Span-4821"><span style="display: inline-block; position: relative; width: 0.872em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.44em, 4.346em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-4822" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.437em;"><span class="mn" id="MathJax-Span-4823" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.47em;"></span></span></span></span><span class="mo" id="MathJax-Span-4824" style="vertical-align: 2.174em;"><span style="display: inline-block; position: relative; width: 0.685em; height: 0px;"><span style="position: absolute; font-family: MathJax_Size4; top: -2.788em; left: 0em;">⎤<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; font-family: MathJax_Size4; top: -0.803em; left: 0em;">⎦<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -1.796em; left: 0em;">⎥<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.78em;"></span></span><span style="position: absolute; top: -2.292em; left: 10.549em;"><span class="texatom" id="MathJax-Span-4825"><span class="mrow" id="MathJax-Span-4826"><span class="mi" id="MathJax-Span-4827" style="font-size: 70.7%; font-family: MathJax_Math-italic;">k</span><span class="mo" id="MathJax-Span-4828" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="mn" id="MathJax-Span-4829" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.36em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -2.227em; border-left: 0px solid; width: 0px; height: 5.004em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>C</mi><mo>=</mo><mo>−</mo><mn>2</mn><msub><mrow><mo>[</mo><mtable rowspacing="4pt" columnspacing="1em"><mtr><mtd><msub><mi>q</mi><mn>3</mn></msub></mtd><mtd><msub><mi>q</mi><mn>2</mn></msub></mtd><mtd><msub><mi>q</mi><mn>1</mn></msub></mtd><mtd><msub><mi>q</mi><mn>0</mn></msub></mtd></mtr><mtr><mtd><msub><mi>q</mi><mn>0</mn></msub></mtd><mtd><mo>−</mo><msub><mi>q</mi><mn>1</mn></msub></mtd><mtd><msub><mi>q</mi><mn>2</mn></msub></mtd><mtd><mo>−</mo><msub><mi>q</mi><mn>3</mn></msub></mtd></mtr><mtr><mtd><mo>−</mo><msub><mi>q</mi><mn>1</mn></msub></mtd><mtd><mo>−</mo><msub><mi>q</mi><mn>0</mn></msub></mtd><mtd><msub><mi>q</mi><mn>3</mn></msub></mtd><mtd><msub><mi>q</mi><mn>2</mn></msub></mtd></mtr></mtable><mo>]</mo></mrow><mrow class="MJX-TeXAtom-ORD"><mi>k</mi><mo>−</mo><mn>1</mn></mrow></msub></math></span></span><script type="math/tex" id="MathJax-Element-99">C= -2\begin{bmatrix} q_3 & q_2 & q_1 & q_0 \\ q_0 & -q_1 & q_2 & -q_3 \\ -q_1 & -q_0 & q_3 & q_2 \end{bmatrix}_{k-1}</script></p>
<p>Here, notice that if we did not simplify the equations with the values of&nbsp;<span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-100-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msup&gt;&lt;mi&gt;&lt;/mi&gt;&lt;mi&gt;w&lt;/mi&gt;&lt;/msup&gt;&lt;msub&gt;&lt;mi&gt;m&lt;/mi&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-4830" style="width: 2.36em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.864em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(1.492em, 1001.86em, 2.733em, -999.997em); top: -2.354em; left: 0em;"><span class="mrow" id="MathJax-Span-4831"><span class="msubsup" id="MathJax-Span-4832"><span style="display: inline-block; position: relative; width: 0.561em; height: 0px;"><span style="position: absolute; clip: rect(3.787em, 1000em, 4.159em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-4833"></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -4.339em; left: 0em;"><span class="mi" id="MathJax-Span-4834" style="font-size: 70.7%; font-family: MathJax_Math-italic;">w</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-4835"><span style="display: inline-block; position: relative; width: 1.306em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.87em, 4.159em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-4836" style="font-family: MathJax_Math-italic;">m</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.872em;"><span class="mi" id="MathJax-Span-4837" style="font-size: 70.7%; font-family: MathJax_Math-italic;">r</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.36em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.304em; border-left: 0px solid; width: 0px; height: 1.158em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup><mi></mi><mi>w</mi></msup><msub><mi>m</mi><mi>r</mi></msub></math></span></span><script type="math/tex" id="MathJax-Element-100">^wm_r</script> for equation (16), we will get the exact same generalized Jacobian matrix from equation (8) (without the values of the vector <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-101-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;g&lt;/mi&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-4838" style="width: 0.623em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.499em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(1.74em, 1000.5em, 2.733em, -999.997em); top: -2.354em; left: 0em;"><span class="mrow" id="MathJax-Span-4839"><span class="mi" id="MathJax-Span-4840" style="font-family: MathJax_Math-italic;">g<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.36em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.304em; border-left: 0px solid; width: 0px; height: 0.927em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>g</mi></math></span></span><script type="math/tex" id="MathJax-Element-101">g</script> being substituted) as well. I will leave this as homework to you guys but the answer can be found in the python code anyway. I was lazy to write 2 different implementations for the accelerometer and the magnetometer so I combined them both. Anyway, we are now ready to get on with the EKF implementation finally!</p>
<div id="EKFimpl"></div>
<hr>
<h2>Quaternion EKF Implementation</h2>
<p>Now, if you have no experience with the Kalman Filter at all, I would strongly recommend that you read one of my <a href="https://thepoorengineer.com/en/angle-control-absolute/#kalman">earlier post</a>&nbsp;on kalman filter to get an idea of it first. The extended kalman filter is simply replacing one of the the matrix in the original original kalman filter with that of the Jacobian matrix since the system is now non-linear.</p>
<p>The equations that we are going to implement are exactly the same as that for the kalman filter as shown below. (This is taken directly from my <a href="https://thepoorengineer.com/en/angle-control-absolute/#kalman">earlier post</a>&nbsp;except that i added k to the numbering to symbolize that it is the kalman filter equation)</p>
<p><strong><span style="text-decoration: underline; color: #338aff;">Prediction</span></strong></p>
<p><span style="color: #338aff;"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-102-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msubsup&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mover&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;&amp;#x005E;&lt;/mo&gt;&lt;/mover&gt;&lt;/mrow&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;/msubsup&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;A&lt;/mi&gt;&lt;msub&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mover&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;&amp;#x005E;&lt;/mo&gt;&lt;/mover&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mi&gt;B&lt;/mi&gt;&lt;msub&gt;&lt;mi&gt;u&lt;/mi&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-4841" style="width: 10.177em; display: inline-block;"><span style="display: inline-block; position: relative; width: 8.192em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(1.306em, 1008.19em, 2.795em, -999.997em); top: -2.354em; left: 0em;"><span class="mrow" id="MathJax-Span-4842"><span class="msubsup" id="MathJax-Span-4843"><span style="display: inline-block; position: relative; width: 1.182em; height: 0px;"><span style="position: absolute; clip: rect(3.043em, 1000.5em, 4.159em, -999.997em); top: -3.967em; left: 0em;"><span class="texatom" id="MathJax-Span-4844"><span class="mrow" id="MathJax-Span-4845"><span class="munderover" id="MathJax-Span-4846"><span style="display: inline-block; position: relative; width: 0.561em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.5em, 4.159em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-4847" style="font-family: MathJax_Math-italic;">x</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.105em, 1000.38em, 3.601em, -999.997em); top: -4.029em; left: 0.065em;"><span class="mo" id="MathJax-Span-4848" style="font-family: MathJax_Main;">^</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.353em, 1000.62em, 4.221em, -999.997em); top: -4.463em; left: 0.561em;"><span class="mo" id="MathJax-Span-4849" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.291em, 1000.44em, 4.159em, -999.997em); top: -3.719em; left: 0.561em;"><span class="mi" id="MathJax-Span-4850" style="font-size: 70.7%; font-family: MathJax_Math-italic;">k</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="mo" id="MathJax-Span-4851" style="font-family: MathJax_Main; padding-left: 0.251em;">=</span><span class="mi" id="MathJax-Span-4852" style="font-family: MathJax_Math-italic; padding-left: 0.251em;">A</span><span class="msubsup" id="MathJax-Span-4853"><span style="display: inline-block; position: relative; width: 1.926em; height: 0px;"><span style="position: absolute; clip: rect(3.043em, 1000.5em, 4.159em, -999.997em); top: -3.967em; left: 0em;"><span class="texatom" id="MathJax-Span-4854"><span class="mrow" id="MathJax-Span-4855"><span class="munderover" id="MathJax-Span-4856"><span style="display: inline-block; position: relative; width: 0.561em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.5em, 4.159em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-4857" style="font-family: MathJax_Math-italic;">x</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.105em, 1000.38em, 3.601em, -999.997em); top: -4.029em; left: 0.065em;"><span class="mo" id="MathJax-Span-4858" style="font-family: MathJax_Main;">^</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.561em;"><span class="texatom" id="MathJax-Span-4859"><span class="mrow" id="MathJax-Span-4860"><span class="mi" id="MathJax-Span-4861" style="font-size: 70.7%; font-family: MathJax_Math-italic;">k</span><span class="mo" id="MathJax-Span-4862" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="mn" id="MathJax-Span-4863" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="mo" id="MathJax-Span-4864" style="font-family: MathJax_Main; padding-left: 0.251em;">+</span><span class="mi" id="MathJax-Span-4865" style="font-family: MathJax_Math-italic; padding-left: 0.251em;">B</span><span class="msubsup" id="MathJax-Span-4866"><span style="display: inline-block; position: relative; width: 0.996em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.56em, 4.159em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-4867" style="font-family: MathJax_Math-italic;">u</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.561em;"><span class="mi" id="MathJax-Span-4868" style="font-size: 70.7%; font-family: MathJax_Math-italic;">k</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.36em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.381em; border-left: 0px solid; width: 0px; height: 1.619em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msubsup><mrow class="MJX-TeXAtom-ORD"><mover><mi>x</mi><mo stretchy="false">^</mo></mover></mrow><mi>k</mi><mo>−</mo></msubsup><mo>=</mo><mi>A</mi><msub><mrow class="MJX-TeXAtom-ORD"><mover><mi>x</mi><mo stretchy="false">^</mo></mover></mrow><mrow class="MJX-TeXAtom-ORD"><mi>k</mi><mo>−</mo><mn>1</mn></mrow></msub><mo>+</mo><mi>B</mi><msub><mi>u</mi><mi>k</mi></msub></math></span></span><script type="math/tex" id="MathJax-Element-102">\hat{x}^-_k=A\hat{x}_{k-1}+Bu_k</script></span>&nbsp; ———–&nbsp; (1k)</p>
<p><span style="color: #338aff;"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-103-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msubsup&gt;&lt;mi&gt;P&lt;/mi&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;/msubsup&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;A&lt;/mi&gt;&lt;msub&gt;&lt;mi&gt;P&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;msup&gt;&lt;mi&gt;A&lt;/mi&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;/msup&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mi&gt;Q&lt;/mi&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-4869" style="width: 11.045em; display: inline-block;"><span style="display: inline-block; position: relative; width: 8.874em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(1.306em, 1008.81em, 2.857em, -999.997em); top: -2.354em; left: 0em;"><span class="mrow" id="MathJax-Span-4870"><span class="msubsup" id="MathJax-Span-4871"><span style="display: inline-block; position: relative; width: 1.492em; height: 0px;"><span style="position: absolute; clip: rect(3.105em, 1000.75em, 4.159em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-4872" style="font-family: MathJax_Math-italic;">P<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.127em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.353em, 1000.62em, 4.221em, -999.997em); top: -4.339em; left: 0.81em;"><span class="mo" id="MathJax-Span-4873" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.291em, 1000.44em, 4.159em, -999.997em); top: -3.657em; left: 0.623em;"><span class="mi" id="MathJax-Span-4874" style="font-size: 70.7%; font-family: MathJax_Math-italic;">k</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="mo" id="MathJax-Span-4875" style="font-family: MathJax_Main; padding-left: 0.251em;">=</span><span class="mi" id="MathJax-Span-4876" style="font-family: MathJax_Math-italic; padding-left: 0.251em;">A</span><span class="msubsup" id="MathJax-Span-4877"><span style="display: inline-block; position: relative; width: 1.988em; height: 0px;"><span style="position: absolute; clip: rect(3.105em, 1000.75em, 4.159em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-4878" style="font-family: MathJax_Math-italic;">P<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.127em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.623em;"><span class="texatom" id="MathJax-Span-4879"><span class="mrow" id="MathJax-Span-4880"><span class="mi" id="MathJax-Span-4881" style="font-size: 70.7%; font-family: MathJax_Math-italic;">k</span><span class="mo" id="MathJax-Span-4882" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="mn" id="MathJax-Span-4883" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-4884"><span style="display: inline-block; position: relative; width: 1.306em; height: 0px;"><span style="position: absolute; clip: rect(3.043em, 1000.75em, 4.159em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-4885" style="font-family: MathJax_Math-italic;">A</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -4.339em; left: 0.748em;"><span class="mi" id="MathJax-Span-4886" style="font-size: 70.7%; font-family: MathJax_Math-italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.065em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="mo" id="MathJax-Span-4887" style="font-family: MathJax_Main; padding-left: 0.251em;">+</span><span class="mi" id="MathJax-Span-4888" style="font-family: MathJax_Math-italic; padding-left: 0.251em;">Q</span></span><span style="display: inline-block; width: 0px; height: 2.36em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.458em; border-left: 0px solid; width: 0px; height: 1.619em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msubsup><mi>P</mi><mi>k</mi><mo>−</mo></msubsup><mo>=</mo><mi>A</mi><msub><mi>P</mi><mrow class="MJX-TeXAtom-ORD"><mi>k</mi><mo>−</mo><mn>1</mn></mrow></msub><msup><mi>A</mi><mi>T</mi></msup><mo>+</mo><mi>Q</mi></math></span></span><script type="math/tex" id="MathJax-Element-103">P^-_k=AP_{k-1}A^T+Q</script></span>&nbsp; ———–&nbsp; (2k)</p>
<p><span style="color: #338aff;">where</span><br>
<span style="color: #338aff;"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-104-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msubsup&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mover&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;&amp;#x005E;&lt;/mo&gt;&lt;/mover&gt;&lt;/mrow&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;/msubsup&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-4889" style="width: 1.492em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.182em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(1.306em, 1001.18em, 2.795em, -999.997em); top: -2.354em; left: 0em;"><span class="mrow" id="MathJax-Span-4890"><span class="msubsup" id="MathJax-Span-4891"><span style="display: inline-block; position: relative; width: 1.182em; height: 0px;"><span style="position: absolute; clip: rect(3.043em, 1000.5em, 4.159em, -999.997em); top: -3.967em; left: 0em;"><span class="texatom" id="MathJax-Span-4892"><span class="mrow" id="MathJax-Span-4893"><span class="munderover" id="MathJax-Span-4894"><span style="display: inline-block; position: relative; width: 0.561em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.5em, 4.159em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-4895" style="font-family: MathJax_Math-italic;">x</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.105em, 1000.38em, 3.601em, -999.997em); top: -4.029em; left: 0.065em;"><span class="mo" id="MathJax-Span-4896" style="font-family: MathJax_Main;">^</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.353em, 1000.62em, 4.221em, -999.997em); top: -4.463em; left: 0.561em;"><span class="mo" id="MathJax-Span-4897" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.291em, 1000.44em, 4.159em, -999.997em); top: -3.719em; left: 0.561em;"><span class="mi" id="MathJax-Span-4898" style="font-size: 70.7%; font-family: MathJax_Math-italic;">k</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.36em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.381em; border-left: 0px solid; width: 0px; height: 1.619em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msubsup><mrow class="MJX-TeXAtom-ORD"><mover><mi>x</mi><mo stretchy="false">^</mo></mover></mrow><mi>k</mi><mo>−</mo></msubsup></math></span></span><script type="math/tex" id="MathJax-Element-104">\hat{x}^-_k</script> is the priori estimate of x at time step <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-105-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-4899" style="width: 0.623em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.499em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(1.492em, 1000.5em, 2.547em, -999.997em); top: -2.354em; left: 0em;"><span class="mrow" id="MathJax-Span-4900"><span class="mi" id="MathJax-Span-4901" style="font-family: MathJax_Math-italic;">k</span></span><span style="display: inline-block; width: 0px; height: 2.36em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.073em; border-left: 0px solid; width: 0px; height: 1.004em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>k</mi></math></span></span><script type="math/tex" id="MathJax-Element-105">k</script></span><br>
<span style="color: #338aff;"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-106-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msubsup&gt;&lt;mi&gt;P&lt;/mi&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;/msubsup&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-4902" style="width: 1.864em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.492em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(1.368em, 1001.49em, 2.857em, -999.997em); top: -2.354em; left: 0em;"><span class="mrow" id="MathJax-Span-4903"><span class="msubsup" id="MathJax-Span-4904"><span style="display: inline-block; position: relative; width: 1.492em; height: 0px;"><span style="position: absolute; clip: rect(3.105em, 1000.75em, 4.159em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-4905" style="font-family: MathJax_Math-italic;">P<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.127em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.353em, 1000.62em, 4.221em, -999.997em); top: -4.339em; left: 0.81em;"><span class="mo" id="MathJax-Span-4906" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.291em, 1000.44em, 4.159em, -999.997em); top: -3.657em; left: 0.623em;"><span class="mi" id="MathJax-Span-4907" style="font-size: 70.7%; font-family: MathJax_Math-italic;">k</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.36em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.458em; border-left: 0px solid; width: 0px; height: 1.619em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msubsup><mi>P</mi><mi>k</mi><mo>−</mo></msubsup></math></span></span><script type="math/tex" id="MathJax-Element-106">P^-_k</script> is the priori estimate of the error at time step <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-107-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-4908" style="width: 0.623em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.499em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(1.492em, 1000.5em, 2.547em, -999.997em); top: -2.354em; left: 0em;"><span class="mrow" id="MathJax-Span-4909"><span class="mi" id="MathJax-Span-4910" style="font-family: MathJax_Math-italic;">k</span></span><span style="display: inline-block; width: 0px; height: 2.36em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.073em; border-left: 0px solid; width: 0px; height: 1.004em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>k</mi></math></span></span><script type="math/tex" id="MathJax-Element-107">k</script></span><br>
<span style="color: #338aff;"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-108-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;Q&lt;/mi&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-4911" style="width: 0.996em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.81em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(1.492em, 1000.75em, 2.733em, -999.997em); top: -2.354em; left: 0em;"><span class="mrow" id="MathJax-Span-4912"><span class="mi" id="MathJax-Span-4913" style="font-family: MathJax_Math-italic;">Q</span></span><span style="display: inline-block; width: 0px; height: 2.36em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.304em; border-left: 0px solid; width: 0px; height: 1.235em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>Q</mi></math></span></span><script type="math/tex" id="MathJax-Element-108">Q</script> is the process variance</span></p>
<p><span style="text-decoration: underline; color: #8633ff;"><strong>Update</strong></span></p>
<p><span style="color: #8633ff;"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-109-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;K&lt;/mi&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mstyle mathsize=&quot;1.44em&quot;&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mfrac&gt;&lt;mrow&gt;&lt;msubsup&gt;&lt;mi&gt;P&lt;/mi&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;/msubsup&gt;&lt;msup&gt;&lt;mi&gt;C&lt;/mi&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;/msup&gt;&lt;/mrow&gt;&lt;mrow&gt;&lt;mi&gt;C&lt;/mi&gt;&lt;msubsup&gt;&lt;mi&gt;P&lt;/mi&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;/msubsup&gt;&lt;msup&gt;&lt;mi&gt;C&lt;/mi&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;/msup&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mi&gt;R&lt;/mi&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;/mrow&gt;&lt;/mstyle&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-4914" style="width: 10.425em; display: inline-block;"><span style="display: inline-block; position: relative; width: 8.378em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(0.375em, 1008.38em, 3.663em, -999.997em); top: -2.354em; left: 0em;"><span class="mrow" id="MathJax-Span-4915"><span class="msubsup" id="MathJax-Span-4916"><span style="display: inline-block; position: relative; width: 1.306em; height: 0px;"><span style="position: absolute; clip: rect(3.105em, 1000.87em, 4.159em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-4917" style="font-family: MathJax_Math-italic;">K<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.065em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.872em;"><span class="mi" id="MathJax-Span-4918" style="font-size: 70.7%; font-family: MathJax_Math-italic;">k</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="mo" id="MathJax-Span-4919" style="font-family: MathJax_Main; padding-left: 0.251em;">=</span><span class="mstyle" id="MathJax-Span-4920" style="padding-left: 0.251em;"><span class="mrow" id="MathJax-Span-4921"><span class="texatom" id="MathJax-Span-4922"><span class="mrow" id="MathJax-Span-4923"><span class="mfrac" id="MathJax-Span-4924"><span style="display: inline-block; position: relative; width: 5.4em; height: 0px; margin-right: 0.189em; margin-left: 0.189em;"><span style="position: absolute; clip: rect(2.857em, 1002.92em, 4.47em, -999.997em); top: -4.836em; left: 50%; margin-left: -1.424em;"><span class="mrow" id="MathJax-Span-4925"><span class="msubsup" id="MathJax-Span-4926"><span style="display: inline-block; position: relative; width: 1.492em; height: 0px;"><span style="position: absolute; clip: rect(3.105em, 1000.75em, 4.159em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-4927" style="font-size: 101.8%; font-family: MathJax_Math-italic;">P<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.065em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.353em, 1000.62em, 4.221em, -999.997em); top: -4.401em; left: 0.872em;"><span class="mo" id="MathJax-Span-4928" style="font-size: 72%; font-family: MathJax_Main;">−</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.291em, 1000.44em, 4.159em, -999.997em); top: -3.657em; left: 0.685em;"><span class="mi" id="MathJax-Span-4929" style="font-size: 72%; font-family: MathJax_Math-italic;">k</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-4930"><span style="display: inline-block; position: relative; width: 1.43em; height: 0px;"><span style="position: absolute; clip: rect(3.043em, 1000.75em, 4.159em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-4931" style="font-size: 101.8%; font-family: MathJax_Math-italic;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.065em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -4.401em; left: 0.872em;"><span class="mi" id="MathJax-Span-4932" style="font-size: 72%; font-family: MathJax_Math-italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.065em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(2.857em, 1005.21em, 4.47em, -999.997em); top: -3.223em; left: 50%; margin-left: -2.602em;"><span class="mrow" id="MathJax-Span-4933"><span class="mi" id="MathJax-Span-4934" style="font-size: 101.8%; font-family: MathJax_Math-italic;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.065em;"></span></span><span class="msubsup" id="MathJax-Span-4935"><span style="display: inline-block; position: relative; width: 1.492em; height: 0px;"><span style="position: absolute; clip: rect(3.105em, 1000.75em, 4.159em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-4936" style="font-size: 101.8%; font-family: MathJax_Math-italic;">P<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.065em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.353em, 1000.62em, 4.221em, -999.997em); top: -4.401em; left: 0.872em;"><span class="mo" id="MathJax-Span-4937" style="font-size: 72%; font-family: MathJax_Main;">−</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.291em, 1000.44em, 4.159em, -999.997em); top: -3.657em; left: 0.685em;"><span class="mi" id="MathJax-Span-4938" style="font-size: 72%; font-family: MathJax_Math-italic;">k</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-4939"><span style="display: inline-block; position: relative; width: 1.43em; height: 0px;"><span style="position: absolute; clip: rect(3.043em, 1000.75em, 4.159em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-4940" style="font-size: 101.8%; font-family: MathJax_Math-italic;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.065em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -4.401em; left: 0.872em;"><span class="mi" id="MathJax-Span-4941" style="font-size: 72%; font-family: MathJax_Math-italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.065em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="mo" id="MathJax-Span-4942" style="font-size: 101.8%; font-family: MathJax_Main;">+</span><span class="mi" id="MathJax-Span-4943" style="font-size: 101.8%; font-family: MathJax_Math-italic;">R</span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(0.872em, 1005.4em, 1.306em, -999.997em); top: -1.424em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.4px solid; width: 5.4em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.12em;"></span></span></span></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.36em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -1.458em; border-left: 0px solid; width: 0px; height: 3.773em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>K</mi><mi>k</mi></msub><mo>=</mo><mstyle mathsize="1.44em"><mrow class="MJX-TeXAtom-ORD"><mfrac><mrow><msubsup><mi>P</mi><mi>k</mi><mo>−</mo></msubsup><msup><mi>C</mi><mi>T</mi></msup></mrow><mrow><mi>C</mi><msubsup><mi>P</mi><mi>k</mi><mo>−</mo></msubsup><msup><mi>C</mi><mi>T</mi></msup><mo>+</mo><mi>R</mi></mrow></mfrac></mrow></mstyle></math></span></span><script type="math/tex" id="MathJax-Element-109">K_k=\Large{\frac{P^-_kC^T}{CP^-_kC^T+R}}</script></span>&nbsp; ———–&nbsp; (3k)</p>
<p><span style="color: #8633ff;"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-110-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mover&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;&amp;#x005E;&lt;/mo&gt;&lt;/mover&gt;&lt;/mrow&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;msubsup&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mover&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;&amp;#x005E;&lt;/mo&gt;&lt;/mover&gt;&lt;/mrow&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;/msubsup&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;K&lt;/mi&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mi&gt;C&lt;/mi&gt;&lt;msubsup&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mover&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;&amp;#x005E;&lt;/mo&gt;&lt;/mover&gt;&lt;/mrow&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;/msubsup&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-4944" style="width: 13.651em; display: inline-block;"><span style="display: inline-block; position: relative; width: 10.983em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(1.306em, 1010.86em, 2.795em, -999.997em); top: -2.354em; left: 0em;"><span class="mrow" id="MathJax-Span-4945"><span class="msubsup" id="MathJax-Span-4946"><span style="display: inline-block; position: relative; width: 0.996em; height: 0px;"><span style="position: absolute; clip: rect(3.043em, 1000.5em, 4.159em, -999.997em); top: -3.967em; left: 0em;"><span class="texatom" id="MathJax-Span-4947"><span class="mrow" id="MathJax-Span-4948"><span class="munderover" id="MathJax-Span-4949"><span style="display: inline-block; position: relative; width: 0.561em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.5em, 4.159em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-4950" style="font-family: MathJax_Math-italic;">x</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.105em, 1000.38em, 3.601em, -999.997em); top: -4.029em; left: 0.065em;"><span class="mo" id="MathJax-Span-4951" style="font-family: MathJax_Main;">^</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.561em;"><span class="mi" id="MathJax-Span-4952" style="font-size: 70.7%; font-family: MathJax_Math-italic;">k</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="mo" id="MathJax-Span-4953" style="font-family: MathJax_Main; padding-left: 0.251em;">=</span><span class="msubsup" id="MathJax-Span-4954" style="padding-left: 0.251em;"><span style="display: inline-block; position: relative; width: 1.182em; height: 0px;"><span style="position: absolute; clip: rect(3.043em, 1000.5em, 4.159em, -999.997em); top: -3.967em; left: 0em;"><span class="texatom" id="MathJax-Span-4955"><span class="mrow" id="MathJax-Span-4956"><span class="munderover" id="MathJax-Span-4957"><span style="display: inline-block; position: relative; width: 0.561em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.5em, 4.159em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-4958" style="font-family: MathJax_Math-italic;">x</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.105em, 1000.38em, 3.601em, -999.997em); top: -4.029em; left: 0.065em;"><span class="mo" id="MathJax-Span-4959" style="font-family: MathJax_Main;">^</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.353em, 1000.62em, 4.221em, -999.997em); top: -4.463em; left: 0.561em;"><span class="mo" id="MathJax-Span-4960" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.291em, 1000.44em, 4.159em, -999.997em); top: -3.719em; left: 0.561em;"><span class="mi" id="MathJax-Span-4961" style="font-size: 70.7%; font-family: MathJax_Math-italic;">k</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="mo" id="MathJax-Span-4962" style="font-family: MathJax_Main; padding-left: 0.251em;">+</span><span class="msubsup" id="MathJax-Span-4963" style="padding-left: 0.251em;"><span style="display: inline-block; position: relative; width: 1.306em; height: 0px;"><span style="position: absolute; clip: rect(3.105em, 1000.87em, 4.159em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-4964" style="font-family: MathJax_Math-italic;">K<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.065em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.872em;"><span class="mi" id="MathJax-Span-4965" style="font-size: 70.7%; font-family: MathJax_Math-italic;">k</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="mo" id="MathJax-Span-4966" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-4967"><span style="display: inline-block; position: relative; width: 0.934em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.5em, 4.346em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-4968" style="font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.499em;"><span class="mi" id="MathJax-Span-4969" style="font-size: 70.7%; font-family: MathJax_Math-italic;">k</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="mo" id="MathJax-Span-4970" style="font-family: MathJax_Main; padding-left: 0.251em;">−</span><span class="mi" id="MathJax-Span-4971" style="font-family: MathJax_Math-italic; padding-left: 0.251em;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.065em;"></span></span><span class="msubsup" id="MathJax-Span-4972"><span style="display: inline-block; position: relative; width: 1.182em; height: 0px;"><span style="position: absolute; clip: rect(3.043em, 1000.5em, 4.159em, -999.997em); top: -3.967em; left: 0em;"><span class="texatom" id="MathJax-Span-4973"><span class="mrow" id="MathJax-Span-4974"><span class="munderover" id="MathJax-Span-4975"><span style="display: inline-block; position: relative; width: 0.561em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.5em, 4.159em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-4976" style="font-family: MathJax_Math-italic;">x</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.105em, 1000.38em, 3.601em, -999.997em); top: -4.029em; left: 0.065em;"><span class="mo" id="MathJax-Span-4977" style="font-family: MathJax_Main;">^</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.353em, 1000.62em, 4.221em, -999.997em); top: -4.463em; left: 0.561em;"><span class="mo" id="MathJax-Span-4978" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.291em, 1000.44em, 4.159em, -999.997em); top: -3.719em; left: 0.561em;"><span class="mi" id="MathJax-Span-4979" style="font-size: 70.7%; font-family: MathJax_Math-italic;">k</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="mo" id="MathJax-Span-4980" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.36em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.381em; border-left: 0px solid; width: 0px; height: 1.619em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mrow class="MJX-TeXAtom-ORD"><mover><mi>x</mi><mo stretchy="false">^</mo></mover></mrow><mi>k</mi></msub><mo>=</mo><msubsup><mrow class="MJX-TeXAtom-ORD"><mover><mi>x</mi><mo stretchy="false">^</mo></mover></mrow><mi>k</mi><mo>−</mo></msubsup><mo>+</mo><msub><mi>K</mi><mi>k</mi></msub><mo stretchy="false">(</mo><msub><mi>y</mi><mi>k</mi></msub><mo>−</mo><mi>C</mi><msubsup><mrow class="MJX-TeXAtom-ORD"><mover><mi>x</mi><mo stretchy="false">^</mo></mover></mrow><mi>k</mi><mo>−</mo></msubsup><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-110">\hat{x}_k=\hat{x}^-_k+K_k(y_k-C\hat{x}^-_k)</script></span>&nbsp; ———–&nbsp; (4k)</p>
<p><span style="color: #8633ff;"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-111-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;P&lt;/mi&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;I&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;K&lt;/mi&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;/msub&gt;&lt;mi&gt;C&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;msubsup&gt;&lt;mi&gt;P&lt;/mi&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;/msubsup&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-4981" style="width: 10.549em; display: inline-block;"><span style="display: inline-block; position: relative; width: 8.502em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(1.368em, 1008.5em, 2.857em, -999.997em); top: -2.354em; left: 0em;"><span class="mrow" id="MathJax-Span-4982"><span class="msubsup" id="MathJax-Span-4983"><span style="display: inline-block; position: relative; width: 1.058em; height: 0px;"><span style="position: absolute; clip: rect(3.105em, 1000.75em, 4.159em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-4984" style="font-family: MathJax_Math-italic;">P<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.127em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.623em;"><span class="mi" id="MathJax-Span-4985" style="font-size: 70.7%; font-family: MathJax_Math-italic;">k</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="mo" id="MathJax-Span-4986" style="font-family: MathJax_Main; padding-left: 0.251em;">=</span><span class="mo" id="MathJax-Span-4987" style="font-family: MathJax_Main; padding-left: 0.251em;">(</span><span class="mi" id="MathJax-Span-4988" style="font-family: MathJax_Math-italic;">I<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.065em;"></span></span><span class="mo" id="MathJax-Span-4989" style="font-family: MathJax_Main; padding-left: 0.251em;">−</span><span class="msubsup" id="MathJax-Span-4990" style="padding-left: 0.251em;"><span style="display: inline-block; position: relative; width: 1.306em; height: 0px;"><span style="position: absolute; clip: rect(3.105em, 1000.87em, 4.159em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-4991" style="font-family: MathJax_Math-italic;">K<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.065em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.872em;"><span class="mi" id="MathJax-Span-4992" style="font-size: 70.7%; font-family: MathJax_Math-italic;">k</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="mi" id="MathJax-Span-4993" style="font-family: MathJax_Math-italic;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.065em;"></span></span><span class="mo" id="MathJax-Span-4994" style="font-family: MathJax_Main;">)</span><span class="msubsup" id="MathJax-Span-4995"><span style="display: inline-block; position: relative; width: 1.492em; height: 0px;"><span style="position: absolute; clip: rect(3.105em, 1000.75em, 4.159em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-4996" style="font-family: MathJax_Math-italic;">P<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.127em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.353em, 1000.62em, 4.221em, -999.997em); top: -4.339em; left: 0.81em;"><span class="mo" id="MathJax-Span-4997" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.291em, 1000.44em, 4.159em, -999.997em); top: -3.657em; left: 0.623em;"><span class="mi" id="MathJax-Span-4998" style="font-size: 70.7%; font-family: MathJax_Math-italic;">k</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.36em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.458em; border-left: 0px solid; width: 0px; height: 1.619em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>P</mi><mi>k</mi></msub><mo>=</mo><mo stretchy="false">(</mo><mi>I</mi><mo>−</mo><msub><mi>K</mi><mi>k</mi></msub><mi>C</mi><mo stretchy="false">)</mo><msubsup><mi>P</mi><mi>k</mi><mo>−</mo></msubsup></math></span></span><script type="math/tex" id="MathJax-Element-111">P_k=(I-K_kC)P^-_k</script></span>&nbsp; ———–&nbsp; (5k)</p>
<p><span style="color: #8633ff;">where</span><br>
<span style="color: #8633ff;"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-112-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-4999" style="width: 1.182em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.934em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(1.74em, 1000.93em, 2.733em, -999.997em); top: -2.354em; left: 0em;"><span class="mrow" id="MathJax-Span-5000"><span class="msubsup" id="MathJax-Span-5001"><span style="display: inline-block; position: relative; width: 0.934em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.5em, 4.346em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-5002" style="font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.499em;"><span class="mi" id="MathJax-Span-5003" style="font-size: 70.7%; font-family: MathJax_Math-italic;">k</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.36em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.304em; border-left: 0px solid; width: 0px; height: 0.927em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>y</mi><mi>k</mi></msub></math></span></span><script type="math/tex" id="MathJax-Element-112">y_k</script> is the actual measured state</span><br>
<span style="color: #8633ff;"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-113-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mover&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;&amp;#x005E;&lt;/mo&gt;&lt;/mover&gt;&lt;/mrow&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-5004" style="width: 1.244em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.996em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(1.43em, 1001em, 2.733em, -999.997em); top: -2.354em; left: 0em;"><span class="mrow" id="MathJax-Span-5005"><span class="msubsup" id="MathJax-Span-5006"><span style="display: inline-block; position: relative; width: 0.996em; height: 0px;"><span style="position: absolute; clip: rect(3.043em, 1000.5em, 4.159em, -999.997em); top: -3.967em; left: 0em;"><span class="texatom" id="MathJax-Span-5007"><span class="mrow" id="MathJax-Span-5008"><span class="munderover" id="MathJax-Span-5009"><span style="display: inline-block; position: relative; width: 0.561em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.5em, 4.159em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-5010" style="font-family: MathJax_Math-italic;">x</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.105em, 1000.38em, 3.601em, -999.997em); top: -4.029em; left: 0.065em;"><span class="mo" id="MathJax-Span-5011" style="font-family: MathJax_Main;">^</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.561em;"><span class="mi" id="MathJax-Span-5012" style="font-size: 70.7%; font-family: MathJax_Math-italic;">k</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.36em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.304em; border-left: 0px solid; width: 0px; height: 1.312em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mrow class="MJX-TeXAtom-ORD"><mover><mi>x</mi><mo stretchy="false">^</mo></mover></mrow><mi>k</mi></msub></math></span></span><script type="math/tex" id="MathJax-Element-113">\hat{x}_k</script> is the posteri estimate of x at time step <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-114-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-5013" style="width: 0.623em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.499em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(1.492em, 1000.5em, 2.547em, -999.997em); top: -2.354em; left: 0em;"><span class="mrow" id="MathJax-Span-5014"><span class="mi" id="MathJax-Span-5015" style="font-family: MathJax_Math-italic;">k</span></span><span style="display: inline-block; width: 0px; height: 2.36em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.073em; border-left: 0px solid; width: 0px; height: 1.004em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>k</mi></math></span></span><script type="math/tex" id="MathJax-Element-114">k</script></span><br>
<span style="color: #8633ff;"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-115-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;P&lt;/mi&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-5016" style="width: 1.306em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.058em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(1.492em, 1001.06em, 2.733em, -999.997em); top: -2.354em; left: 0em;"><span class="mrow" id="MathJax-Span-5017"><span class="msubsup" id="MathJax-Span-5018"><span style="display: inline-block; position: relative; width: 1.058em; height: 0px;"><span style="position: absolute; clip: rect(3.105em, 1000.75em, 4.159em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-5019" style="font-family: MathJax_Math-italic;">P<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.127em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.623em;"><span class="mi" id="MathJax-Span-5020" style="font-size: 70.7%; font-family: MathJax_Math-italic;">k</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.36em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.304em; border-left: 0px solid; width: 0px; height: 1.235em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>P</mi><mi>k</mi></msub></math></span></span><script type="math/tex" id="MathJax-Element-115">P_k</script> is the posteri estimate of the error at time step <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-116-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-5021" style="width: 0.623em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.499em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(1.492em, 1000.5em, 2.547em, -999.997em); top: -2.354em; left: 0em;"><span class="mrow" id="MathJax-Span-5022"><span class="mi" id="MathJax-Span-5023" style="font-family: MathJax_Math-italic;">k</span></span><span style="display: inline-block; width: 0px; height: 2.36em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.073em; border-left: 0px solid; width: 0px; height: 1.004em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>k</mi></math></span></span><script type="math/tex" id="MathJax-Element-116">k</script></span><br>
<span style="color: #8633ff;"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-117-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;K&lt;/mi&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-5024" style="width: 1.616em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.306em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(1.492em, 1001.31em, 2.733em, -999.997em); top: -2.354em; left: 0em;"><span class="mrow" id="MathJax-Span-5025"><span class="msubsup" id="MathJax-Span-5026"><span style="display: inline-block; position: relative; width: 1.306em; height: 0px;"><span style="position: absolute; clip: rect(3.105em, 1000.87em, 4.159em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-5027" style="font-family: MathJax_Math-italic;">K<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.065em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.872em;"><span class="mi" id="MathJax-Span-5028" style="font-size: 70.7%; font-family: MathJax_Math-italic;">k</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.36em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.304em; border-left: 0px solid; width: 0px; height: 1.235em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>K</mi><mi>k</mi></msub></math></span></span><script type="math/tex" id="MathJax-Element-117">K_k</script> is the kalman gain at time step <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-118-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-5029" style="width: 0.623em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.499em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(1.492em, 1000.5em, 2.547em, -999.997em); top: -2.354em; left: 0em;"><span class="mrow" id="MathJax-Span-5030"><span class="mi" id="MathJax-Span-5031" style="font-family: MathJax_Math-italic;">k</span></span><span style="display: inline-block; width: 0px; height: 2.36em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.073em; border-left: 0px solid; width: 0px; height: 1.004em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>k</mi></math></span></span><script type="math/tex" id="MathJax-Element-118">k</script></span><br>
<span style="color: #8633ff;"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-119-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;R&lt;/mi&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-5032" style="width: 0.934em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.748em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(1.492em, 1000.75em, 2.547em, -999.997em); top: -2.354em; left: 0em;"><span class="mrow" id="MathJax-Span-5033"><span class="mi" id="MathJax-Span-5034" style="font-family: MathJax_Math-italic;">R</span></span><span style="display: inline-block; width: 0px; height: 2.36em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.073em; border-left: 0px solid; width: 0px; height: 1.004em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>R</mi></math></span></span><script type="math/tex" id="MathJax-Element-119">R</script> is the measurement variance</span></p>
<p>※The other parameters in equation 1 to 5 (such as the constants A, B and C) will be described in detail in below.</p>
<p>Let us go through the equations in order.</p>
<p><strong><span style="text-decoration: underline; color: #338aff;">Prediction</span></strong></p>
<p><span style="text-decoration: underline; color: #338aff;">Equation 1k</span></p>
<p><span style="color: #338aff;"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-120-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msubsup&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mover&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;&amp;#x005E;&lt;/mo&gt;&lt;/mover&gt;&lt;/mrow&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;/msubsup&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;A&lt;/mi&gt;&lt;msub&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mover&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;&amp;#x005E;&lt;/mo&gt;&lt;/mover&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mi&gt;B&lt;/mi&gt;&lt;msub&gt;&lt;mi&gt;u&lt;/mi&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-5035" style="width: 10.177em; display: inline-block;"><span style="display: inline-block; position: relative; width: 8.192em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(1.306em, 1008.19em, 2.795em, -999.997em); top: -2.354em; left: 0em;"><span class="mrow" id="MathJax-Span-5036"><span class="msubsup" id="MathJax-Span-5037"><span style="display: inline-block; position: relative; width: 1.182em; height: 0px;"><span style="position: absolute; clip: rect(3.043em, 1000.5em, 4.159em, -999.997em); top: -3.967em; left: 0em;"><span class="texatom" id="MathJax-Span-5038"><span class="mrow" id="MathJax-Span-5039"><span class="munderover" id="MathJax-Span-5040"><span style="display: inline-block; position: relative; width: 0.561em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.5em, 4.159em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-5041" style="font-family: MathJax_Math-italic;">x</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.105em, 1000.38em, 3.601em, -999.997em); top: -4.029em; left: 0.065em;"><span class="mo" id="MathJax-Span-5042" style="font-family: MathJax_Main;">^</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.353em, 1000.62em, 4.221em, -999.997em); top: -4.463em; left: 0.561em;"><span class="mo" id="MathJax-Span-5043" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.291em, 1000.44em, 4.159em, -999.997em); top: -3.719em; left: 0.561em;"><span class="mi" id="MathJax-Span-5044" style="font-size: 70.7%; font-family: MathJax_Math-italic;">k</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="mo" id="MathJax-Span-5045" style="font-family: MathJax_Main; padding-left: 0.251em;">=</span><span class="mi" id="MathJax-Span-5046" style="font-family: MathJax_Math-italic; padding-left: 0.251em;">A</span><span class="msubsup" id="MathJax-Span-5047"><span style="display: inline-block; position: relative; width: 1.926em; height: 0px;"><span style="position: absolute; clip: rect(3.043em, 1000.5em, 4.159em, -999.997em); top: -3.967em; left: 0em;"><span class="texatom" id="MathJax-Span-5048"><span class="mrow" id="MathJax-Span-5049"><span class="munderover" id="MathJax-Span-5050"><span style="display: inline-block; position: relative; width: 0.561em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.5em, 4.159em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-5051" style="font-family: MathJax_Math-italic;">x</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.105em, 1000.38em, 3.601em, -999.997em); top: -4.029em; left: 0.065em;"><span class="mo" id="MathJax-Span-5052" style="font-family: MathJax_Main;">^</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.561em;"><span class="texatom" id="MathJax-Span-5053"><span class="mrow" id="MathJax-Span-5054"><span class="mi" id="MathJax-Span-5055" style="font-size: 70.7%; font-family: MathJax_Math-italic;">k</span><span class="mo" id="MathJax-Span-5056" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="mn" id="MathJax-Span-5057" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="mo" id="MathJax-Span-5058" style="font-family: MathJax_Main; padding-left: 0.251em;">+</span><span class="mi" id="MathJax-Span-5059" style="font-family: MathJax_Math-italic; padding-left: 0.251em;">B</span><span class="msubsup" id="MathJax-Span-5060"><span style="display: inline-block; position: relative; width: 0.996em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.56em, 4.159em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-5061" style="font-family: MathJax_Math-italic;">u</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.561em;"><span class="mi" id="MathJax-Span-5062" style="font-size: 70.7%; font-family: MathJax_Math-italic;">k</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.36em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.381em; border-left: 0px solid; width: 0px; height: 1.619em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msubsup><mrow class="MJX-TeXAtom-ORD"><mover><mi>x</mi><mo stretchy="false">^</mo></mover></mrow><mi>k</mi><mo>−</mo></msubsup><mo>=</mo><mi>A</mi><msub><mrow class="MJX-TeXAtom-ORD"><mover><mi>x</mi><mo stretchy="false">^</mo></mover></mrow><mrow class="MJX-TeXAtom-ORD"><mi>k</mi><mo>−</mo><mn>1</mn></mrow></msub><mo>+</mo><mi>B</mi><msub><mi>u</mi><mi>k</mi></msub></math></span></span><script type="math/tex" id="MathJax-Element-120">\hat{x}^-_k=A\hat{x}_{k-1}+Bu_k</script></span>&nbsp; ———–&nbsp; (1k)</p>
<p>If you know the kalman filter well, you would have realized that we have derived this equation already in the earlier part of this post. Below is a copy of the equation (7) from the <a href="https://thepoorengineer.com/en/category/projects/attitude-determination-with-quaternion-using-ekf/#KalmanStates">kalman filter states</a> section above except that I replace <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-121-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-5063" style="width: 0.623em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.499em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(1.492em, 1000.5em, 2.547em, -999.997em); top: -2.354em; left: 0em;"><span class="mrow" id="MathJax-Span-5064"><span class="mi" id="MathJax-Span-5065" style="font-family: MathJax_Math-italic;">k</span></span><span style="display: inline-block; width: 0px; height: 2.36em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.073em; border-left: 0px solid; width: 0px; height: 1.004em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>k</mi></math></span></span><script type="math/tex" id="MathJax-Element-121">k</script> with <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-122-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-5066" style="width: 2.857em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.298em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(1.492em, 1002.24em, 2.609em, -999.997em); top: -2.354em; left: 0em;"><span class="mrow" id="MathJax-Span-5067"><span class="mi" id="MathJax-Span-5068" style="font-family: MathJax_Math-italic;">k</span><span class="mo" id="MathJax-Span-5069" style="font-family: MathJax_Main; padding-left: 0.251em;">−</span><span class="mn" id="MathJax-Span-5070" style="font-family: MathJax_Main; padding-left: 0.251em;">1</span></span><span style="display: inline-block; width: 0px; height: 2.36em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.15em; border-left: 0px solid; width: 0px; height: 1.158em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>k</mi><mo>−</mo><mn>1</mn></math></span></span><script type="math/tex" id="MathJax-Element-122">k-1</script>.</p>
<p><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-123-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mrow&gt;&lt;mo&gt;[&lt;/mo&gt;&lt;mtable rowspacing=&quot;4pt&quot; columnspacing=&quot;1em&quot;&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;msup&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;mi&gt;g&lt;/mi&gt;&lt;/msup&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;/mtable&gt;&lt;mo&gt;]&lt;/mo&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;msub&gt;&lt;mrow&gt;&lt;mo&gt;[&lt;/mo&gt;&lt;mtable rowspacing=&quot;4pt&quot; columnspacing=&quot;1em&quot;&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mi&gt;I&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mn&gt;4&lt;/mn&gt;&lt;mo&gt;&amp;#xD7;&lt;/mo&gt;&lt;mn&gt;4&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mo&gt;&amp;#x2013;&lt;/mo&gt;&lt;mfrac&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/mfrac&gt;&lt;mi&gt;S&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mn&gt;3&lt;/mn&gt;&lt;mo&gt;&amp;#xD7;&lt;/mo&gt;&lt;mn&gt;4&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mi&gt;I&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mn&gt;3&lt;/mn&gt;&lt;mo&gt;&amp;#xD7;&lt;/mo&gt;&lt;mn&gt;3&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;/mtable&gt;&lt;mo&gt;]&lt;/mo&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;msub&gt;&lt;mrow&gt;&lt;mo&gt;[&lt;/mo&gt;&lt;mtable rowspacing=&quot;4pt&quot; columnspacing=&quot;1em&quot;&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;msup&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;mi&gt;g&lt;/mi&gt;&lt;/msup&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;/mtable&gt;&lt;mo&gt;]&lt;/mo&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;msub&gt;&lt;mrow&gt;&lt;mo&gt;[&lt;/mo&gt;&lt;mtable rowspacing=&quot;4pt&quot; columnspacing=&quot;1em&quot;&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mfrac&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/mfrac&gt;&lt;mi&gt;S&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mn&gt;3&lt;/mn&gt;&lt;mo&gt;&amp;#xD7;&lt;/mo&gt;&lt;mn&gt;3&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;/mtable&gt;&lt;mo&gt;]&lt;/mo&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;msub&gt;&lt;mi&gt;w&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-5071" style="width: 32.013em; display: inline-block;"><span style="display: inline-block; position: relative; width: 25.81em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(0.437em, 1025.81em, 3.911em, -999.997em); top: -2.354em; left: 0em;"><span class="mrow" id="MathJax-Span-5072"><span class="msubsup" id="MathJax-Span-5073"><span style="display: inline-block; position: relative; width: 2.733em; height: 0px;"><span style="position: absolute; clip: rect(2.36em, 1002.05em, 5.09em, -999.997em); top: -3.967em; left: 0em;"><span class="mrow" id="MathJax-Span-5074"><span class="mo" id="MathJax-Span-5075" style="vertical-align: 0em;"><span style="font-family: MathJax_Size3;">[</span></span><span class="mtable" id="MathJax-Span-5076" style="padding-right: 0.189em; padding-left: 0.189em;"><span style="display: inline-block; position: relative; width: 0.872em; height: 0px;"><span style="position: absolute; clip: rect(2.671em, 1000.87em, 4.904em, -999.997em); top: -3.967em; left: 0em;"><span style="display: inline-block; position: relative; width: 0.872em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.44em, 4.346em, -999.997em); top: -4.587em; left: 50%; margin-left: -0.245em;"><span class="mtd" id="MathJax-Span-5077"><span class="mrow" id="MathJax-Span-5078"><span class="mi" id="MathJax-Span-5079" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.105em, 1000.87em, 4.159em, -999.997em); top: -3.223em; left: 50%; margin-left: -0.431em;"><span class="mtd" id="MathJax-Span-5080"><span class="mrow" id="MathJax-Span-5081"><span class="msubsup" id="MathJax-Span-5082"><span style="display: inline-block; position: relative; width: 0.872em; height: 0px;"><span style="position: absolute; clip: rect(3.105em, 1000.44em, 4.159em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-5083" style="font-family: MathJax_Math-italic;">b</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -4.339em; left: 0.437em;"><span class="mi" id="MathJax-Span-5084" style="font-size: 70.7%; font-family: MathJax_Math-italic;">g<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="mo" id="MathJax-Span-5085" style="vertical-align: 0em;"><span style="font-family: MathJax_Size3;">]</span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -2.975em; left: 2.298em;"><span class="texatom" id="MathJax-Span-5086"><span class="mrow" id="MathJax-Span-5087"><span class="mi" id="MathJax-Span-5088" style="font-size: 70.7%; font-family: MathJax_Math-italic;">k</span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="mo" id="MathJax-Span-5089" style="font-family: MathJax_Main; padding-left: 0.251em;">=</span><span class="msubsup" id="MathJax-Span-5090" style="padding-left: 0.251em;"><span style="display: inline-block; position: relative; width: 9.184em; height: 0px;"><span style="position: absolute; clip: rect(2.05em, 1007.51em, 5.4em, -999.997em); top: -3.967em; left: 0em;"><span class="mrow" id="MathJax-Span-5091"><span class="mo" id="MathJax-Span-5092" style="vertical-align: 0em;"><span style="font-family: MathJax_Size4;">[</span></span><span class="mtable" id="MathJax-Span-5093" style="padding-right: 0.189em; padding-left: 0.189em;"><span style="display: inline-block; position: relative; width: 6.269em; height: 0px;"><span style="position: absolute; clip: rect(2.422em, 1001.86em, 5.214em, -999.997em); top: -3.967em; left: 0em;"><span style="display: inline-block; position: relative; width: 1.864em; height: 0px;"><span style="position: absolute; clip: rect(3.105em, 1001.8em, 4.283em, -999.997em); top: -4.65em; left: 50%; margin-left: -0.865em;"><span class="mtd" id="MathJax-Span-5094"><span class="mrow" id="MathJax-Span-5095"><span class="msubsup" id="MathJax-Span-5096"><span style="display: inline-block; position: relative; width: 1.802em; height: 0px;"><span style="position: absolute; clip: rect(3.105em, 1000.5em, 4.159em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-5097" style="font-family: MathJax_Math-italic;">I<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.065em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.437em;"><span class="texatom" id="MathJax-Span-5098"><span class="mrow" id="MathJax-Span-5099"><span class="mn" id="MathJax-Span-5100" style="font-size: 70.7%; font-family: MathJax_Main;">4</span><span class="mo" id="MathJax-Span-5101" style="font-size: 70.7%; font-family: MathJax_Main;">×</span><span class="mn" id="MathJax-Span-5102" style="font-size: 70.7%; font-family: MathJax_Main;">4</span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.105em, 1001.86em, 4.346em, -999.997em); top: -3.037em; left: 50%; margin-left: -0.927em;"><span class="mtd" id="MathJax-Span-5113"><span class="mrow" id="MathJax-Span-5114"><span class="msubsup" id="MathJax-Span-5115"><span style="display: inline-block; position: relative; width: 1.864em; height: 0px;"><span style="position: absolute; clip: rect(3.105em, 1000.44em, 4.159em, -999.997em); top: -3.967em; left: 0em;"><span class="mn" id="MathJax-Span-5116" style="font-family: MathJax_Main;">0</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.499em;"><span class="texatom" id="MathJax-Span-5117"><span class="mrow" id="MathJax-Span-5118"><span class="mn" id="MathJax-Span-5119" style="font-size: 70.7%; font-family: MathJax_Main;">3</span><span class="mo" id="MathJax-Span-5120" style="font-size: 70.7%; font-family: MathJax_Main;">×</span><span class="mn" id="MathJax-Span-5121" style="font-size: 70.7%; font-family: MathJax_Main;">4</span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(2.174em, 1003.35em, 5.214em, -999.997em); top: -3.967em; left: 2.857em;"><span style="display: inline-block; position: relative; width: 3.415em; height: 0px;"><span style="position: absolute; clip: rect(2.857em, 1003.35em, 4.532em, -999.997em); top: -4.65em; left: 50%; margin-left: -1.734em;"><span class="mtd" id="MathJax-Span-5103"><span class="mrow" id="MathJax-Span-5104"><span class="mo" id="MathJax-Span-5105" style="font-family: MathJax_Main;">–</span><span class="mfrac" id="MathJax-Span-5106" style="padding-left: 0.189em;"><span style="display: inline-block; position: relative; width: 0.623em; height: 0px; margin-right: 0.127em; margin-left: 0.127em;"><span style="position: absolute; clip: rect(3.291em, 1000.5em, 4.159em, -999.997em); top: -4.401em; left: 50%; margin-left: -0.245em;"><span class="mi" id="MathJax-Span-5107" style="font-size: 70.7%; font-family: MathJax_Math-italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.065em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.291em, 1000.31em, 4.159em, -999.997em); top: -3.595em; left: 50%; margin-left: -0.183em;"><span class="mn" id="MathJax-Span-5108" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(0.81em, 1000.62em, 1.244em, -999.997em); top: -1.3em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 0.623em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.058em;"></span></span></span></span><span class="mi" id="MathJax-Span-5109" style="font-family: MathJax_Math-italic;">S<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.065em;"></span></span><span class="mo" id="MathJax-Span-5110" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-5111" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-5112" style="font-family: MathJax_Main;">)</span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.105em, 1001.8em, 4.346em, -999.997em); top: -3.037em; left: 50%; margin-left: -0.865em;"><span class="mtd" id="MathJax-Span-5122"><span class="mrow" id="MathJax-Span-5123"><span class="msubsup" id="MathJax-Span-5124"><span style="display: inline-block; position: relative; width: 1.802em; height: 0px;"><span style="position: absolute; clip: rect(3.105em, 1000.5em, 4.159em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-5125" style="font-family: MathJax_Math-italic;">I<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.065em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.437em;"><span class="texatom" id="MathJax-Span-5126"><span class="mrow" id="MathJax-Span-5127"><span class="mn" id="MathJax-Span-5128" style="font-size: 70.7%; font-family: MathJax_Main;">3</span><span class="mo" id="MathJax-Span-5129" style="font-size: 70.7%; font-family: MathJax_Main;">×</span><span class="mn" id="MathJax-Span-5130" style="font-size: 70.7%; font-family: MathJax_Main;">3</span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="mo" id="MathJax-Span-5131" style="vertical-align: 0em;"><span style="font-family: MathJax_Size4;">]</span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -2.664em; left: 7.819em;"><span class="texatom" id="MathJax-Span-5132"><span class="mrow" id="MathJax-Span-5133"><span class="mi" id="MathJax-Span-5134" style="font-size: 70.7%; font-family: MathJax_Math-italic;">k</span><span class="mo" id="MathJax-Span-5135" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="mn" id="MathJax-Span-5136" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-5137"><span style="display: inline-block; position: relative; width: 3.601em; height: 0px;"><span style="position: absolute; clip: rect(2.36em, 1002.05em, 5.09em, -999.997em); top: -3.967em; left: 0em;"><span class="mrow" id="MathJax-Span-5138"><span class="mo" id="MathJax-Span-5139" style="vertical-align: 0em;"><span style="font-family: MathJax_Size3;">[</span></span><span class="mtable" id="MathJax-Span-5140" style="padding-right: 0.189em; padding-left: 0.189em;"><span style="display: inline-block; position: relative; width: 0.872em; height: 0px;"><span style="position: absolute; clip: rect(2.671em, 1000.87em, 4.904em, -999.997em); top: -3.967em; left: 0em;"><span style="display: inline-block; position: relative; width: 0.872em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.44em, 4.346em, -999.997em); top: -4.587em; left: 50%; margin-left: -0.245em;"><span class="mtd" id="MathJax-Span-5141"><span class="mrow" id="MathJax-Span-5142"><span class="mi" id="MathJax-Span-5143" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.105em, 1000.87em, 4.159em, -999.997em); top: -3.223em; left: 50%; margin-left: -0.431em;"><span class="mtd" id="MathJax-Span-5144"><span class="mrow" id="MathJax-Span-5145"><span class="msubsup" id="MathJax-Span-5146"><span style="display: inline-block; position: relative; width: 0.872em; height: 0px;"><span style="position: absolute; clip: rect(3.105em, 1000.44em, 4.159em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-5147" style="font-family: MathJax_Math-italic;">b</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -4.339em; left: 0.437em;"><span class="mi" id="MathJax-Span-5148" style="font-size: 70.7%; font-family: MathJax_Math-italic;">g<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="mo" id="MathJax-Span-5149" style="vertical-align: 0em;"><span style="font-family: MathJax_Size3;">]</span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -2.975em; left: 2.298em;"><span class="texatom" id="MathJax-Span-5150"><span class="mrow" id="MathJax-Span-5151"><span class="mi" id="MathJax-Span-5152" style="font-size: 70.7%; font-family: MathJax_Math-italic;">k</span><span class="mo" id="MathJax-Span-5153" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="mn" id="MathJax-Span-5154" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="mo" id="MathJax-Span-5155" style="font-family: MathJax_Main; padding-left: 0.251em;">+</span><span class="msubsup" id="MathJax-Span-5156" style="padding-left: 0.251em;"><span style="display: inline-block; position: relative; width: 5.648em; height: 0px;"><span style="position: absolute; clip: rect(2.05em, 1004.03em, 5.4em, -999.997em); top: -3.967em; left: 0em;"><span class="mrow" id="MathJax-Span-5157"><span class="mo" id="MathJax-Span-5158" style="vertical-align: 0em;"><span style="font-family: MathJax_Size4;">[</span></span><span class="mtable" id="MathJax-Span-5159" style="padding-right: 0.189em; padding-left: 0.189em;"><span style="display: inline-block; position: relative; width: 2.733em; height: 0px;"><span style="position: absolute; clip: rect(2.174em, 1002.67em, 5.214em, -999.997em); top: -3.967em; left: 0em;"><span style="display: inline-block; position: relative; width: 2.733em; height: 0px;"><span style="position: absolute; clip: rect(2.857em, 1002.67em, 4.532em, -999.997em); top: -4.65em; left: 50%; margin-left: -1.362em;"><span class="mtd" id="MathJax-Span-5160"><span class="mrow" id="MathJax-Span-5161"><span class="mfrac" id="MathJax-Span-5162"><span style="display: inline-block; position: relative; width: 0.623em; height: 0px; margin-right: 0.127em; margin-left: 0.127em;"><span style="position: absolute; clip: rect(3.291em, 1000.5em, 4.159em, -999.997em); top: -4.401em; left: 50%; margin-left: -0.245em;"><span class="mi" id="MathJax-Span-5163" style="font-size: 70.7%; font-family: MathJax_Math-italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.065em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.291em, 1000.31em, 4.159em, -999.997em); top: -3.595em; left: 50%; margin-left: -0.183em;"><span class="mn" id="MathJax-Span-5164" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(0.81em, 1000.62em, 1.244em, -999.997em); top: -1.3em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 0.623em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.058em;"></span></span></span></span><span class="mi" id="MathJax-Span-5165" style="font-family: MathJax_Math-italic;">S<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.065em;"></span></span><span class="mo" id="MathJax-Span-5166" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-5167" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-5168" style="font-family: MathJax_Main;">)</span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.105em, 1001.86em, 4.346em, -999.997em); top: -3.037em; left: 50%; margin-left: -0.927em;"><span class="mtd" id="MathJax-Span-5169"><span class="mrow" id="MathJax-Span-5170"><span class="msubsup" id="MathJax-Span-5171"><span style="display: inline-block; position: relative; width: 1.864em; height: 0px;"><span style="position: absolute; clip: rect(3.105em, 1000.44em, 4.159em, -999.997em); top: -3.967em; left: 0em;"><span class="mn" id="MathJax-Span-5172" style="font-family: MathJax_Main;">0</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.499em;"><span class="texatom" id="MathJax-Span-5173"><span class="mrow" id="MathJax-Span-5174"><span class="mn" id="MathJax-Span-5175" style="font-size: 70.7%; font-family: MathJax_Main;">3</span><span class="mo" id="MathJax-Span-5176" style="font-size: 70.7%; font-family: MathJax_Main;">×</span><span class="mn" id="MathJax-Span-5177" style="font-size: 70.7%; font-family: MathJax_Main;">3</span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="mo" id="MathJax-Span-5178" style="vertical-align: 0em;"><span style="font-family: MathJax_Size4;">]</span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -2.664em; left: 4.283em;"><span class="texatom" id="MathJax-Span-5179"><span class="mrow" id="MathJax-Span-5180"><span class="mi" id="MathJax-Span-5181" style="font-size: 70.7%; font-family: MathJax_Math-italic;">k</span><span class="mo" id="MathJax-Span-5182" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="mn" id="MathJax-Span-5183" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-5184"><span style="display: inline-block; position: relative; width: 2.05em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.68em, 4.159em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-5185" style="font-family: MathJax_Math-italic;">w</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.748em;"><span class="texatom" id="MathJax-Span-5186"><span class="mrow" id="MathJax-Span-5187"><span class="mi" id="MathJax-Span-5188" style="font-size: 70.7%; font-family: MathJax_Math-italic;">k</span><span class="mo" id="MathJax-Span-5189" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="mn" id="MathJax-Span-5190" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.36em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -1.765em; border-left: 0px solid; width: 0px; height: 4.004em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mrow><mo>[</mo><mtable rowspacing="4pt" columnspacing="1em"><mtr><mtd><mi>q</mi></mtd></mtr><mtr><mtd><msup><mi>b</mi><mi>g</mi></msup></mtd></mtr></mtable><mo>]</mo></mrow><mrow class="MJX-TeXAtom-ORD"><mi>k</mi></mrow></msub><mo>=</mo><msub><mrow><mo>[</mo><mtable rowspacing="4pt" columnspacing="1em"><mtr><mtd><msub><mi>I</mi><mrow class="MJX-TeXAtom-ORD"><mn>4</mn><mo>×</mo><mn>4</mn></mrow></msub></mtd><mtd><mo>–</mo><mfrac><mi>T</mi><mn>2</mn></mfrac><mi>S</mi><mo stretchy="false">(</mo><mi>q</mi><mo stretchy="false">)</mo></mtd></mtr><mtr><mtd><msub><mn>0</mn><mrow class="MJX-TeXAtom-ORD"><mn>3</mn><mo>×</mo><mn>4</mn></mrow></msub></mtd><mtd><msub><mi>I</mi><mrow class="MJX-TeXAtom-ORD"><mn>3</mn><mo>×</mo><mn>3</mn></mrow></msub></mtd></mtr></mtable><mo>]</mo></mrow><mrow class="MJX-TeXAtom-ORD"><mi>k</mi><mo>−</mo><mn>1</mn></mrow></msub><msub><mrow><mo>[</mo><mtable rowspacing="4pt" columnspacing="1em"><mtr><mtd><mi>q</mi></mtd></mtr><mtr><mtd><msup><mi>b</mi><mi>g</mi></msup></mtd></mtr></mtable><mo>]</mo></mrow><mrow class="MJX-TeXAtom-ORD"><mi>k</mi><mo>−</mo><mn>1</mn></mrow></msub><mo>+</mo><msub><mrow><mo>[</mo><mtable rowspacing="4pt" columnspacing="1em"><mtr><mtd><mfrac><mi>T</mi><mn>2</mn></mfrac><mi>S</mi><mo stretchy="false">(</mo><mi>q</mi><mo stretchy="false">)</mo></mtd></mtr><mtr><mtd><msub><mn>0</mn><mrow class="MJX-TeXAtom-ORD"><mn>3</mn><mo>×</mo><mn>3</mn></mrow></msub></mtd></mtr></mtable><mo>]</mo></mrow><mrow class="MJX-TeXAtom-ORD"><mi>k</mi><mo>−</mo><mn>1</mn></mrow></msub><msub><mi>w</mi><mrow class="MJX-TeXAtom-ORD"><mi>k</mi><mo>−</mo><mn>1</mn></mrow></msub></math></span></span><script type="math/tex" id="MathJax-Element-123">\begin{bmatrix} q \\ b^g \end{bmatrix}_{k} = \begin{bmatrix} I_{4×4} & – \frac{T}{2}S(q) \\ 0_{3×4} & I_{3×3} \end{bmatrix}_{k-1}\begin{bmatrix} q \\ b^g \end{bmatrix}_{k-1} + \begin{bmatrix} \frac{T}{2}S(q) \\ 0_{3×3} \end{bmatrix}_{k-1}w_{k-1}</script></p>
<p>From the above equation, we can determine our <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-124-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;A&lt;/mi&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-5191" style="width: 0.934em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.748em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(1.43em, 1000.75em, 2.547em, -999.997em); top: -2.354em; left: 0em;"><span class="mrow" id="MathJax-Span-5192"><span class="mi" id="MathJax-Span-5193" style="font-family: MathJax_Math-italic;">A</span></span><span style="display: inline-block; width: 0px; height: 2.36em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.073em; border-left: 0px solid; width: 0px; height: 1.081em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>A</mi></math></span></span><script type="math/tex" id="MathJax-Element-124">A</script> and <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-125-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;B&lt;/mi&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-5194" style="width: 0.934em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.748em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(1.492em, 1000.75em, 2.547em, -999.997em); top: -2.354em; left: 0em;"><span class="mrow" id="MathJax-Span-5195"><span class="mi" id="MathJax-Span-5196" style="font-family: MathJax_Math-italic;">B</span></span><span style="display: inline-block; width: 0px; height: 2.36em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.073em; border-left: 0px solid; width: 0px; height: 1.004em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>B</mi></math></span></span><script type="math/tex" id="MathJax-Element-125">B</script> matrices.</p>
<p><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-126-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;A&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;msub&gt;&lt;mrow&gt;&lt;mo&gt;[&lt;/mo&gt;&lt;mtable rowspacing=&quot;4pt&quot; columnspacing=&quot;1em&quot;&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mi&gt;I&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mn&gt;4&lt;/mn&gt;&lt;mo&gt;&amp;#xD7;&lt;/mo&gt;&lt;mn&gt;4&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mo&gt;&amp;#x2013;&lt;/mo&gt;&lt;mfrac&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/mfrac&gt;&lt;mi&gt;S&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mn&gt;3&lt;/mn&gt;&lt;mo&gt;&amp;#xD7;&lt;/mo&gt;&lt;mn&gt;4&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mi&gt;I&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mn&gt;3&lt;/mn&gt;&lt;mo&gt;&amp;#xD7;&lt;/mo&gt;&lt;mn&gt;3&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;/mtable&gt;&lt;mo&gt;]&lt;/mo&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-5197" style="width: 13.961em; display: inline-block;"><span style="display: inline-block; position: relative; width: 11.231em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(0.437em, 1011.23em, 3.911em, -999.997em); top: -2.354em; left: 0em;"><span class="mrow" id="MathJax-Span-5198"><span class="mi" id="MathJax-Span-5199" style="font-family: MathJax_Math-italic;">A</span><span class="mo" id="MathJax-Span-5200" style="font-family: MathJax_Main; padding-left: 0.251em;">=</span><span class="msubsup" id="MathJax-Span-5201" style="padding-left: 0.251em;"><span style="display: inline-block; position: relative; width: 9.184em; height: 0px;"><span style="position: absolute; clip: rect(2.05em, 1007.51em, 5.4em, -999.997em); top: -3.967em; left: 0em;"><span class="mrow" id="MathJax-Span-5202"><span class="mo" id="MathJax-Span-5203" style="vertical-align: 0em;"><span style="font-family: MathJax_Size4;">[</span></span><span class="mtable" id="MathJax-Span-5204" style="padding-right: 0.189em; padding-left: 0.189em;"><span style="display: inline-block; position: relative; width: 6.269em; height: 0px;"><span style="position: absolute; clip: rect(2.422em, 1001.86em, 5.214em, -999.997em); top: -3.967em; left: 0em;"><span style="display: inline-block; position: relative; width: 1.864em; height: 0px;"><span style="position: absolute; clip: rect(3.105em, 1001.8em, 4.283em, -999.997em); top: -4.65em; left: 50%; margin-left: -0.865em;"><span class="mtd" id="MathJax-Span-5205"><span class="mrow" id="MathJax-Span-5206"><span class="msubsup" id="MathJax-Span-5207"><span style="display: inline-block; position: relative; width: 1.802em; height: 0px;"><span style="position: absolute; clip: rect(3.105em, 1000.5em, 4.159em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-5208" style="font-family: MathJax_Math-italic;">I<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.065em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.437em;"><span class="texatom" id="MathJax-Span-5209"><span class="mrow" id="MathJax-Span-5210"><span class="mn" id="MathJax-Span-5211" style="font-size: 70.7%; font-family: MathJax_Main;">4</span><span class="mo" id="MathJax-Span-5212" style="font-size: 70.7%; font-family: MathJax_Main;">×</span><span class="mn" id="MathJax-Span-5213" style="font-size: 70.7%; font-family: MathJax_Main;">4</span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.105em, 1001.86em, 4.346em, -999.997em); top: -3.037em; left: 50%; margin-left: -0.927em;"><span class="mtd" id="MathJax-Span-5224"><span class="mrow" id="MathJax-Span-5225"><span class="msubsup" id="MathJax-Span-5226"><span style="display: inline-block; position: relative; width: 1.864em; height: 0px;"><span style="position: absolute; clip: rect(3.105em, 1000.44em, 4.159em, -999.997em); top: -3.967em; left: 0em;"><span class="mn" id="MathJax-Span-5227" style="font-family: MathJax_Main;">0</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.499em;"><span class="texatom" id="MathJax-Span-5228"><span class="mrow" id="MathJax-Span-5229"><span class="mn" id="MathJax-Span-5230" style="font-size: 70.7%; font-family: MathJax_Main;">3</span><span class="mo" id="MathJax-Span-5231" style="font-size: 70.7%; font-family: MathJax_Main;">×</span><span class="mn" id="MathJax-Span-5232" style="font-size: 70.7%; font-family: MathJax_Main;">4</span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(2.174em, 1003.35em, 5.214em, -999.997em); top: -3.967em; left: 2.857em;"><span style="display: inline-block; position: relative; width: 3.415em; height: 0px;"><span style="position: absolute; clip: rect(2.857em, 1003.35em, 4.532em, -999.997em); top: -4.65em; left: 50%; margin-left: -1.734em;"><span class="mtd" id="MathJax-Span-5214"><span class="mrow" id="MathJax-Span-5215"><span class="mo" id="MathJax-Span-5216" style="font-family: MathJax_Main;">–</span><span class="mfrac" id="MathJax-Span-5217" style="padding-left: 0.189em;"><span style="display: inline-block; position: relative; width: 0.623em; height: 0px; margin-right: 0.127em; margin-left: 0.127em;"><span style="position: absolute; clip: rect(3.291em, 1000.5em, 4.159em, -999.997em); top: -4.401em; left: 50%; margin-left: -0.245em;"><span class="mi" id="MathJax-Span-5218" style="font-size: 70.7%; font-family: MathJax_Math-italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.065em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.291em, 1000.31em, 4.159em, -999.997em); top: -3.595em; left: 50%; margin-left: -0.183em;"><span class="mn" id="MathJax-Span-5219" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(0.81em, 1000.62em, 1.244em, -999.997em); top: -1.3em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 0.623em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.058em;"></span></span></span></span><span class="mi" id="MathJax-Span-5220" style="font-family: MathJax_Math-italic;">S<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.065em;"></span></span><span class="mo" id="MathJax-Span-5221" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-5222" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-5223" style="font-family: MathJax_Main;">)</span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.105em, 1001.8em, 4.346em, -999.997em); top: -3.037em; left: 50%; margin-left: -0.865em;"><span class="mtd" id="MathJax-Span-5233"><span class="mrow" id="MathJax-Span-5234"><span class="msubsup" id="MathJax-Span-5235"><span style="display: inline-block; position: relative; width: 1.802em; height: 0px;"><span style="position: absolute; clip: rect(3.105em, 1000.5em, 4.159em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-5236" style="font-family: MathJax_Math-italic;">I<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.065em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.437em;"><span class="texatom" id="MathJax-Span-5237"><span class="mrow" id="MathJax-Span-5238"><span class="mn" id="MathJax-Span-5239" style="font-size: 70.7%; font-family: MathJax_Main;">3</span><span class="mo" id="MathJax-Span-5240" style="font-size: 70.7%; font-family: MathJax_Main;">×</span><span class="mn" id="MathJax-Span-5241" style="font-size: 70.7%; font-family: MathJax_Main;">3</span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="mo" id="MathJax-Span-5242" style="vertical-align: 0em;"><span style="font-family: MathJax_Size4;">]</span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -2.664em; left: 7.819em;"><span class="texatom" id="MathJax-Span-5243"><span class="mrow" id="MathJax-Span-5244"><span class="mi" id="MathJax-Span-5245" style="font-size: 70.7%; font-family: MathJax_Math-italic;">k</span><span class="mo" id="MathJax-Span-5246" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="mn" id="MathJax-Span-5247" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.36em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -1.765em; border-left: 0px solid; width: 0px; height: 4.004em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>A</mi><mo>=</mo><msub><mrow><mo>[</mo><mtable rowspacing="4pt" columnspacing="1em"><mtr><mtd><msub><mi>I</mi><mrow class="MJX-TeXAtom-ORD"><mn>4</mn><mo>×</mo><mn>4</mn></mrow></msub></mtd><mtd><mo>–</mo><mfrac><mi>T</mi><mn>2</mn></mfrac><mi>S</mi><mo stretchy="false">(</mo><mi>q</mi><mo stretchy="false">)</mo></mtd></mtr><mtr><mtd><msub><mn>0</mn><mrow class="MJX-TeXAtom-ORD"><mn>3</mn><mo>×</mo><mn>4</mn></mrow></msub></mtd><mtd><msub><mi>I</mi><mrow class="MJX-TeXAtom-ORD"><mn>3</mn><mo>×</mo><mn>3</mn></mrow></msub></mtd></mtr></mtable><mo>]</mo></mrow><mrow class="MJX-TeXAtom-ORD"><mi>k</mi><mo>−</mo><mn>1</mn></mrow></msub></math></span></span><script type="math/tex" id="MathJax-Element-126">A=\begin{bmatrix} I_{4×4} & – \frac{T}{2}S(q) \\ 0_{3×4} & I_{3×3} \end{bmatrix}_{k-1}</script></p>
<p><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-127-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;B&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;msub&gt;&lt;mrow&gt;&lt;mo&gt;[&lt;/mo&gt;&lt;mtable rowspacing=&quot;4pt&quot; columnspacing=&quot;1em&quot;&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mfrac&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/mfrac&gt;&lt;mi&gt;S&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mn&gt;3&lt;/mn&gt;&lt;mo&gt;&amp;#xD7;&lt;/mo&gt;&lt;mn&gt;3&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;/mtable&gt;&lt;mo&gt;]&lt;/mo&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-5248" style="width: 9.556em; display: inline-block;"><span style="display: inline-block; position: relative; width: 7.695em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(0.437em, 1007.7em, 3.911em, -999.997em); top: -2.354em; left: 0em;"><span class="mrow" id="MathJax-Span-5249"><span class="mi" id="MathJax-Span-5250" style="font-family: MathJax_Math-italic;">B</span><span class="mo" id="MathJax-Span-5251" style="font-family: MathJax_Main; padding-left: 0.251em;">=</span><span class="msubsup" id="MathJax-Span-5252" style="padding-left: 0.251em;"><span style="display: inline-block; position: relative; width: 5.648em; height: 0px;"><span style="position: absolute; clip: rect(2.05em, 1004.03em, 5.4em, -999.997em); top: -3.967em; left: 0em;"><span class="mrow" id="MathJax-Span-5253"><span class="mo" id="MathJax-Span-5254" style="vertical-align: 0em;"><span style="font-family: MathJax_Size4;">[</span></span><span class="mtable" id="MathJax-Span-5255" style="padding-right: 0.189em; padding-left: 0.189em;"><span style="display: inline-block; position: relative; width: 2.733em; height: 0px;"><span style="position: absolute; clip: rect(2.174em, 1002.67em, 5.214em, -999.997em); top: -3.967em; left: 0em;"><span style="display: inline-block; position: relative; width: 2.733em; height: 0px;"><span style="position: absolute; clip: rect(2.857em, 1002.67em, 4.532em, -999.997em); top: -4.65em; left: 50%; margin-left: -1.362em;"><span class="mtd" id="MathJax-Span-5256"><span class="mrow" id="MathJax-Span-5257"><span class="mfrac" id="MathJax-Span-5258"><span style="display: inline-block; position: relative; width: 0.623em; height: 0px; margin-right: 0.127em; margin-left: 0.127em;"><span style="position: absolute; clip: rect(3.291em, 1000.5em, 4.159em, -999.997em); top: -4.401em; left: 50%; margin-left: -0.245em;"><span class="mi" id="MathJax-Span-5259" style="font-size: 70.7%; font-family: MathJax_Math-italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.065em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.291em, 1000.31em, 4.159em, -999.997em); top: -3.595em; left: 50%; margin-left: -0.183em;"><span class="mn" id="MathJax-Span-5260" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(0.81em, 1000.62em, 1.244em, -999.997em); top: -1.3em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 0.623em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.058em;"></span></span></span></span><span class="mi" id="MathJax-Span-5261" style="font-family: MathJax_Math-italic;">S<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.065em;"></span></span><span class="mo" id="MathJax-Span-5262" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-5263" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-5264" style="font-family: MathJax_Main;">)</span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.105em, 1001.86em, 4.346em, -999.997em); top: -3.037em; left: 50%; margin-left: -0.927em;"><span class="mtd" id="MathJax-Span-5265"><span class="mrow" id="MathJax-Span-5266"><span class="msubsup" id="MathJax-Span-5267"><span style="display: inline-block; position: relative; width: 1.864em; height: 0px;"><span style="position: absolute; clip: rect(3.105em, 1000.44em, 4.159em, -999.997em); top: -3.967em; left: 0em;"><span class="mn" id="MathJax-Span-5268" style="font-family: MathJax_Main;">0</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.499em;"><span class="texatom" id="MathJax-Span-5269"><span class="mrow" id="MathJax-Span-5270"><span class="mn" id="MathJax-Span-5271" style="font-size: 70.7%; font-family: MathJax_Main;">3</span><span class="mo" id="MathJax-Span-5272" style="font-size: 70.7%; font-family: MathJax_Main;">×</span><span class="mn" id="MathJax-Span-5273" style="font-size: 70.7%; font-family: MathJax_Main;">3</span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="mo" id="MathJax-Span-5274" style="vertical-align: 0em;"><span style="font-family: MathJax_Size4;">]</span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -2.664em; left: 4.283em;"><span class="texatom" id="MathJax-Span-5275"><span class="mrow" id="MathJax-Span-5276"><span class="mi" id="MathJax-Span-5277" style="font-size: 70.7%; font-family: MathJax_Math-italic;">k</span><span class="mo" id="MathJax-Span-5278" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="mn" id="MathJax-Span-5279" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.36em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -1.765em; border-left: 0px solid; width: 0px; height: 4.004em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>B</mi><mo>=</mo><msub><mrow><mo>[</mo><mtable rowspacing="4pt" columnspacing="1em"><mtr><mtd><mfrac><mi>T</mi><mn>2</mn></mfrac><mi>S</mi><mo stretchy="false">(</mo><mi>q</mi><mo stretchy="false">)</mo></mtd></mtr><mtr><mtd><msub><mn>0</mn><mrow class="MJX-TeXAtom-ORD"><mn>3</mn><mo>×</mo><mn>3</mn></mrow></msub></mtd></mtr></mtable><mo>]</mo></mrow><mrow class="MJX-TeXAtom-ORD"><mi>k</mi><mo>−</mo><mn>1</mn></mrow></msub></math></span></span><script type="math/tex" id="MathJax-Element-127">B=\begin{bmatrix} \frac{T}{2}S(q) \\ 0_{3×3} \end{bmatrix}_{k-1}</script></p>
<p>where</p>
<p><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-128-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;S&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mrow&gt;&lt;mo&gt;[&lt;/mo&gt;&lt;mtable rowspacing=&quot;4pt&quot; columnspacing=&quot;1em&quot;&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mn&gt;3&lt;/mn&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mn&gt;3&lt;/mn&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mn&gt;3&lt;/mn&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;/mtable&gt;&lt;mo&gt;]&lt;/mo&gt;&lt;/mrow&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-5280" style="width: 14.767em; display: inline-block;"><span style="display: inline-block; position: relative; width: 11.914em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(2.174em, 1011.6em, 7.757em, -999.997em); top: -5.208em; left: 0em;"><span class="mrow" id="MathJax-Span-5281"><span class="mi" id="MathJax-Span-5282" style="font-family: MathJax_Math-italic;">S<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.065em;"></span></span><span class="mo" id="MathJax-Span-5283" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-5284" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-5285" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-5286" style="font-family: MathJax_Main; padding-left: 0.251em;">=</span><span class="mrow" id="MathJax-Span-5287" style="padding-left: 0.251em;"><span class="mo" id="MathJax-Span-5288" style="vertical-align: 2.857em;"><span style="display: inline-block; position: relative; width: 0.685em; height: 0px;"><span style="position: absolute; font-family: MathJax_Size4; top: -2.788em; left: 0em;">⎡<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; font-family: MathJax_Size4; top: 0.561em; left: 0em;">⎣<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -1.61em; left: 0em;">⎢<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -1.051em; left: 0em;">⎢<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -0.493em; left: 0em;">⎢<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="mtable" id="MathJax-Span-5289" style="padding-right: 0.189em; padding-left: 0.189em;"><span style="display: inline-block; position: relative; width: 6.951em; height: 0px;"><span style="position: absolute; clip: rect(3.167em, 1001.68em, 8.502em, -999.997em); top: -5.952em; left: 0em;"><span style="display: inline-block; position: relative; width: 1.678em; height: 0px;"><span style="position: absolute; clip: rect(3.229em, 1001.68em, 4.346em, -999.997em); top: -6.014em; left: 50%; margin-left: -0.803em;"><span class="mtd" id="MathJax-Span-5290"><span class="mrow" id="MathJax-Span-5291"><span class="mo" id="MathJax-Span-5292" style="font-family: MathJax_Main;">−</span><span class="msubsup" id="MathJax-Span-5293"><span style="display: inline-block; position: relative; width: 0.872em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.44em, 4.346em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-5294" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.437em;"><span class="mn" id="MathJax-Span-5295" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.353em, 1000.87em, 4.346em, -999.997em); top: -4.587em; left: 50%; margin-left: -0.431em;"><span class="mtd" id="MathJax-Span-5308"><span class="mrow" id="MathJax-Span-5309"><span class="msubsup" id="MathJax-Span-5310"><span style="display: inline-block; position: relative; width: 0.872em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.44em, 4.346em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-5311" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.437em;"><span class="mn" id="MathJax-Span-5312" style="font-size: 70.7%; font-family: MathJax_Main;">0</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.353em, 1000.87em, 4.346em, -999.997em); top: -3.223em; left: 50%; margin-left: -0.431em;"><span class="mtd" id="MathJax-Span-5324"><span class="mrow" id="MathJax-Span-5325"><span class="msubsup" id="MathJax-Span-5326"><span style="display: inline-block; position: relative; width: 0.872em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.44em, 4.346em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-5327" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.437em;"><span class="mn" id="MathJax-Span-5328" style="font-size: 70.7%; font-family: MathJax_Main;">3</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.229em, 1001.68em, 4.346em, -999.997em); top: -1.796em; left: 50%; margin-left: -0.803em;"><span class="mtd" id="MathJax-Span-5340"><span class="mrow" id="MathJax-Span-5341"><span class="mo" id="MathJax-Span-5342" style="font-family: MathJax_Main;">−</span><span class="msubsup" id="MathJax-Span-5343"><span style="display: inline-block; position: relative; width: 0.872em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.44em, 4.346em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-5344" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.437em;"><span class="mn" id="MathJax-Span-5345" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span><span style="display: inline-block; width: 0px; height: 5.958em;"></span></span><span style="position: absolute; clip: rect(3.167em, 1001.68em, 8.502em, -999.997em); top: -5.952em; left: 2.671em;"><span style="display: inline-block; position: relative; width: 1.678em; height: 0px;"><span style="position: absolute; clip: rect(3.229em, 1001.68em, 4.346em, -999.997em); top: -6.014em; left: 50%; margin-left: -0.803em;"><span class="mtd" id="MathJax-Span-5296"><span class="mrow" id="MathJax-Span-5297"><span class="mo" id="MathJax-Span-5298" style="font-family: MathJax_Main;">−</span><span class="msubsup" id="MathJax-Span-5299"><span style="display: inline-block; position: relative; width: 0.872em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.44em, 4.346em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-5300" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.437em;"><span class="mn" id="MathJax-Span-5301" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.229em, 1001.68em, 4.346em, -999.997em); top: -4.587em; left: 50%; margin-left: -0.803em;"><span class="mtd" id="MathJax-Span-5313"><span class="mrow" id="MathJax-Span-5314"><span class="mo" id="MathJax-Span-5315" style="font-family: MathJax_Main;">−</span><span class="msubsup" id="MathJax-Span-5316"><span style="display: inline-block; position: relative; width: 0.872em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.44em, 4.346em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-5317" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.437em;"><span class="mn" id="MathJax-Span-5318" style="font-size: 70.7%; font-family: MathJax_Main;">3</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.353em, 1000.87em, 4.346em, -999.997em); top: -3.223em; left: 50%; margin-left: -0.431em;"><span class="mtd" id="MathJax-Span-5329"><span class="mrow" id="MathJax-Span-5330"><span class="msubsup" id="MathJax-Span-5331"><span style="display: inline-block; position: relative; width: 0.872em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.44em, 4.346em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-5332" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.437em;"><span class="mn" id="MathJax-Span-5333" style="font-size: 70.7%; font-family: MathJax_Main;">0</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.353em, 1000.87em, 4.346em, -999.997em); top: -1.796em; left: 50%; margin-left: -0.431em;"><span class="mtd" id="MathJax-Span-5346"><span class="mrow" id="MathJax-Span-5347"><span class="msubsup" id="MathJax-Span-5348"><span style="display: inline-block; position: relative; width: 0.872em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.44em, 4.346em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-5349" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.437em;"><span class="mn" id="MathJax-Span-5350" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span><span style="display: inline-block; width: 0px; height: 5.958em;"></span></span><span style="position: absolute; clip: rect(3.167em, 1001.68em, 8.502em, -999.997em); top: -5.952em; left: 5.338em;"><span style="display: inline-block; position: relative; width: 1.678em; height: 0px;"><span style="position: absolute; clip: rect(3.229em, 1001.68em, 4.346em, -999.997em); top: -6.014em; left: 50%; margin-left: -0.803em;"><span class="mtd" id="MathJax-Span-5302"><span class="mrow" id="MathJax-Span-5303"><span class="mo" id="MathJax-Span-5304" style="font-family: MathJax_Main;">−</span><span class="msubsup" id="MathJax-Span-5305"><span style="display: inline-block; position: relative; width: 0.872em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.44em, 4.346em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-5306" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.437em;"><span class="mn" id="MathJax-Span-5307" style="font-size: 70.7%; font-family: MathJax_Main;">3</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.353em, 1000.87em, 4.346em, -999.997em); top: -4.587em; left: 50%; margin-left: -0.431em;"><span class="mtd" id="MathJax-Span-5319"><span class="mrow" id="MathJax-Span-5320"><span class="msubsup" id="MathJax-Span-5321"><span style="display: inline-block; position: relative; width: 0.872em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.44em, 4.346em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-5322" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.437em;"><span class="mn" id="MathJax-Span-5323" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.229em, 1001.68em, 4.346em, -999.997em); top: -3.223em; left: 50%; margin-left: -0.803em;"><span class="mtd" id="MathJax-Span-5334"><span class="mrow" id="MathJax-Span-5335"><span class="mo" id="MathJax-Span-5336" style="font-family: MathJax_Main;">−</span><span class="msubsup" id="MathJax-Span-5337"><span style="display: inline-block; position: relative; width: 0.872em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.44em, 4.346em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-5338" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.437em;"><span class="mn" id="MathJax-Span-5339" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.353em, 1000.87em, 4.346em, -999.997em); top: -1.796em; left: 50%; margin-left: -0.431em;"><span class="mtd" id="MathJax-Span-5351"><span class="mrow" id="MathJax-Span-5352"><span class="msubsup" id="MathJax-Span-5353"><span style="display: inline-block; position: relative; width: 0.872em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.44em, 4.346em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-5354" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.437em;"><span class="mn" id="MathJax-Span-5355" style="font-size: 70.7%; font-family: MathJax_Main;">0</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span><span style="display: inline-block; width: 0px; height: 5.958em;"></span></span></span></span><span class="mo" id="MathJax-Span-5356" style="vertical-align: 2.857em;"><span style="display: inline-block; position: relative; width: 0.685em; height: 0px;"><span style="position: absolute; font-family: MathJax_Size4; top: -2.788em; left: 0em;">⎤<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; font-family: MathJax_Size4; top: 0.561em; left: 0em;">⎦<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -1.61em; left: 0em;">⎥<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -1.051em; left: 0em;">⎥<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -0.493em; left: 0em;">⎥<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 5.214em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -2.996em; border-left: 0px solid; width: 0px; height: 6.619em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>S</mi><mo stretchy="false">(</mo><mi>q</mi><mo stretchy="false">)</mo><mo>=</mo><mrow><mo>[</mo><mtable rowspacing="4pt" columnspacing="1em"><mtr><mtd><mo>−</mo><msub><mi>q</mi><mn>1</mn></msub></mtd><mtd><mo>−</mo><msub><mi>q</mi><mn>2</mn></msub></mtd><mtd><mo>−</mo><msub><mi>q</mi><mn>3</mn></msub></mtd></mtr><mtr><mtd><msub><mi>q</mi><mn>0</mn></msub></mtd><mtd><mo>−</mo><msub><mi>q</mi><mn>3</mn></msub></mtd><mtd><msub><mi>q</mi><mn>2</mn></msub></mtd></mtr><mtr><mtd><msub><mi>q</mi><mn>3</mn></msub></mtd><mtd><msub><mi>q</mi><mn>0</mn></msub></mtd><mtd><mo>−</mo><msub><mi>q</mi><mn>1</mn></msub></mtd></mtr><mtr><mtd><mo>−</mo><msub><mi>q</mi><mn>2</mn></msub></mtd><mtd><msub><mi>q</mi><mn>1</mn></msub></mtd><mtd><msub><mi>q</mi><mn>0</mn></msub></mtd></mtr></mtable><mo>]</mo></mrow></math></span></span><script type="math/tex" id="MathJax-Element-128">S(q)=\begin{bmatrix} -q_1 & -q_2 & -q_3 \\ q_0 & -q_3 & q_2 \\ q_3 & q_0 & -q_1 \\ -q_2 & q_1 & q_0 \end{bmatrix}</script></p>
<p>With all these information, we can now determine <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-129-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msubsup&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mover&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;&amp;#x005E;&lt;/mo&gt;&lt;/mover&gt;&lt;/mrow&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;/msubsup&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-5357" style="width: 1.492em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.182em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(1.306em, 1001.18em, 2.795em, -999.997em); top: -2.354em; left: 0em;"><span class="mrow" id="MathJax-Span-5358"><span class="msubsup" id="MathJax-Span-5359"><span style="display: inline-block; position: relative; width: 1.182em; height: 0px;"><span style="position: absolute; clip: rect(3.043em, 1000.5em, 4.159em, -999.997em); top: -3.967em; left: 0em;"><span class="texatom" id="MathJax-Span-5360"><span class="mrow" id="MathJax-Span-5361"><span class="munderover" id="MathJax-Span-5362"><span style="display: inline-block; position: relative; width: 0.561em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.5em, 4.159em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-5363" style="font-family: MathJax_Math-italic;">x</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.105em, 1000.38em, 3.601em, -999.997em); top: -4.029em; left: 0.065em;"><span class="mo" id="MathJax-Span-5364" style="font-family: MathJax_Main;">^</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.353em, 1000.62em, 4.221em, -999.997em); top: -4.463em; left: 0.561em;"><span class="mo" id="MathJax-Span-5365" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.291em, 1000.44em, 4.159em, -999.997em); top: -3.719em; left: 0.561em;"><span class="mi" id="MathJax-Span-5366" style="font-size: 70.7%; font-family: MathJax_Math-italic;">k</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.36em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.381em; border-left: 0px solid; width: 0px; height: 1.619em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msubsup><mrow class="MJX-TeXAtom-ORD"><mover><mi>x</mi><mo stretchy="false">^</mo></mover></mrow><mi>k</mi><mo>−</mo></msubsup></math></span></span><script type="math/tex" id="MathJax-Element-129">\hat{x}^-_k</script> in equation (1k). Once this is done, we have to normalize the quaternion in our kalman filter states dues inaccuracies in the discretized calculation. Next up is equation (2k).</p>
<p><span style="text-decoration: underline; color: #338aff;">Equation 2k</span></p>
<p><span style="color: #338aff;"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-130-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msubsup&gt;&lt;mi&gt;P&lt;/mi&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;/msubsup&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;A&lt;/mi&gt;&lt;msub&gt;&lt;mi&gt;P&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;msup&gt;&lt;mi&gt;A&lt;/mi&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;/msup&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mi&gt;Q&lt;/mi&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-5367" style="width: 11.045em; display: inline-block;"><span style="display: inline-block; position: relative; width: 8.874em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(1.306em, 1008.81em, 2.857em, -999.997em); top: -2.354em; left: 0em;"><span class="mrow" id="MathJax-Span-5368"><span class="msubsup" id="MathJax-Span-5369"><span style="display: inline-block; position: relative; width: 1.492em; height: 0px;"><span style="position: absolute; clip: rect(3.105em, 1000.75em, 4.159em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-5370" style="font-family: MathJax_Math-italic;">P<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.127em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.353em, 1000.62em, 4.221em, -999.997em); top: -4.339em; left: 0.81em;"><span class="mo" id="MathJax-Span-5371" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.291em, 1000.44em, 4.159em, -999.997em); top: -3.657em; left: 0.623em;"><span class="mi" id="MathJax-Span-5372" style="font-size: 70.7%; font-family: MathJax_Math-italic;">k</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="mo" id="MathJax-Span-5373" style="font-family: MathJax_Main; padding-left: 0.251em;">=</span><span class="mi" id="MathJax-Span-5374" style="font-family: MathJax_Math-italic; padding-left: 0.251em;">A</span><span class="msubsup" id="MathJax-Span-5375"><span style="display: inline-block; position: relative; width: 1.988em; height: 0px;"><span style="position: absolute; clip: rect(3.105em, 1000.75em, 4.159em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-5376" style="font-family: MathJax_Math-italic;">P<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.127em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.623em;"><span class="texatom" id="MathJax-Span-5377"><span class="mrow" id="MathJax-Span-5378"><span class="mi" id="MathJax-Span-5379" style="font-size: 70.7%; font-family: MathJax_Math-italic;">k</span><span class="mo" id="MathJax-Span-5380" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="mn" id="MathJax-Span-5381" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-5382"><span style="display: inline-block; position: relative; width: 1.306em; height: 0px;"><span style="position: absolute; clip: rect(3.043em, 1000.75em, 4.159em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-5383" style="font-family: MathJax_Math-italic;">A</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -4.339em; left: 0.748em;"><span class="mi" id="MathJax-Span-5384" style="font-size: 70.7%; font-family: MathJax_Math-italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.065em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="mo" id="MathJax-Span-5385" style="font-family: MathJax_Main; padding-left: 0.251em;">+</span><span class="mi" id="MathJax-Span-5386" style="font-family: MathJax_Math-italic; padding-left: 0.251em;">Q</span></span><span style="display: inline-block; width: 0px; height: 2.36em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.458em; border-left: 0px solid; width: 0px; height: 1.619em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msubsup><mi>P</mi><mi>k</mi><mo>−</mo></msubsup><mo>=</mo><mi>A</mi><msub><mi>P</mi><mrow class="MJX-TeXAtom-ORD"><mi>k</mi><mo>−</mo><mn>1</mn></mrow></msub><msup><mi>A</mi><mi>T</mi></msup><mo>+</mo><mi>Q</mi></math></span></span><script type="math/tex" id="MathJax-Element-130">P^-_k=AP_{k-1}A^T+Q</script></span>&nbsp; ———–&nbsp; (2k)</p>
<p>This equation is pretty straightforward. However, we have to decide an initial value for the <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-131-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;P&lt;/mi&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-5387" style="width: 0.934em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.748em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(1.492em, 1000.75em, 2.547em, -999.997em); top: -2.354em; left: 0em;"><span class="mrow" id="MathJax-Span-5388"><span class="mi" id="MathJax-Span-5389" style="font-family: MathJax_Math-italic;">P<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.127em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.36em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.073em; border-left: 0px solid; width: 0px; height: 1.004em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>P</mi></math></span></span><script type="math/tex" id="MathJax-Element-131">P</script> matrix and the <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-132-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;Q&lt;/mi&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-5390" style="width: 0.996em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.81em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(1.492em, 1000.75em, 2.733em, -999.997em); top: -2.354em; left: 0em;"><span class="mrow" id="MathJax-Span-5391"><span class="mi" id="MathJax-Span-5392" style="font-family: MathJax_Math-italic;">Q</span></span><span style="display: inline-block; width: 0px; height: 2.36em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.304em; border-left: 0px solid; width: 0px; height: 1.235em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>Q</mi></math></span></span><script type="math/tex" id="MathJax-Element-132">Q</script> matrix. You should play around with the values in the code to see how this affects the overall performance of the algorithm. You will realize that if you start with a <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-133-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;P&lt;/mi&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-5393" style="width: 0.934em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.748em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(1.492em, 1000.75em, 2.547em, -999.997em); top: -2.354em; left: 0em;"><span class="mrow" id="MathJax-Span-5394"><span class="mi" id="MathJax-Span-5395" style="font-family: MathJax_Math-italic;">P<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.127em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.36em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.073em; border-left: 0px solid; width: 0px; height: 1.004em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>P</mi></math></span></span><script type="math/tex" id="MathJax-Element-133">P</script> matrix with huge values, it may not converge to give you a coherent result. On the other hand, if you start with a <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-134-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;P&lt;/mi&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-5396" style="width: 0.934em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.748em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(1.492em, 1000.75em, 2.547em, -999.997em); top: -2.354em; left: 0em;"><span class="mrow" id="MathJax-Span-5397"><span class="mi" id="MathJax-Span-5398" style="font-family: MathJax_Math-italic;">P<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.127em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.36em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.073em; border-left: 0px solid; width: 0px; height: 1.004em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>P</mi></math></span></span><script type="math/tex" id="MathJax-Element-134">P</script> matrix with small values, it may take quite a while for the <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-135-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;P&lt;/mi&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-5399" style="width: 0.934em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.748em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(1.492em, 1000.75em, 2.547em, -999.997em); top: -2.354em; left: 0em;"><span class="mrow" id="MathJax-Span-5400"><span class="mi" id="MathJax-Span-5401" style="font-family: MathJax_Math-italic;">P<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.127em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.36em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.073em; border-left: 0px solid; width: 0px; height: 1.004em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>P</mi></math></span></span><script type="math/tex" id="MathJax-Element-135">P</script> matrix to converge to the actual solution.&nbsp;The <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-136-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;Q&lt;/mi&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-5402" style="width: 0.996em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.81em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(1.492em, 1000.75em, 2.733em, -999.997em); top: -2.354em; left: 0em;"><span class="mrow" id="MathJax-Span-5403"><span class="mi" id="MathJax-Span-5404" style="font-family: MathJax_Math-italic;">Q</span></span><span style="display: inline-block; width: 0px; height: 2.36em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.304em; border-left: 0px solid; width: 0px; height: 1.235em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>Q</mi></math></span></span><script type="math/tex" id="MathJax-Element-136">Q</script> matrix is the process variance, and it represents the inaccuracies of the model that we are using.</p>
<p>In the code, equation (1k) and (2k) are both done within the <span style="font-family: &#39;courier new&#39;, courier, monospace;">predict()</span> method as shown below. (predictAccelMag() will be explained under equation (3k))</p>
<pre class="lang:python decode:true" title="Kalman Filter Prediction Step">def predict(self, w, dt):
    q = self.xHat[0:4]
    Sq = np.array([[-q[1], -q[2], -q[3]],
                   [ q[0], -q[3],  q[2]],
                   [ q[3],  q[0], -q[1]],
                   [-q[2],  q[1],  q[0]]])
    tmp1 = np.concatenate((np.identity(4), -dt / 2 * Sq), axis=1)
    tmp2 = np.concatenate((np.zeros((3, 4)), np.identity(3)), axis=1)
    self.A = np.concatenate((tmp1, tmp2), axis=0)
    self.B = np.concatenate((dt / 2 * Sq, np.zeros((3, 3))), axis=0)
    self.xHatBar = np.matmul(self.A, self.xHat) + np.matmul(self.B, np.array(w).transpose())
    self.xHatBar[0:4] = self.normalizeQuat(self.xHatBar[0:4])
    self.xHatPrev = self.xHat

    self.yHatBar = self.predictAccelMag()
    self.pBar = np.matmul(np.matmul(self.A, self.p), self.A.transpose()) + self.Q
</pre>
<p><span style="text-decoration: underline; color: #8633ff;"><strong>Update</strong></span></p>
<p><span style="text-decoration: underline; color: #8633ff;">Equation 3k</span></p>
<p><span style="color: #8633ff;"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-137-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;K&lt;/mi&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mstyle mathsize=&quot;1.44em&quot;&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mfrac&gt;&lt;mrow&gt;&lt;msubsup&gt;&lt;mi&gt;P&lt;/mi&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;/msubsup&gt;&lt;msup&gt;&lt;mi&gt;C&lt;/mi&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;/msup&gt;&lt;/mrow&gt;&lt;mrow&gt;&lt;mi&gt;C&lt;/mi&gt;&lt;msubsup&gt;&lt;mi&gt;P&lt;/mi&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;/msubsup&gt;&lt;msup&gt;&lt;mi&gt;C&lt;/mi&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;/msup&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mi&gt;R&lt;/mi&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;/mrow&gt;&lt;/mstyle&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-5405" style="width: 10.425em; display: inline-block;"><span style="display: inline-block; position: relative; width: 8.378em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(0.375em, 1008.38em, 3.663em, -999.997em); top: -2.354em; left: 0em;"><span class="mrow" id="MathJax-Span-5406"><span class="msubsup" id="MathJax-Span-5407"><span style="display: inline-block; position: relative; width: 1.306em; height: 0px;"><span style="position: absolute; clip: rect(3.105em, 1000.87em, 4.159em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-5408" style="font-family: MathJax_Math-italic;">K<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.065em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.872em;"><span class="mi" id="MathJax-Span-5409" style="font-size: 70.7%; font-family: MathJax_Math-italic;">k</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="mo" id="MathJax-Span-5410" style="font-family: MathJax_Main; padding-left: 0.251em;">=</span><span class="mstyle" id="MathJax-Span-5411" style="padding-left: 0.251em;"><span class="mrow" id="MathJax-Span-5412"><span class="texatom" id="MathJax-Span-5413"><span class="mrow" id="MathJax-Span-5414"><span class="mfrac" id="MathJax-Span-5415"><span style="display: inline-block; position: relative; width: 5.4em; height: 0px; margin-right: 0.189em; margin-left: 0.189em;"><span style="position: absolute; clip: rect(2.857em, 1002.92em, 4.47em, -999.997em); top: -4.836em; left: 50%; margin-left: -1.424em;"><span class="mrow" id="MathJax-Span-5416"><span class="msubsup" id="MathJax-Span-5417"><span style="display: inline-block; position: relative; width: 1.492em; height: 0px;"><span style="position: absolute; clip: rect(3.105em, 1000.75em, 4.159em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-5418" style="font-size: 101.8%; font-family: MathJax_Math-italic;">P<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.065em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.353em, 1000.62em, 4.221em, -999.997em); top: -4.401em; left: 0.872em;"><span class="mo" id="MathJax-Span-5419" style="font-size: 72%; font-family: MathJax_Main;">−</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.291em, 1000.44em, 4.159em, -999.997em); top: -3.657em; left: 0.685em;"><span class="mi" id="MathJax-Span-5420" style="font-size: 72%; font-family: MathJax_Math-italic;">k</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-5421"><span style="display: inline-block; position: relative; width: 1.43em; height: 0px;"><span style="position: absolute; clip: rect(3.043em, 1000.75em, 4.159em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-5422" style="font-size: 101.8%; font-family: MathJax_Math-italic;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.065em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -4.401em; left: 0.872em;"><span class="mi" id="MathJax-Span-5423" style="font-size: 72%; font-family: MathJax_Math-italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.065em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(2.857em, 1005.21em, 4.47em, -999.997em); top: -3.223em; left: 50%; margin-left: -2.602em;"><span class="mrow" id="MathJax-Span-5424"><span class="mi" id="MathJax-Span-5425" style="font-size: 101.8%; font-family: MathJax_Math-italic;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.065em;"></span></span><span class="msubsup" id="MathJax-Span-5426"><span style="display: inline-block; position: relative; width: 1.492em; height: 0px;"><span style="position: absolute; clip: rect(3.105em, 1000.75em, 4.159em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-5427" style="font-size: 101.8%; font-family: MathJax_Math-italic;">P<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.065em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.353em, 1000.62em, 4.221em, -999.997em); top: -4.401em; left: 0.872em;"><span class="mo" id="MathJax-Span-5428" style="font-size: 72%; font-family: MathJax_Main;">−</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.291em, 1000.44em, 4.159em, -999.997em); top: -3.657em; left: 0.685em;"><span class="mi" id="MathJax-Span-5429" style="font-size: 72%; font-family: MathJax_Math-italic;">k</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-5430"><span style="display: inline-block; position: relative; width: 1.43em; height: 0px;"><span style="position: absolute; clip: rect(3.043em, 1000.75em, 4.159em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-5431" style="font-size: 101.8%; font-family: MathJax_Math-italic;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.065em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -4.401em; left: 0.872em;"><span class="mi" id="MathJax-Span-5432" style="font-size: 72%; font-family: MathJax_Math-italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.065em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="mo" id="MathJax-Span-5433" style="font-size: 101.8%; font-family: MathJax_Main;">+</span><span class="mi" id="MathJax-Span-5434" style="font-size: 101.8%; font-family: MathJax_Math-italic;">R</span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(0.872em, 1005.4em, 1.306em, -999.997em); top: -1.424em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.4px solid; width: 5.4em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.12em;"></span></span></span></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.36em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -1.458em; border-left: 0px solid; width: 0px; height: 3.773em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>K</mi><mi>k</mi></msub><mo>=</mo><mstyle mathsize="1.44em"><mrow class="MJX-TeXAtom-ORD"><mfrac><mrow><msubsup><mi>P</mi><mi>k</mi><mo>−</mo></msubsup><msup><mi>C</mi><mi>T</mi></msup></mrow><mrow><mi>C</mi><msubsup><mi>P</mi><mi>k</mi><mo>−</mo></msubsup><msup><mi>C</mi><mi>T</mi></msup><mo>+</mo><mi>R</mi></mrow></mfrac></mrow></mstyle></math></span></span><script type="math/tex" id="MathJax-Element-137">K_k=\Large{\frac{P^-_kC^T}{CP^-_kC^T+R}}</script></span>&nbsp; ———–&nbsp; (3k)</p>
<p>In order to implement equation (3k), we first have to figure out what is our <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-138-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;C&lt;/mi&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-5435" style="width: 0.996em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.81em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(1.492em, 1000.81em, 2.547em, -999.997em); top: -2.354em; left: 0em;"><span class="mrow" id="MathJax-Span-5436"><span class="mi" id="MathJax-Span-5437" style="font-family: MathJax_Math-italic;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.065em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.36em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.073em; border-left: 0px solid; width: 0px; height: 1.081em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>C</mi></math></span></span><script type="math/tex" id="MathJax-Element-138">C</script> matrix here. If you take a look at my <a href="https://thepoorengineer.com/en/angle-control-absolute/#kalman">previous post explaining the kalman filter</a>&nbsp;using the pendulum example, you will know that the <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-139-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;C&lt;/mi&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-5438" style="width: 0.996em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.81em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(1.492em, 1000.81em, 2.547em, -999.997em); top: -2.354em; left: 0em;"><span class="mrow" id="MathJax-Span-5439"><span class="mi" id="MathJax-Span-5440" style="font-family: MathJax_Math-italic;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.065em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.36em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.073em; border-left: 0px solid; width: 0px; height: 1.081em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>C</mi></math></span></span><script type="math/tex" id="MathJax-Element-139">C</script> matrix is a matrix to convert our kalman filter states to the measured variables. In the pendulum example, it just so happens that the measured variables are the same as the kalman filters states thus the <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-140-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;C&lt;/mi&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-5441" style="width: 0.996em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.81em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(1.492em, 1000.81em, 2.547em, -999.997em); top: -2.354em; left: 0em;"><span class="mrow" id="MathJax-Span-5442"><span class="mi" id="MathJax-Span-5443" style="font-family: MathJax_Math-italic;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.065em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.36em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.073em; border-left: 0px solid; width: 0px; height: 1.081em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>C</mi></math></span></span><script type="math/tex" id="MathJax-Element-140">C</script> matrix is the identity matrix. However, in our case here, our measured variables are the direction of the gravity and North vector while our kalman filter states are the quartenion and the gyro bias. They are essentially different parameters thus we have to figure out a <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-141-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;C&lt;/mi&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-5444" style="width: 0.996em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.81em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(1.492em, 1000.81em, 2.547em, -999.997em); top: -2.354em; left: 0em;"><span class="mrow" id="MathJax-Span-5445"><span class="mi" id="MathJax-Span-5446" style="font-family: MathJax_Math-italic;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.065em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.36em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.073em; border-left: 0px solid; width: 0px; height: 1.081em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>C</mi></math></span></span><script type="math/tex" id="MathJax-Element-141">C</script> matrix which allows us to convert out state variables into the measured variables.</p>
<p>Now, if you had diligently read through everything in this post, you should realize that we have already derived our <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-142-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;C&lt;/mi&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-5447" style="width: 0.996em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.81em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(1.492em, 1000.81em, 2.547em, -999.997em); top: -2.354em; left: 0em;"><span class="mrow" id="MathJax-Span-5448"><span class="mi" id="MathJax-Span-5449" style="font-family: MathJax_Math-italic;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.065em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.36em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.073em; border-left: 0px solid; width: 0px; height: 1.081em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>C</mi></math></span></span><script type="math/tex" id="MathJax-Element-142">C</script> matrix in the accelerometer and magnetometer section.</p>
<p>For the Accelerometer,</p>
<p><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-143-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;C&lt;/mi&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;msub&gt;&lt;mrow&gt;&lt;mo&gt;[&lt;/mo&gt;&lt;mtable rowspacing=&quot;4pt&quot; columnspacing=&quot;1em&quot;&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mn&gt;3&lt;/mn&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mn&gt;3&lt;/mn&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mn&gt;3&lt;/mn&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;/mtable&gt;&lt;mo&gt;]&lt;/mo&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-5450" style="width: 19.42em; display: inline-block;"><span style="display: inline-block; position: relative; width: 15.636em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(0.003em, 1015.64em, 4.283em, -999.997em); top: -2.354em; left: 0em;"><span class="mrow" id="MathJax-Span-5451"><span class="msubsup" id="MathJax-Span-5452"><span style="display: inline-block; position: relative; width: 1.182em; height: 0px;"><span style="position: absolute; clip: rect(3.105em, 1000.75em, 4.159em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-5453" style="font-family: MathJax_Math-italic;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.065em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.748em;"><span class="mi" id="MathJax-Span-5454" style="font-size: 70.7%; font-family: MathJax_Math-italic;">a</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="mo" id="MathJax-Span-5455" style="font-family: MathJax_Main; padding-left: 0.251em;">=</span><span class="mo" id="MathJax-Span-5456" style="font-family: MathJax_Main; padding-left: 0.251em;">−</span><span class="mn" id="MathJax-Span-5457" style="font-family: MathJax_Main;">2</span><span class="msubsup" id="MathJax-Span-5458"><span style="display: inline-block; position: relative; width: 11.914em; height: 0px;"><span style="position: absolute; clip: rect(2.422em, 1010.24em, 6.641em, -999.997em); top: -4.774em; left: 0em;"><span class="mrow" id="MathJax-Span-5459"><span class="mo" id="MathJax-Span-5460" style="vertical-align: 2.174em;"><span style="display: inline-block; position: relative; width: 0.685em; height: 0px;"><span style="position: absolute; font-family: MathJax_Size4; top: -2.788em; left: 0em;">⎡<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; font-family: MathJax_Size4; top: -0.803em; left: 0em;">⎣<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -1.796em; left: 0em;">⎢<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="mtable" id="MathJax-Span-5461" style="padding-right: 0.189em; padding-left: 0.189em;"><span style="display: inline-block; position: relative; width: 8.812em; height: 0px;"><span style="position: absolute; clip: rect(2.484em, 1001.68em, 6.455em, -999.997em); top: -4.587em; left: 0em;"><span style="display: inline-block; position: relative; width: 1.678em; height: 0px;"><span style="position: absolute; clip: rect(3.229em, 1001.68em, 4.346em, -999.997em); top: -5.332em; left: 50%; margin-left: -0.803em;"><span class="mtd" id="MathJax-Span-5462"><span class="mrow" id="MathJax-Span-5463"><span class="mo" id="MathJax-Span-5464" style="font-family: MathJax_Main;">−</span><span class="msubsup" id="MathJax-Span-5465"><span style="display: inline-block; position: relative; width: 0.872em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.44em, 4.346em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-5466" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.437em;"><span class="mn" id="MathJax-Span-5467" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.353em, 1000.87em, 4.346em, -999.997em); top: -3.905em; left: 50%; margin-left: -0.431em;"><span class="mtd" id="MathJax-Span-5484"><span class="mrow" id="MathJax-Span-5485"><span class="msubsup" id="MathJax-Span-5486"><span style="display: inline-block; position: relative; width: 0.872em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.44em, 4.346em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-5487" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.437em;"><span class="mn" id="MathJax-Span-5488" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.353em, 1000.87em, 4.346em, -999.997em); top: -2.54em; left: 50%; margin-left: -0.431em;"><span class="mtd" id="MathJax-Span-5504"><span class="mrow" id="MathJax-Span-5505"><span class="msubsup" id="MathJax-Span-5506"><span style="display: inline-block; position: relative; width: 0.872em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.44em, 4.346em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-5507" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.437em;"><span class="mn" id="MathJax-Span-5508" style="font-size: 70.7%; font-family: MathJax_Main;">0</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.594em;"></span></span><span style="position: absolute; clip: rect(2.484em, 1001.68em, 6.331em, -999.997em); top: -4.463em; left: 2.671em;"><span style="display: inline-block; position: relative; width: 1.678em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.87em, 4.346em, -999.997em); top: -5.332em; left: 50%; margin-left: -0.431em;"><span class="mtd" id="MathJax-Span-5468"><span class="mrow" id="MathJax-Span-5469"><span class="msubsup" id="MathJax-Span-5470"><span style="display: inline-block; position: relative; width: 0.872em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.44em, 4.346em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-5471" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.437em;"><span class="mn" id="MathJax-Span-5472" style="font-size: 70.7%; font-family: MathJax_Main;">3</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.353em, 1000.87em, 4.346em, -999.997em); top: -3.905em; left: 50%; margin-left: -0.431em;"><span class="mtd" id="MathJax-Span-5489"><span class="mrow" id="MathJax-Span-5490"><span class="msubsup" id="MathJax-Span-5491"><span style="display: inline-block; position: relative; width: 0.872em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.44em, 4.346em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-5492" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.437em;"><span class="mn" id="MathJax-Span-5493" style="font-size: 70.7%; font-family: MathJax_Main;">0</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.229em, 1001.68em, 4.346em, -999.997em); top: -2.54em; left: 50%; margin-left: -0.803em;"><span class="mtd" id="MathJax-Span-5509"><span class="mrow" id="MathJax-Span-5510"><span class="mo" id="MathJax-Span-5511" style="font-family: MathJax_Main;">−</span><span class="msubsup" id="MathJax-Span-5512"><span style="display: inline-block; position: relative; width: 0.872em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.44em, 4.346em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-5513" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.437em;"><span class="mn" id="MathJax-Span-5514" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.47em;"></span></span><span style="position: absolute; clip: rect(2.484em, 1001.68em, 6.455em, -999.997em); top: -4.587em; left: 5.338em;"><span style="display: inline-block; position: relative; width: 1.678em; height: 0px;"><span style="position: absolute; clip: rect(3.229em, 1001.68em, 4.346em, -999.997em); top: -5.332em; left: 50%; margin-left: -0.803em;"><span class="mtd" id="MathJax-Span-5473"><span class="mrow" id="MathJax-Span-5474"><span class="mo" id="MathJax-Span-5475" style="font-family: MathJax_Main;">−</span><span class="msubsup" id="MathJax-Span-5476"><span style="display: inline-block; position: relative; width: 0.872em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.44em, 4.346em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-5477" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.437em;"><span class="mn" id="MathJax-Span-5478" style="font-size: 70.7%; font-family: MathJax_Main;">0</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.353em, 1000.87em, 4.346em, -999.997em); top: -3.905em; left: 50%; margin-left: -0.431em;"><span class="mtd" id="MathJax-Span-5494"><span class="mrow" id="MathJax-Span-5495"><span class="msubsup" id="MathJax-Span-5496"><span style="display: inline-block; position: relative; width: 0.872em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.44em, 4.346em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-5497" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.437em;"><span class="mn" id="MathJax-Span-5498" style="font-size: 70.7%; font-family: MathJax_Main;">3</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.229em, 1001.68em, 4.346em, -999.997em); top: -2.54em; left: 50%; margin-left: -0.803em;"><span class="mtd" id="MathJax-Span-5515"><span class="mrow" id="MathJax-Span-5516"><span class="mo" id="MathJax-Span-5517" style="font-family: MathJax_Main;">−</span><span class="msubsup" id="MathJax-Span-5518"><span style="display: inline-block; position: relative; width: 0.872em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.44em, 4.346em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-5519" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.437em;"><span class="mn" id="MathJax-Span-5520" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.594em;"></span></span><span style="position: absolute; clip: rect(2.484em, 1000.87em, 6.331em, -999.997em); top: -4.463em; left: 7.944em;"><span style="display: inline-block; position: relative; width: 0.872em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.87em, 4.346em, -999.997em); top: -5.332em; left: 50%; margin-left: -0.431em;"><span class="mtd" id="MathJax-Span-5479"><span class="mrow" id="MathJax-Span-5480"><span class="msubsup" id="MathJax-Span-5481"><span style="display: inline-block; position: relative; width: 0.872em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.44em, 4.346em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-5482" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.437em;"><span class="mn" id="MathJax-Span-5483" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.353em, 1000.87em, 4.346em, -999.997em); top: -3.905em; left: 50%; margin-left: -0.431em;"><span class="mtd" id="MathJax-Span-5499"><span class="mrow" id="MathJax-Span-5500"><span class="msubsup" id="MathJax-Span-5501"><span style="display: inline-block; position: relative; width: 0.872em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.44em, 4.346em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-5502" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.437em;"><span class="mn" id="MathJax-Span-5503" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.353em, 1000.87em, 4.346em, -999.997em); top: -2.54em; left: 50%; margin-left: -0.431em;"><span class="mtd" id="MathJax-Span-5521"><span class="mrow" id="MathJax-Span-5522"><span class="msubsup" id="MathJax-Span-5523"><span style="display: inline-block; position: relative; width: 0.872em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.44em, 4.346em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-5524" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.437em;"><span class="mn" id="MathJax-Span-5525" style="font-size: 70.7%; font-family: MathJax_Main;">3</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.47em;"></span></span></span></span><span class="mo" id="MathJax-Span-5526" style="vertical-align: 2.174em;"><span style="display: inline-block; position: relative; width: 0.685em; height: 0px;"><span style="position: absolute; font-family: MathJax_Size4; top: -2.788em; left: 0em;">⎤<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; font-family: MathJax_Size4; top: -0.803em; left: 0em;">⎦<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -1.796em; left: 0em;">⎥<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.78em;"></span></span><span style="position: absolute; top: -2.292em; left: 10.549em;"><span class="texatom" id="MathJax-Span-5527"><span class="mrow" id="MathJax-Span-5528"><span class="mi" id="MathJax-Span-5529" style="font-size: 70.7%; font-family: MathJax_Math-italic;">k</span><span class="mo" id="MathJax-Span-5530" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="mn" id="MathJax-Span-5531" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.36em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -2.227em; border-left: 0px solid; width: 0px; height: 5.004em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>C</mi><mi>a</mi></msub><mo>=</mo><mo>−</mo><mn>2</mn><msub><mrow><mo>[</mo><mtable rowspacing="4pt" columnspacing="1em"><mtr><mtd><mo>−</mo><msub><mi>q</mi><mn>2</mn></msub></mtd><mtd><msub><mi>q</mi><mn>3</mn></msub></mtd><mtd><mo>−</mo><msub><mi>q</mi><mn>0</mn></msub></mtd><mtd><msub><mi>q</mi><mn>1</mn></msub></mtd></mtr><mtr><mtd><msub><mi>q</mi><mn>1</mn></msub></mtd><mtd><msub><mi>q</mi><mn>0</mn></msub></mtd><mtd><msub><mi>q</mi><mn>3</mn></msub></mtd><mtd><msub><mi>q</mi><mn>2</mn></msub></mtd></mtr><mtr><mtd><msub><mi>q</mi><mn>0</mn></msub></mtd><mtd><mo>−</mo><msub><mi>q</mi><mn>1</mn></msub></mtd><mtd><mo>−</mo><msub><mi>q</mi><mn>2</mn></msub></mtd><mtd><msub><mi>q</mi><mn>3</mn></msub></mtd></mtr></mtable><mo>]</mo></mrow><mrow class="MJX-TeXAtom-ORD"><mi>k</mi><mo>−</mo><mn>1</mn></mrow></msub></math></span></span><script type="math/tex" id="MathJax-Element-143">C_a= -2\begin{bmatrix} -q_2 & q_3 & -q_0 & q_1 \\ q_1 & q_0 & q_3 & q_2 \\ q_0 & -q_1 & -q_2 & q_3 \end{bmatrix}_{k-1}</script></p>
<p>Notice here that I removed the multiple <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-144-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;g&lt;/mi&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-5532" style="width: 0.623em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.499em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(1.74em, 1000.5em, 2.733em, -999.997em); top: -2.354em; left: 0em;"><span class="mrow" id="MathJax-Span-5533"><span class="mi" id="MathJax-Span-5534" style="font-family: MathJax_Math-italic;">g<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.36em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.304em; border-left: 0px solid; width: 0px; height: 0.927em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>g</mi></math></span></span><script type="math/tex" id="MathJax-Element-144">g</script> because the accelerometer data that I will be using is in units of <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-145-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;g&lt;/mi&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-5535" style="width: 0.623em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.499em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(1.74em, 1000.5em, 2.733em, -999.997em); top: -2.354em; left: 0em;"><span class="mrow" id="MathJax-Span-5536"><span class="mi" id="MathJax-Span-5537" style="font-family: MathJax_Math-italic;">g<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.36em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.304em; border-left: 0px solid; width: 0px; height: 0.927em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>g</mi></math></span></span><script type="math/tex" id="MathJax-Element-145">g</script>.</p>
<p>For the Magnetometer,</p>
<p><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-146-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;C&lt;/mi&gt;&lt;mi&gt;m&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;msub&gt;&lt;mrow&gt;&lt;mo&gt;[&lt;/mo&gt;&lt;mtable rowspacing=&quot;4pt&quot; columnspacing=&quot;1em&quot;&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mn&gt;3&lt;/mn&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mn&gt;3&lt;/mn&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mn&gt;3&lt;/mn&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;/mtable&gt;&lt;mo&gt;]&lt;/mo&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-5538" style="width: 19.73em; display: inline-block;"><span style="display: inline-block; position: relative; width: 15.884em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(0.003em, 1015.88em, 4.283em, -999.997em); top: -2.354em; left: 0em;"><span class="mrow" id="MathJax-Span-5539"><span class="msubsup" id="MathJax-Span-5540"><span style="display: inline-block; position: relative; width: 1.43em; height: 0px;"><span style="position: absolute; clip: rect(3.105em, 1000.75em, 4.159em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-5541" style="font-family: MathJax_Math-italic;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.065em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.748em;"><span class="mi" id="MathJax-Span-5542" style="font-size: 70.7%; font-family: MathJax_Math-italic;">m</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="mo" id="MathJax-Span-5543" style="font-family: MathJax_Main; padding-left: 0.251em;">=</span><span class="mo" id="MathJax-Span-5544" style="font-family: MathJax_Main; padding-left: 0.251em;">−</span><span class="mn" id="MathJax-Span-5545" style="font-family: MathJax_Main;">2</span><span class="msubsup" id="MathJax-Span-5546"><span style="display: inline-block; position: relative; width: 11.914em; height: 0px;"><span style="position: absolute; clip: rect(2.422em, 1010.24em, 6.641em, -999.997em); top: -4.774em; left: 0em;"><span class="mrow" id="MathJax-Span-5547"><span class="mo" id="MathJax-Span-5548" style="vertical-align: 2.174em;"><span style="display: inline-block; position: relative; width: 0.685em; height: 0px;"><span style="position: absolute; font-family: MathJax_Size4; top: -2.788em; left: 0em;">⎡<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; font-family: MathJax_Size4; top: -0.803em; left: 0em;">⎣<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -1.796em; left: 0em;">⎢<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="mtable" id="MathJax-Span-5549" style="padding-right: 0.189em; padding-left: 0.189em;"><span style="display: inline-block; position: relative; width: 8.812em; height: 0px;"><span style="position: absolute; clip: rect(2.484em, 1001.68em, 6.331em, -999.997em); top: -4.463em; left: 0em;"><span style="display: inline-block; position: relative; width: 1.678em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.87em, 4.346em, -999.997em); top: -5.332em; left: 50%; margin-left: -0.431em;"><span class="mtd" id="MathJax-Span-5550"><span class="mrow" id="MathJax-Span-5551"><span class="msubsup" id="MathJax-Span-5552"><span style="display: inline-block; position: relative; width: 0.872em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.44em, 4.346em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-5553" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.437em;"><span class="mn" id="MathJax-Span-5554" style="font-size: 70.7%; font-family: MathJax_Main;">3</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.353em, 1000.87em, 4.346em, -999.997em); top: -3.905em; left: 50%; margin-left: -0.431em;"><span class="mtd" id="MathJax-Span-5570"><span class="mrow" id="MathJax-Span-5571"><span class="msubsup" id="MathJax-Span-5572"><span style="display: inline-block; position: relative; width: 0.872em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.44em, 4.346em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-5573" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.437em;"><span class="mn" id="MathJax-Span-5574" style="font-size: 70.7%; font-family: MathJax_Main;">0</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.229em, 1001.68em, 4.346em, -999.997em); top: -2.54em; left: 50%; margin-left: -0.803em;"><span class="mtd" id="MathJax-Span-5592"><span class="mrow" id="MathJax-Span-5593"><span class="mo" id="MathJax-Span-5594" style="font-family: MathJax_Main;">−</span><span class="msubsup" id="MathJax-Span-5595"><span style="display: inline-block; position: relative; width: 0.872em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.44em, 4.346em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-5596" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.437em;"><span class="mn" id="MathJax-Span-5597" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.47em;"></span></span><span style="position: absolute; clip: rect(2.484em, 1001.68em, 6.331em, -999.997em); top: -4.463em; left: 2.671em;"><span style="display: inline-block; position: relative; width: 1.678em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.87em, 4.346em, -999.997em); top: -5.332em; left: 50%; margin-left: -0.431em;"><span class="mtd" id="MathJax-Span-5555"><span class="mrow" id="MathJax-Span-5556"><span class="msubsup" id="MathJax-Span-5557"><span style="display: inline-block; position: relative; width: 0.872em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.44em, 4.346em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-5558" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.437em;"><span class="mn" id="MathJax-Span-5559" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.229em, 1001.68em, 4.346em, -999.997em); top: -3.905em; left: 50%; margin-left: -0.803em;"><span class="mtd" id="MathJax-Span-5575"><span class="mrow" id="MathJax-Span-5576"><span class="mo" id="MathJax-Span-5577" style="font-family: MathJax_Main;">−</span><span class="msubsup" id="MathJax-Span-5578"><span style="display: inline-block; position: relative; width: 0.872em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.44em, 4.346em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-5579" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.437em;"><span class="mn" id="MathJax-Span-5580" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.229em, 1001.68em, 4.346em, -999.997em); top: -2.54em; left: 50%; margin-left: -0.803em;"><span class="mtd" id="MathJax-Span-5598"><span class="mrow" id="MathJax-Span-5599"><span class="mo" id="MathJax-Span-5600" style="font-family: MathJax_Main;">−</span><span class="msubsup" id="MathJax-Span-5601"><span style="display: inline-block; position: relative; width: 0.872em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.44em, 4.346em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-5602" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.437em;"><span class="mn" id="MathJax-Span-5603" style="font-size: 70.7%; font-family: MathJax_Main;">0</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.47em;"></span></span><span style="position: absolute; clip: rect(2.484em, 1000.87em, 6.331em, -999.997em); top: -4.463em; left: 5.338em;"><span style="display: inline-block; position: relative; width: 0.872em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.87em, 4.346em, -999.997em); top: -5.332em; left: 50%; margin-left: -0.431em;"><span class="mtd" id="MathJax-Span-5560"><span class="mrow" id="MathJax-Span-5561"><span class="msubsup" id="MathJax-Span-5562"><span style="display: inline-block; position: relative; width: 0.872em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.44em, 4.346em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-5563" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.437em;"><span class="mn" id="MathJax-Span-5564" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.353em, 1000.87em, 4.346em, -999.997em); top: -3.905em; left: 50%; margin-left: -0.431em;"><span class="mtd" id="MathJax-Span-5581"><span class="mrow" id="MathJax-Span-5582"><span class="msubsup" id="MathJax-Span-5583"><span style="display: inline-block; position: relative; width: 0.872em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.44em, 4.346em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-5584" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.437em;"><span class="mn" id="MathJax-Span-5585" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.353em, 1000.87em, 4.346em, -999.997em); top: -2.54em; left: 50%; margin-left: -0.431em;"><span class="mtd" id="MathJax-Span-5604"><span class="mrow" id="MathJax-Span-5605"><span class="msubsup" id="MathJax-Span-5606"><span style="display: inline-block; position: relative; width: 0.872em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.44em, 4.346em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-5607" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.437em;"><span class="mn" id="MathJax-Span-5608" style="font-size: 70.7%; font-family: MathJax_Main;">3</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.47em;"></span></span><span style="position: absolute; clip: rect(2.484em, 1001.68em, 6.331em, -999.997em); top: -4.463em; left: 7.199em;"><span style="display: inline-block; position: relative; width: 1.678em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.87em, 4.346em, -999.997em); top: -5.332em; left: 50%; margin-left: -0.431em;"><span class="mtd" id="MathJax-Span-5565"><span class="mrow" id="MathJax-Span-5566"><span class="msubsup" id="MathJax-Span-5567"><span style="display: inline-block; position: relative; width: 0.872em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.44em, 4.346em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-5568" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.437em;"><span class="mn" id="MathJax-Span-5569" style="font-size: 70.7%; font-family: MathJax_Main;">0</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.229em, 1001.68em, 4.346em, -999.997em); top: -3.905em; left: 50%; margin-left: -0.803em;"><span class="mtd" id="MathJax-Span-5586"><span class="mrow" id="MathJax-Span-5587"><span class="mo" id="MathJax-Span-5588" style="font-family: MathJax_Main;">−</span><span class="msubsup" id="MathJax-Span-5589"><span style="display: inline-block; position: relative; width: 0.872em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.44em, 4.346em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-5590" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.437em;"><span class="mn" id="MathJax-Span-5591" style="font-size: 70.7%; font-family: MathJax_Main;">3</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.353em, 1000.87em, 4.346em, -999.997em); top: -2.54em; left: 50%; margin-left: -0.431em;"><span class="mtd" id="MathJax-Span-5609"><span class="mrow" id="MathJax-Span-5610"><span class="msubsup" id="MathJax-Span-5611"><span style="display: inline-block; position: relative; width: 0.872em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.44em, 4.346em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-5612" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.437em;"><span class="mn" id="MathJax-Span-5613" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.47em;"></span></span></span></span><span class="mo" id="MathJax-Span-5614" style="vertical-align: 2.174em;"><span style="display: inline-block; position: relative; width: 0.685em; height: 0px;"><span style="position: absolute; font-family: MathJax_Size4; top: -2.788em; left: 0em;">⎤<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; font-family: MathJax_Size4; top: -0.803em; left: 0em;">⎦<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -1.796em; left: 0em;">⎥<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.78em;"></span></span><span style="position: absolute; top: -2.292em; left: 10.549em;"><span class="texatom" id="MathJax-Span-5615"><span class="mrow" id="MathJax-Span-5616"><span class="mi" id="MathJax-Span-5617" style="font-size: 70.7%; font-family: MathJax_Math-italic;">k</span><span class="mo" id="MathJax-Span-5618" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="mn" id="MathJax-Span-5619" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.36em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -2.227em; border-left: 0px solid; width: 0px; height: 5.004em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>C</mi><mi>m</mi></msub><mo>=</mo><mo>−</mo><mn>2</mn><msub><mrow><mo>[</mo><mtable rowspacing="4pt" columnspacing="1em"><mtr><mtd><msub><mi>q</mi><mn>3</mn></msub></mtd><mtd><msub><mi>q</mi><mn>2</mn></msub></mtd><mtd><msub><mi>q</mi><mn>1</mn></msub></mtd><mtd><msub><mi>q</mi><mn>0</mn></msub></mtd></mtr><mtr><mtd><msub><mi>q</mi><mn>0</mn></msub></mtd><mtd><mo>−</mo><msub><mi>q</mi><mn>1</mn></msub></mtd><mtd><msub><mi>q</mi><mn>2</mn></msub></mtd><mtd><mo>−</mo><msub><mi>q</mi><mn>3</mn></msub></mtd></mtr><mtr><mtd><mo>−</mo><msub><mi>q</mi><mn>1</mn></msub></mtd><mtd><mo>−</mo><msub><mi>q</mi><mn>0</mn></msub></mtd><mtd><msub><mi>q</mi><mn>3</mn></msub></mtd><mtd><msub><mi>q</mi><mn>2</mn></msub></mtd></mtr></mtable><mo>]</mo></mrow><mrow class="MJX-TeXAtom-ORD"><mi>k</mi><mo>−</mo><mn>1</mn></mrow></msub></math></span></span><script type="math/tex" id="MathJax-Element-146">C_m= -2\begin{bmatrix} q_3 & q_2 & q_1 & q_0 \\ q_0 & -q_1 & q_2 & -q_3 \\ -q_1 & -q_0 & q_3 & q_2 \end{bmatrix}_{k-1}</script></p>
<p>In order to determine the <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-147-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;C&lt;/mi&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-5620" style="width: 0.996em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.81em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(1.492em, 1000.81em, 2.547em, -999.997em); top: -2.354em; left: 0em;"><span class="mrow" id="MathJax-Span-5621"><span class="mi" id="MathJax-Span-5622" style="font-family: MathJax_Math-italic;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.065em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.36em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.073em; border-left: 0px solid; width: 0px; height: 1.081em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>C</mi></math></span></span><script type="math/tex" id="MathJax-Element-147">C</script> matrix, we would require the quaternion state from the previous iteration. Since the conversion of quaternion to rotation matrix from the world frame to the body frame is the same for the accelerometer and the magnetometer, there is actually a more generalized form of the <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-148-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;C&lt;/mi&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-5623" style="width: 0.996em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.81em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(1.492em, 1000.81em, 2.547em, -999.997em); top: -2.354em; left: 0em;"><span class="mrow" id="MathJax-Span-5624"><span class="mi" id="MathJax-Span-5625" style="font-family: MathJax_Math-italic;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.065em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.36em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.073em; border-left: 0px solid; width: 0px; height: 1.081em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>C</mi></math></span></span><script type="math/tex" id="MathJax-Element-148">C</script> equation that will work for both the accelerometer and the magnetometer. I left that as a homework in the above section but the answer is actually already within the code under the method <span style="font-family: &#39;courier new&#39;, courier, monospace;">getJacobianMatrix()</span>.</p>
<p>For the purpose of clarity, I am once again going to write out the exact equation that is implemented within the python code.</p>
<p><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-149-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mtable columnalign=&quot;right left right left right left right left right left right left&quot; rowspacing=&quot;3pt&quot; columnspacing=&quot;0em 2em 0em 2em 0em 2em 0em 2em 0em 2em 0em&quot; displaystyle=&quot;true&quot;&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;msubsup&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mover&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;&amp;#x005E;&lt;/mo&gt;&lt;/mover&gt;&lt;/mrow&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;/msubsup&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mi&gt;&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;C&lt;/mi&gt;&lt;msubsup&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mover&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;&amp;#x005E;&lt;/mo&gt;&lt;/mover&gt;&lt;/mrow&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;/msubsup&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mrow&gt;&lt;mo&gt;[&lt;/mo&gt;&lt;mtable rowspacing=&quot;4pt&quot; columnspacing=&quot;1em&quot;&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mover&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;&amp;#x005E;&lt;/mo&gt;&lt;/mover&gt;&lt;/mrow&gt;&lt;mi&gt;m&lt;/mi&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mover&gt;&lt;mi&gt;m&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;&amp;#x005E;&lt;/mo&gt;&lt;/mover&gt;&lt;/mrow&gt;&lt;mi&gt;m&lt;/mi&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;/mtable&gt;&lt;mo&gt;]&lt;/mo&gt;&lt;/mrow&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mi&gt;&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mrow&gt;&lt;mo&gt;[&lt;/mo&gt;&lt;mtable rowspacing=&quot;4pt&quot; columnspacing=&quot;1em&quot;&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mi&gt;C&lt;/mi&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mn&gt;3&lt;/mn&gt;&lt;mo&gt;&amp;#xD7;&lt;/mo&gt;&lt;mn&gt;3&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mi&gt;C&lt;/mi&gt;&lt;mi&gt;m&lt;/mi&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mn&gt;3&lt;/mn&gt;&lt;mo&gt;&amp;#xD7;&lt;/mo&gt;&lt;mn&gt;3&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;/mtable&gt;&lt;mo&gt;]&lt;/mo&gt;&lt;/mrow&gt;&lt;msub&gt;&lt;mrow&gt;&lt;mo&gt;[&lt;/mo&gt;&lt;mtable rowspacing=&quot;4pt&quot; columnspacing=&quot;1em&quot;&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;msup&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;mi&gt;g&lt;/mi&gt;&lt;/msup&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;/mtable&gt;&lt;mo&gt;]&lt;/mo&gt;&lt;/mrow&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;/mtable&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-5626" style="width: 17.001em; display: inline-block;"><span style="display: inline-block; position: relative; width: 13.713em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(0.003em, 1013.53em, 4.221em, -999.997em); top: -2.354em; left: 0em;"><span class="mrow" id="MathJax-Span-5627"><span class="mtable" id="MathJax-Span-5628" style="padding-right: 0.189em; padding-left: 0.189em;"><span style="display: inline-block; position: relative; width: 13.341em; height: 0px;"><span style="position: absolute; clip: rect(2.547em, 1003.48em, 6.765em, -999.997em); top: -4.898em; left: 0em;"><span style="display: inline-block; position: relative; width: 3.477em; height: 0px;"><span style="position: absolute; clip: rect(2.919em, 1001.18em, 4.408em, -999.997em); top: -5.27em; right: 0em;"><span class="mtd" id="MathJax-Span-5629"><span class="mrow" id="MathJax-Span-5630"><span class="msubsup" id="MathJax-Span-5631"><span style="display: inline-block; position: relative; width: 1.182em; height: 0px;"><span style="position: absolute; clip: rect(3.043em, 1000.5em, 4.346em, -999.997em); top: -3.967em; left: 0em;"><span class="texatom" id="MathJax-Span-5632"><span class="mrow" id="MathJax-Span-5633"><span class="munderover" id="MathJax-Span-5634"><span style="display: inline-block; position: relative; width: 0.561em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.5em, 4.346em, -999.997em); top: -3.967em; left: 0.003em;"><span class="mi" id="MathJax-Span-5635" style="font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.105em, 1000.38em, 3.601em, -999.997em); top: -4.029em; left: 0.065em;"><span class="mo" id="MathJax-Span-5636" style="font-family: MathJax_Main;">^</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.353em, 1000.62em, 4.221em, -999.997em); top: -4.463em; left: 0.561em;"><span class="mo" id="MathJax-Span-5637" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.291em, 1000.44em, 4.159em, -999.997em); top: -3.719em; left: 0.561em;"><span class="mi" id="MathJax-Span-5638" style="font-size: 70.7%; font-family: MathJax_Math-italic;">k</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(2.36em, 1003.48em, 5.152em, -999.997em); top: -3.285em; right: 0em;"><span class="mtd" id="MathJax-Span-5652"><span class="mrow" id="MathJax-Span-5653"><span class="msubsup" id="MathJax-Span-5654"><span style="display: inline-block; position: relative; width: 3.477em; height: 0px;"><span style="position: absolute; clip: rect(2.36em, 1002.73em, 5.09em, -999.997em); top: -3.967em; left: 0em;"><span class="mrow" id="MathJax-Span-5655"><span class="mo" id="MathJax-Span-5656" style="vertical-align: 0em;"><span style="font-family: MathJax_Size3;">[</span></span><span class="mtable" id="MathJax-Span-5657" style="padding-right: 0.189em; padding-left: 0.189em;"><span style="display: inline-block; position: relative; width: 1.554em; height: 0px;"><span style="position: absolute; clip: rect(2.36em, 1001.55em, 5.09em, -999.997em); top: -3.967em; left: 0em;"><span style="display: inline-block; position: relative; width: 1.554em; height: 0px;"><span style="position: absolute; clip: rect(3.043em, 1001.24em, 4.346em, -999.997em); top: -4.587em; left: 50%; margin-left: -0.617em;"><span class="mtd" id="MathJax-Span-5658"><span class="mrow" id="MathJax-Span-5659"><span class="msubsup" id="MathJax-Span-5660"><span style="display: inline-block; position: relative; width: 1.244em; height: 0px;"><span style="position: absolute; clip: rect(3.043em, 1000.5em, 4.159em, -999.997em); top: -3.967em; left: 0em;"><span class="texatom" id="MathJax-Span-5661"><span class="mrow" id="MathJax-Span-5662"><span class="munderover" id="MathJax-Span-5663"><span style="display: inline-block; position: relative; width: 0.561em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.5em, 4.159em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-5664" style="font-family: MathJax_Math-italic;">a</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.105em, 1000.38em, 3.601em, -999.997em); top: -4.029em; left: 0.003em;"><span class="mo" id="MathJax-Span-5665" style="font-family: MathJax_Main;">^</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.561em;"><span class="mi" id="MathJax-Span-5666" style="font-size: 70.7%; font-family: MathJax_Math-italic;">m</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.043em, 1001.55em, 4.346em, -999.997em); top: -3.223em; left: 50%; margin-left: -0.803em;"><span class="mtd" id="MathJax-Span-5667"><span class="mrow" id="MathJax-Span-5668"><span class="msubsup" id="MathJax-Span-5669"><span style="display: inline-block; position: relative; width: 1.554em; height: 0px;"><span style="position: absolute; clip: rect(3.043em, 1000.87em, 4.159em, -999.997em); top: -3.967em; left: 0em;"><span class="texatom" id="MathJax-Span-5670"><span class="mrow" id="MathJax-Span-5671"><span class="munderover" id="MathJax-Span-5672"><span style="display: inline-block; position: relative; width: 0.872em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.87em, 4.159em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-5673" style="font-family: MathJax_Math-italic;">m</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.105em, 1000.38em, 3.601em, -999.997em); top: -4.029em; left: 0.189em;"><span class="mo" id="MathJax-Span-5674" style="font-family: MathJax_Main;">^</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.872em;"><span class="mi" id="MathJax-Span-5675" style="font-size: 70.7%; font-family: MathJax_Math-italic;">m</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="mo" id="MathJax-Span-5676" style="vertical-align: 0em;"><span style="font-family: MathJax_Size3;">]</span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -2.975em; left: 2.981em;"><span class="mi" id="MathJax-Span-5677" style="font-size: 70.7%; font-family: MathJax_Math-italic;">k</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.904em;"></span></span><span style="position: absolute; clip: rect(2.547em, 1009.87em, 6.765em, -999.997em); top: -4.898em; left: 3.477em;"><span style="display: inline-block; position: relative; width: 9.867em; height: 0px;"><span style="position: absolute; clip: rect(2.919em, 1003.23em, 4.408em, -999.997em); top: -5.27em; left: 0em;"><span class="mtd" id="MathJax-Span-5639"><span class="mrow" id="MathJax-Span-5640"><span class="mi" id="MathJax-Span-5641"></span><span class="mo" id="MathJax-Span-5642" style="font-family: MathJax_Main; padding-left: 0.251em;">=</span><span class="mi" id="MathJax-Span-5643" style="font-family: MathJax_Math-italic; padding-left: 0.251em;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.065em;"></span></span><span class="msubsup" id="MathJax-Span-5644"><span style="display: inline-block; position: relative; width: 1.182em; height: 0px;"><span style="position: absolute; clip: rect(3.043em, 1000.5em, 4.159em, -999.997em); top: -3.967em; left: 0em;"><span class="texatom" id="MathJax-Span-5645"><span class="mrow" id="MathJax-Span-5646"><span class="munderover" id="MathJax-Span-5647"><span style="display: inline-block; position: relative; width: 0.561em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.5em, 4.159em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-5648" style="font-family: MathJax_Math-italic;">x</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.105em, 1000.38em, 3.601em, -999.997em); top: -4.029em; left: 0.065em;"><span class="mo" id="MathJax-Span-5649" style="font-family: MathJax_Main;">^</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.353em, 1000.62em, 4.221em, -999.997em); top: -4.463em; left: 0.561em;"><span class="mo" id="MathJax-Span-5650" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.291em, 1000.44em, 4.159em, -999.997em); top: -3.719em; left: 0.561em;"><span class="mi" id="MathJax-Span-5651" style="font-size: 70.7%; font-family: MathJax_Math-italic;">k</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(2.36em, 1009.87em, 5.152em, -999.997em); top: -3.285em; left: 0em;"><span class="mtd" id="MathJax-Span-5678"><span class="mrow" id="MathJax-Span-5679"><span class="mi" id="MathJax-Span-5680"></span><span class="mo" id="MathJax-Span-5681" style="font-family: MathJax_Main; padding-left: 0.251em;">=</span><span class="mrow" id="MathJax-Span-5682" style="padding-left: 0.251em;"><span class="mo" id="MathJax-Span-5683" style="vertical-align: 0em;"><span style="font-family: MathJax_Size3;">[</span></span><span class="mtable" id="MathJax-Span-5684" style="padding-right: 0.189em; padding-left: 0.189em;"><span style="display: inline-block; position: relative; width: 4.221em; height: 0px;"><span style="position: absolute; clip: rect(2.422em, 1001.43em, 5.09em, -999.997em); top: -3.967em; left: 0em;"><span style="display: inline-block; position: relative; width: 1.43em; height: 0px;"><span style="position: absolute; clip: rect(3.105em, 1001.18em, 4.346em, -999.997em); top: -4.587em; left: 50%; margin-left: -0.555em;"><span class="mtd" id="MathJax-Span-5685"><span class="mrow" id="MathJax-Span-5686"><span class="msubsup" id="MathJax-Span-5687"><span style="display: inline-block; position: relative; width: 1.182em; height: 0px;"><span style="position: absolute; clip: rect(3.105em, 1000.75em, 4.159em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-5688" style="font-family: MathJax_Math-italic;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.065em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.748em;"><span class="mi" id="MathJax-Span-5689" style="font-size: 70.7%; font-family: MathJax_Math-italic;">a</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.105em, 1001.43em, 4.346em, -999.997em); top: -3.223em; left: 50%; margin-left: -0.679em;"><span class="mtd" id="MathJax-Span-5699"><span class="mrow" id="MathJax-Span-5700"><span class="msubsup" id="MathJax-Span-5701"><span style="display: inline-block; position: relative; width: 1.43em; height: 0px;"><span style="position: absolute; clip: rect(3.105em, 1000.75em, 4.159em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-5702" style="font-family: MathJax_Math-italic;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.065em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.748em;"><span class="mi" id="MathJax-Span-5703" style="font-size: 70.7%; font-family: MathJax_Math-italic;">m</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(2.484em, 1001.86em, 5.09em, -999.997em); top: -3.967em; left: 2.422em;"><span style="display: inline-block; position: relative; width: 1.864em; height: 0px;"><span style="position: absolute; clip: rect(3.105em, 1001.86em, 4.346em, -999.997em); top: -4.587em; left: 50%; margin-left: -0.927em;"><span class="mtd" id="MathJax-Span-5690"><span class="mrow" id="MathJax-Span-5691"><span class="msubsup" id="MathJax-Span-5692"><span style="display: inline-block; position: relative; width: 1.864em; height: 0px;"><span style="position: absolute; clip: rect(3.105em, 1000.44em, 4.159em, -999.997em); top: -3.967em; left: 0em;"><span class="mn" id="MathJax-Span-5693" style="font-family: MathJax_Main;">0</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.499em;"><span class="texatom" id="MathJax-Span-5694"><span class="mrow" id="MathJax-Span-5695"><span class="mn" id="MathJax-Span-5696" style="font-size: 70.7%; font-family: MathJax_Main;">3</span><span class="mo" id="MathJax-Span-5697" style="font-size: 70.7%; font-family: MathJax_Main;">×</span><span class="mn" id="MathJax-Span-5698" style="font-size: 70.7%; font-family: MathJax_Main;">3</span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.105em, 1001.86em, 4.346em, -999.997em); top: -3.223em; left: 50%; margin-left: -0.927em;"><span class="mtd" id="MathJax-Span-5704"><span class="mrow" id="MathJax-Span-5705"><span class="msubsup" id="MathJax-Span-5706"><span style="display: inline-block; position: relative; width: 1.864em; height: 0px;"><span style="position: absolute; clip: rect(3.105em, 1000.44em, 4.159em, -999.997em); top: -3.967em; left: 0em;"><span class="mn" id="MathJax-Span-5707" style="font-family: MathJax_Main;">0</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.499em;"><span class="texatom" id="MathJax-Span-5708"><span class="mrow" id="MathJax-Span-5709"><span class="mn" id="MathJax-Span-5710" style="font-size: 70.7%; font-family: MathJax_Main;">3</span><span class="mo" id="MathJax-Span-5711" style="font-size: 70.7%; font-family: MathJax_Main;">×</span><span class="mn" id="MathJax-Span-5712" style="font-size: 70.7%; font-family: MathJax_Main;">3</span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="mo" id="MathJax-Span-5713" style="vertical-align: 0em;"><span style="font-family: MathJax_Size3;">]</span></span></span><span class="msubsup" id="MathJax-Span-5714" style="padding-left: 0.189em;"><span style="display: inline-block; position: relative; width: 2.733em; height: 0px;"><span style="position: absolute; clip: rect(2.36em, 1002.05em, 5.09em, -999.997em); top: -3.967em; left: 0em;"><span class="mrow" id="MathJax-Span-5715"><span class="mo" id="MathJax-Span-5716" style="vertical-align: 0em;"><span style="font-family: MathJax_Size3;">[</span></span><span class="mtable" id="MathJax-Span-5717" style="padding-right: 0.189em; padding-left: 0.189em;"><span style="display: inline-block; position: relative; width: 0.872em; height: 0px;"><span style="position: absolute; clip: rect(2.671em, 1000.87em, 4.904em, -999.997em); top: -3.967em; left: 0em;"><span style="display: inline-block; position: relative; width: 0.872em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.44em, 4.346em, -999.997em); top: -4.587em; left: 50%; margin-left: -0.245em;"><span class="mtd" id="MathJax-Span-5718"><span class="mrow" id="MathJax-Span-5719"><span class="mi" id="MathJax-Span-5720" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.105em, 1000.87em, 4.159em, -999.997em); top: -3.223em; left: 50%; margin-left: -0.431em;"><span class="mtd" id="MathJax-Span-5721"><span class="mrow" id="MathJax-Span-5722"><span class="msubsup" id="MathJax-Span-5723"><span style="display: inline-block; position: relative; width: 0.872em; height: 0px;"><span style="position: absolute; clip: rect(3.105em, 1000.44em, 4.159em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-5724" style="font-family: MathJax_Math-italic;">b</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -4.339em; left: 0.437em;"><span class="mi" id="MathJax-Span-5725" style="font-size: 70.7%; font-family: MathJax_Math-italic;">g<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="mo" id="MathJax-Span-5726" style="vertical-align: 0em;"><span style="font-family: MathJax_Size3;">]</span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -2.975em; left: 2.298em;"><span class="mi" id="MathJax-Span-5727" style="font-size: 70.7%; font-family: MathJax_Math-italic;">k</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.904em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.36em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -2.15em; border-left: 0px solid; width: 0px; height: 5.004em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mtable columnalign="right left right left right left right left right left right left" rowspacing="3pt" columnspacing="0em 2em 0em 2em 0em 2em 0em 2em 0em 2em 0em" displaystyle="true"><mtr><mtd><msubsup><mrow class="MJX-TeXAtom-ORD"><mover><mi>y</mi><mo stretchy="false">^</mo></mover></mrow><mi>k</mi><mo>−</mo></msubsup></mtd><mtd><mi></mi><mo>=</mo><mi>C</mi><msubsup><mrow class="MJX-TeXAtom-ORD"><mover><mi>x</mi><mo stretchy="false">^</mo></mover></mrow><mi>k</mi><mo>−</mo></msubsup></mtd></mtr><mtr><mtd><msub><mrow><mo>[</mo><mtable rowspacing="4pt" columnspacing="1em"><mtr><mtd><msub><mrow class="MJX-TeXAtom-ORD"><mover><mi>a</mi><mo stretchy="false">^</mo></mover></mrow><mi>m</mi></msub></mtd></mtr><mtr><mtd><msub><mrow class="MJX-TeXAtom-ORD"><mover><mi>m</mi><mo stretchy="false">^</mo></mover></mrow><mi>m</mi></msub></mtd></mtr></mtable><mo>]</mo></mrow><mi>k</mi></msub></mtd><mtd><mi></mi><mo>=</mo><mrow><mo>[</mo><mtable rowspacing="4pt" columnspacing="1em"><mtr><mtd><msub><mi>C</mi><mi>a</mi></msub></mtd><mtd><msub><mn>0</mn><mrow class="MJX-TeXAtom-ORD"><mn>3</mn><mo>×</mo><mn>3</mn></mrow></msub></mtd></mtr><mtr><mtd><msub><mi>C</mi><mi>m</mi></msub></mtd><mtd><msub><mn>0</mn><mrow class="MJX-TeXAtom-ORD"><mn>3</mn><mo>×</mo><mn>3</mn></mrow></msub></mtd></mtr></mtable><mo>]</mo></mrow><msub><mrow><mo>[</mo><mtable rowspacing="4pt" columnspacing="1em"><mtr><mtd><mi>q</mi></mtd></mtr><mtr><mtd><msup><mi>b</mi><mi>g</mi></msup></mtd></mtr></mtable><mo>]</mo></mrow><mi>k</mi></msub></mtd></mtr></mtable></math></span></span><script type="math/tex" id="MathJax-Element-149">\begin{align}\hat{y}^-_k &= C\hat{x}^-_k \\ \begin{bmatrix} \hat{a}_m \\ \hat{m}_m \end{bmatrix}_k &= \begin{bmatrix} C_a & 0_{3×3}  \\ C_m & 0_{3×3} \end{bmatrix} \begin{bmatrix} q \\ b^g \end{bmatrix}_k \end{align}</script></p>
<p>The last term that we have to determine in order to implement equation (3k) is the <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-150-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;R&lt;/mi&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-5728" style="width: 0.934em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.748em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(1.492em, 1000.75em, 2.547em, -999.997em); top: -2.354em; left: 0em;"><span class="mrow" id="MathJax-Span-5729"><span class="mi" id="MathJax-Span-5730" style="font-family: MathJax_Math-italic;">R</span></span><span style="display: inline-block; width: 0px; height: 2.36em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.073em; border-left: 0px solid; width: 0px; height: 1.004em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>R</mi></math></span></span><script type="math/tex" id="MathJax-Element-150">R</script> matrix. This is the measurement variance and it represents how accurate our measurement data is. Similar to the <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-151-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;Q&lt;/mi&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-5731" style="width: 0.996em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.81em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(1.492em, 1000.75em, 2.733em, -999.997em); top: -2.354em; left: 0em;"><span class="mrow" id="MathJax-Span-5732"><span class="mi" id="MathJax-Span-5733" style="font-family: MathJax_Math-italic;">Q</span></span><span style="display: inline-block; width: 0px; height: 2.36em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.304em; border-left: 0px solid; width: 0px; height: 1.235em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>Q</mi></math></span></span><script type="math/tex" id="MathJax-Element-151">Q</script> matrix in equation (2k), this term is important yet difficult to determine. The values of these terms are usually determine through simulations or actual tests so in this tutorial, I am just going to use an arbitrary value which does not have any special meaning.</p>
<p><span style="text-decoration: underline; color: #8633ff;">Equation 4k</span></p>
<p><span style="color: #8633ff;"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-152-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mover&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;&amp;#x005E;&lt;/mo&gt;&lt;/mover&gt;&lt;/mrow&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;msubsup&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mover&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;&amp;#x005E;&lt;/mo&gt;&lt;/mover&gt;&lt;/mrow&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;/msubsup&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;K&lt;/mi&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mi&gt;C&lt;/mi&gt;&lt;msubsup&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mover&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;&amp;#x005E;&lt;/mo&gt;&lt;/mover&gt;&lt;/mrow&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;/msubsup&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-5734" style="width: 13.651em; display: inline-block;"><span style="display: inline-block; position: relative; width: 10.983em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(1.306em, 1010.86em, 2.795em, -999.997em); top: -2.354em; left: 0em;"><span class="mrow" id="MathJax-Span-5735"><span class="msubsup" id="MathJax-Span-5736"><span style="display: inline-block; position: relative; width: 0.996em; height: 0px;"><span style="position: absolute; clip: rect(3.043em, 1000.5em, 4.159em, -999.997em); top: -3.967em; left: 0em;"><span class="texatom" id="MathJax-Span-5737"><span class="mrow" id="MathJax-Span-5738"><span class="munderover" id="MathJax-Span-5739"><span style="display: inline-block; position: relative; width: 0.561em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.5em, 4.159em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-5740" style="font-family: MathJax_Math-italic;">x</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.105em, 1000.38em, 3.601em, -999.997em); top: -4.029em; left: 0.065em;"><span class="mo" id="MathJax-Span-5741" style="font-family: MathJax_Main;">^</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.561em;"><span class="mi" id="MathJax-Span-5742" style="font-size: 70.7%; font-family: MathJax_Math-italic;">k</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="mo" id="MathJax-Span-5743" style="font-family: MathJax_Main; padding-left: 0.251em;">=</span><span class="msubsup" id="MathJax-Span-5744" style="padding-left: 0.251em;"><span style="display: inline-block; position: relative; width: 1.182em; height: 0px;"><span style="position: absolute; clip: rect(3.043em, 1000.5em, 4.159em, -999.997em); top: -3.967em; left: 0em;"><span class="texatom" id="MathJax-Span-5745"><span class="mrow" id="MathJax-Span-5746"><span class="munderover" id="MathJax-Span-5747"><span style="display: inline-block; position: relative; width: 0.561em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.5em, 4.159em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-5748" style="font-family: MathJax_Math-italic;">x</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.105em, 1000.38em, 3.601em, -999.997em); top: -4.029em; left: 0.065em;"><span class="mo" id="MathJax-Span-5749" style="font-family: MathJax_Main;">^</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.353em, 1000.62em, 4.221em, -999.997em); top: -4.463em; left: 0.561em;"><span class="mo" id="MathJax-Span-5750" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.291em, 1000.44em, 4.159em, -999.997em); top: -3.719em; left: 0.561em;"><span class="mi" id="MathJax-Span-5751" style="font-size: 70.7%; font-family: MathJax_Math-italic;">k</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="mo" id="MathJax-Span-5752" style="font-family: MathJax_Main; padding-left: 0.251em;">+</span><span class="msubsup" id="MathJax-Span-5753" style="padding-left: 0.251em;"><span style="display: inline-block; position: relative; width: 1.306em; height: 0px;"><span style="position: absolute; clip: rect(3.105em, 1000.87em, 4.159em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-5754" style="font-family: MathJax_Math-italic;">K<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.065em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.872em;"><span class="mi" id="MathJax-Span-5755" style="font-size: 70.7%; font-family: MathJax_Math-italic;">k</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="mo" id="MathJax-Span-5756" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-5757"><span style="display: inline-block; position: relative; width: 0.934em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.5em, 4.346em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-5758" style="font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.499em;"><span class="mi" id="MathJax-Span-5759" style="font-size: 70.7%; font-family: MathJax_Math-italic;">k</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="mo" id="MathJax-Span-5760" style="font-family: MathJax_Main; padding-left: 0.251em;">−</span><span class="mi" id="MathJax-Span-5761" style="font-family: MathJax_Math-italic; padding-left: 0.251em;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.065em;"></span></span><span class="msubsup" id="MathJax-Span-5762"><span style="display: inline-block; position: relative; width: 1.182em; height: 0px;"><span style="position: absolute; clip: rect(3.043em, 1000.5em, 4.159em, -999.997em); top: -3.967em; left: 0em;"><span class="texatom" id="MathJax-Span-5763"><span class="mrow" id="MathJax-Span-5764"><span class="munderover" id="MathJax-Span-5765"><span style="display: inline-block; position: relative; width: 0.561em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.5em, 4.159em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-5766" style="font-family: MathJax_Math-italic;">x</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.105em, 1000.38em, 3.601em, -999.997em); top: -4.029em; left: 0.065em;"><span class="mo" id="MathJax-Span-5767" style="font-family: MathJax_Main;">^</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.353em, 1000.62em, 4.221em, -999.997em); top: -4.463em; left: 0.561em;"><span class="mo" id="MathJax-Span-5768" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.291em, 1000.44em, 4.159em, -999.997em); top: -3.719em; left: 0.561em;"><span class="mi" id="MathJax-Span-5769" style="font-size: 70.7%; font-family: MathJax_Math-italic;">k</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="mo" id="MathJax-Span-5770" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.36em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.381em; border-left: 0px solid; width: 0px; height: 1.619em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mrow class="MJX-TeXAtom-ORD"><mover><mi>x</mi><mo stretchy="false">^</mo></mover></mrow><mi>k</mi></msub><mo>=</mo><msubsup><mrow class="MJX-TeXAtom-ORD"><mover><mi>x</mi><mo stretchy="false">^</mo></mover></mrow><mi>k</mi><mo>−</mo></msubsup><mo>+</mo><msub><mi>K</mi><mi>k</mi></msub><mo stretchy="false">(</mo><msub><mi>y</mi><mi>k</mi></msub><mo>−</mo><mi>C</mi><msubsup><mrow class="MJX-TeXAtom-ORD"><mover><mi>x</mi><mo stretchy="false">^</mo></mover></mrow><mi>k</mi><mo>−</mo></msubsup><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-152">\hat{x}_k=\hat{x}^-_k+K_k(y_k-C\hat{x}^-_k)</script></span>&nbsp; ———–&nbsp; (4k)</p>
<p>Next up is equation (4k) which by now we should have all the terms except for <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-153-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-5771" style="width: 1.182em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.934em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(1.74em, 1000.93em, 2.733em, -999.997em); top: -2.354em; left: 0em;"><span class="mrow" id="MathJax-Span-5772"><span class="msubsup" id="MathJax-Span-5773"><span style="display: inline-block; position: relative; width: 0.934em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.5em, 4.346em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-5774" style="font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.499em;"><span class="mi" id="MathJax-Span-5775" style="font-size: 70.7%; font-family: MathJax_Math-italic;">k</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.36em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.304em; border-left: 0px solid; width: 0px; height: 0.927em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>y</mi><mi>k</mi></msub></math></span></span><script type="math/tex" id="MathJax-Element-153">y_k</script>. This is the actual measurement values that we obtain from the sensor data. In my python code, this is expressed as shown below.</p>
<p><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-154-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mrow&gt;&lt;mo&gt;[&lt;/mo&gt;&lt;mtable rowspacing=&quot;4pt&quot; columnspacing=&quot;1em&quot;&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mi&gt;m&lt;/mi&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mi&gt;m&lt;/mi&gt;&lt;mi&gt;m&lt;/mi&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;/mtable&gt;&lt;mo&gt;]&lt;/mo&gt;&lt;/mrow&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-5776" style="width: 6.455em; display: inline-block;"><span style="display: inline-block; position: relative; width: 5.214em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(1.74em, 1004.97em, 4.47em, -999.997em); top: -3.347em; left: 0em;"><span class="mrow" id="MathJax-Span-5777"><span class="msubsup" id="MathJax-Span-5778"><span style="display: inline-block; position: relative; width: 0.934em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.5em, 4.346em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-5779" style="font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.499em;"><span class="mi" id="MathJax-Span-5780" style="font-size: 70.7%; font-family: MathJax_Math-italic;">k</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="mo" id="MathJax-Span-5781" style="font-family: MathJax_Main; padding-left: 0.251em;">=</span><span class="mrow" id="MathJax-Span-5782" style="padding-left: 0.251em;"><span class="mo" id="MathJax-Span-5783" style="vertical-align: 0em;"><span style="font-family: MathJax_Size3;">[</span></span><span class="mtable" id="MathJax-Span-5784" style="padding-right: 0.189em; padding-left: 0.189em;"><span style="display: inline-block; position: relative; width: 1.554em; height: 0px;"><span style="position: absolute; clip: rect(2.671em, 1001.55em, 5.09em, -999.997em); top: -3.967em; left: 0em;"><span style="display: inline-block; position: relative; width: 1.554em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1001.24em, 4.346em, -999.997em); top: -4.587em; left: 50%; margin-left: -0.617em;"><span class="mtd" id="MathJax-Span-5785"><span class="mrow" id="MathJax-Span-5786"><span class="msubsup" id="MathJax-Span-5787"><span style="display: inline-block; position: relative; width: 1.244em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.5em, 4.159em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-5788" style="font-family: MathJax_Math-italic;">a</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.561em;"><span class="mi" id="MathJax-Span-5789" style="font-size: 70.7%; font-family: MathJax_Math-italic;">m</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.353em, 1001.55em, 4.346em, -999.997em); top: -3.223em; left: 50%; margin-left: -0.803em;"><span class="mtd" id="MathJax-Span-5790"><span class="mrow" id="MathJax-Span-5791"><span class="msubsup" id="MathJax-Span-5792"><span style="display: inline-block; position: relative; width: 1.554em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.87em, 4.159em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-5793" style="font-family: MathJax_Math-italic;">m</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.872em;"><span class="mi" id="MathJax-Span-5794" style="font-size: 70.7%; font-family: MathJax_Math-italic;">m</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="mo" id="MathJax-Span-5795" style="vertical-align: 0em;"><span style="font-family: MathJax_Size3;">]</span></span></span></span><span style="display: inline-block; width: 0px; height: 3.353em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -1.227em; border-left: 0px solid; width: 0px; height: 3.158em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>y</mi><mi>k</mi></msub><mo>=</mo><mrow><mo>[</mo><mtable rowspacing="4pt" columnspacing="1em"><mtr><mtd><msub><mi>a</mi><mi>m</mi></msub></mtd></mtr><mtr><mtd><msub><mi>m</mi><mi>m</mi></msub></mtd></mtr></mtable><mo>]</mo></mrow></math></span></span><script type="math/tex" id="MathJax-Element-154">y_k = \begin{bmatrix} a_m \\ m_m \end{bmatrix}</script></p>
<p>Since we are making an addition to the quaternion, we have to normalize it again after this step to maintain a unit quaternion during the calculations.</p>
<p><span style="text-decoration: underline; color: #8633ff;">Equation 5k</span></p>
<p><span style="color: #8633ff;"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-155-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;P&lt;/mi&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;I&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;K&lt;/mi&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;/msub&gt;&lt;mi&gt;C&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;msubsup&gt;&lt;mi&gt;P&lt;/mi&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;/msubsup&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-5796" style="width: 10.549em; display: inline-block;"><span style="display: inline-block; position: relative; width: 8.502em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(1.368em, 1008.5em, 2.857em, -999.997em); top: -2.354em; left: 0em;"><span class="mrow" id="MathJax-Span-5797"><span class="msubsup" id="MathJax-Span-5798"><span style="display: inline-block; position: relative; width: 1.058em; height: 0px;"><span style="position: absolute; clip: rect(3.105em, 1000.75em, 4.159em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-5799" style="font-family: MathJax_Math-italic;">P<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.127em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.623em;"><span class="mi" id="MathJax-Span-5800" style="font-size: 70.7%; font-family: MathJax_Math-italic;">k</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="mo" id="MathJax-Span-5801" style="font-family: MathJax_Main; padding-left: 0.251em;">=</span><span class="mo" id="MathJax-Span-5802" style="font-family: MathJax_Main; padding-left: 0.251em;">(</span><span class="mi" id="MathJax-Span-5803" style="font-family: MathJax_Math-italic;">I<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.065em;"></span></span><span class="mo" id="MathJax-Span-5804" style="font-family: MathJax_Main; padding-left: 0.251em;">−</span><span class="msubsup" id="MathJax-Span-5805" style="padding-left: 0.251em;"><span style="display: inline-block; position: relative; width: 1.306em; height: 0px;"><span style="position: absolute; clip: rect(3.105em, 1000.87em, 4.159em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-5806" style="font-family: MathJax_Math-italic;">K<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.065em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.872em;"><span class="mi" id="MathJax-Span-5807" style="font-size: 70.7%; font-family: MathJax_Math-italic;">k</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="mi" id="MathJax-Span-5808" style="font-family: MathJax_Math-italic;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.065em;"></span></span><span class="mo" id="MathJax-Span-5809" style="font-family: MathJax_Main;">)</span><span class="msubsup" id="MathJax-Span-5810"><span style="display: inline-block; position: relative; width: 1.492em; height: 0px;"><span style="position: absolute; clip: rect(3.105em, 1000.75em, 4.159em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-5811" style="font-family: MathJax_Math-italic;">P<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.127em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.353em, 1000.62em, 4.221em, -999.997em); top: -4.339em; left: 0.81em;"><span class="mo" id="MathJax-Span-5812" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.291em, 1000.44em, 4.159em, -999.997em); top: -3.657em; left: 0.623em;"><span class="mi" id="MathJax-Span-5813" style="font-size: 70.7%; font-family: MathJax_Math-italic;">k</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.36em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.458em; border-left: 0px solid; width: 0px; height: 1.619em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>P</mi><mi>k</mi></msub><mo>=</mo><mo stretchy="false">(</mo><mi>I</mi><mo>−</mo><msub><mi>K</mi><mi>k</mi></msub><mi>C</mi><mo stretchy="false">)</mo><msubsup><mi>P</mi><mi>k</mi><mo>−</mo></msubsup></math></span></span><script type="math/tex" id="MathJax-Element-155">P_k=(I-K_kC)P^-_k</script></span>&nbsp; ———–&nbsp; (5k)</p>
<p>As for equation (5k), we already have all the variables ready so implementing it will be no problem at all. Equation (3k) to (5k) are all implemented within the <span style="font-family: &#39;courier new&#39;, courier, monospace;">update()</span> method in the python code as shown below as well.</p>
<pre class="lang:python decode:true " title="Kalman Filter Update Implementation">def update(self, a, m):
    tmp1 = np.linalg.inv(np.matmul(np.matmul(self.C, self.pBar), self.C.transpose()) + self.R)
    self.K = np.matmul(np.matmul(self.pBar, self.C.transpose()), tmp1)

    magGuass_B = self.getMagVector(m)
    accel_B = self.getAccelVector(a)

    measurement = np.concatenate((accel_B, magGuass_B), axis=0)
    self.xHat = self.xHatBar + np.matmul(self.K, measurement - self.yHatBar)
    self.xHat[0:4] = self.normalizeQuat(self.xHat[0:4])
    self.p = np.matmul(np.identity(7) - np.matmul(self.K, self.C), self.pBar)</pre>
<p>We are now done with the implentation! Go ahead and run the program to check out how awesome it is! Here’s a picture of how it the program should look like when it is run! (:</p>
<figure id="attachment_1997" aria-describedby="caption-attachment-1997" style="width: 740px" class="wp-caption aligncenter"><img loading="lazy" class="size-full wp-image-1997" src="./Attitude Determination with Quaternion using Extended Kalman Filter Archives - ThePoorEngineer_files/DisplayImage.jpg" alt="" width="740" height="589" srcset="https://thepoorengineer.com/wp-content/uploads/2018/09/DisplayImage.jpg 740w, https://thepoorengineer.com/wp-content/uploads/2018/09/DisplayImage-300x239.jpg 300w" sizes="(max-width: 740px) 100vw, 740px"><figcaption id="caption-attachment-1997" class="wp-caption-text">Python Implementation Display</figcaption></figure>
<div id="conclusion"></div>
<hr>
<h2>Conclusion</h2>
<p>This project took about 2 months for me to complete, partly because of my lack of knowledge, and also partly due to the inaccurate sources that I was reading up in the internet. Now that I am finally at the conclusion, I must say that I have learnt a lot, and there are actually a lot more that can be done to improve the program/algorithm.</p>
<p>One thing that I felt was weird was the equation (4K) where we added the difference between the estimated values and actual measured values to our quaternion. For most parameters, this is perfectly normal. For example, you can add to accelerations or velocities to say that it is accelerating or moving faster. However, additions to quaternion do not have any symbolic meaning. In fact, what we wanted to achieve is to add a small rotation to correct for the orientation thus we should not be adding to the quaternion, but to the rotation angle in my opinion. However, when implemented, the above works so I’m not really sure what is going on with the mathematics in there. There are journal papers which does what I described but the complexity is on a whole new level so I am not going to introduce it. If you are interested, they are called “Multiplicative Extended Kalman Filter (MEKF)” and a simple search in google should show many related articles.</p>
<p>Another thing that I felt could be done better (but I have not done it yet) is the calibration of the magnetometer. We have successfully mapped the data points on a unit sphere, but the points may still be skewed to one direction. There must be a way for us to take references from different angles and spread the points evenly between the 360 degree azimuth. Also, if you take a careful look at the implementation of equation (3k), you will realize that we are actually inverting a 6×6 matrix. Numpy in python knows how to do it, but not me! Also, inverting huge matrices are often very computationally costly so we should find ways to reduce the dimension of the matrix being inverted as much as possible. There is actually another form of Kalman Filter for this called the Iterated Kalman Filter. I have not yet read it through but it seems to be able to solve the problem that I just mentioned.</p>
<p>There are clearly much more work that we can do to improve the logic but for now, lets run the program and enjoy the fruits of our labour! (:</p>
    
    
                       
	</div><!-- .entry-content -->

	<footer class="entry-footer">
			</footer><!-- .entry-footer -->
</article><!-- #post-## -->








<article id="post-1852" class="post-1852 post type-post status-publish format-standard hentry category-attitude-determination-with-quaternion-using-ekf clearfix" itemscope="itemscope" itemtype="http://schema.org/BlogPosting" itemprop="blogPost">

	   
	<header class="entry-header">
  
		<h2 class="entry-title" itemprop="headline"><a href="https://thepoorengineer.com/en/calibrating-the-magnetometer/" rel="bookmark">Calibrating the Magnetometer</a></h2>    
    

				<div class="entry-meta">
			<span class="posted-on">Posted on <a href="https://thepoorengineer.com/en/calibrating-the-magnetometer/" rel="bookmark"><time class="entry-date published" datetime="2018-07-28T12:11:26+09:00">July 28, 2018</time><time class="updated" datetime="2018-09-10T22:28:44+09:00" itemprop="dateUpdated">September 10, 2018</time></a></span>		</div><!-- .entry-meta -->
			</header><!-- .entry-header -->

	<div class="entry-content" itemprop="text">
    
    
  	<h3>Table of Contents</h3>
<ol>
<li><a href="https://thepoorengineer.com/en/attitude-determination/">Foreword and Introduction</a></li>
<li><a href="https://thepoorengineer.com/en/graphics/">Preparing the Graphics</a>
<ul>
<li><a href="https://thepoorengineer.com/en/graphics/#wireframe">Creating the Wireframe</a></li>
<li><a href="https://thepoorengineer.com/en/graphics/#perspective">Creating a Perspective View</a></li>
<li><a href="https://thepoorengineer.com/en/graphics/#pygame">Drawing in Pygame</a></li>
</ul>
</li>
<li><a href="https://thepoorengineer.com/en/quaternion/">Quaternion Rotation</a>
<ul>
<li><a href="https://thepoorengineer.com/en/quaternion/#quaternion">Quaternion basics</a></li>
<li><a href="https://thepoorengineer.com/en/quaternion/#testRotation">Testing Quaternion Rotation in Pygame</a></li>
<li><a href="https://thepoorengineer.com/en/quaternion/#gyroRotation">Implementing Rotations with MEMS Gyrometer Data</a></li>
</ul>
</li>
<li><strong><span style="color: red;">Calibrating the Magnetometer</span></strong>
<ul>
<li><strong><a href="https://thepoorengineer.com/en/category/projects/attitude-determination-with-quaternion-using-ekf/#ErrorModel">Error Modelling</a></strong></li>
<li><strong><a href="https://thepoorengineer.com/en/category/projects/attitude-determination-with-quaternion-using-ekf/#MeasurementModel">Measurement Model</a></strong></li>
<li><strong><a href="https://thepoorengineer.com/en/category/projects/attitude-determination-with-quaternion-using-ekf/#Calibration">Calibration</a></strong></li>
</ul>
</li>
<li><a href="https://thepoorengineer.com/en/ekf-impl/">Extended Kalman Filter Implementation</a>
<ul>
<li><a href="https://thepoorengineer.com/en/ekf-impl/#KalmanStates">Kalman Filter States</a></li>
<li><a href="https://thepoorengineer.com/en/ekf-impl/#AccelData">Accelerometer Data</a></li>
<li><a href="https://thepoorengineer.com/en/ekf-impl/#MagData">Magnetometer Data</a></li>
<li><a href="https://thepoorengineer.com/en/ekf-impl/#EKFimpl">Quaternion EKF Implementation</a></li>
</ul>
</li>
<li><a href="https://thepoorengineer.com/en/ekf-impl/#conclusion">Conclusion</a></li>
</ol>
<p>In order to remove the bias from the 3-axis gyroscope, we would require a reference for at least 2 of the axis for a fully defined solution. This can be visualized simply.First, position your fingers similar to that of&nbsp;Fleming’s Right-hand Rule. The 3 fingers show the x (thumb), y (index), z (middle). You will realize that when you lock the direction of one finger in place, you could still rotate your hand in some way. However, if you lock the direction of any 2 fingers, you’ll find that there is no way for you to rotate your hand anymore. This means that we will need at least 2 references for the axis to lock the 3 directional vectors in place.</p>
<p>In order to do so, we are going to use the accelerometer (gravity vector always points to the ground) and the magnetometer (Earth’s magnetic field always points to the Magnetic North). In this post, I will talk about the calibration of the Magnetometer. Calibration of the accelerometer is not done because the raw data is already quite “clean”.</p>
<p>What we want to get from the magnetometer is the North directional vector. However, there are all sorts of errors that influence the actual measurement thus there is a need to perform a calibration for the magnetometer before using it. The magnetometer module that I was using was the&nbsp;<strong><a href="https://www.pololu.com/file/0J703/LSM303D.pdf">LSM303D</a></strong>. It came together with the <strong><a href="https://www.pololu.com/product/2468">Pololu&nbsp;MinIMU-9 v3</a>&nbsp;</strong>which is now discontinued but the model is not really that important because the calibration method mentioned here should work for all magnetometers.</p>
<p>I got my study materials from a few journal papers, but this <strong><a href="https://teslabs.com/articles/magnetometer-calibration/">website</a> </strong>was the most helpful because it actually explains the actually method concisely. In fact, what I am going to explain here will be almost similar to what is written in the <strong><a href="https://teslabs.com/articles/magnetometer-calibration/">website</a>&nbsp;</strong>so you can just check out either one (I hope mine is easier to understand!).</p>
<div id="ErrorModel"></div>
<hr>
<h2>Error Modelling</h2>
<p>In this section, I will list down a few of the common errors found in a magnetometer together with its mathematical model.</p>
<h6><span style="text-decoration: underline;">Scale Factor</span></h6>
<p>Alright, this is not really an error due to noise but we will require some form of scaling for the input in order to generate outputs that fall within our desired range. For example, we might want to normalize our 3 direction vectors to have a value between 0 to 1. This can be modeled mathematically with a diagonal matrix as</p>
<p style="text-align: center;"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-156-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;S&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mrow&gt;&lt;mo&gt;[&lt;/mo&gt;&lt;mtable rowspacing=&quot;4pt&quot; columnspacing=&quot;1em&quot;&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;/mtable&gt;&lt;mo&gt;]&lt;/mo&gt;&lt;/mrow&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-5814" style="width: 10.487em; display: inline-block;"><span style="display: inline-block; position: relative; width: 8.44em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(2.174em, 1008.13em, 6.393em, -999.997em); top: -4.525em; left: 0em;"><span class="mrow" id="MathJax-Span-5815"><span class="mi" id="MathJax-Span-5816" style="font-family: MathJax_Math-italic;">S<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.065em;"></span></span><span class="mo" id="MathJax-Span-5817" style="font-family: MathJax_Main; padding-left: 0.251em;">=</span><span class="mrow" id="MathJax-Span-5818" style="padding-left: 0.251em;"><span class="mo" id="MathJax-Span-5819" style="vertical-align: 2.174em;"><span style="display: inline-block; position: relative; width: 0.685em; height: 0px;"><span style="position: absolute; font-family: MathJax_Size4; top: -2.788em; left: 0em;">⎡<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; font-family: MathJax_Size4; top: -0.741em; left: 0em;">⎣<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -1.734em; left: 0em;">⎢<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="mtable" id="MathJax-Span-5820" style="padding-right: 0.189em; padding-left: 0.189em;"><span style="display: inline-block; position: relative; width: 4.718em; height: 0px;"><span style="position: absolute; clip: rect(2.298em, 1000.93em, 6.02em, -999.997em); top: -4.339em; left: 0em;"><span style="display: inline-block; position: relative; width: 0.934em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.93em, 4.346em, -999.997em); top: -5.394em; left: 50%; margin-left: -0.493em;"><span class="mtd" id="MathJax-Span-5821"><span class="mrow" id="MathJax-Span-5822"><span class="msubsup" id="MathJax-Span-5823"><span style="display: inline-block; position: relative; width: 0.934em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.44em, 4.159em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-5824" style="font-family: MathJax_Math-italic;">s</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.499em;"><span class="mi" id="MathJax-Span-5825" style="font-size: 70.7%; font-family: MathJax_Math-italic;">x</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.105em, 1000.44em, 4.159em, -999.997em); top: -3.967em; left: 50%; margin-left: -0.245em;"><span class="mtd" id="MathJax-Span-5832"><span class="mrow" id="MathJax-Span-5833"><span class="mn" id="MathJax-Span-5834" style="font-family: MathJax_Main;">0</span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.105em, 1000.44em, 4.159em, -999.997em); top: -2.478em; left: 50%; margin-left: -0.245em;"><span class="mtd" id="MathJax-Span-5843"><span class="mrow" id="MathJax-Span-5844"><span class="mn" id="MathJax-Span-5845" style="font-family: MathJax_Main;">0</span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.346em;"></span></span><span style="position: absolute; clip: rect(2.36em, 1000.87em, 6.269em, -999.997em); top: -4.587em; left: 1.926em;"><span style="display: inline-block; position: relative; width: 0.872em; height: 0px;"><span style="position: absolute; clip: rect(3.105em, 1000.44em, 4.159em, -999.997em); top: -5.394em; left: 50%; margin-left: -0.245em;"><span class="mtd" id="MathJax-Span-5826"><span class="mrow" id="MathJax-Span-5827"><span class="mn" id="MathJax-Span-5828" style="font-family: MathJax_Main;">0</span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.353em, 1000.87em, 4.47em, -999.997em); top: -3.967em; left: 50%; margin-left: -0.431em;"><span class="mtd" id="MathJax-Span-5835"><span class="mrow" id="MathJax-Span-5836"><span class="msubsup" id="MathJax-Span-5837"><span style="display: inline-block; position: relative; width: 0.872em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.44em, 4.159em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-5838" style="font-family: MathJax_Math-italic;">s</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.499em;"><span class="mi" id="MathJax-Span-5839" style="font-size: 70.7%; font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.105em, 1000.44em, 4.159em, -999.997em); top: -2.478em; left: 50%; margin-left: -0.245em;"><span class="mtd" id="MathJax-Span-5846"><span class="mrow" id="MathJax-Span-5847"><span class="mn" id="MathJax-Span-5848" style="font-family: MathJax_Main;">0</span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.594em;"></span></span><span style="position: absolute; clip: rect(2.484em, 1000.87em, 6.579em, -999.997em); top: -4.712em; left: 3.849em;"><span style="display: inline-block; position: relative; width: 0.872em; height: 0px;"><span style="position: absolute; clip: rect(3.105em, 1000.44em, 4.159em, -999.997em); top: -5.394em; left: 50%; margin-left: -0.245em;"><span class="mtd" id="MathJax-Span-5829"><span class="mrow" id="MathJax-Span-5830"><span class="mn" id="MathJax-Span-5831" style="font-family: MathJax_Main;">0</span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.105em, 1000.44em, 4.159em, -999.997em); top: -3.967em; left: 50%; margin-left: -0.245em;"><span class="mtd" id="MathJax-Span-5840"><span class="mrow" id="MathJax-Span-5841"><span class="mn" id="MathJax-Span-5842" style="font-family: MathJax_Main;">0</span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.353em, 1000.87em, 4.346em, -999.997em); top: -2.478em; left: 50%; margin-left: -0.431em;"><span class="mtd" id="MathJax-Span-5849"><span class="mrow" id="MathJax-Span-5850"><span class="msubsup" id="MathJax-Span-5851"><span style="display: inline-block; position: relative; width: 0.872em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.44em, 4.159em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-5852" style="font-family: MathJax_Math-italic;">s</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.499em;"><span class="mi" id="MathJax-Span-5853" style="font-size: 70.7%; font-family: MathJax_Math-italic;">z<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.718em;"></span></span></span></span><span class="mo" id="MathJax-Span-5854" style="vertical-align: 2.174em;"><span style="display: inline-block; position: relative; width: 0.685em; height: 0px;"><span style="position: absolute; font-family: MathJax_Size4; top: -2.788em; left: 0em;">⎤<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; font-family: MathJax_Size4; top: -0.741em; left: 0em;">⎦<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -1.734em; left: 0em;">⎥<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.532em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -2.15em; border-left: 0px solid; width: 0px; height: 5.004em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>S</mi><mo>=</mo><mrow><mo>[</mo><mtable rowspacing="4pt" columnspacing="1em"><mtr><mtd><msub><mi>s</mi><mi>x</mi></msub></mtd><mtd><mn>0</mn></mtd><mtd><mn>0</mn></mtd></mtr><mtr><mtd><mn>0</mn></mtd><mtd><msub><mi>s</mi><mi>y</mi></msub></mtd><mtd><mn>0</mn></mtd></mtr><mtr><mtd><mn>0</mn></mtd><mtd><mn>0</mn></mtd><mtd><msub><mi>s</mi><mi>z</mi></msub></mtd></mtr></mtable><mo>]</mo></mrow></math></span></span><script type="math/tex" id="MathJax-Element-156">S = \begin{bmatrix} s_x & 0 & 0 \\ 0 & s_y & 0 \\ 0 & 0 & s_z \end{bmatrix}</script></p>
<h6><span style="text-decoration: underline;">Misalignment Error</span></h6>
<p>When setting up the sensors on module, the 3 axis will most probably be somewhat misaligned because we can never position it perfectly. This causes the measurement axis to be skewed such that it is not exactly orthogonal. This can be modeled via</p>
<p style="text-align: center;"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-157-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;N&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mrow&gt;&lt;mo&gt;[&lt;/mo&gt;&lt;mtable rowspacing=&quot;4pt&quot; columnspacing=&quot;1em&quot;&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;/mtable&gt;&lt;mo&gt;]&lt;/mo&gt;&lt;/mrow&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-5855" style="width: 13.403em; display: inline-block;"><span style="display: inline-block; position: relative; width: 10.797em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(2.174em, 1010.49em, 6.641em, -999.997em); top: -4.65em; left: 0em;"><span class="mrow" id="MathJax-Span-5856"><span class="mi" id="MathJax-Span-5857" style="font-family: MathJax_Math-italic;">N<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.065em;"></span></span><span class="mo" id="MathJax-Span-5858" style="font-family: MathJax_Main; padding-left: 0.251em;">=</span><span class="mrow" id="MathJax-Span-5859" style="padding-left: 0.251em;"><span class="mo" id="MathJax-Span-5860" style="vertical-align: 2.298em;"><span style="display: inline-block; position: relative; width: 0.685em; height: 0px;"><span style="position: absolute; font-family: MathJax_Size4; top: -2.788em; left: 0em;">⎡<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; font-family: MathJax_Size4; top: -0.555em; left: 0em;">⎣<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -1.61em; left: 0em;">⎢<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="mtable" id="MathJax-Span-5861" style="padding-right: 0.189em; padding-left: 0.189em;"><span style="display: inline-block; position: relative; width: 6.889em; height: 0px;"><span style="position: absolute; clip: rect(2.609em, 1001.68em, 6.703em, -999.997em); top: -4.712em; left: 0em;"><span style="display: inline-block; position: relative; width: 1.678em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1001.68em, 4.47em, -999.997em); top: -5.456em; left: 50%; margin-left: -0.865em;"><span class="mtd" id="MathJax-Span-5862"><span class="mrow" id="MathJax-Span-5863"><span class="msubsup" id="MathJax-Span-5864"><span style="display: inline-block; position: relative; width: 1.678em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.56em, 4.159em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-5865" style="font-family: MathJax_Math-italic;">n</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.623em;"><span class="texatom" id="MathJax-Span-5866"><span class="mrow" id="MathJax-Span-5867"><span class="mi" id="MathJax-Span-5868" style="font-size: 70.7%; font-family: MathJax_Math-italic;">x</span><span class="mo" id="MathJax-Span-5869" style="font-size: 70.7%; font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-5870" style="font-size: 70.7%; font-family: MathJax_Math-italic;">x</span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.353em, 1001.62em, 4.47em, -999.997em); top: -3.967em; left: 50%; margin-left: -0.803em;"><span class="mtd" id="MathJax-Span-5889"><span class="mrow" id="MathJax-Span-5890"><span class="msubsup" id="MathJax-Span-5891"><span style="display: inline-block; position: relative; width: 1.616em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.56em, 4.159em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-5892" style="font-family: MathJax_Math-italic;">n</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.623em;"><span class="texatom" id="MathJax-Span-5893"><span class="mrow" id="MathJax-Span-5894"><span class="mi" id="MathJax-Span-5895" style="font-size: 70.7%; font-family: MathJax_Math-italic;">x</span><span class="mo" id="MathJax-Span-5896" style="font-size: 70.7%; font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-5897" style="font-size: 70.7%; font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.353em, 1001.62em, 4.47em, -999.997em); top: -2.478em; left: 50%; margin-left: -0.803em;"><span class="mtd" id="MathJax-Span-5916"><span class="mrow" id="MathJax-Span-5917"><span class="msubsup" id="MathJax-Span-5918"><span style="display: inline-block; position: relative; width: 1.616em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.56em, 4.159em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-5919" style="font-family: MathJax_Math-italic;">n</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.623em;"><span class="texatom" id="MathJax-Span-5920"><span class="mrow" id="MathJax-Span-5921"><span class="mi" id="MathJax-Span-5922" style="font-size: 70.7%; font-family: MathJax_Math-italic;">x</span><span class="mo" id="MathJax-Span-5923" style="font-size: 70.7%; font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-5924" style="font-size: 70.7%; font-family: MathJax_Math-italic;">z<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.718em;"></span></span><span style="position: absolute; clip: rect(2.609em, 1001.62em, 6.703em, -999.997em); top: -4.712em; left: 2.671em;"><span style="display: inline-block; position: relative; width: 1.616em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1001.62em, 4.47em, -999.997em); top: -5.456em; left: 50%; margin-left: -0.803em;"><span class="mtd" id="MathJax-Span-5871"><span class="mrow" id="MathJax-Span-5872"><span class="msubsup" id="MathJax-Span-5873"><span style="display: inline-block; position: relative; width: 1.616em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.56em, 4.159em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-5874" style="font-family: MathJax_Math-italic;">n</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.623em;"><span class="texatom" id="MathJax-Span-5875"><span class="mrow" id="MathJax-Span-5876"><span class="mi" id="MathJax-Span-5877" style="font-size: 70.7%; font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-5878" style="font-size: 70.7%; font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-5879" style="font-size: 70.7%; font-family: MathJax_Math-italic;">x</span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.353em, 1001.55em, 4.47em, -999.997em); top: -3.967em; left: 50%; margin-left: -0.803em;"><span class="mtd" id="MathJax-Span-5898"><span class="mrow" id="MathJax-Span-5899"><span class="msubsup" id="MathJax-Span-5900"><span style="display: inline-block; position: relative; width: 1.554em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.56em, 4.159em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-5901" style="font-family: MathJax_Math-italic;">n</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.623em;"><span class="texatom" id="MathJax-Span-5902"><span class="mrow" id="MathJax-Span-5903"><span class="mi" id="MathJax-Span-5904" style="font-size: 70.7%; font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-5905" style="font-size: 70.7%; font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-5906" style="font-size: 70.7%; font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.353em, 1001.55em, 4.47em, -999.997em); top: -2.478em; left: 50%; margin-left: -0.803em;"><span class="mtd" id="MathJax-Span-5925"><span class="mrow" id="MathJax-Span-5926"><span class="msubsup" id="MathJax-Span-5927"><span style="display: inline-block; position: relative; width: 1.554em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.56em, 4.159em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-5928" style="font-family: MathJax_Math-italic;">n</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.623em;"><span class="texatom" id="MathJax-Span-5929"><span class="mrow" id="MathJax-Span-5930"><span class="mi" id="MathJax-Span-5931" style="font-size: 70.7%; font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-5932" style="font-size: 70.7%; font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-5933" style="font-size: 70.7%; font-family: MathJax_Math-italic;">z<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.718em;"></span></span><span style="position: absolute; clip: rect(2.609em, 1001.62em, 6.703em, -999.997em); top: -4.712em; left: 5.338em;"><span style="display: inline-block; position: relative; width: 1.616em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1001.62em, 4.47em, -999.997em); top: -5.456em; left: 50%; margin-left: -0.803em;"><span class="mtd" id="MathJax-Span-5880"><span class="mrow" id="MathJax-Span-5881"><span class="msubsup" id="MathJax-Span-5882"><span style="display: inline-block; position: relative; width: 1.616em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.56em, 4.159em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-5883" style="font-family: MathJax_Math-italic;">n</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.623em;"><span class="texatom" id="MathJax-Span-5884"><span class="mrow" id="MathJax-Span-5885"><span class="mi" id="MathJax-Span-5886" style="font-size: 70.7%; font-family: MathJax_Math-italic;">z<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-5887" style="font-size: 70.7%; font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-5888" style="font-size: 70.7%; font-family: MathJax_Math-italic;">x</span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.353em, 1001.55em, 4.47em, -999.997em); top: -3.967em; left: 50%; margin-left: -0.803em;"><span class="mtd" id="MathJax-Span-5907"><span class="mrow" id="MathJax-Span-5908"><span class="msubsup" id="MathJax-Span-5909"><span style="display: inline-block; position: relative; width: 1.554em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.56em, 4.159em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-5910" style="font-family: MathJax_Math-italic;">n</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.623em;"><span class="texatom" id="MathJax-Span-5911"><span class="mrow" id="MathJax-Span-5912"><span class="mi" id="MathJax-Span-5913" style="font-size: 70.7%; font-family: MathJax_Math-italic;">z<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-5914" style="font-size: 70.7%; font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-5915" style="font-size: 70.7%; font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.353em, 1001.55em, 4.47em, -999.997em); top: -2.478em; left: 50%; margin-left: -0.741em;"><span class="mtd" id="MathJax-Span-5934"><span class="mrow" id="MathJax-Span-5935"><span class="msubsup" id="MathJax-Span-5936"><span style="display: inline-block; position: relative; width: 1.554em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.56em, 4.159em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-5937" style="font-family: MathJax_Math-italic;">n</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.623em;"><span class="texatom" id="MathJax-Span-5938"><span class="mrow" id="MathJax-Span-5939"><span class="mi" id="MathJax-Span-5940" style="font-size: 70.7%; font-family: MathJax_Math-italic;">z<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-5941" style="font-size: 70.7%; font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-5942" style="font-size: 70.7%; font-family: MathJax_Math-italic;">z<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.718em;"></span></span></span></span><span class="mo" id="MathJax-Span-5943" style="vertical-align: 2.298em;"><span style="display: inline-block; position: relative; width: 0.685em; height: 0px;"><span style="position: absolute; font-family: MathJax_Size4; top: -2.788em; left: 0em;">⎤<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; font-family: MathJax_Size4; top: -0.555em; left: 0em;">⎦<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -1.61em; left: 0em;">⎥<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.656em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -2.304em; border-left: 0px solid; width: 0px; height: 5.235em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>N</mi><mo>=</mo><mrow><mo>[</mo><mtable rowspacing="4pt" columnspacing="1em"><mtr><mtd><msub><mi>n</mi><mrow class="MJX-TeXAtom-ORD"><mi>x</mi><mo>,</mo><mi>x</mi></mrow></msub></mtd><mtd><msub><mi>n</mi><mrow class="MJX-TeXAtom-ORD"><mi>y</mi><mo>,</mo><mi>x</mi></mrow></msub></mtd><mtd><msub><mi>n</mi><mrow class="MJX-TeXAtom-ORD"><mi>z</mi><mo>,</mo><mi>x</mi></mrow></msub></mtd></mtr><mtr><mtd><msub><mi>n</mi><mrow class="MJX-TeXAtom-ORD"><mi>x</mi><mo>,</mo><mi>y</mi></mrow></msub></mtd><mtd><msub><mi>n</mi><mrow class="MJX-TeXAtom-ORD"><mi>y</mi><mo>,</mo><mi>y</mi></mrow></msub></mtd><mtd><msub><mi>n</mi><mrow class="MJX-TeXAtom-ORD"><mi>z</mi><mo>,</mo><mi>y</mi></mrow></msub></mtd></mtr><mtr><mtd><msub><mi>n</mi><mrow class="MJX-TeXAtom-ORD"><mi>x</mi><mo>,</mo><mi>z</mi></mrow></msub></mtd><mtd><msub><mi>n</mi><mrow class="MJX-TeXAtom-ORD"><mi>y</mi><mo>,</mo><mi>z</mi></mrow></msub></mtd><mtd><msub><mi>n</mi><mrow class="MJX-TeXAtom-ORD"><mi>z</mi><mo>,</mo><mi>z</mi></mrow></msub></mtd></mtr></mtable><mo>]</mo></mrow></math></span></span><script type="math/tex" id="MathJax-Element-157">N = \begin{bmatrix} n_{x,x} & n_{y,x} & n_{z,x} \\ n_{x,y} & n_{y,y} & n_{z,y} \\ n_{x,z} & n_{y,z} & n_{z,z} \end{bmatrix}</script></p>
<p>where each column represents the orientation of the respective axis with respect to the orthogonal axis.</p>
<h6><span style="text-decoration: underline;">Bias Error</span></h6>
<p>The bias error is the error that shifts the measurement values away from the actual value by a fixed amount. If the mean of the actual measurement is 100, then having a bias of 10 would mean that the mean of the measurement reading will be 110. This can be modeled by a simple offset vector as shown below.</p>
<p style="text-align: center;"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-158-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;mi&gt;m&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mrow&gt;&lt;mo&gt;[&lt;/mo&gt;&lt;mtable rowspacing=&quot;4pt&quot; columnspacing=&quot;1em&quot;&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;m&lt;/mi&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;m&lt;/mi&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;m&lt;/mi&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;/mtable&gt;&lt;mo&gt;]&lt;/mo&gt;&lt;/mrow&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-5944" style="width: 7.323em; display: inline-block;"><span style="display: inline-block; position: relative; width: 5.896em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(2.174em, 1005.59em, 6.641em, -999.997em); top: -4.65em; left: 0em;"><span class="mrow" id="MathJax-Span-5945"><span class="msubsup" id="MathJax-Span-5946"><span style="display: inline-block; position: relative; width: 1.12em; height: 0px;"><span style="position: absolute; clip: rect(3.105em, 1000.44em, 4.159em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-5947" style="font-family: MathJax_Math-italic;">b</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.437em;"><span class="mi" id="MathJax-Span-5948" style="font-size: 70.7%; font-family: MathJax_Math-italic;">m</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="mo" id="MathJax-Span-5949" style="font-family: MathJax_Main; padding-left: 0.251em;">=</span><span class="mrow" id="MathJax-Span-5950" style="padding-left: 0.251em;"><span class="mo" id="MathJax-Span-5951" style="vertical-align: 2.298em;"><span style="display: inline-block; position: relative; width: 0.685em; height: 0px;"><span style="position: absolute; font-family: MathJax_Size4; top: -2.788em; left: 0em;">⎡<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; font-family: MathJax_Size4; top: -0.555em; left: 0em;">⎣<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -1.61em; left: 0em;">⎢<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="mtable" id="MathJax-Span-5952" style="padding-right: 0.189em; padding-left: 0.189em;"><span style="display: inline-block; position: relative; width: 1.74em; height: 0px;"><span style="position: absolute; clip: rect(2.609em, 1001.74em, 6.951em, -999.997em); top: -4.96em; left: 0em;"><span style="display: inline-block; position: relative; width: 1.74em; height: 0px;"><span style="position: absolute; clip: rect(3.105em, 1001.74em, 4.47em, -999.997em); top: -5.456em; left: 50%; margin-left: -0.865em;"><span class="mtd" id="MathJax-Span-5953"><span class="mrow" id="MathJax-Span-5954"><span class="msubsup" id="MathJax-Span-5955"><span style="display: inline-block; position: relative; width: 1.74em; height: 0px;"><span style="position: absolute; clip: rect(3.105em, 1000.44em, 4.159em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-5956" style="font-family: MathJax_Math-italic;">b</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.437em;"><span class="texatom" id="MathJax-Span-5957"><span class="mrow" id="MathJax-Span-5958"><span class="mi" id="MathJax-Span-5959" style="font-size: 70.7%; font-family: MathJax_Math-italic;">m</span><span class="mo" id="MathJax-Span-5960" style="font-size: 70.7%; font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-5961" style="font-size: 70.7%; font-family: MathJax_Math-italic;">x</span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.105em, 1001.68em, 4.47em, -999.997em); top: -3.967em; left: 50%; margin-left: -0.803em;"><span class="mtd" id="MathJax-Span-5962"><span class="mrow" id="MathJax-Span-5963"><span class="msubsup" id="MathJax-Span-5964"><span style="display: inline-block; position: relative; width: 1.678em; height: 0px;"><span style="position: absolute; clip: rect(3.105em, 1000.44em, 4.159em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-5965" style="font-family: MathJax_Math-italic;">b</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.437em;"><span class="texatom" id="MathJax-Span-5966"><span class="mrow" id="MathJax-Span-5967"><span class="mi" id="MathJax-Span-5968" style="font-size: 70.7%; font-family: MathJax_Math-italic;">m</span><span class="mo" id="MathJax-Span-5969" style="font-size: 70.7%; font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-5970" style="font-size: 70.7%; font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.105em, 1001.68em, 4.47em, -999.997em); top: -2.478em; left: 50%; margin-left: -0.803em;"><span class="mtd" id="MathJax-Span-5971"><span class="mrow" id="MathJax-Span-5972"><span class="msubsup" id="MathJax-Span-5973"><span style="display: inline-block; position: relative; width: 1.678em; height: 0px;"><span style="position: absolute; clip: rect(3.105em, 1000.44em, 4.159em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-5974" style="font-family: MathJax_Math-italic;">b</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.437em;"><span class="texatom" id="MathJax-Span-5975"><span class="mrow" id="MathJax-Span-5976"><span class="mi" id="MathJax-Span-5977" style="font-size: 70.7%; font-family: MathJax_Math-italic;">m</span><span class="mo" id="MathJax-Span-5978" style="font-size: 70.7%; font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-5979" style="font-size: 70.7%; font-family: MathJax_Math-italic;">z<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.966em;"></span></span></span></span><span class="mo" id="MathJax-Span-5980" style="vertical-align: 2.298em;"><span style="display: inline-block; position: relative; width: 0.685em; height: 0px;"><span style="position: absolute; font-family: MathJax_Size4; top: -2.788em; left: 0em;">⎤<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; font-family: MathJax_Size4; top: -0.555em; left: 0em;">⎦<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -1.61em; left: 0em;">⎥<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.656em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -2.304em; border-left: 0px solid; width: 0px; height: 5.235em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>b</mi><mi>m</mi></msub><mo>=</mo><mrow><mo>[</mo><mtable rowspacing="4pt" columnspacing="1em"><mtr><mtd><msub><mi>b</mi><mrow class="MJX-TeXAtom-ORD"><mi>m</mi><mo>,</mo><mi>x</mi></mrow></msub></mtd></mtr><mtr><mtd><msub><mi>b</mi><mrow class="MJX-TeXAtom-ORD"><mi>m</mi><mo>,</mo><mi>y</mi></mrow></msub></mtd></mtr><mtr><mtd><msub><mi>b</mi><mrow class="MJX-TeXAtom-ORD"><mi>m</mi><mo>,</mo><mi>z</mi></mrow></msub></mtd></mtr></mtable><mo>]</mo></mrow></math></span></span><script type="math/tex" id="MathJax-Element-158">b_m = \begin{bmatrix} b_{m,x} \\ b_{m,y} \\ b_{m,z} \end{bmatrix}</script></p>
<h6><span style="text-decoration: underline;">Hard Iron Error</span></h6>
<p>Hard iron errors appear due to the presence of permanent magnets and&nbsp;remanence of magnetized iron. The effect of hard iron errors is the same as having a bias (think of it as the permanent magnet pulling the North direction vector towards it) so the error model is similar as well.</p>
<p style="text-align: center;"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-159-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;h&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mrow&gt;&lt;mo&gt;[&lt;/mo&gt;&lt;mtable rowspacing=&quot;4pt&quot; columnspacing=&quot;1em&quot;&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;h&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;h&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;h&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;/mtable&gt;&lt;mo&gt;]&lt;/mo&gt;&lt;/mrow&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-5981" style="width: 7.385em; display: inline-block;"><span style="display: inline-block; position: relative; width: 5.958em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(2.174em, 1005.65em, 6.641em, -999.997em); top: -4.65em; left: 0em;"><span class="mrow" id="MathJax-Span-5982"><span class="msubsup" id="MathJax-Span-5983"><span style="display: inline-block; position: relative; width: 1.182em; height: 0px;"><span style="position: absolute; clip: rect(3.105em, 1000.44em, 4.159em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-5984" style="font-family: MathJax_Math-italic;">b</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.437em;"><span class="texatom" id="MathJax-Span-5985"><span class="mrow" id="MathJax-Span-5986"><span class="mi" id="MathJax-Span-5987" style="font-size: 70.7%; font-family: MathJax_Math-italic;">h</span><span class="mi" id="MathJax-Span-5988" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="mo" id="MathJax-Span-5989" style="font-family: MathJax_Main; padding-left: 0.251em;">=</span><span class="mrow" id="MathJax-Span-5990" style="padding-left: 0.251em;"><span class="mo" id="MathJax-Span-5991" style="vertical-align: 2.298em;"><span style="display: inline-block; position: relative; width: 0.685em; height: 0px;"><span style="position: absolute; font-family: MathJax_Size4; top: -2.788em; left: 0em;">⎡<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; font-family: MathJax_Size4; top: -0.555em; left: 0em;">⎣<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -1.61em; left: 0em;">⎢<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="mtable" id="MathJax-Span-5992" style="padding-right: 0.189em; padding-left: 0.189em;"><span style="display: inline-block; position: relative; width: 1.74em; height: 0px;"><span style="position: absolute; clip: rect(2.609em, 1001.74em, 6.951em, -999.997em); top: -4.96em; left: 0em;"><span style="display: inline-block; position: relative; width: 1.74em; height: 0px;"><span style="position: absolute; clip: rect(3.105em, 1001.74em, 4.47em, -999.997em); top: -5.456em; left: 50%; margin-left: -0.865em;"><span class="mtd" id="MathJax-Span-5993"><span class="mrow" id="MathJax-Span-5994"><span class="msubsup" id="MathJax-Span-5995"><span style="display: inline-block; position: relative; width: 1.74em; height: 0px;"><span style="position: absolute; clip: rect(3.105em, 1000.44em, 4.159em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-5996" style="font-family: MathJax_Math-italic;">b</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.437em;"><span class="texatom" id="MathJax-Span-5997"><span class="mrow" id="MathJax-Span-5998"><span class="mi" id="MathJax-Span-5999" style="font-size: 70.7%; font-family: MathJax_Math-italic;">h</span><span class="mi" id="MathJax-Span-6000" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span class="mo" id="MathJax-Span-6001" style="font-size: 70.7%; font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-6002" style="font-size: 70.7%; font-family: MathJax_Math-italic;">x</span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.105em, 1001.68em, 4.47em, -999.997em); top: -3.967em; left: 50%; margin-left: -0.865em;"><span class="mtd" id="MathJax-Span-6003"><span class="mrow" id="MathJax-Span-6004"><span class="msubsup" id="MathJax-Span-6005"><span style="display: inline-block; position: relative; width: 1.678em; height: 0px;"><span style="position: absolute; clip: rect(3.105em, 1000.44em, 4.159em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-6006" style="font-family: MathJax_Math-italic;">b</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.437em;"><span class="texatom" id="MathJax-Span-6007"><span class="mrow" id="MathJax-Span-6008"><span class="mi" id="MathJax-Span-6009" style="font-size: 70.7%; font-family: MathJax_Math-italic;">h</span><span class="mi" id="MathJax-Span-6010" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span class="mo" id="MathJax-Span-6011" style="font-size: 70.7%; font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-6012" style="font-size: 70.7%; font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.105em, 1001.68em, 4.47em, -999.997em); top: -2.478em; left: 50%; margin-left: -0.865em;"><span class="mtd" id="MathJax-Span-6013"><span class="mrow" id="MathJax-Span-6014"><span class="msubsup" id="MathJax-Span-6015"><span style="display: inline-block; position: relative; width: 1.678em; height: 0px;"><span style="position: absolute; clip: rect(3.105em, 1000.44em, 4.159em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-6016" style="font-family: MathJax_Math-italic;">b</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.437em;"><span class="texatom" id="MathJax-Span-6017"><span class="mrow" id="MathJax-Span-6018"><span class="mi" id="MathJax-Span-6019" style="font-size: 70.7%; font-family: MathJax_Math-italic;">h</span><span class="mi" id="MathJax-Span-6020" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span class="mo" id="MathJax-Span-6021" style="font-size: 70.7%; font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-6022" style="font-size: 70.7%; font-family: MathJax_Math-italic;">z<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.966em;"></span></span></span></span><span class="mo" id="MathJax-Span-6023" style="vertical-align: 2.298em;"><span style="display: inline-block; position: relative; width: 0.685em; height: 0px;"><span style="position: absolute; font-family: MathJax_Size4; top: -2.788em; left: 0em;">⎤<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; font-family: MathJax_Size4; top: -0.555em; left: 0em;">⎦<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -1.61em; left: 0em;">⎥<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.656em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -2.304em; border-left: 0px solid; width: 0px; height: 5.235em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>b</mi><mrow class="MJX-TeXAtom-ORD"><mi>h</mi><mi>i</mi></mrow></msub><mo>=</mo><mrow><mo>[</mo><mtable rowspacing="4pt" columnspacing="1em"><mtr><mtd><msub><mi>b</mi><mrow class="MJX-TeXAtom-ORD"><mi>h</mi><mi>i</mi><mo>,</mo><mi>x</mi></mrow></msub></mtd></mtr><mtr><mtd><msub><mi>b</mi><mrow class="MJX-TeXAtom-ORD"><mi>h</mi><mi>i</mi><mo>,</mo><mi>y</mi></mrow></msub></mtd></mtr><mtr><mtd><msub><mi>b</mi><mrow class="MJX-TeXAtom-ORD"><mi>h</mi><mi>i</mi><mo>,</mo><mi>z</mi></mrow></msub></mtd></mtr></mtable><mo>]</mo></mrow></math></span></span><script type="math/tex" id="MathJax-Element-159">b_{hi} = \begin{bmatrix} b_{hi,x} \\ b_{hi,y} \\ b_{hi,z} \end{bmatrix}</script></p>
<h6><span style="text-decoration: underline;">Soft Iron Error</span></h6>
<p>Soft iron errors appear due to the presence of material that influences or distorts a magnetic field, but does not necessarily generate a magnetic field itself. The presence of iron and nickel for example, will generate a distortion in the measured magnetic field. While hard-iron distortion is constant regardless of orientation, the distortion produced by soft-iron materials is dependent upon the orientation of the material relative to the sensor and the magnetic field. Thus, in order to model this error, a more complicated matrix is required such as shown below.</p>
<p style="text-align: center;"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-160-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;A&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mrow&gt;&lt;mo&gt;[&lt;/mo&gt;&lt;mtable rowspacing=&quot;4pt&quot; columnspacing=&quot;1em&quot;&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mn&gt;00&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mn&gt;01&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mn&gt;02&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mn&gt;10&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mn&gt;11&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mn&gt;12&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mn&gt;20&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mn&gt;21&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mn&gt;22&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;/mtable&gt;&lt;mo&gt;]&lt;/mo&gt;&lt;/mrow&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-6024" style="width: 12.968em; display: inline-block;"><span style="display: inline-block; position: relative; width: 10.425em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(2.174em, 1010.12em, 6.393em, -999.997em); top: -4.525em; left: 0em;"><span class="mrow" id="MathJax-Span-6025"><span class="msubsup" id="MathJax-Span-6026"><span style="display: inline-block; position: relative; width: 1.43em; height: 0px;"><span style="position: absolute; clip: rect(3.043em, 1000.75em, 4.159em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-6027" style="font-family: MathJax_Math-italic;">A</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.748em;"><span class="texatom" id="MathJax-Span-6028"><span class="mrow" id="MathJax-Span-6029"><span class="mi" id="MathJax-Span-6030" style="font-size: 70.7%; font-family: MathJax_Math-italic;">s</span><span class="mi" id="MathJax-Span-6031" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="mo" id="MathJax-Span-6032" style="font-family: MathJax_Main; padding-left: 0.251em;">=</span><span class="mrow" id="MathJax-Span-6033" style="padding-left: 0.251em;"><span class="mo" id="MathJax-Span-6034" style="vertical-align: 2.174em;"><span style="display: inline-block; position: relative; width: 0.685em; height: 0px;"><span style="position: absolute; font-family: MathJax_Size4; top: -2.788em; left: 0em;">⎡<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; font-family: MathJax_Size4; top: -0.803em; left: 0em;">⎣<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -1.796em; left: 0em;">⎢<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="mtable" id="MathJax-Span-6035" style="padding-right: 0.189em; padding-left: 0.189em;"><span style="display: inline-block; position: relative; width: 5.958em; height: 0px;"><span style="position: absolute; clip: rect(2.422em, 1001.31em, 6.207em, -999.997em); top: -4.401em; left: 0em;"><span style="display: inline-block; position: relative; width: 1.306em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1001.31em, 4.346em, -999.997em); top: -5.332em; left: 50%; margin-left: -0.679em;"><span class="mtd" id="MathJax-Span-6036"><span class="mrow" id="MathJax-Span-6037"><span class="msubsup" id="MathJax-Span-6038"><span style="display: inline-block; position: relative; width: 1.306em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.5em, 4.159em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-6039" style="font-family: MathJax_Math-italic;">a</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.561em;"><span class="texatom" id="MathJax-Span-6040"><span class="mrow" id="MathJax-Span-6041"><span class="mn" id="MathJax-Span-6042" style="font-size: 70.7%; font-family: MathJax_Main;">00</span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.353em, 1001.31em, 4.346em, -999.997em); top: -3.905em; left: 50%; margin-left: -0.679em;"><span class="mtd" id="MathJax-Span-6057"><span class="mrow" id="MathJax-Span-6058"><span class="msubsup" id="MathJax-Span-6059"><span style="display: inline-block; position: relative; width: 1.306em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.5em, 4.159em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-6060" style="font-family: MathJax_Math-italic;">a</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.561em;"><span class="texatom" id="MathJax-Span-6061"><span class="mrow" id="MathJax-Span-6062"><span class="mn" id="MathJax-Span-6063" style="font-size: 70.7%; font-family: MathJax_Main;">10</span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.353em, 1001.31em, 4.346em, -999.997em); top: -2.54em; left: 50%; margin-left: -0.679em;"><span class="mtd" id="MathJax-Span-6078"><span class="mrow" id="MathJax-Span-6079"><span class="msubsup" id="MathJax-Span-6080"><span style="display: inline-block; position: relative; width: 1.306em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.5em, 4.159em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-6081" style="font-family: MathJax_Math-italic;">a</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.561em;"><span class="texatom" id="MathJax-Span-6082"><span class="mrow" id="MathJax-Span-6083"><span class="mn" id="MathJax-Span-6084" style="font-size: 70.7%; font-family: MathJax_Main;">20</span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.408em;"></span></span><span style="position: absolute; clip: rect(2.422em, 1001.31em, 6.207em, -999.997em); top: -4.401em; left: 2.298em;"><span style="display: inline-block; position: relative; width: 1.306em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1001.31em, 4.346em, -999.997em); top: -5.332em; left: 50%; margin-left: -0.679em;"><span class="mtd" id="MathJax-Span-6043"><span class="mrow" id="MathJax-Span-6044"><span class="msubsup" id="MathJax-Span-6045"><span style="display: inline-block; position: relative; width: 1.306em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.5em, 4.159em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-6046" style="font-family: MathJax_Math-italic;">a</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.561em;"><span class="texatom" id="MathJax-Span-6047"><span class="mrow" id="MathJax-Span-6048"><span class="mn" id="MathJax-Span-6049" style="font-size: 70.7%; font-family: MathJax_Main;">01</span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.353em, 1001.31em, 4.283em, -999.997em); top: -3.905em; left: 50%; margin-left: -0.679em;"><span class="mtd" id="MathJax-Span-6064"><span class="mrow" id="MathJax-Span-6065"><span class="msubsup" id="MathJax-Span-6066"><span style="display: inline-block; position: relative; width: 1.306em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.5em, 4.159em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-6067" style="font-family: MathJax_Math-italic;">a</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.561em;"><span class="texatom" id="MathJax-Span-6068"><span class="mrow" id="MathJax-Span-6069"><span class="mn" id="MathJax-Span-6070" style="font-size: 70.7%; font-family: MathJax_Main;">11</span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.353em, 1001.31em, 4.283em, -999.997em); top: -2.54em; left: 50%; margin-left: -0.679em;"><span class="mtd" id="MathJax-Span-6085"><span class="mrow" id="MathJax-Span-6086"><span class="msubsup" id="MathJax-Span-6087"><span style="display: inline-block; position: relative; width: 1.306em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.5em, 4.159em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-6088" style="font-family: MathJax_Math-italic;">a</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.561em;"><span class="texatom" id="MathJax-Span-6089"><span class="mrow" id="MathJax-Span-6090"><span class="mn" id="MathJax-Span-6091" style="font-size: 70.7%; font-family: MathJax_Main;">21</span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.408em;"></span></span><span style="position: absolute; clip: rect(2.422em, 1001.31em, 6.207em, -999.997em); top: -4.401em; left: 4.656em;"><span style="display: inline-block; position: relative; width: 1.306em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1001.31em, 4.346em, -999.997em); top: -5.332em; left: 50%; margin-left: -0.679em;"><span class="mtd" id="MathJax-Span-6050"><span class="mrow" id="MathJax-Span-6051"><span class="msubsup" id="MathJax-Span-6052"><span style="display: inline-block; position: relative; width: 1.306em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.5em, 4.159em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-6053" style="font-family: MathJax_Math-italic;">a</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.561em;"><span class="texatom" id="MathJax-Span-6054"><span class="mrow" id="MathJax-Span-6055"><span class="mn" id="MathJax-Span-6056" style="font-size: 70.7%; font-family: MathJax_Main;">02</span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.353em, 1001.31em, 4.283em, -999.997em); top: -3.905em; left: 50%; margin-left: -0.679em;"><span class="mtd" id="MathJax-Span-6071"><span class="mrow" id="MathJax-Span-6072"><span class="msubsup" id="MathJax-Span-6073"><span style="display: inline-block; position: relative; width: 1.306em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.5em, 4.159em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-6074" style="font-family: MathJax_Math-italic;">a</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.561em;"><span class="texatom" id="MathJax-Span-6075"><span class="mrow" id="MathJax-Span-6076"><span class="mn" id="MathJax-Span-6077" style="font-size: 70.7%; font-family: MathJax_Main;">12</span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.353em, 1001.31em, 4.283em, -999.997em); top: -2.54em; left: 50%; margin-left: -0.679em;"><span class="mtd" id="MathJax-Span-6092"><span class="mrow" id="MathJax-Span-6093"><span class="msubsup" id="MathJax-Span-6094"><span style="display: inline-block; position: relative; width: 1.306em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.5em, 4.159em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-6095" style="font-family: MathJax_Math-italic;">a</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.561em;"><span class="texatom" id="MathJax-Span-6096"><span class="mrow" id="MathJax-Span-6097"><span class="mn" id="MathJax-Span-6098" style="font-size: 70.7%; font-family: MathJax_Main;">22</span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.408em;"></span></span></span></span><span class="mo" id="MathJax-Span-6099" style="vertical-align: 2.174em;"><span style="display: inline-block; position: relative; width: 0.685em; height: 0px;"><span style="position: absolute; font-family: MathJax_Size4; top: -2.788em; left: 0em;">⎤<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; font-family: MathJax_Size4; top: -0.803em; left: 0em;">⎦<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -1.796em; left: 0em;">⎥<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.532em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -2.15em; border-left: 0px solid; width: 0px; height: 4.85em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>A</mi><mrow class="MJX-TeXAtom-ORD"><mi>s</mi><mi>i</mi></mrow></msub><mo>=</mo><mrow><mo>[</mo><mtable rowspacing="4pt" columnspacing="1em"><mtr><mtd><msub><mi>a</mi><mrow class="MJX-TeXAtom-ORD"><mn>00</mn></mrow></msub></mtd><mtd><msub><mi>a</mi><mrow class="MJX-TeXAtom-ORD"><mn>01</mn></mrow></msub></mtd><mtd><msub><mi>a</mi><mrow class="MJX-TeXAtom-ORD"><mn>02</mn></mrow></msub></mtd></mtr><mtr><mtd><msub><mi>a</mi><mrow class="MJX-TeXAtom-ORD"><mn>10</mn></mrow></msub></mtd><mtd><msub><mi>a</mi><mrow class="MJX-TeXAtom-ORD"><mn>11</mn></mrow></msub></mtd><mtd><msub><mi>a</mi><mrow class="MJX-TeXAtom-ORD"><mn>12</mn></mrow></msub></mtd></mtr><mtr><mtd><msub><mi>a</mi><mrow class="MJX-TeXAtom-ORD"><mn>20</mn></mrow></msub></mtd><mtd><msub><mi>a</mi><mrow class="MJX-TeXAtom-ORD"><mn>21</mn></mrow></msub></mtd><mtd><msub><mi>a</mi><mrow class="MJX-TeXAtom-ORD"><mn>22</mn></mrow></msub></mtd></mtr></mtable><mo>]</mo></mrow></math></span></span><script type="math/tex" id="MathJax-Element-160">A_{si} = \begin{bmatrix} a_{00} & a_{01} & a_{02} \\ a_{10} & a_{11} & a_{12} \\ a_{20} & a_{21} & a_{22} \end{bmatrix}</script></p>
<p>where each column represents the orientation and scale of the&nbsp;respective axis with respect to the orthogonal axis.</p>
<div id="MeasurementModel"></div>
<hr>
<h2>Measurement Model</h2>
<p>Using the mathematical model of the above errors, we can then summarize the measurement model as such:</p>
<p style="text-align: center;"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-161-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;h&lt;/mi&gt;&lt;mi&gt;m&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;S&lt;/mi&gt;&lt;mi&gt;N&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;A&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mi&gt;h&lt;/mi&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;h&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;mi&gt;m&lt;/mi&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-6100" style="width: 14.643em; display: inline-block;"><span style="display: inline-block; position: relative; width: 11.79em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(1.43em, 1011.79em, 2.795em, -999.997em); top: -2.354em; left: 0em;"><span class="mrow" id="MathJax-Span-6101"><span class="msubsup" id="MathJax-Span-6102"><span style="display: inline-block; position: relative; width: 1.306em; height: 0px;"><span style="position: absolute; clip: rect(3.105em, 1000.56em, 4.159em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-6103" style="font-family: MathJax_Math-italic;">h</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.561em;"><span class="mi" id="MathJax-Span-6104" style="font-size: 70.7%; font-family: MathJax_Math-italic;">m</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="mo" id="MathJax-Span-6105" style="font-family: MathJax_Main; padding-left: 0.251em;">=</span><span class="mi" id="MathJax-Span-6106" style="font-family: MathJax_Math-italic; padding-left: 0.251em;">S<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.065em;"></span></span><span class="mi" id="MathJax-Span-6107" style="font-family: MathJax_Math-italic;">N<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.065em;"></span></span><span class="mo" id="MathJax-Span-6108" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-6109"><span style="display: inline-block; position: relative; width: 1.43em; height: 0px;"><span style="position: absolute; clip: rect(3.043em, 1000.75em, 4.159em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-6110" style="font-family: MathJax_Math-italic;">A</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.748em;"><span class="texatom" id="MathJax-Span-6111"><span class="mrow" id="MathJax-Span-6112"><span class="mi" id="MathJax-Span-6113" style="font-size: 70.7%; font-family: MathJax_Math-italic;">s</span><span class="mi" id="MathJax-Span-6114" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="mi" id="MathJax-Span-6115" style="font-family: MathJax_Math-italic;">h</span><span class="mo" id="MathJax-Span-6116" style="font-family: MathJax_Main; padding-left: 0.251em;">+</span><span class="msubsup" id="MathJax-Span-6117" style="padding-left: 0.251em;"><span style="display: inline-block; position: relative; width: 1.182em; height: 0px;"><span style="position: absolute; clip: rect(3.105em, 1000.44em, 4.159em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-6118" style="font-family: MathJax_Math-italic;">b</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.437em;"><span class="texatom" id="MathJax-Span-6119"><span class="mrow" id="MathJax-Span-6120"><span class="mi" id="MathJax-Span-6121" style="font-size: 70.7%; font-family: MathJax_Math-italic;">h</span><span class="mi" id="MathJax-Span-6122" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="mo" id="MathJax-Span-6123" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-6124" style="font-family: MathJax_Main; padding-left: 0.251em;">+</span><span class="msubsup" id="MathJax-Span-6125" style="padding-left: 0.251em;"><span style="display: inline-block; position: relative; width: 1.12em; height: 0px;"><span style="position: absolute; clip: rect(3.105em, 1000.44em, 4.159em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-6126" style="font-family: MathJax_Math-italic;">b</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.437em;"><span class="mi" id="MathJax-Span-6127" style="font-size: 70.7%; font-family: MathJax_Math-italic;">m</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.36em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.381em; border-left: 0px solid; width: 0px; height: 1.388em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>h</mi><mi>m</mi></msub><mo>=</mo><mi>S</mi><mi>N</mi><mo stretchy="false">(</mo><msub><mi>A</mi><mrow class="MJX-TeXAtom-ORD"><mi>s</mi><mi>i</mi></mrow></msub><mi>h</mi><mo>+</mo><msub><mi>b</mi><mrow class="MJX-TeXAtom-ORD"><mi>h</mi><mi>i</mi></mrow></msub><mo stretchy="false">)</mo><mo>+</mo><msub><mi>b</mi><mi>m</mi></msub></math></span></span><script type="math/tex" id="MathJax-Element-161">h_m = SN(A_{si}h + b_{hi}) + b_m</script></p>
<p>where</p>
<p><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-162-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;h&lt;/mi&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-6128" style="width: 0.685em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.561em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(1.492em, 1000.56em, 2.547em, -999.997em); top: -2.354em; left: 0em;"><span class="mrow" id="MathJax-Span-6129"><span class="mi" id="MathJax-Span-6130" style="font-family: MathJax_Math-italic;">h</span></span><span style="display: inline-block; width: 0px; height: 2.36em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.073em; border-left: 0px solid; width: 0px; height: 1.004em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>h</mi></math></span></span><script type="math/tex" id="MathJax-Element-162">h</script> is the actual magnetic field<br>
<span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-163-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;h&lt;/mi&gt;&lt;mi&gt;m&lt;/mi&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-6131" style="width: 1.616em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.306em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(1.492em, 1001.31em, 2.733em, -999.997em); top: -2.354em; left: 0em;"><span class="mrow" id="MathJax-Span-6132"><span class="msubsup" id="MathJax-Span-6133"><span style="display: inline-block; position: relative; width: 1.306em; height: 0px;"><span style="position: absolute; clip: rect(3.105em, 1000.56em, 4.159em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-6134" style="font-family: MathJax_Math-italic;">h</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.561em;"><span class="mi" id="MathJax-Span-6135" style="font-size: 70.7%; font-family: MathJax_Math-italic;">m</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.36em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.304em; border-left: 0px solid; width: 0px; height: 1.235em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>h</mi><mi>m</mi></msub></math></span></span><script type="math/tex" id="MathJax-Element-163">h_m</script> is the measurement reading from the magnetometer with errors</p>
<p>We can then combine some of the errors together to get a more simplified form:</p>
<p style="text-align: center;"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-164-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;h&lt;/mi&gt;&lt;mi&gt;m&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;A&lt;/mi&gt;&lt;mi&gt;h&lt;/mi&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-6136" style="width: 7.013em; display: inline-block;"><span style="display: inline-block; position: relative; width: 5.648em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(1.43em, 1005.65em, 2.733em, -999.997em); top: -2.354em; left: 0em;"><span class="mrow" id="MathJax-Span-6137"><span class="msubsup" id="MathJax-Span-6138"><span style="display: inline-block; position: relative; width: 1.306em; height: 0px;"><span style="position: absolute; clip: rect(3.105em, 1000.56em, 4.159em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-6139" style="font-family: MathJax_Math-italic;">h</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.561em;"><span class="mi" id="MathJax-Span-6140" style="font-size: 70.7%; font-family: MathJax_Math-italic;">m</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="mo" id="MathJax-Span-6141" style="font-family: MathJax_Main; padding-left: 0.251em;">=</span><span class="mi" id="MathJax-Span-6142" style="font-family: MathJax_Math-italic; padding-left: 0.251em;">A</span><span class="mi" id="MathJax-Span-6143" style="font-family: MathJax_Math-italic;">h</span><span class="mo" id="MathJax-Span-6144" style="font-family: MathJax_Main; padding-left: 0.251em;">+</span><span class="mi" id="MathJax-Span-6145" style="font-family: MathJax_Math-italic; padding-left: 0.251em;">b</span></span><span style="display: inline-block; width: 0px; height: 2.36em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.304em; border-left: 0px solid; width: 0px; height: 1.235em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>h</mi><mi>m</mi></msub><mo>=</mo><mi>A</mi><mi>h</mi><mo>+</mo><mi>b</mi></math></span></span><script type="math/tex" id="MathJax-Element-164">h_m = Ah + b</script></p>
<p>where</p>
<p><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-165-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;A&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;S&lt;/mi&gt;&lt;mi&gt;N&lt;/mi&gt;&lt;msub&gt;&lt;mi&gt;A&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-6146" style="width: 6.269em; display: inline-block;"><span style="display: inline-block; position: relative; width: 5.028em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(1.43em, 1005.03em, 2.733em, -999.997em); top: -2.354em; left: 0em;"><span class="mrow" id="MathJax-Span-6147"><span class="mi" id="MathJax-Span-6148" style="font-family: MathJax_Math-italic;">A</span><span class="mo" id="MathJax-Span-6149" style="font-family: MathJax_Main; padding-left: 0.251em;">=</span><span class="mi" id="MathJax-Span-6150" style="font-family: MathJax_Math-italic; padding-left: 0.251em;">S<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.065em;"></span></span><span class="mi" id="MathJax-Span-6151" style="font-family: MathJax_Math-italic;">N<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.065em;"></span></span><span class="msubsup" id="MathJax-Span-6152"><span style="display: inline-block; position: relative; width: 1.43em; height: 0px;"><span style="position: absolute; clip: rect(3.043em, 1000.75em, 4.159em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-6153" style="font-family: MathJax_Math-italic;">A</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.748em;"><span class="texatom" id="MathJax-Span-6154"><span class="mrow" id="MathJax-Span-6155"><span class="mi" id="MathJax-Span-6156" style="font-size: 70.7%; font-family: MathJax_Math-italic;">s</span><span class="mi" id="MathJax-Span-6157" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.36em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.304em; border-left: 0px solid; width: 0px; height: 1.235em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>A</mi><mo>=</mo><mi>S</mi><mi>N</mi><msub><mi>A</mi><mrow class="MJX-TeXAtom-ORD"><mi>s</mi><mi>i</mi></mrow></msub></math></span></span><script type="math/tex" id="MathJax-Element-165">A = SNA_{si}</script></p>
<p><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-166-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;S&lt;/mi&gt;&lt;mi&gt;N&lt;/mi&gt;&lt;msub&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;h&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;mi&gt;m&lt;/mi&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-6158" style="width: 8.502em; display: inline-block;"><span style="display: inline-block; position: relative; width: 6.827em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(1.492em, 1006.83em, 2.733em, -999.997em); top: -2.354em; left: 0em;"><span class="mrow" id="MathJax-Span-6159"><span class="mi" id="MathJax-Span-6160" style="font-family: MathJax_Math-italic;">b</span><span class="mo" id="MathJax-Span-6161" style="font-family: MathJax_Main; padding-left: 0.251em;">=</span><span class="mi" id="MathJax-Span-6162" style="font-family: MathJax_Math-italic; padding-left: 0.251em;">S<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.065em;"></span></span><span class="mi" id="MathJax-Span-6163" style="font-family: MathJax_Math-italic;">N<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.065em;"></span></span><span class="msubsup" id="MathJax-Span-6164"><span style="display: inline-block; position: relative; width: 1.182em; height: 0px;"><span style="position: absolute; clip: rect(3.105em, 1000.44em, 4.159em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-6165" style="font-family: MathJax_Math-italic;">b</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.437em;"><span class="texatom" id="MathJax-Span-6166"><span class="mrow" id="MathJax-Span-6167"><span class="mi" id="MathJax-Span-6168" style="font-size: 70.7%; font-family: MathJax_Math-italic;">h</span><span class="mi" id="MathJax-Span-6169" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="mo" id="MathJax-Span-6170" style="font-family: MathJax_Main; padding-left: 0.251em;">+</span><span class="msubsup" id="MathJax-Span-6171" style="padding-left: 0.251em;"><span style="display: inline-block; position: relative; width: 1.12em; height: 0px;"><span style="position: absolute; clip: rect(3.105em, 1000.44em, 4.159em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-6172" style="font-family: MathJax_Math-italic;">b</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.437em;"><span class="mi" id="MathJax-Span-6173" style="font-size: 70.7%; font-family: MathJax_Math-italic;">m</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.36em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.304em; border-left: 0px solid; width: 0px; height: 1.235em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>b</mi><mo>=</mo><mi>S</mi><mi>N</mi><msub><mi>b</mi><mrow class="MJX-TeXAtom-ORD"><mi>h</mi><mi>i</mi></mrow></msub><mo>+</mo><msub><mi>b</mi><mi>m</mi></msub></math></span></span><script type="math/tex" id="MathJax-Element-166">b = SNb_{hi} + b_m</script></p>
<div id="Calibration"></div>
<hr>
<h2>Calibration</h2>
<p>With the above measurement model, we can now manipulate the equation to make <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-167-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;h&lt;/mi&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-6174" style="width: 0.685em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.561em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(1.492em, 1000.56em, 2.547em, -999.997em); top: -2.354em; left: 0em;"><span class="mrow" id="MathJax-Span-6175"><span class="mi" id="MathJax-Span-6176" style="font-family: MathJax_Math-italic;">h</span></span><span style="display: inline-block; width: 0px; height: 2.36em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.073em; border-left: 0px solid; width: 0px; height: 1.004em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>h</mi></math></span></span><script type="math/tex" id="MathJax-Element-167">h</script> the subject instead.</p>
<p style="text-align: center;"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-168-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;h&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;msup&gt;&lt;mi&gt;A&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;h&lt;/mi&gt;&lt;mi&gt;m&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;&amp;#x2013;&lt;/mo&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-6177" style="width: 8.502em; display: inline-block;"><span style="display: inline-block; position: relative; width: 6.827em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(1.368em, 1006.7em, 2.795em, -999.997em); top: -2.354em; left: 0em;"><span class="mrow" id="MathJax-Span-6178"><span class="mi" id="MathJax-Span-6179" style="font-family: MathJax_Math-italic;">h</span><span class="mo" id="MathJax-Span-6180" style="font-family: MathJax_Main; padding-left: 0.251em;">=</span><span class="msubsup" id="MathJax-Span-6181" style="padding-left: 0.251em;"><span style="display: inline-block; position: relative; width: 1.74em; height: 0px;"><span style="position: absolute; clip: rect(3.043em, 1000.75em, 4.159em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-6182" style="font-family: MathJax_Math-italic;">A</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -4.339em; left: 0.748em;"><span class="texatom" id="MathJax-Span-6183"><span class="mrow" id="MathJax-Span-6184"><span class="mo" id="MathJax-Span-6185" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="mn" id="MathJax-Span-6186" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="mo" id="MathJax-Span-6187" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-6188"><span style="display: inline-block; position: relative; width: 1.306em; height: 0px;"><span style="position: absolute; clip: rect(3.105em, 1000.56em, 4.159em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-6189" style="font-family: MathJax_Math-italic;">h</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.561em;"><span class="mi" id="MathJax-Span-6190" style="font-size: 70.7%; font-family: MathJax_Math-italic;">m</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="mo" id="MathJax-Span-6191" style="font-family: MathJax_Main;">–</span><span class="mi" id="MathJax-Span-6192" style="font-family: MathJax_Math-italic; padding-left: 0.189em;">b</span><span class="mo" id="MathJax-Span-6193" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.36em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.381em; border-left: 0px solid; width: 0px; height: 1.465em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>h</mi><mo>=</mo><msup><mi>A</mi><mrow class="MJX-TeXAtom-ORD"><mo>−</mo><mn>1</mn></mrow></msup><mo stretchy="false">(</mo><msub><mi>h</mi><mi>m</mi></msub><mo>–</mo><mi>b</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-168">h = A^{-1}(h_m – b)</script>&nbsp; &nbsp; &nbsp;——————–&nbsp; &nbsp; &nbsp;(1)</p>
<p>where</p>
<p><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-169-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;h&lt;/mi&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-6194" style="width: 0.685em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.561em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(1.492em, 1000.56em, 2.547em, -999.997em); top: -2.354em; left: 0em;"><span class="mrow" id="MathJax-Span-6195"><span class="mi" id="MathJax-Span-6196" style="font-family: MathJax_Math-italic;">h</span></span><span style="display: inline-block; width: 0px; height: 2.36em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.073em; border-left: 0px solid; width: 0px; height: 1.004em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>h</mi></math></span></span><script type="math/tex" id="MathJax-Element-169">h</script> is the actual magnetic field<br>
<span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-170-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;h&lt;/mi&gt;&lt;mi&gt;m&lt;/mi&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-6197" style="width: 1.616em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.306em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(1.492em, 1001.31em, 2.733em, -999.997em); top: -2.354em; left: 0em;"><span class="mrow" id="MathJax-Span-6198"><span class="msubsup" id="MathJax-Span-6199"><span style="display: inline-block; position: relative; width: 1.306em; height: 0px;"><span style="position: absolute; clip: rect(3.105em, 1000.56em, 4.159em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-6200" style="font-family: MathJax_Math-italic;">h</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.561em;"><span class="mi" id="MathJax-Span-6201" style="font-size: 70.7%; font-family: MathJax_Math-italic;">m</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.36em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.304em; border-left: 0px solid; width: 0px; height: 1.235em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>h</mi><mi>m</mi></msub></math></span></span><script type="math/tex" id="MathJax-Element-170">h_m</script> is the measurement reading from the magnetometer with errors</p>
<p>Therefore, if we know the values of the <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-171-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msup&gt;&lt;mi&gt;A&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-6202" style="width: 2.174em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.74em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(1.368em, 1001.74em, 2.547em, -999.997em); top: -2.354em; left: 0em;"><span class="mrow" id="MathJax-Span-6203"><span class="msubsup" id="MathJax-Span-6204"><span style="display: inline-block; position: relative; width: 1.74em; height: 0px;"><span style="position: absolute; clip: rect(3.043em, 1000.75em, 4.159em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-6205" style="font-family: MathJax_Math-italic;">A</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -4.339em; left: 0.748em;"><span class="texatom" id="MathJax-Span-6206"><span class="mrow" id="MathJax-Span-6207"><span class="mo" id="MathJax-Span-6208" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="mn" id="MathJax-Span-6209" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.36em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.073em; border-left: 0px solid; width: 0px; height: 1.158em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup><mi>A</mi><mrow class="MJX-TeXAtom-ORD"><mo>−</mo><mn>1</mn></mrow></msup></math></span></span><script type="math/tex" id="MathJax-Element-171">A^{-1}</script> and <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-172-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-6210" style="width: 0.561em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.437em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(1.492em, 1000.44em, 2.547em, -999.997em); top: -2.354em; left: 0em;"><span class="mrow" id="MathJax-Span-6211"><span class="mi" id="MathJax-Span-6212" style="font-family: MathJax_Math-italic;">b</span></span><span style="display: inline-block; width: 0px; height: 2.36em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.073em; border-left: 0px solid; width: 0px; height: 1.004em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>b</mi></math></span></span><script type="math/tex" id="MathJax-Element-172">b</script> matrix, we will be able to solve for the actual magnetic field. As such, this section will focus on how to estimate the values of the&nbsp;<span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-173-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msup&gt;&lt;mi&gt;A&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-6213" style="width: 2.174em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.74em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(1.368em, 1001.74em, 2.547em, -999.997em); top: -2.354em; left: 0em;"><span class="mrow" id="MathJax-Span-6214"><span class="msubsup" id="MathJax-Span-6215"><span style="display: inline-block; position: relative; width: 1.74em; height: 0px;"><span style="position: absolute; clip: rect(3.043em, 1000.75em, 4.159em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-6216" style="font-family: MathJax_Math-italic;">A</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -4.339em; left: 0.748em;"><span class="texatom" id="MathJax-Span-6217"><span class="mrow" id="MathJax-Span-6218"><span class="mo" id="MathJax-Span-6219" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="mn" id="MathJax-Span-6220" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.36em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.073em; border-left: 0px solid; width: 0px; height: 1.158em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup><mi>A</mi><mrow class="MJX-TeXAtom-ORD"><mo>−</mo><mn>1</mn></mrow></msup></math></span></span><script type="math/tex" id="MathJax-Element-173">A^{-1}</script> and <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-174-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-6221" style="width: 0.561em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.437em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(1.492em, 1000.44em, 2.547em, -999.997em); top: -2.354em; left: 0em;"><span class="mrow" id="MathJax-Span-6222"><span class="mi" id="MathJax-Span-6223" style="font-family: MathJax_Math-italic;">b</span></span><span style="display: inline-block; width: 0px; height: 2.36em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.073em; border-left: 0px solid; width: 0px; height: 1.004em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>b</mi></math></span></span><script type="math/tex" id="MathJax-Element-174">b</script> matrix using measurement data.</p>
<p>Firstly, there is actually another set of criteria that we have. That is, we want to set the magnitude of the actual magnetic field to be 1. In mathematical equation, that is</p>
<p style="text-align: center;"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-175-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msup&gt;&lt;mi&gt;h&lt;/mi&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;/msup&gt;&lt;mi&gt;h&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-6224" style="width: 4.408em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.539em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(1.306em, 1003.48em, 2.547em, -999.997em); top: -2.354em; left: 0em;"><span class="mrow" id="MathJax-Span-6225"><span class="msubsup" id="MathJax-Span-6226"><span style="display: inline-block; position: relative; width: 1.182em; height: 0px;"><span style="position: absolute; clip: rect(3.105em, 1000.56em, 4.159em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-6227" style="font-family: MathJax_Math-italic;">h</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -4.339em; left: 0.561em;"><span class="mi" id="MathJax-Span-6228" style="font-size: 70.7%; font-family: MathJax_Math-italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.065em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="mi" id="MathJax-Span-6229" style="font-family: MathJax_Math-italic;">h</span><span class="mo" id="MathJax-Span-6230" style="font-family: MathJax_Main; padding-left: 0.251em;">=</span><span class="mn" id="MathJax-Span-6231" style="font-family: MathJax_Main; padding-left: 0.251em;">1</span></span><span style="display: inline-block; width: 0px; height: 2.36em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.073em; border-left: 0px solid; width: 0px; height: 1.235em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup><mi>h</mi><mi>T</mi></msup><mi>h</mi><mo>=</mo><mn>1</mn></math></span></span><script type="math/tex" id="MathJax-Element-175">h^Th = 1</script>&nbsp; &nbsp; &nbsp;——————–&nbsp; &nbsp; &nbsp;(2)</p>
<p style="text-align: center;"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-176-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mrow&gt;&lt;mo&gt;[&lt;/mo&gt;&lt;mtable rowspacing=&quot;4pt&quot; columnspacing=&quot;1em&quot;&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mi&gt;h&lt;/mi&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mi&gt;h&lt;/mi&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mi&gt;h&lt;/mi&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;/mtable&gt;&lt;mo&gt;]&lt;/mo&gt;&lt;/mrow&gt;&lt;mrow&gt;&lt;mo&gt;[&lt;/mo&gt;&lt;mtable rowspacing=&quot;4pt&quot; columnspacing=&quot;1em&quot;&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mi&gt;h&lt;/mi&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mi&gt;h&lt;/mi&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mi&gt;h&lt;/mi&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;/mtable&gt;&lt;mo&gt;]&lt;/mo&gt;&lt;/mrow&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-6232" style="width: 13.341em; display: inline-block;"><span style="display: inline-block; position: relative; width: 10.735em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(2.174em, 1010.67em, 6.393em, -999.997em); top: -4.525em; left: 0em;"><span class="mrow" id="MathJax-Span-6233"><span class="mrow" id="MathJax-Span-6234"><span class="mo" id="MathJax-Span-6235" style=""><span style="font-family: MathJax_Main;">[</span></span><span class="mtable" id="MathJax-Span-6236" style="padding-right: 0.189em; padding-left: 0.189em;"><span style="display: inline-block; position: relative; width: 5.028em; height: 0px;"><span style="position: absolute; clip: rect(3.105em, 1001.06em, 4.346em, -999.997em); top: -3.967em; left: 0em;"><span style="display: inline-block; position: relative; width: 1.058em; height: 0px;"><span style="position: absolute; clip: rect(3.105em, 1001.06em, 4.346em, -999.997em); top: -3.967em; left: 50%; margin-left: -0.555em;"><span class="mtd" id="MathJax-Span-6237"><span class="mrow" id="MathJax-Span-6238"><span class="msubsup" id="MathJax-Span-6239"><span style="display: inline-block; position: relative; width: 1.058em; height: 0px;"><span style="position: absolute; clip: rect(3.105em, 1000.56em, 4.159em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-6240" style="font-family: MathJax_Math-italic;">h</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.561em;"><span class="mi" id="MathJax-Span-6241" style="font-size: 70.7%; font-family: MathJax_Math-italic;">x</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.105em, 1001em, 4.47em, -999.997em); top: -3.967em; left: 2.05em;"><span style="display: inline-block; position: relative; width: 0.996em; height: 0px;"><span style="position: absolute; clip: rect(3.105em, 1001em, 4.47em, -999.997em); top: -3.967em; left: 50%; margin-left: -0.493em;"><span class="mtd" id="MathJax-Span-6242"><span class="mrow" id="MathJax-Span-6243"><span class="msubsup" id="MathJax-Span-6244"><span style="display: inline-block; position: relative; width: 0.996em; height: 0px;"><span style="position: absolute; clip: rect(3.105em, 1000.56em, 4.159em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-6245" style="font-family: MathJax_Math-italic;">h</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.561em;"><span class="mi" id="MathJax-Span-6246" style="font-size: 70.7%; font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.105em, 1001em, 4.346em, -999.997em); top: -3.967em; left: 4.035em;"><span style="display: inline-block; position: relative; width: 0.996em; height: 0px;"><span style="position: absolute; clip: rect(3.105em, 1001em, 4.346em, -999.997em); top: -3.967em; left: 50%; margin-left: -0.493em;"><span class="mtd" id="MathJax-Span-6247"><span class="mrow" id="MathJax-Span-6248"><span class="msubsup" id="MathJax-Span-6249"><span style="display: inline-block; position: relative; width: 0.996em; height: 0px;"><span style="position: absolute; clip: rect(3.105em, 1000.56em, 4.159em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-6250" style="font-family: MathJax_Math-italic;">h</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.561em;"><span class="mi" id="MathJax-Span-6251" style="font-size: 70.7%; font-family: MathJax_Math-italic;">z<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="mo" id="MathJax-Span-6252" style=""><span style="font-family: MathJax_Main;">]</span></span></span><span class="mrow" id="MathJax-Span-6253" style="padding-left: 0.189em;"><span class="mo" id="MathJax-Span-6254" style="vertical-align: 2.174em;"><span style="display: inline-block; position: relative; width: 0.685em; height: 0px;"><span style="position: absolute; font-family: MathJax_Size4; top: -2.788em; left: 0em;">⎡<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; font-family: MathJax_Size4; top: -0.741em; left: 0em;">⎣<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -1.734em; left: 0em;">⎢<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="mtable" id="MathJax-Span-6255" style="padding-right: 0.189em; padding-left: 0.189em;"><span style="display: inline-block; position: relative; width: 1.058em; height: 0px;"><span style="position: absolute; clip: rect(2.484em, 1001.06em, 6.641em, -999.997em); top: -4.774em; left: 0em;"><span style="display: inline-block; position: relative; width: 1.058em; height: 0px;"><span style="position: absolute; clip: rect(3.105em, 1001.06em, 4.346em, -999.997em); top: -5.394em; left: 50%; margin-left: -0.555em;"><span class="mtd" id="MathJax-Span-6256"><span class="mrow" id="MathJax-Span-6257"><span class="msubsup" id="MathJax-Span-6258"><span style="display: inline-block; position: relative; width: 1.058em; height: 0px;"><span style="position: absolute; clip: rect(3.105em, 1000.56em, 4.159em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-6259" style="font-family: MathJax_Math-italic;">h</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.561em;"><span class="mi" id="MathJax-Span-6260" style="font-size: 70.7%; font-family: MathJax_Math-italic;">x</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.105em, 1001em, 4.47em, -999.997em); top: -3.967em; left: 50%; margin-left: -0.493em;"><span class="mtd" id="MathJax-Span-6261"><span class="mrow" id="MathJax-Span-6262"><span class="msubsup" id="MathJax-Span-6263"><span style="display: inline-block; position: relative; width: 0.996em; height: 0px;"><span style="position: absolute; clip: rect(3.105em, 1000.56em, 4.159em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-6264" style="font-family: MathJax_Math-italic;">h</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.561em;"><span class="mi" id="MathJax-Span-6265" style="font-size: 70.7%; font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.105em, 1001em, 4.346em, -999.997em); top: -2.478em; left: 50%; margin-left: -0.493em;"><span class="mtd" id="MathJax-Span-6266"><span class="mrow" id="MathJax-Span-6267"><span class="msubsup" id="MathJax-Span-6268"><span style="display: inline-block; position: relative; width: 0.996em; height: 0px;"><span style="position: absolute; clip: rect(3.105em, 1000.56em, 4.159em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-6269" style="font-family: MathJax_Math-italic;">h</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.561em;"><span class="mi" id="MathJax-Span-6270" style="font-size: 70.7%; font-family: MathJax_Math-italic;">z<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.78em;"></span></span></span></span><span class="mo" id="MathJax-Span-6271" style="vertical-align: 2.174em;"><span style="display: inline-block; position: relative; width: 0.685em; height: 0px;"><span style="position: absolute; font-family: MathJax_Size4; top: -2.788em; left: 0em;">⎤<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; font-family: MathJax_Size4; top: -0.741em; left: 0em;">⎦<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -1.734em; left: 0em;">⎥<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span><span class="mo" id="MathJax-Span-6272" style="font-family: MathJax_Main; padding-left: 0.251em;">=</span><span class="mn" id="MathJax-Span-6273" style="font-family: MathJax_Main; padding-left: 0.251em;">1</span></span><span style="display: inline-block; width: 0px; height: 4.532em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -2.15em; border-left: 0px solid; width: 0px; height: 5.004em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mo>[</mo><mtable rowspacing="4pt" columnspacing="1em"><mtr><mtd><msub><mi>h</mi><mi>x</mi></msub></mtd><mtd><msub><mi>h</mi><mi>y</mi></msub></mtd><mtd><msub><mi>h</mi><mi>z</mi></msub></mtd></mtr></mtable><mo>]</mo></mrow><mrow><mo>[</mo><mtable rowspacing="4pt" columnspacing="1em"><mtr><mtd><msub><mi>h</mi><mi>x</mi></msub></mtd></mtr><mtr><mtd><msub><mi>h</mi><mi>y</mi></msub></mtd></mtr><mtr><mtd><msub><mi>h</mi><mi>z</mi></msub></mtd></mtr></mtable><mo>]</mo></mrow><mo>=</mo><mn>1</mn></math></span></span><script type="math/tex" id="MathJax-Element-176">\begin{bmatrix} h_x & h_y & h_z \end{bmatrix}\begin{bmatrix} h_x \\ h_y \\ h_z \end{bmatrix} = 1</script></p>
<p>If we substitute equation (1) into equation (2), we will get the following equation.</p>
<p style="text-align: center;"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-177-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;h&lt;/mi&gt;&lt;mi&gt;m&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;msup&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;/msup&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msup&gt;&lt;mi&gt;A&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;msup&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;/msup&gt;&lt;msup&gt;&lt;mi&gt;A&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;h&lt;/mi&gt;&lt;mi&gt;m&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-6274" style="width: 18.427em; display: inline-block;"><span style="display: inline-block; position: relative; width: 14.829em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(1.306em, 1014.77em, 2.795em, -999.997em); top: -2.354em; left: 0em;"><span class="mrow" id="MathJax-Span-6275"><span class="mo" id="MathJax-Span-6276" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-6277"><span style="display: inline-block; position: relative; width: 1.306em; height: 0px;"><span style="position: absolute; clip: rect(3.105em, 1000.56em, 4.159em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-6278" style="font-family: MathJax_Math-italic;">h</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.561em;"><span class="mi" id="MathJax-Span-6279" style="font-size: 70.7%; font-family: MathJax_Math-italic;">m</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="mo" id="MathJax-Span-6280" style="font-family: MathJax_Main; padding-left: 0.251em;">−</span><span class="mi" id="MathJax-Span-6281" style="font-family: MathJax_Math-italic; padding-left: 0.251em;">b</span><span class="msubsup" id="MathJax-Span-6282"><span style="display: inline-block; position: relative; width: 0.996em; height: 0px;"><span style="position: absolute; clip: rect(3.043em, 1000.31em, 4.408em, -999.997em); top: -3.967em; left: 0em;"><span class="mo" id="MathJax-Span-6283" style="font-family: MathJax_Main;">)</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -4.339em; left: 0.375em;"><span class="mi" id="MathJax-Span-6284" style="font-size: 70.7%; font-family: MathJax_Math-italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.065em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="mo" id="MathJax-Span-6285" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-6286"><span style="display: inline-block; position: relative; width: 1.74em; height: 0px;"><span style="position: absolute; clip: rect(3.043em, 1000.75em, 4.159em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-6287" style="font-family: MathJax_Math-italic;">A</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -4.339em; left: 0.748em;"><span class="texatom" id="MathJax-Span-6288"><span class="mrow" id="MathJax-Span-6289"><span class="mo" id="MathJax-Span-6290" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="mn" id="MathJax-Span-6291" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-6292"><span style="display: inline-block; position: relative; width: 0.996em; height: 0px;"><span style="position: absolute; clip: rect(3.043em, 1000.31em, 4.408em, -999.997em); top: -3.967em; left: 0em;"><span class="mo" id="MathJax-Span-6293" style="font-family: MathJax_Main;">)</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -4.339em; left: 0.375em;"><span class="mi" id="MathJax-Span-6294" style="font-size: 70.7%; font-family: MathJax_Math-italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.065em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-6295"><span style="display: inline-block; position: relative; width: 1.74em; height: 0px;"><span style="position: absolute; clip: rect(3.043em, 1000.75em, 4.159em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-6296" style="font-family: MathJax_Math-italic;">A</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -4.339em; left: 0.748em;"><span class="texatom" id="MathJax-Span-6297"><span class="mrow" id="MathJax-Span-6298"><span class="mo" id="MathJax-Span-6299" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="mn" id="MathJax-Span-6300" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="mo" id="MathJax-Span-6301" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-6302"><span style="display: inline-block; position: relative; width: 1.306em; height: 0px;"><span style="position: absolute; clip: rect(3.105em, 1000.56em, 4.159em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-6303" style="font-family: MathJax_Math-italic;">h</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.561em;"><span class="mi" id="MathJax-Span-6304" style="font-size: 70.7%; font-family: MathJax_Math-italic;">m</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="mo" id="MathJax-Span-6305" style="font-family: MathJax_Main; padding-left: 0.251em;">−</span><span class="mi" id="MathJax-Span-6306" style="font-family: MathJax_Math-italic; padding-left: 0.251em;">b</span><span class="mo" id="MathJax-Span-6307" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-6308" style="font-family: MathJax_Main; padding-left: 0.251em;">=</span><span class="mn" id="MathJax-Span-6309" style="font-family: MathJax_Main; padding-left: 0.251em;">1</span></span><span style="display: inline-block; width: 0px; height: 2.36em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.381em; border-left: 0px solid; width: 0px; height: 1.542em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo stretchy="false">(</mo><msub><mi>h</mi><mi>m</mi></msub><mo>−</mo><mi>b</mi><msup><mo stretchy="false">)</mo><mi>T</mi></msup><mo stretchy="false">(</mo><msup><mi>A</mi><mrow class="MJX-TeXAtom-ORD"><mo>−</mo><mn>1</mn></mrow></msup><msup><mo stretchy="false">)</mo><mi>T</mi></msup><msup><mi>A</mi><mrow class="MJX-TeXAtom-ORD"><mo>−</mo><mn>1</mn></mrow></msup><mo stretchy="false">(</mo><msub><mi>h</mi><mi>m</mi></msub><mo>−</mo><mi>b</mi><mo stretchy="false">)</mo><mo>=</mo><mn>1</mn></math></span></span><script type="math/tex" id="MathJax-Element-177">(h_m-b)^T(A^{-1})^TA^{-1}(h_m-b) = 1</script></p>
<p>Let <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-178-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;Q&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msup&gt;&lt;mi&gt;A&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;msup&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;/msup&gt;&lt;msup&gt;&lt;mi&gt;A&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-6310" style="width: 8.626em; display: inline-block;"><span style="display: inline-block; position: relative; width: 6.951em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(1.306em, 1006.95em, 2.795em, -999.997em); top: -2.354em; left: 0em;"><span class="mrow" id="MathJax-Span-6311"><span class="mi" id="MathJax-Span-6312" style="font-family: MathJax_Math-italic;">Q</span><span class="mo" id="MathJax-Span-6313" style="font-family: MathJax_Main; padding-left: 0.251em;">=</span><span class="mo" id="MathJax-Span-6314" style="font-family: MathJax_Main; padding-left: 0.251em;">(</span><span class="msubsup" id="MathJax-Span-6315"><span style="display: inline-block; position: relative; width: 1.74em; height: 0px;"><span style="position: absolute; clip: rect(3.043em, 1000.75em, 4.159em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-6316" style="font-family: MathJax_Math-italic;">A</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -4.339em; left: 0.748em;"><span class="texatom" id="MathJax-Span-6317"><span class="mrow" id="MathJax-Span-6318"><span class="mo" id="MathJax-Span-6319" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="mn" id="MathJax-Span-6320" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-6321"><span style="display: inline-block; position: relative; width: 0.996em; height: 0px;"><span style="position: absolute; clip: rect(3.043em, 1000.31em, 4.408em, -999.997em); top: -3.967em; left: 0em;"><span class="mo" id="MathJax-Span-6322" style="font-family: MathJax_Main;">)</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -4.339em; left: 0.375em;"><span class="mi" id="MathJax-Span-6323" style="font-size: 70.7%; font-family: MathJax_Math-italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.065em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-6324"><span style="display: inline-block; position: relative; width: 1.74em; height: 0px;"><span style="position: absolute; clip: rect(3.043em, 1000.75em, 4.159em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-6325" style="font-family: MathJax_Math-italic;">A</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -4.339em; left: 0.748em;"><span class="texatom" id="MathJax-Span-6326"><span class="mrow" id="MathJax-Span-6327"><span class="mo" id="MathJax-Span-6328" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="mn" id="MathJax-Span-6329" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.36em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.381em; border-left: 0px solid; width: 0px; height: 1.542em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>Q</mi><mo>=</mo><mo stretchy="false">(</mo><msup><mi>A</mi><mrow class="MJX-TeXAtom-ORD"><mo>−</mo><mn>1</mn></mrow></msup><msup><mo stretchy="false">)</mo><mi>T</mi></msup><msup><mi>A</mi><mrow class="MJX-TeXAtom-ORD"><mo>−</mo><mn>1</mn></mrow></msup></math></span></span><script type="math/tex" id="MathJax-Element-178">Q = (A^{-1})^TA^{-1}</script>. Therefore, <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-179-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;Q&lt;/mi&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-6330" style="width: 0.996em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.81em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(1.492em, 1000.75em, 2.733em, -999.997em); top: -2.354em; left: 0em;"><span class="mrow" id="MathJax-Span-6331"><span class="mi" id="MathJax-Span-6332" style="font-family: MathJax_Math-italic;">Q</span></span><span style="display: inline-block; width: 0px; height: 2.36em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.304em; border-left: 0px solid; width: 0px; height: 1.235em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>Q</mi></math></span></span><script type="math/tex" id="MathJax-Element-179">Q</script> must be a symmetric matrix since it is the product of a matrix multiplied by its transpose.</p>
<p style="text-align: center;"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-180-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;h&lt;/mi&gt;&lt;mi&gt;m&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;msup&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;/msup&gt;&lt;mi&gt;Q&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;h&lt;/mi&gt;&lt;mi&gt;m&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-6333" style="width: 13.403em; display: inline-block;"><span style="display: inline-block; position: relative; width: 10.797em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(1.306em, 1010.74em, 2.795em, -999.997em); top: -2.354em; left: 0em;"><span class="mrow" id="MathJax-Span-6334"><span class="mo" id="MathJax-Span-6335" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-6336"><span style="display: inline-block; position: relative; width: 1.306em; height: 0px;"><span style="position: absolute; clip: rect(3.105em, 1000.56em, 4.159em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-6337" style="font-family: MathJax_Math-italic;">h</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.561em;"><span class="mi" id="MathJax-Span-6338" style="font-size: 70.7%; font-family: MathJax_Math-italic;">m</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="mo" id="MathJax-Span-6339" style="font-family: MathJax_Main; padding-left: 0.251em;">−</span><span class="mi" id="MathJax-Span-6340" style="font-family: MathJax_Math-italic; padding-left: 0.251em;">b</span><span class="msubsup" id="MathJax-Span-6341"><span style="display: inline-block; position: relative; width: 0.996em; height: 0px;"><span style="position: absolute; clip: rect(3.043em, 1000.31em, 4.408em, -999.997em); top: -3.967em; left: 0em;"><span class="mo" id="MathJax-Span-6342" style="font-family: MathJax_Main;">)</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -4.339em; left: 0.375em;"><span class="mi" id="MathJax-Span-6343" style="font-size: 70.7%; font-family: MathJax_Math-italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.065em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="mi" id="MathJax-Span-6344" style="font-family: MathJax_Math-italic;">Q</span><span class="mo" id="MathJax-Span-6345" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-6346"><span style="display: inline-block; position: relative; width: 1.306em; height: 0px;"><span style="position: absolute; clip: rect(3.105em, 1000.56em, 4.159em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-6347" style="font-family: MathJax_Math-italic;">h</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.561em;"><span class="mi" id="MathJax-Span-6348" style="font-size: 70.7%; font-family: MathJax_Math-italic;">m</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="mo" id="MathJax-Span-6349" style="font-family: MathJax_Main; padding-left: 0.251em;">−</span><span class="mi" id="MathJax-Span-6350" style="font-family: MathJax_Math-italic; padding-left: 0.251em;">b</span><span class="mo" id="MathJax-Span-6351" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-6352" style="font-family: MathJax_Main; padding-left: 0.251em;">=</span><span class="mn" id="MathJax-Span-6353" style="font-family: MathJax_Main; padding-left: 0.251em;">1</span></span><span style="display: inline-block; width: 0px; height: 2.36em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.381em; border-left: 0px solid; width: 0px; height: 1.542em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo stretchy="false">(</mo><msub><mi>h</mi><mi>m</mi></msub><mo>−</mo><mi>b</mi><msup><mo stretchy="false">)</mo><mi>T</mi></msup><mi>Q</mi><mo stretchy="false">(</mo><msub><mi>h</mi><mi>m</mi></msub><mo>−</mo><mi>b</mi><mo stretchy="false">)</mo><mo>=</mo><mn>1</mn></math></span></span><script type="math/tex" id="MathJax-Element-180">(h_m-b)^TQ(h_m-b) = 1</script></p>
<p>Expanding the above equation and simplifying,</p>
<p style="text-align: center;"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-181-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msup&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;msub&gt;&lt;mi&gt;h&lt;/mi&gt;&lt;mi&gt;m&lt;/mi&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;/msup&gt;&lt;mi&gt;Q&lt;/mi&gt;&lt;msub&gt;&lt;mi&gt;h&lt;/mi&gt;&lt;mi&gt;m&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;&amp;#x2013;&lt;/mo&gt;&lt;msup&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;msub&gt;&lt;mi&gt;h&lt;/mi&gt;&lt;mi&gt;m&lt;/mi&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;/msup&gt;&lt;mi&gt;Q&lt;/mi&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;mo&gt;&amp;#x2013;&lt;/mo&gt;&lt;msup&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;/msup&gt;&lt;mi&gt;Q&lt;/mi&gt;&lt;msub&gt;&lt;mi&gt;h&lt;/mi&gt;&lt;mi&gt;m&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;msup&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;/msup&gt;&lt;mi&gt;Q&lt;/mi&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;mo&gt;&amp;#x2013;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-6354" style="width: 22.336em; display: inline-block;"><span style="display: inline-block; position: relative; width: 17.993em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(1.244em, 1017.93em, 2.733em, -999.997em); top: -2.354em; left: 0em;"><span class="mrow" id="MathJax-Span-6355"><span class="msubsup" id="MathJax-Span-6356"><span style="display: inline-block; position: relative; width: 1.864em; height: 0px;"><span style="position: absolute; clip: rect(3.105em, 1001.31em, 4.346em, -999.997em); top: -3.967em; left: 0em;"><span class="texatom" id="MathJax-Span-6357"><span class="mrow" id="MathJax-Span-6358"><span class="msubsup" id="MathJax-Span-6359"><span style="display: inline-block; position: relative; width: 1.306em; height: 0px;"><span style="position: absolute; clip: rect(3.105em, 1000.56em, 4.159em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-6360" style="font-family: MathJax_Math-italic;">h</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.561em;"><span class="mi" id="MathJax-Span-6361" style="font-size: 70.7%; font-family: MathJax_Math-italic;">m</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -4.401em; left: 1.306em;"><span class="mi" id="MathJax-Span-6362" style="font-size: 70.7%; font-family: MathJax_Math-italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.065em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="mi" id="MathJax-Span-6363" style="font-family: MathJax_Math-italic;">Q</span><span class="msubsup" id="MathJax-Span-6364"><span style="display: inline-block; position: relative; width: 1.306em; height: 0px;"><span style="position: absolute; clip: rect(3.105em, 1000.56em, 4.159em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-6365" style="font-family: MathJax_Math-italic;">h</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.561em;"><span class="mi" id="MathJax-Span-6366" style="font-size: 70.7%; font-family: MathJax_Math-italic;">m</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="mo" id="MathJax-Span-6367" style="font-family: MathJax_Main;">–</span><span class="msubsup" id="MathJax-Span-6368" style="padding-left: 0.189em;"><span style="display: inline-block; position: relative; width: 1.864em; height: 0px;"><span style="position: absolute; clip: rect(3.105em, 1001.31em, 4.346em, -999.997em); top: -3.967em; left: 0em;"><span class="texatom" id="MathJax-Span-6369"><span class="mrow" id="MathJax-Span-6370"><span class="msubsup" id="MathJax-Span-6371"><span style="display: inline-block; position: relative; width: 1.306em; height: 0px;"><span style="position: absolute; clip: rect(3.105em, 1000.56em, 4.159em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-6372" style="font-family: MathJax_Math-italic;">h</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.561em;"><span class="mi" id="MathJax-Span-6373" style="font-size: 70.7%; font-family: MathJax_Math-italic;">m</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -4.401em; left: 1.306em;"><span class="mi" id="MathJax-Span-6374" style="font-size: 70.7%; font-family: MathJax_Math-italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.065em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="mi" id="MathJax-Span-6375" style="font-family: MathJax_Math-italic;">Q</span><span class="mi" id="MathJax-Span-6376" style="font-family: MathJax_Math-italic;">b</span><span class="mo" id="MathJax-Span-6377" style="font-family: MathJax_Main;">–</span><span class="msubsup" id="MathJax-Span-6378" style="padding-left: 0.189em;"><span style="display: inline-block; position: relative; width: 0.996em; height: 0px;"><span style="position: absolute; clip: rect(3.105em, 1000.44em, 4.159em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-6379" style="font-family: MathJax_Math-italic;">b</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -4.339em; left: 0.437em;"><span class="mi" id="MathJax-Span-6380" style="font-size: 70.7%; font-family: MathJax_Math-italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.065em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="mi" id="MathJax-Span-6381" style="font-family: MathJax_Math-italic;">Q</span><span class="msubsup" id="MathJax-Span-6382"><span style="display: inline-block; position: relative; width: 1.306em; height: 0px;"><span style="position: absolute; clip: rect(3.105em, 1000.56em, 4.159em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-6383" style="font-family: MathJax_Math-italic;">h</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.561em;"><span class="mi" id="MathJax-Span-6384" style="font-size: 70.7%; font-family: MathJax_Math-italic;">m</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="mo" id="MathJax-Span-6385" style="font-family: MathJax_Main; padding-left: 0.251em;">+</span><span class="msubsup" id="MathJax-Span-6386" style="padding-left: 0.251em;"><span style="display: inline-block; position: relative; width: 0.996em; height: 0px;"><span style="position: absolute; clip: rect(3.105em, 1000.44em, 4.159em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-6387" style="font-family: MathJax_Math-italic;">b</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -4.339em; left: 0.437em;"><span class="mi" id="MathJax-Span-6388" style="font-size: 70.7%; font-family: MathJax_Math-italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.065em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="mi" id="MathJax-Span-6389" style="font-family: MathJax_Math-italic;">Q</span><span class="mi" id="MathJax-Span-6390" style="font-family: MathJax_Math-italic;">b</span><span class="mo" id="MathJax-Span-6391" style="font-family: MathJax_Main;">–</span><span class="mn" id="MathJax-Span-6392" style="font-family: MathJax_Main; padding-left: 0.189em;">1</span><span class="mo" id="MathJax-Span-6393" style="font-family: MathJax_Main; padding-left: 0.251em;">=</span><span class="mn" id="MathJax-Span-6394" style="font-family: MathJax_Main; padding-left: 0.251em;">0</span></span><span style="display: inline-block; width: 0px; height: 2.36em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.304em; border-left: 0px solid; width: 0px; height: 1.542em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup><mrow class="MJX-TeXAtom-ORD"><msub><mi>h</mi><mi>m</mi></msub></mrow><mi>T</mi></msup><mi>Q</mi><msub><mi>h</mi><mi>m</mi></msub><mo>–</mo><msup><mrow class="MJX-TeXAtom-ORD"><msub><mi>h</mi><mi>m</mi></msub></mrow><mi>T</mi></msup><mi>Q</mi><mi>b</mi><mo>–</mo><msup><mi>b</mi><mi>T</mi></msup><mi>Q</mi><msub><mi>h</mi><mi>m</mi></msub><mo>+</mo><msup><mi>b</mi><mi>T</mi></msup><mi>Q</mi><mi>b</mi><mo>–</mo><mn>1</mn><mo>=</mo><mn>0</mn></math></span></span><script type="math/tex" id="MathJax-Element-181">{h_m}^TQh_m – {h_m}^TQb – b^TQh_m + b^TQb – 1 = 0</script>&nbsp; &nbsp; &nbsp;——————–&nbsp; &nbsp; &nbsp;(3)</p>
<p>since <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-182-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;Q&lt;/mi&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-6395" style="width: 0.996em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.81em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(1.492em, 1000.75em, 2.733em, -999.997em); top: -2.354em; left: 0em;"><span class="mrow" id="MathJax-Span-6396"><span class="mi" id="MathJax-Span-6397" style="font-family: MathJax_Math-italic;">Q</span></span><span style="display: inline-block; width: 0px; height: 2.36em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.304em; border-left: 0px solid; width: 0px; height: 1.235em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>Q</mi></math></span></span><script type="math/tex" id="MathJax-Element-182">Q</script> is symmetric, <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-183-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msup&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;/msup&gt;&lt;mi&gt;Q&lt;/mi&gt;&lt;mi&gt;h&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;msup&gt;&lt;mi&gt;h&lt;/mi&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;/msup&gt;&lt;mi&gt;Q&lt;/mi&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-6398" style="width: 7.571em; display: inline-block;"><span style="display: inline-block; position: relative; width: 6.083em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(1.306em, 1006.08em, 2.733em, -999.997em); top: -2.354em; left: 0em;"><span class="mrow" id="MathJax-Span-6399"><span class="msubsup" id="MathJax-Span-6400"><span style="display: inline-block; position: relative; width: 0.996em; height: 0px;"><span style="position: absolute; clip: rect(3.105em, 1000.44em, 4.159em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-6401" style="font-family: MathJax_Math-italic;">b</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -4.339em; left: 0.437em;"><span class="mi" id="MathJax-Span-6402" style="font-size: 70.7%; font-family: MathJax_Math-italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.065em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="mi" id="MathJax-Span-6403" style="font-family: MathJax_Math-italic;">Q</span><span class="mi" id="MathJax-Span-6404" style="font-family: MathJax_Math-italic;">h</span><span class="mo" id="MathJax-Span-6405" style="font-family: MathJax_Main; padding-left: 0.251em;">=</span><span class="msubsup" id="MathJax-Span-6406" style="padding-left: 0.251em;"><span style="display: inline-block; position: relative; width: 1.182em; height: 0px;"><span style="position: absolute; clip: rect(3.105em, 1000.56em, 4.159em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-6407" style="font-family: MathJax_Math-italic;">h</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -4.339em; left: 0.561em;"><span class="mi" id="MathJax-Span-6408" style="font-size: 70.7%; font-family: MathJax_Math-italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.065em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="mi" id="MathJax-Span-6409" style="font-family: MathJax_Math-italic;">Q</span><span class="mi" id="MathJax-Span-6410" style="font-family: MathJax_Math-italic;">b</span></span><span style="display: inline-block; width: 0px; height: 2.36em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.304em; border-left: 0px solid; width: 0px; height: 1.465em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup><mi>b</mi><mi>T</mi></msup><mi>Q</mi><mi>h</mi><mo>=</mo><msup><mi>h</mi><mi>T</mi></msup><mi>Q</mi><mi>b</mi></math></span></span><script type="math/tex" id="MathJax-Element-183">b^TQh = h^TQb</script>. Therefore, we can futher simplify equation (3) to</p>
<p style="text-align: center;"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-184-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msup&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;msub&gt;&lt;mi&gt;h&lt;/mi&gt;&lt;mi&gt;m&lt;/mi&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;/msup&gt;&lt;mi&gt;Q&lt;/mi&gt;&lt;msub&gt;&lt;mi&gt;h&lt;/mi&gt;&lt;mi&gt;m&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;&amp;#x2013;&lt;/mo&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;msup&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;msub&gt;&lt;mi&gt;h&lt;/mi&gt;&lt;mi&gt;m&lt;/mi&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;/msup&gt;&lt;mi&gt;Q&lt;/mi&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;msup&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;/msup&gt;&lt;mi&gt;Q&lt;/mi&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;mo&gt;&amp;#x2013;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-6411" style="width: 18.241em; display: inline-block;"><span style="display: inline-block; position: relative; width: 14.705em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(1.244em, 1014.64em, 2.733em, -999.997em); top: -2.354em; left: 0em;"><span class="mrow" id="MathJax-Span-6412"><span class="msubsup" id="MathJax-Span-6413"><span style="display: inline-block; position: relative; width: 1.864em; height: 0px;"><span style="position: absolute; clip: rect(3.105em, 1001.31em, 4.346em, -999.997em); top: -3.967em; left: 0em;"><span class="texatom" id="MathJax-Span-6414"><span class="mrow" id="MathJax-Span-6415"><span class="msubsup" id="MathJax-Span-6416"><span style="display: inline-block; position: relative; width: 1.306em; height: 0px;"><span style="position: absolute; clip: rect(3.105em, 1000.56em, 4.159em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-6417" style="font-family: MathJax_Math-italic;">h</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.561em;"><span class="mi" id="MathJax-Span-6418" style="font-size: 70.7%; font-family: MathJax_Math-italic;">m</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -4.401em; left: 1.306em;"><span class="mi" id="MathJax-Span-6419" style="font-size: 70.7%; font-family: MathJax_Math-italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.065em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="mi" id="MathJax-Span-6420" style="font-family: MathJax_Math-italic;">Q</span><span class="msubsup" id="MathJax-Span-6421"><span style="display: inline-block; position: relative; width: 1.306em; height: 0px;"><span style="position: absolute; clip: rect(3.105em, 1000.56em, 4.159em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-6422" style="font-family: MathJax_Math-italic;">h</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.561em;"><span class="mi" id="MathJax-Span-6423" style="font-size: 70.7%; font-family: MathJax_Math-italic;">m</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="mo" id="MathJax-Span-6424" style="font-family: MathJax_Main;">–</span><span class="mn" id="MathJax-Span-6425" style="font-family: MathJax_Main; padding-left: 0.189em;">2</span><span class="msubsup" id="MathJax-Span-6426"><span style="display: inline-block; position: relative; width: 1.864em; height: 0px;"><span style="position: absolute; clip: rect(3.105em, 1001.31em, 4.346em, -999.997em); top: -3.967em; left: 0em;"><span class="texatom" id="MathJax-Span-6427"><span class="mrow" id="MathJax-Span-6428"><span class="msubsup" id="MathJax-Span-6429"><span style="display: inline-block; position: relative; width: 1.306em; height: 0px;"><span style="position: absolute; clip: rect(3.105em, 1000.56em, 4.159em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-6430" style="font-family: MathJax_Math-italic;">h</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.561em;"><span class="mi" id="MathJax-Span-6431" style="font-size: 70.7%; font-family: MathJax_Math-italic;">m</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -4.401em; left: 1.306em;"><span class="mi" id="MathJax-Span-6432" style="font-size: 70.7%; font-family: MathJax_Math-italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.065em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="mi" id="MathJax-Span-6433" style="font-family: MathJax_Math-italic;">Q</span><span class="mi" id="MathJax-Span-6434" style="font-family: MathJax_Math-italic;">b</span><span class="mo" id="MathJax-Span-6435" style="font-family: MathJax_Main; padding-left: 0.251em;">+</span><span class="msubsup" id="MathJax-Span-6436" style="padding-left: 0.251em;"><span style="display: inline-block; position: relative; width: 0.996em; height: 0px;"><span style="position: absolute; clip: rect(3.105em, 1000.44em, 4.159em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-6437" style="font-family: MathJax_Math-italic;">b</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -4.339em; left: 0.437em;"><span class="mi" id="MathJax-Span-6438" style="font-size: 70.7%; font-family: MathJax_Math-italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.065em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="mi" id="MathJax-Span-6439" style="font-family: MathJax_Math-italic;">Q</span><span class="mi" id="MathJax-Span-6440" style="font-family: MathJax_Math-italic;">b</span><span class="mo" id="MathJax-Span-6441" style="font-family: MathJax_Main;">–</span><span class="mn" id="MathJax-Span-6442" style="font-family: MathJax_Main; padding-left: 0.189em;">1</span><span class="mo" id="MathJax-Span-6443" style="font-family: MathJax_Main; padding-left: 0.251em;">=</span><span class="mn" id="MathJax-Span-6444" style="font-family: MathJax_Main; padding-left: 0.251em;">0</span></span><span style="display: inline-block; width: 0px; height: 2.36em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.304em; border-left: 0px solid; width: 0px; height: 1.542em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup><mrow class="MJX-TeXAtom-ORD"><msub><mi>h</mi><mi>m</mi></msub></mrow><mi>T</mi></msup><mi>Q</mi><msub><mi>h</mi><mi>m</mi></msub><mo>–</mo><mn>2</mn><msup><mrow class="MJX-TeXAtom-ORD"><msub><mi>h</mi><mi>m</mi></msub></mrow><mi>T</mi></msup><mi>Q</mi><mi>b</mi><mo>+</mo><msup><mi>b</mi><mi>T</mi></msup><mi>Q</mi><mi>b</mi><mo>–</mo><mn>1</mn><mo>=</mo><mn>0</mn></math></span></span><script type="math/tex" id="MathJax-Element-184">{h_m}^TQh_m – 2{h_m}^TQb + b^TQb – 1 = 0</script>&nbsp; &nbsp; &nbsp;——————–&nbsp; &nbsp; &nbsp;(4)</p>
<p>Equation (4) can now be rewritten in <strong><a href="https://en.wikipedia.org/wiki/Quadric">quadric form</a></strong> (a quadric is a generalization of conic sections (ellipses, parabolas, and hyperbolas))</p>
<p style="text-align: center;"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-185-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msup&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;msub&gt;&lt;mi&gt;h&lt;/mi&gt;&lt;mi&gt;m&lt;/mi&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;/msup&gt;&lt;mi&gt;Q&lt;/mi&gt;&lt;msub&gt;&lt;mi&gt;h&lt;/mi&gt;&lt;mi&gt;m&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;msup&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;msub&gt;&lt;mi&gt;h&lt;/mi&gt;&lt;mi&gt;m&lt;/mi&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;/msup&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-6445" style="width: 14.023em; display: inline-block;"><span style="display: inline-block; position: relative; width: 11.293em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(1.244em, 1011.23em, 2.733em, -999.997em); top: -2.354em; left: 0em;"><span class="mrow" id="MathJax-Span-6446"><span class="msubsup" id="MathJax-Span-6447"><span style="display: inline-block; position: relative; width: 1.864em; height: 0px;"><span style="position: absolute; clip: rect(3.105em, 1001.31em, 4.346em, -999.997em); top: -3.967em; left: 0em;"><span class="texatom" id="MathJax-Span-6448"><span class="mrow" id="MathJax-Span-6449"><span class="msubsup" id="MathJax-Span-6450"><span style="display: inline-block; position: relative; width: 1.306em; height: 0px;"><span style="position: absolute; clip: rect(3.105em, 1000.56em, 4.159em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-6451" style="font-family: MathJax_Math-italic;">h</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.561em;"><span class="mi" id="MathJax-Span-6452" style="font-size: 70.7%; font-family: MathJax_Math-italic;">m</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -4.401em; left: 1.306em;"><span class="mi" id="MathJax-Span-6453" style="font-size: 70.7%; font-family: MathJax_Math-italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.065em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="mi" id="MathJax-Span-6454" style="font-family: MathJax_Math-italic;">Q</span><span class="msubsup" id="MathJax-Span-6455"><span style="display: inline-block; position: relative; width: 1.306em; height: 0px;"><span style="position: absolute; clip: rect(3.105em, 1000.56em, 4.159em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-6456" style="font-family: MathJax_Math-italic;">h</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.561em;"><span class="mi" id="MathJax-Span-6457" style="font-size: 70.7%; font-family: MathJax_Math-italic;">m</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="mo" id="MathJax-Span-6458" style="font-family: MathJax_Main; padding-left: 0.251em;">+</span><span class="msubsup" id="MathJax-Span-6459" style="padding-left: 0.251em;"><span style="display: inline-block; position: relative; width: 1.864em; height: 0px;"><span style="position: absolute; clip: rect(3.105em, 1001.31em, 4.346em, -999.997em); top: -3.967em; left: 0em;"><span class="texatom" id="MathJax-Span-6460"><span class="mrow" id="MathJax-Span-6461"><span class="msubsup" id="MathJax-Span-6462"><span style="display: inline-block; position: relative; width: 1.306em; height: 0px;"><span style="position: absolute; clip: rect(3.105em, 1000.56em, 4.159em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-6463" style="font-family: MathJax_Math-italic;">h</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.561em;"><span class="mi" id="MathJax-Span-6464" style="font-size: 70.7%; font-family: MathJax_Math-italic;">m</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -4.401em; left: 1.306em;"><span class="mi" id="MathJax-Span-6465" style="font-size: 70.7%; font-family: MathJax_Math-italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.065em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="mi" id="MathJax-Span-6466" style="font-family: MathJax_Math-italic;">n</span><span class="mo" id="MathJax-Span-6467" style="font-family: MathJax_Main; padding-left: 0.251em;">+</span><span class="mi" id="MathJax-Span-6468" style="font-family: MathJax_Math-italic; padding-left: 0.251em;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-6469" style="font-family: MathJax_Main; padding-left: 0.251em;">=</span><span class="mn" id="MathJax-Span-6470" style="font-family: MathJax_Main; padding-left: 0.251em;">0</span></span><span style="display: inline-block; width: 0px; height: 2.36em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.304em; border-left: 0px solid; width: 0px; height: 1.542em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup><mrow class="MJX-TeXAtom-ORD"><msub><mi>h</mi><mi>m</mi></msub></mrow><mi>T</mi></msup><mi>Q</mi><msub><mi>h</mi><mi>m</mi></msub><mo>+</mo><msup><mrow class="MJX-TeXAtom-ORD"><msub><mi>h</mi><mi>m</mi></msub></mrow><mi>T</mi></msup><mi>n</mi><mo>+</mo><mi>d</mi><mo>=</mo><mn>0</mn></math></span></span><script type="math/tex" id="MathJax-Element-185">{h_m}^TQh_m + {h_m}^Tn + d = 0</script>&nbsp; &nbsp; &nbsp;——————–&nbsp; &nbsp; &nbsp;(5)</p>
<p>where</p>
<p><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-186-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;Q&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msup&gt;&lt;mi&gt;A&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;msup&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;/msup&gt;&lt;msup&gt;&lt;mi&gt;A&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-6471" style="width: 8.626em; display: inline-block;"><span style="display: inline-block; position: relative; width: 6.951em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(1.306em, 1006.95em, 2.795em, -999.997em); top: -2.354em; left: 0em;"><span class="mrow" id="MathJax-Span-6472"><span class="mi" id="MathJax-Span-6473" style="font-family: MathJax_Math-italic;">Q</span><span class="mo" id="MathJax-Span-6474" style="font-family: MathJax_Main; padding-left: 0.251em;">=</span><span class="mo" id="MathJax-Span-6475" style="font-family: MathJax_Main; padding-left: 0.251em;">(</span><span class="msubsup" id="MathJax-Span-6476"><span style="display: inline-block; position: relative; width: 1.74em; height: 0px;"><span style="position: absolute; clip: rect(3.043em, 1000.75em, 4.159em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-6477" style="font-family: MathJax_Math-italic;">A</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -4.339em; left: 0.748em;"><span class="texatom" id="MathJax-Span-6478"><span class="mrow" id="MathJax-Span-6479"><span class="mo" id="MathJax-Span-6480" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="mn" id="MathJax-Span-6481" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-6482"><span style="display: inline-block; position: relative; width: 0.996em; height: 0px;"><span style="position: absolute; clip: rect(3.043em, 1000.31em, 4.408em, -999.997em); top: -3.967em; left: 0em;"><span class="mo" id="MathJax-Span-6483" style="font-family: MathJax_Main;">)</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -4.339em; left: 0.375em;"><span class="mi" id="MathJax-Span-6484" style="font-size: 70.7%; font-family: MathJax_Math-italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.065em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-6485"><span style="display: inline-block; position: relative; width: 1.74em; height: 0px;"><span style="position: absolute; clip: rect(3.043em, 1000.75em, 4.159em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-6486" style="font-family: MathJax_Math-italic;">A</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -4.339em; left: 0.748em;"><span class="texatom" id="MathJax-Span-6487"><span class="mrow" id="MathJax-Span-6488"><span class="mo" id="MathJax-Span-6489" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="mn" id="MathJax-Span-6490" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.36em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.381em; border-left: 0px solid; width: 0px; height: 1.542em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>Q</mi><mo>=</mo><mo stretchy="false">(</mo><msup><mi>A</mi><mrow class="MJX-TeXAtom-ORD"><mo>−</mo><mn>1</mn></mrow></msup><msup><mo stretchy="false">)</mo><mi>T</mi></msup><msup><mi>A</mi><mrow class="MJX-TeXAtom-ORD"><mo>−</mo><mn>1</mn></mrow></msup></math></span></span><script type="math/tex" id="MathJax-Element-186">Q = (A^{-1})^TA^{-1}</script></p>
<p><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-187-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;mi&gt;Q&lt;/mi&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-6491" style="width: 5.462em; display: inline-block;"><span style="display: inline-block; position: relative; width: 4.408em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(1.492em, 1004.41em, 2.733em, -999.997em); top: -2.354em; left: 0em;"><span class="mrow" id="MathJax-Span-6492"><span class="mi" id="MathJax-Span-6493" style="font-family: MathJax_Math-italic;">n</span><span class="mo" id="MathJax-Span-6494" style="font-family: MathJax_Main; padding-left: 0.251em;">=</span><span class="mo" id="MathJax-Span-6495" style="font-family: MathJax_Main; padding-left: 0.251em;">−</span><span class="mn" id="MathJax-Span-6496" style="font-family: MathJax_Main;">2</span><span class="mi" id="MathJax-Span-6497" style="font-family: MathJax_Math-italic;">Q</span><span class="mi" id="MathJax-Span-6498" style="font-family: MathJax_Math-italic;">b</span></span><span style="display: inline-block; width: 0px; height: 2.36em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.304em; border-left: 0px solid; width: 0px; height: 1.235em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>n</mi><mo>=</mo><mo>−</mo><mn>2</mn><mi>Q</mi><mi>b</mi></math></span></span><script type="math/tex" id="MathJax-Element-187">n = -2Qb</script></p>
<p><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-188-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;msup&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;/msup&gt;&lt;mi&gt;Q&lt;/mi&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;mo&gt;&amp;#x2013;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-6499" style="width: 6.455em; display: inline-block;"><span style="display: inline-block; position: relative; width: 5.214em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(1.306em, 1005.15em, 2.733em, -999.997em); top: -2.354em; left: 0em;"><span class="mrow" id="MathJax-Span-6500"><span class="mi" id="MathJax-Span-6501" style="font-family: MathJax_Math-italic;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-6502" style="font-family: MathJax_Main; padding-left: 0.251em;">=</span><span class="msubsup" id="MathJax-Span-6503" style="padding-left: 0.251em;"><span style="display: inline-block; position: relative; width: 0.996em; height: 0px;"><span style="position: absolute; clip: rect(3.105em, 1000.44em, 4.159em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-6504" style="font-family: MathJax_Math-italic;">b</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -4.339em; left: 0.437em;"><span class="mi" id="MathJax-Span-6505" style="font-size: 70.7%; font-family: MathJax_Math-italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.065em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="mi" id="MathJax-Span-6506" style="font-family: MathJax_Math-italic;">Q</span><span class="mi" id="MathJax-Span-6507" style="font-family: MathJax_Math-italic;">b</span><span class="mo" id="MathJax-Span-6508" style="font-family: MathJax_Main;">–</span><span class="mn" id="MathJax-Span-6509" style="font-family: MathJax_Main; padding-left: 0.189em;">1</span></span><span style="display: inline-block; width: 0px; height: 2.36em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.304em; border-left: 0px solid; width: 0px; height: 1.465em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>d</mi><mo>=</mo><msup><mi>b</mi><mi>T</mi></msup><mi>Q</mi><mi>b</mi><mo>–</mo><mn>1</mn></math></span></span><script type="math/tex" id="MathJax-Element-188">d = b^TQb – 1</script></p>
<p>There are many different types of quadric surfaces and they can all be verified mathematically. However, we are not going to do that here because there is a more obvious answer. <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-189-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;h&lt;/mi&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-6510" style="width: 0.685em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.561em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(1.492em, 1000.56em, 2.547em, -999.997em); top: -2.354em; left: 0em;"><span class="mrow" id="MathJax-Span-6511"><span class="mi" id="MathJax-Span-6512" style="font-family: MathJax_Math-italic;">h</span></span><span style="display: inline-block; width: 0px; height: 2.36em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.073em; border-left: 0px solid; width: 0px; height: 1.004em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>h</mi></math></span></span><script type="math/tex" id="MathJax-Element-189">h</script> is supposed to be a unit direction vector so it would only be natural that the set of all directions would form a unit circle. In other words, Equation (5) must be that of an ellipse (a circle is a special case of an ellipse). On a side note, you can find a list of all quadric surfaces and their definition from <strong><a href="http://www.geom.uiuc.edu/docs/reference/CRC-formulas/node61.html">this site</a></strong>.</p>
<p>Anyway, what we need to do now is to collect some data so that we can use it for our calibration. In order to collect the data, we need the Arduino to send it to the computer, and Python on the computer to save the data (you can always use any other programs to achieve this). The Arduino program is exactly the same as the one in the <strong><a href="https://thepoorengineer.com/en/quaternion/#gyroRotation">previous section</a>&nbsp;</strong>but I’ll provide it below just in case. The python program simply collects the data for a period of time and saves the file in a csv format (Please don’t mind the class name because I was too lazy to change it from my previous project). I will also provide the data that I have collected so that you can replicate the graph that I will show later.</p>
<ul>
<li><a href="https://thepoorengineer.com/wp-content/uploads/2018/07/ArduinoExtractSensorData.zip"><span style="font-size: 12pt;">Arduino Code</span></a></li>
<li><a href="https://thepoorengineer.com/wp-content/uploads/2018/07/getRealData.txt"><span style="font-size: 12pt;">Python Data Collection Code</span></a></li>
<li><a href="https://thepoorengineer.com/wp-content/uploads/2018/07/magnetometer.csv"><span style="font-size: 12pt;">Magnetometer Data</span></a></li>
</ul>
<p>Alright, go ahead and collect your data if you happen to use the same sensor as me. Otherwise, you can still use part of the code for the communication between Arduino and Python.</p>
<p>Right now, if we were to simply plot our raw data, the data points will most probably appear on the surface of an ellipse which has a center that has an offset from the origin. However, after our calibration, if we do a scatter plot of our data taken in all directions, we would expect that the points will now lie close to the surface of a unit circle. That is the main objective of this calibration process. Before I begin, here is the calibration code. The algorithm is based on this <strong><a href="https://ieeexplore.ieee.org/document/1290055/authors">journal paper</a>&nbsp;</strong>(Least squares ellipsoid fitting) and this<strong><a href="https://ieeexplore.ieee.org/document/6289882/"> journal paper</a></strong> (scaling the solution).</p>
<ul>
<li><span style="font-size: 12pt;"><a href="https://thepoorengineer.com/wp-content/uploads/2018/07/calibrateMag.txt">Python Magnetometer Calibration Code</a></span></li>
</ul>
<p>Let’s take a look at the raw data that I have gotten from the sensor. I must say that I did not rotate the magnetometer in all directions while collecting the data thus there are blank spaces in the graph as shown below. You would possible get better results if you were to capture the data more thoroughly.</p>
<figure id="attachment_1878" aria-describedby="caption-attachment-1878" style="width: 816px" class="wp-caption aligncenter"><img loading="lazy" class="size-full wp-image-1878" src="./Attitude Determination with Quaternion using Extended Kalman Filter Archives - ThePoorEngineer_files/Uncalibrated.png" alt="" width="816" height="652" srcset="https://thepoorengineer.com/wp-content/uploads/2018/07/Uncalibrated.png 816w, https://thepoorengineer.com/wp-content/uploads/2018/07/Uncalibrated-300x240.png 300w, https://thepoorengineer.com/wp-content/uploads/2018/07/Uncalibrated-768x614.png 768w" sizes="(max-width: 816px) 100vw, 816px"><figcaption id="caption-attachment-1878" class="wp-caption-text">Uncalibrated Magnetometer Data</figcaption></figure>
<p>If you take a careful look at the above graph, you’ll see a small blue dot at (0, 0, 0). That is actually a unit circle centered at the origin so we want our data to be scaled down such that it lies on that blue circle. You should try to run the program on your computer because then you’ll be able to rotate the 3D graph to get a more complete view. Anyway, I am not going to go through the least squares fitting algorithm from the <strong><a href="https://ieeexplore.ieee.org/document/1290055/authors">first paper</a></strong> (because I don’t really understand the mathematics behind it as well..) but after applying the fitting algorithm, we will be able to solve for the values of <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-190-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;Q&lt;/mi&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-6513" style="width: 0.996em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.81em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(1.492em, 1000.75em, 2.733em, -999.997em); top: -2.354em; left: 0em;"><span class="mrow" id="MathJax-Span-6514"><span class="mi" id="MathJax-Span-6515" style="font-family: MathJax_Math-italic;">Q</span></span><span style="display: inline-block; width: 0px; height: 2.36em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.304em; border-left: 0px solid; width: 0px; height: 1.235em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>Q</mi></math></span></span><script type="math/tex" id="MathJax-Element-190">Q</script>, <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-191-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-6516" style="width: 0.81em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.623em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(1.74em, 1000.62em, 2.547em, -999.997em); top: -2.354em; left: 0em;"><span class="mrow" id="MathJax-Span-6517"><span class="mi" id="MathJax-Span-6518" style="font-family: MathJax_Math-italic;">n</span></span><span style="display: inline-block; width: 0px; height: 2.36em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.073em; border-left: 0px solid; width: 0px; height: 0.696em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>n</mi></math></span></span><script type="math/tex" id="MathJax-Element-191">n</script> and <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-192-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-6519" style="width: 0.623em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.499em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(1.492em, 1000.5em, 2.547em, -999.997em); top: -2.354em; left: 0em;"><span class="mrow" id="MathJax-Span-6520"><span class="mi" id="MathJax-Span-6521" style="font-family: MathJax_Math-italic;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.36em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.073em; border-left: 0px solid; width: 0px; height: 1.004em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>d</mi></math></span></span><script type="math/tex" id="MathJax-Element-192">d</script> from equation (5).</p>
<p>Next, we will have to determine the values of <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-193-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msup&gt;&lt;mi&gt;A&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-6522" style="width: 2.174em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.74em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(1.368em, 1001.74em, 2.547em, -999.997em); top: -2.354em; left: 0em;"><span class="mrow" id="MathJax-Span-6523"><span class="msubsup" id="MathJax-Span-6524"><span style="display: inline-block; position: relative; width: 1.74em; height: 0px;"><span style="position: absolute; clip: rect(3.043em, 1000.75em, 4.159em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-6525" style="font-family: MathJax_Math-italic;">A</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -4.339em; left: 0.748em;"><span class="texatom" id="MathJax-Span-6526"><span class="mrow" id="MathJax-Span-6527"><span class="mo" id="MathJax-Span-6528" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="mn" id="MathJax-Span-6529" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.36em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.073em; border-left: 0px solid; width: 0px; height: 1.158em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup><mi>A</mi><mrow class="MJX-TeXAtom-ORD"><mo>−</mo><mn>1</mn></mrow></msup></math></span></span><script type="math/tex" id="MathJax-Element-193">A^{-1}</script> and <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-194-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-6530" style="width: 0.561em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.437em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(1.492em, 1000.44em, 2.547em, -999.997em); top: -2.354em; left: 0em;"><span class="mrow" id="MathJax-Span-6531"><span class="mi" id="MathJax-Span-6532" style="font-family: MathJax_Math-italic;">b</span></span><span style="display: inline-block; width: 0px; height: 2.36em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.073em; border-left: 0px solid; width: 0px; height: 1.004em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>b</mi></math></span></span><script type="math/tex" id="MathJax-Element-194">b</script> so that we can apply equation (1) to perform our calibration. This is done via the following equations based on the <strong><a href="https://ieeexplore.ieee.org/document/6289882/">second paper</a></strong>.</p>
<p style="text-align: center;"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-195-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mstyle mathsize=&quot;1.44em&quot;&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;msup&gt;&lt;mi&gt;Q&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;/mrow&gt;&lt;/mstyle&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-6533" style="width: 8.688em; display: inline-block;"><span style="display: inline-block; position: relative; width: 7.013em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(1.182em, 1007.01em, 3.167em, -999.997em); top: -2.664em; left: 0em;"><span class="mrow" id="MathJax-Span-6534"><span class="mstyle" id="MathJax-Span-6535"><span class="mrow" id="MathJax-Span-6536"><span class="texatom" id="MathJax-Span-6537"><span class="mrow" id="MathJax-Span-6538"><span class="mi" id="MathJax-Span-6539" style="font-size: 144%; font-family: MathJax_Math-italic;">b</span><span class="mo" id="MathJax-Span-6540" style="font-size: 144%; font-family: MathJax_Main; padding-left: 0.251em;">=</span><span class="mo" id="MathJax-Span-6541" style="font-size: 144%; font-family: MathJax_Main; padding-left: 0.251em;">−</span><span class="msubsup" id="MathJax-Span-6542"><span style="display: inline-block; position: relative; width: 2.547em; height: 0px;"><span style="position: absolute; clip: rect(2.795em, 1001.06em, 4.47em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-6543" style="font-size: 144%; font-family: MathJax_Math-italic;">Q</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -4.587em; left: 1.12em;"><span class="texatom" id="MathJax-Span-6544"><span class="mrow" id="MathJax-Span-6545"><span class="mo" id="MathJax-Span-6546" style="font-size: 101.8%; font-family: MathJax_Main;">−</span><span class="mn" id="MathJax-Span-6547" style="font-size: 101.8%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="mi" id="MathJax-Span-6548" style="font-size: 144%; font-family: MathJax_Math-italic;">n</span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.671em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.458em; border-left: 0px solid; width: 0px; height: 2.081em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mstyle mathsize="1.44em"><mrow class="MJX-TeXAtom-ORD"><mi>b</mi><mo>=</mo><mo>−</mo><msup><mi>Q</mi><mrow class="MJX-TeXAtom-ORD"><mo>−</mo><mn>1</mn></mrow></msup><mi>n</mi></mrow></mstyle></math></span></span><script type="math/tex" id="MathJax-Element-195">\Large{b = -Q^{-1}n}</script></p>
<p style="text-align: center;"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-196-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mstyle mathsize=&quot;1.44em&quot;&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;msup&gt;&lt;mi&gt;A&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mfrac&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;msqrt&gt;&lt;msup&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;/msup&gt;&lt;msup&gt;&lt;mi&gt;M&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;/msqrt&gt;&lt;/mfrac&gt;&lt;msup&gt;&lt;mi&gt;M&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo&gt;/&lt;/mo&gt;&lt;/mrow&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;/mrow&gt;&lt;/mstyle&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-6549" style="width: 17.931em; display: inline-block;"><span style="display: inline-block; position: relative; width: 14.457em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(1.12em, 1014.46em, 3.911em, -999.997em); top: -2.664em; left: 0em;"><span class="mrow" id="MathJax-Span-6550"><span class="mstyle" id="MathJax-Span-6551"><span class="mrow" id="MathJax-Span-6552"><span class="texatom" id="MathJax-Span-6553"><span class="mrow" id="MathJax-Span-6554"><span class="msubsup" id="MathJax-Span-6555"><span style="display: inline-block; position: relative; width: 2.484em; height: 0px;"><span style="position: absolute; clip: rect(2.733em, 1001.06em, 4.159em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-6556" style="font-size: 144%; font-family: MathJax_Math-italic;">A</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -4.587em; left: 1.058em;"><span class="texatom" id="MathJax-Span-6557"><span class="mrow" id="MathJax-Span-6558"><span class="mo" id="MathJax-Span-6559" style="font-size: 101.8%; font-family: MathJax_Main;">−</span><span class="mn" id="MathJax-Span-6560" style="font-size: 101.8%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="mo" id="MathJax-Span-6561" style="font-size: 144%; font-family: MathJax_Main; padding-left: 0.251em;">=</span><span class="mfrac" id="MathJax-Span-6562" style="padding-left: 0.375em;"><span style="display: inline-block; position: relative; width: 6.517em; height: 0px; margin-right: 0.189em; margin-left: 0.189em;"><span style="position: absolute; clip: rect(3.105em, 1000.44em, 4.159em, -999.997em); top: -4.525em; left: 50%; margin-left: -0.245em;"><span class="mn" id="MathJax-Span-6563" style="font-size: 101.8%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(2.795em, 1006.33em, 4.346em, -999.997em); top: -3.099em; left: 50%; margin-left: -3.161em;"><span class="msqrt" id="MathJax-Span-6564"><span style="display: inline-block; position: relative; width: 6.331em; height: 0px;"><span style="position: absolute; clip: rect(2.919em, 1005.28em, 4.221em, -999.997em); top: -3.967em; left: 0.996em;"><span class="mrow" id="MathJax-Span-6565"><span class="msubsup" id="MathJax-Span-6566"><span style="display: inline-block; position: relative; width: 1.182em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.62em, 4.159em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-6567" style="font-size: 101.8%; font-family: MathJax_Math-italic;">n</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -4.277em; left: 0.623em;"><span class="mi" id="MathJax-Span-6568" style="font-size: 72%; font-family: MathJax_Math-italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.065em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-6569"><span style="display: inline-block; position: relative; width: 2.174em; height: 0px;"><span style="position: absolute; clip: rect(3.105em, 1001.06em, 4.159em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-6570" style="font-size: 101.8%; font-family: MathJax_Math-italic;">M<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.065em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -4.401em; left: 1.12em;"><span class="texatom" id="MathJax-Span-6571"><span class="mrow" id="MathJax-Span-6572"><span class="mo" id="MathJax-Span-6573" style="font-size: 72%; font-family: MathJax_Main;">−</span><span class="mn" id="MathJax-Span-6574" style="font-size: 72%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="mi" id="MathJax-Span-6575" style="font-size: 101.8%; font-family: MathJax_Math-italic;">n</span><span class="mo" id="MathJax-Span-6576" style="font-size: 101.8%; font-family: MathJax_Main;">−</span><span class="mi" id="MathJax-Span-6577" style="font-size: 101.8%; font-family: MathJax_Math-italic;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.477em, 1005.28em, 3.911em, -999.997em); top: -4.712em; left: 0.996em;"><span style="display: inline-block; position: relative; width: 5.276em; height: 0px;"><span style="position: absolute; top: -3.967em; left: -0.059em;"><span style="font-size: 101.8%; font-family: MathJax_Main;">−</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.967em; left: 4.594em;"><span style="font-size: 101.8%; font-family: MathJax_Main;">−</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.967em; left: 0.437em;"><span style="font-size: 101.8%; font-family: MathJax_Main;">−</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.967em; left: 0.934em;"><span style="font-size: 101.8%; font-family: MathJax_Main;">−</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.967em; left: 1.43em;"><span style="font-size: 101.8%; font-family: MathJax_Main;">−</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.967em; left: 1.988em;"><span style="font-size: 101.8%; font-family: MathJax_Main;">−</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.967em; left: 2.484em;"><span style="font-size: 101.8%; font-family: MathJax_Main;">−</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.967em; left: 3.043em;"><span style="font-size: 101.8%; font-family: MathJax_Main;">−</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.967em; left: 3.539em;"><span style="font-size: 101.8%; font-family: MathJax_Main;">−</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.967em; left: 4.097em;"><span style="font-size: 101.8%; font-family: MathJax_Main;">−</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(2.919em, 1001.06em, 4.532em, -999.997em); top: -4.153em; left: 0em;"><span><span style="font-size: 101.8%; font-family: MathJax_Size1;">√</span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(0.872em, 1006.52em, 1.306em, -999.997em); top: -1.424em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.4px solid; width: 6.517em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.12em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-6578"><span style="display: inline-block; position: relative; width: 3.229em; height: 0px;"><span style="position: absolute; clip: rect(2.795em, 1001.49em, 4.159em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-6579" style="font-size: 144%; font-family: MathJax_Math-italic;">M<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.065em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -4.587em; left: 1.616em;"><span class="texatom" id="MathJax-Span-6580"><span class="mrow" id="MathJax-Span-6581"><span class="mn" id="MathJax-Span-6582" style="font-size: 101.8%; font-family: MathJax_Main;">1</span><span class="texatom" id="MathJax-Span-6583"><span class="mrow" id="MathJax-Span-6584"><span class="mo" id="MathJax-Span-6585" style="font-size: 101.8%; font-family: MathJax_Main;">/</span></span></span><span class="mn" id="MathJax-Span-6586" style="font-size: 101.8%; font-family: MathJax_Main;">2</span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.671em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -1.381em; border-left: 0px solid; width: 0px; height: 3.158em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mstyle mathsize="1.44em"><mrow class="MJX-TeXAtom-ORD"><msup><mi>A</mi><mrow class="MJX-TeXAtom-ORD"><mo>−</mo><mn>1</mn></mrow></msup><mo>=</mo><mfrac><mn>1</mn><msqrt><msup><mi>n</mi><mi>T</mi></msup><msup><mi>M</mi><mrow class="MJX-TeXAtom-ORD"><mo>−</mo><mn>1</mn></mrow></msup><mi>n</mi><mo>−</mo><mi>d</mi></msqrt></mfrac><msup><mi>M</mi><mrow class="MJX-TeXAtom-ORD"><mn>1</mn><mrow class="MJX-TeXAtom-ORD"><mo>/</mo></mrow><mn>2</mn></mrow></msup></mrow></mstyle></math></span></span><script type="math/tex" id="MathJax-Element-196">\Large{A^{-1} = \frac{1}{\sqrt{n^TM^{-1}n-d}}M^{1/2}}</script></p>
<p>Now that we have the required variables to use equation (1), we are finally able to perform the calibration method. What we have to do now is simply apply equation (1) to all measurement points! For my data set, I was able to get the following graph.</p>
<figure id="attachment_1879" aria-describedby="caption-attachment-1879" style="width: 814px" class="wp-caption aligncenter"><img loading="lazy" class="size-full wp-image-1879" src="./Attitude Determination with Quaternion using Extended Kalman Filter Archives - ThePoorEngineer_files/Calibrated.png" alt="" width="814" height="650" srcset="https://thepoorengineer.com/wp-content/uploads/2018/07/Calibrated.png 814w, https://thepoorengineer.com/wp-content/uploads/2018/07/Calibrated-300x240.png 300w, https://thepoorengineer.com/wp-content/uploads/2018/07/Calibrated-768x613.png 768w" sizes="(max-width: 814px) 100vw, 814px"><figcaption id="caption-attachment-1879" class="wp-caption-text">Calibrated Magnetometer Data</figcaption></figure>
<p>And we are done! The magnetometer is now ready for use! On a side note, I do feel that there is still room for improvement in the above calibration process. For my magnetometer, the direction vector is slightly skewed to a particular direction, meaning that an actual 90 degrees show up as 80 degrees and a -90 degrees show up as -80 degrees. I suppose there are ways to correct these but I have not yet found the time to look things up. For now, let us use the above method and proceed to the next section!</p>
<p style="text-align: right;"><a href="https://thepoorengineer.com/en/ekf-impl/"><span style="font-size: 14pt;"><span style="text-decoration: underline;"><strong><span style="font-size: 12pt;">Go to Next Section</span></strong></span></span></a></p>
    
    
                       
	</div><!-- .entry-content -->

	<footer class="entry-footer">
			</footer><!-- .entry-footer -->
</article><!-- #post-## -->








<article id="post-1744" class="post-1744 post type-post status-publish format-standard hentry category-attitude-determination-with-quaternion-using-ekf clearfix" itemscope="itemscope" itemtype="http://schema.org/BlogPosting" itemprop="blogPost">

	   
	<header class="entry-header">
  
		<h2 class="entry-title" itemprop="headline"><a href="https://thepoorengineer.com/en/quaternion/" rel="bookmark">Quaternion Rotation</a></h2>    
    

				<div class="entry-meta">
			<span class="posted-on">Posted on <a href="https://thepoorengineer.com/en/quaternion/" rel="bookmark"><time class="entry-date published" datetime="2018-07-10T21:17:26+09:00">July 10, 2018</time><time class="updated" datetime="2018-09-10T22:26:58+09:00" itemprop="dateUpdated">September 10, 2018</time></a></span>		</div><!-- .entry-meta -->
			</header><!-- .entry-header -->

	<div class="entry-content" itemprop="text">
    
    
  	<h3>Table of Contents</h3>
<ol>
<li><a href="https://thepoorengineer.com/en/attitude-determination/">Foreword and Introduction</a></li>
<li><a href="https://thepoorengineer.com/en/graphics/">Preparing the Graphics</a>
<ul>
<li><a href="https://thepoorengineer.com/en/graphics/#wireframe">Creating the Wireframe</a></li>
<li><a href="https://thepoorengineer.com/en/graphics/#perspective">Creating a Perspective View</a></li>
<li><a href="https://thepoorengineer.com/en/graphics/#pygame">Drawing in Pygame</a></li>
</ul>
</li>
<li><strong><span style="color: red;">Quaternion Rotation</span></strong>
<ul>
<li><strong><a href="https://thepoorengineer.com/en/category/projects/attitude-determination-with-quaternion-using-ekf/#quaternion">Quaternion basics</a></strong></li>
<li><strong><a href="https://thepoorengineer.com/en/category/projects/attitude-determination-with-quaternion-using-ekf/#testRotation">Testing Quaternion Rotation in Pygame</a></strong></li>
<li><strong><a href="https://thepoorengineer.com/en/category/projects/attitude-determination-with-quaternion-using-ekf/#gyroRotation">Implementing Rotations with MEMS Gyrometer Data</a></strong></li>
</ul>
</li>
<li><a href="https://thepoorengineer.com/en/calibrating-the-magnetometer/">Calibrating the Magnetometer</a>
<ul>
<li><a href="https://thepoorengineer.com/en/calibrating-the-magnetometer/#ErrorModel">Error Modelling</a></li>
<li><a href="https://thepoorengineer.com/en/calibrating-the-magnetometer/#MeasurementModel">Measurement Model</a></li>
<li><a href="https://thepoorengineer.com/en/calibrating-the-magnetometer/#Calibration">Calibration</a></li>
</ul>
</li>
<li><a href="https://thepoorengineer.com/en/ekf-impl/">Extended Kalman Filter Implementation</a>
<ul>
<li><a href="https://thepoorengineer.com/en/ekf-impl/#KalmanStates">Kalman Filter States</a></li>
<li><a href="https://thepoorengineer.com/en/ekf-impl/#AccelData">Accelerometer Data</a></li>
<li><a href="https://thepoorengineer.com/en/ekf-impl/#MagData">Magnetometer Data</a></li>
<li><a href="https://thepoorengineer.com/en/ekf-impl/#EKFimpl">Quaternion EKF Implementation</a></li>
</ul>
</li>
<li><a href="https://thepoorengineer.com/en/ekf-impl/#conclusion">Conclusion</a></li>
</ol>
<p>In this post, I will go through some of the quaternion basics, and provide a simple implementation in python to visual the rotations. However, we will not be doing any derivations from first principles as it is quite mathematical. Instead, we will use existing formulae to build our code.</p>
<div id="quaternion"></div>
<hr>
<h2>Quaternion basics</h2>
<p>Quaternion provides us with a way for rotating a point around a specified axis by a specified angle. If you are just starting out in the topic of 3d rotations, you will often hear people saying “use quaternion because it will have any gimbal lock problems”. This is true, but the same applies to rotation matrices well. Rotation matrices do not experience gimbal lock problems. In fact, it does not make sense to say that at all. The gimbal lock problem happens when you use Euler Angles, which are simply a set of 3 elemental rotations to allow you to describe any orientation in a 3D space.&nbsp; In attitude determination, we often visualize a 3D rotation as a combination of yaw, pitch and roll. These are Euler angles thus they are susceptible to the gimbal lock problem, regardless of whether you use quaternion or not.</p>
<p>A quaternion is named as such because there are 4 components in total. If <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-197-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-6587" style="width: 0.561em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.437em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(1.74em, 1000.44em, 2.733em, -999.997em); top: -2.354em; left: 0em;"><span class="mrow" id="MathJax-Span-6588"><span class="mi" id="MathJax-Span-6589" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.36em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.304em; border-left: 0px solid; width: 0px; height: 0.927em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>q</mi></math></span></span><script type="math/tex" id="MathJax-Element-197">q</script> is a quaternion, then</p>
<p style="text-align: center;"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-198-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/msub&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mover&gt;&lt;mi&gt;&amp;#x0131;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;&amp;#x007E;&lt;/mo&gt;&lt;/mover&gt;&lt;/mrow&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msub&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mover&gt;&lt;mi&gt;&amp;#x0237;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;&amp;#x007E;&lt;/mo&gt;&lt;/mover&gt;&lt;/mrow&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mn&gt;3&lt;/mn&gt;&lt;/msub&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mover&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;&amp;#x007E;&lt;/mo&gt;&lt;/mover&gt;&lt;/mrow&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-6590" style="width: 13.154em; display: inline-block;"><span style="display: inline-block; position: relative; width: 10.611em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(1.244em, 1010.61em, 2.733em, -999.997em); top: -2.354em; left: 0em;"><span class="mrow" id="MathJax-Span-6591"><span class="mi" id="MathJax-Span-6592" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-6593" style="font-family: MathJax_Main; padding-left: 0.251em;">=</span><span class="msubsup" id="MathJax-Span-6594" style="padding-left: 0.251em;"><span style="display: inline-block; position: relative; width: 0.872em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.44em, 4.346em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-6595" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.437em;"><span class="mn" id="MathJax-Span-6596" style="font-size: 70.7%; font-family: MathJax_Main;">0</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="mo" id="MathJax-Span-6597" style="font-family: MathJax_Main; padding-left: 0.251em;">+</span><span class="msubsup" id="MathJax-Span-6598" style="padding-left: 0.251em;"><span style="display: inline-block; position: relative; width: 0.872em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.44em, 4.346em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-6599" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.437em;"><span class="mn" id="MathJax-Span-6600" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="texatom" id="MathJax-Span-6601"><span class="mrow" id="MathJax-Span-6602"><span class="munderover" id="MathJax-Span-6603"><span style="display: inline-block; position: relative; width: 0.561em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.31em, 4.159em, -999.997em); top: -3.967em; left: 0.065em;"><span class="mi" id="MathJax-Span-6604" style="font-family: MathJax_Main-italic;">ı<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.065em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.477em, 1000.44em, 3.973em, -999.997em); top: -4.339em; left: 0.065em;"><span class="mo" id="MathJax-Span-6605" style="font-family: MathJax_Main;">~</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span></span><span class="mo" id="MathJax-Span-6606" style="font-family: MathJax_Main; padding-left: 0.251em;">+</span><span class="msubsup" id="MathJax-Span-6607" style="padding-left: 0.251em;"><span style="display: inline-block; position: relative; width: 0.872em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.44em, 4.346em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-6608" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.437em;"><span class="mn" id="MathJax-Span-6609" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="texatom" id="MathJax-Span-6610"><span class="mrow" id="MathJax-Span-6611"><span class="munderover" id="MathJax-Span-6612"><span style="display: inline-block; position: relative; width: 0.499em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.31em, 4.346em, -999.997em); top: -3.967em; left: 0.065em;"><span class="mi" id="MathJax-Span-6613" style="font-family: MathJax_Main-italic;">ȷ</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.477em, 1000.44em, 3.973em, -999.997em); top: -4.339em; left: 0em;"><span class="mo" id="MathJax-Span-6614" style="font-family: MathJax_Main;">~</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span></span><span class="mo" id="MathJax-Span-6615" style="font-family: MathJax_Main; padding-left: 0.251em;">+</span><span class="msubsup" id="MathJax-Span-6616" style="padding-left: 0.251em;"><span style="display: inline-block; position: relative; width: 0.872em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.44em, 4.346em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-6617" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.437em;"><span class="mn" id="MathJax-Span-6618" style="font-size: 70.7%; font-family: MathJax_Main;">3</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="texatom" id="MathJax-Span-6619"><span class="mrow" id="MathJax-Span-6620"><span class="munderover" id="MathJax-Span-6621"><span style="display: inline-block; position: relative; width: 0.499em; height: 0px;"><span style="position: absolute; clip: rect(3.105em, 1000.5em, 4.159em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-6622" style="font-family: MathJax_Math-italic;">k</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.477em, 1000.44em, 3.973em, -999.997em); top: -4.587em; left: 0.003em;"><span class="mo" id="MathJax-Span-6623" style="font-family: MathJax_Main;">~</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.36em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.304em; border-left: 0px solid; width: 0px; height: 1.619em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>q</mi><mo>=</mo><msub><mi>q</mi><mn>0</mn></msub><mo>+</mo><msub><mi>q</mi><mn>1</mn></msub><mrow class="MJX-TeXAtom-ORD"><mover><mi>ı</mi><mo stretchy="false">~</mo></mover></mrow><mo>+</mo><msub><mi>q</mi><mn>2</mn></msub><mrow class="MJX-TeXAtom-ORD"><mover><mi>ȷ</mi><mo stretchy="false">~</mo></mover></mrow><mo>+</mo><msub><mi>q</mi><mn>3</mn></msub><mrow class="MJX-TeXAtom-ORD"><mover><mi>k</mi><mo stretchy="false">~</mo></mover></mrow></math></span></span><script type="math/tex" id="MathJax-Element-198">q=q_0+q_1\tilde{\imath}+q_2\tilde{\jmath}+q_3\tilde{k}</script></p>
<p>You can think of quaternion as an extension of complex number where instead of 1 real and 1 imaginary number, you now have 1 real and 3 imaginary numbers. Another way of notating a quaternion is a as such:</p>
<p style="text-align: center;"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-199-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mrow&gt;&lt;mo&gt;[&lt;/mo&gt;&lt;mtable rowspacing=&quot;4pt&quot; columnspacing=&quot;1em&quot;&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mover&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mtext mathvariant=&quot;bold&quot;&gt;q&lt;/mtext&gt;&lt;/mrow&gt;&lt;mo stretchy=&quot;false&quot;&gt;&amp;#x007E;&lt;/mo&gt;&lt;/mover&gt;&lt;/mrow&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;/mtable&gt;&lt;mo&gt;]&lt;/mo&gt;&lt;/mrow&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mrow&gt;&lt;mo&gt;[&lt;/mo&gt;&lt;mtable rowspacing=&quot;4pt&quot; columnspacing=&quot;1em&quot;&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mn&gt;3&lt;/mn&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;/mtable&gt;&lt;mo&gt;]&lt;/mo&gt;&lt;/mrow&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-6624" style="width: 9.867em; display: inline-block;"><span style="display: inline-block; position: relative; width: 7.944em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(2.795em, 1007.63em, 8.378em, -999.997em); top: -5.828em; left: 0em;"><span class="mrow" id="MathJax-Span-6625"><span class="mi" id="MathJax-Span-6626" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-6627" style="font-family: MathJax_Main; padding-left: 0.251em;">=</span><span class="mrow" id="MathJax-Span-6628" style="padding-left: 0.251em;"><span class="mo" id="MathJax-Span-6629" style="vertical-align: 0em;"><span style="font-family: MathJax_Size3;">[</span></span><span class="mtable" id="MathJax-Span-6630" style="padding-right: 0.189em; padding-left: 0.189em;"><span style="display: inline-block; position: relative; width: 0.872em; height: 0px;"><span style="position: absolute; clip: rect(2.671em, 1000.87em, 5.09em, -999.997em); top: -3.967em; left: 0em;"><span style="display: inline-block; position: relative; width: 0.872em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.87em, 4.346em, -999.997em); top: -4.587em; left: 50%; margin-left: -0.431em;"><span class="mtd" id="MathJax-Span-6631"><span class="mrow" id="MathJax-Span-6632"><span class="msubsup" id="MathJax-Span-6633"><span style="display: inline-block; position: relative; width: 0.872em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.44em, 4.346em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-6634" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.437em;"><span class="mn" id="MathJax-Span-6635" style="font-size: 70.7%; font-family: MathJax_Main;">0</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.105em, 1000.62em, 4.346em, -999.997em); top: -3.223em; left: 50%; margin-left: -0.307em;"><span class="mtd" id="MathJax-Span-6636"><span class="mrow" id="MathJax-Span-6637"><span class="texatom" id="MathJax-Span-6638"><span class="mrow" id="MathJax-Span-6639"><span class="munderover" id="MathJax-Span-6640"><span style="display: inline-block; position: relative; width: 0.623em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.62em, 4.346em, -999.997em); top: -3.967em; left: 0em;"><span class="texatom" id="MathJax-Span-6641"><span class="mrow" id="MathJax-Span-6642"><span class="mtext" id="MathJax-Span-6643" style="font-family: MathJax_Main-bold;">q</span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.477em, 1000.44em, 3.973em, -999.997em); top: -4.339em; left: 0.065em;"><span class="mo" id="MathJax-Span-6644" style="font-family: MathJax_Main;">~</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="mo" id="MathJax-Span-6645" style="vertical-align: 0em;"><span style="font-family: MathJax_Size3;">]</span></span></span><span class="mo" id="MathJax-Span-6646" style="font-family: MathJax_Main; padding-left: 0.251em;">=</span><span class="mrow" id="MathJax-Span-6647" style="padding-left: 0.251em;"><span class="mo" id="MathJax-Span-6648" style="vertical-align: 2.857em;"><span style="display: inline-block; position: relative; width: 0.685em; height: 0px;"><span style="position: absolute; font-family: MathJax_Size4; top: -2.788em; left: 0em;">⎡<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; font-family: MathJax_Size4; top: 0.561em; left: 0em;">⎣<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -1.61em; left: 0em;">⎢<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -1.051em; left: 0em;">⎢<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -0.493em; left: 0em;">⎢<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="mtable" id="MathJax-Span-6649" style="padding-right: 0.189em; padding-left: 0.189em;"><span style="display: inline-block; position: relative; width: 0.872em; height: 0px;"><span style="position: absolute; clip: rect(3.167em, 1000.87em, 8.378em, -999.997em); top: -5.828em; left: 0em;"><span style="display: inline-block; position: relative; width: 0.872em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.87em, 4.346em, -999.997em); top: -6.014em; left: 50%; margin-left: -0.431em;"><span class="mtd" id="MathJax-Span-6650"><span class="mrow" id="MathJax-Span-6651"><span class="msubsup" id="MathJax-Span-6652"><span style="display: inline-block; position: relative; width: 0.872em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.44em, 4.346em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-6653" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.437em;"><span class="mn" id="MathJax-Span-6654" style="font-size: 70.7%; font-family: MathJax_Main;">0</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.353em, 1000.87em, 4.346em, -999.997em); top: -4.587em; left: 50%; margin-left: -0.431em;"><span class="mtd" id="MathJax-Span-6655"><span class="mrow" id="MathJax-Span-6656"><span class="msubsup" id="MathJax-Span-6657"><span style="display: inline-block; position: relative; width: 0.872em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.44em, 4.346em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-6658" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.437em;"><span class="mn" id="MathJax-Span-6659" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.353em, 1000.87em, 4.346em, -999.997em); top: -3.223em; left: 50%; margin-left: -0.431em;"><span class="mtd" id="MathJax-Span-6660"><span class="mrow" id="MathJax-Span-6661"><span class="msubsup" id="MathJax-Span-6662"><span style="display: inline-block; position: relative; width: 0.872em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.44em, 4.346em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-6663" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.437em;"><span class="mn" id="MathJax-Span-6664" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.353em, 1000.87em, 4.346em, -999.997em); top: -1.796em; left: 50%; margin-left: -0.431em;"><span class="mtd" id="MathJax-Span-6665"><span class="mrow" id="MathJax-Span-6666"><span class="msubsup" id="MathJax-Span-6667"><span style="display: inline-block; position: relative; width: 0.872em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.44em, 4.346em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-6668" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.437em;"><span class="mn" id="MathJax-Span-6669" style="font-size: 70.7%; font-family: MathJax_Main;">3</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span><span style="display: inline-block; width: 0px; height: 5.834em;"></span></span></span></span><span class="mo" id="MathJax-Span-6670" style="vertical-align: 2.857em;"><span style="display: inline-block; position: relative; width: 0.685em; height: 0px;"><span style="position: absolute; font-family: MathJax_Size4; top: -2.788em; left: 0em;">⎤<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; font-family: MathJax_Size4; top: 0.561em; left: 0em;">⎦<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -1.61em; left: 0em;">⎥<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -1.051em; left: 0em;">⎥<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -0.493em; left: 0em;">⎥<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 5.834em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -2.996em; border-left: 0px solid; width: 0px; height: 6.619em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>q</mi><mo>=</mo><mrow><mo>[</mo><mtable rowspacing="4pt" columnspacing="1em"><mtr><mtd><msub><mi>q</mi><mn>0</mn></msub></mtd></mtr><mtr><mtd><mrow class="MJX-TeXAtom-ORD"><mover><mrow class="MJX-TeXAtom-ORD"><mtext mathvariant="bold">q</mtext></mrow><mo stretchy="false">~</mo></mover></mrow></mtd></mtr></mtable><mo>]</mo></mrow><mo>=</mo><mrow><mo>[</mo><mtable rowspacing="4pt" columnspacing="1em"><mtr><mtd><msub><mi>q</mi><mn>0</mn></msub></mtd></mtr><mtr><mtd><msub><mi>q</mi><mn>1</mn></msub></mtd></mtr><mtr><mtd><msub><mi>q</mi><mn>2</mn></msub></mtd></mtr><mtr><mtd><msub><mi>q</mi><mn>3</mn></msub></mtd></mtr></mtable><mo>]</mo></mrow></math></span></span><script type="math/tex" id="MathJax-Element-199">q=\begin{bmatrix} q_0 \\ \tilde{\textbf{q}} \end{bmatrix} = \begin{bmatrix} q_0 \\ q_1 \\ q_2 \\ q_3\end{bmatrix}</script></p>
<p>However, note that some authors write the imaginary part first before the real part. For example,</p>
<p style="text-align: center;"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-200-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/msub&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mover&gt;&lt;mi&gt;&amp;#x0131;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;&amp;#x007E;&lt;/mo&gt;&lt;/mover&gt;&lt;/mrow&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mover&gt;&lt;mi&gt;&amp;#x0237;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;&amp;#x007E;&lt;/mo&gt;&lt;/mover&gt;&lt;/mrow&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msub&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mover&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;&amp;#x007E;&lt;/mo&gt;&lt;/mover&gt;&lt;/mrow&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mn&gt;3&lt;/mn&gt;&lt;/msub&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mrow&gt;&lt;mo&gt;[&lt;/mo&gt;&lt;mtable rowspacing=&quot;4pt&quot; columnspacing=&quot;1em&quot;&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mover&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mtext mathvariant=&quot;bold&quot;&gt;q&lt;/mtext&gt;&lt;/mrow&gt;&lt;mo stretchy=&quot;false&quot;&gt;&amp;#x007E;&lt;/mo&gt;&lt;/mover&gt;&lt;/mrow&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mn&gt;3&lt;/mn&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;/mtable&gt;&lt;mo&gt;]&lt;/mo&gt;&lt;/mrow&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-6671" style="width: 17.621em; display: inline-block;"><span style="display: inline-block; position: relative; width: 14.209em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(1.74em, 1013.96em, 4.47em, -999.997em); top: -3.347em; left: 0em;"><span class="mrow" id="MathJax-Span-6672"><span class="mi" id="MathJax-Span-6673" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-6674" style="font-family: MathJax_Main; padding-left: 0.251em;">=</span><span class="msubsup" id="MathJax-Span-6675" style="padding-left: 0.251em;"><span style="display: inline-block; position: relative; width: 0.872em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.44em, 4.346em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-6676" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.437em;"><span class="mn" id="MathJax-Span-6677" style="font-size: 70.7%; font-family: MathJax_Main;">0</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="texatom" id="MathJax-Span-6678"><span class="mrow" id="MathJax-Span-6679"><span class="munderover" id="MathJax-Span-6680"><span style="display: inline-block; position: relative; width: 0.561em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.31em, 4.159em, -999.997em); top: -3.967em; left: 0.065em;"><span class="mi" id="MathJax-Span-6681" style="font-family: MathJax_Main-italic;">ı<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.065em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.477em, 1000.44em, 3.973em, -999.997em); top: -4.339em; left: 0.065em;"><span class="mo" id="MathJax-Span-6682" style="font-family: MathJax_Main;">~</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span></span><span class="mo" id="MathJax-Span-6683" style="font-family: MathJax_Main; padding-left: 0.251em;">+</span><span class="msubsup" id="MathJax-Span-6684" style="padding-left: 0.251em;"><span style="display: inline-block; position: relative; width: 0.872em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.44em, 4.346em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-6685" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.437em;"><span class="mn" id="MathJax-Span-6686" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="texatom" id="MathJax-Span-6687"><span class="mrow" id="MathJax-Span-6688"><span class="munderover" id="MathJax-Span-6689"><span style="display: inline-block; position: relative; width: 0.499em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.31em, 4.346em, -999.997em); top: -3.967em; left: 0.065em;"><span class="mi" id="MathJax-Span-6690" style="font-family: MathJax_Main-italic;">ȷ</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.477em, 1000.44em, 3.973em, -999.997em); top: -4.339em; left: 0em;"><span class="mo" id="MathJax-Span-6691" style="font-family: MathJax_Main;">~</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span></span><span class="mo" id="MathJax-Span-6692" style="font-family: MathJax_Main; padding-left: 0.251em;">+</span><span class="msubsup" id="MathJax-Span-6693" style="padding-left: 0.251em;"><span style="display: inline-block; position: relative; width: 0.872em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.44em, 4.346em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-6694" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.437em;"><span class="mn" id="MathJax-Span-6695" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="texatom" id="MathJax-Span-6696"><span class="mrow" id="MathJax-Span-6697"><span class="munderover" id="MathJax-Span-6698"><span style="display: inline-block; position: relative; width: 0.499em; height: 0px;"><span style="position: absolute; clip: rect(3.105em, 1000.5em, 4.159em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-6699" style="font-family: MathJax_Math-italic;">k</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.477em, 1000.44em, 3.973em, -999.997em); top: -4.587em; left: 0.003em;"><span class="mo" id="MathJax-Span-6700" style="font-family: MathJax_Main;">~</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span></span><span class="mo" id="MathJax-Span-6701" style="font-family: MathJax_Main; padding-left: 0.251em;">+</span><span class="msubsup" id="MathJax-Span-6702" style="padding-left: 0.251em;"><span style="display: inline-block; position: relative; width: 0.872em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.44em, 4.346em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-6703" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.437em;"><span class="mn" id="MathJax-Span-6704" style="font-size: 70.7%; font-family: MathJax_Main;">3</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="mo" id="MathJax-Span-6705" style="font-family: MathJax_Main; padding-left: 0.251em;">=</span><span class="mrow" id="MathJax-Span-6706" style="padding-left: 0.251em;"><span class="mo" id="MathJax-Span-6707" style="vertical-align: 0em;"><span style="font-family: MathJax_Size3;">[</span></span><span class="mtable" id="MathJax-Span-6708" style="padding-right: 0.189em; padding-left: 0.189em;"><span style="display: inline-block; position: relative; width: 0.872em; height: 0px;"><span style="position: absolute; clip: rect(2.422em, 1000.87em, 5.09em, -999.997em); top: -3.967em; left: 0em;"><span style="display: inline-block; position: relative; width: 0.872em; height: 0px;"><span style="position: absolute; clip: rect(3.105em, 1000.62em, 4.346em, -999.997em); top: -4.587em; left: 50%; margin-left: -0.307em;"><span class="mtd" id="MathJax-Span-6709"><span class="mrow" id="MathJax-Span-6710"><span class="texatom" id="MathJax-Span-6711"><span class="mrow" id="MathJax-Span-6712"><span class="munderover" id="MathJax-Span-6713"><span style="display: inline-block; position: relative; width: 0.623em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.62em, 4.346em, -999.997em); top: -3.967em; left: 0em;"><span class="texatom" id="MathJax-Span-6714"><span class="mrow" id="MathJax-Span-6715"><span class="mtext" id="MathJax-Span-6716" style="font-family: MathJax_Main-bold;">q</span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.477em, 1000.44em, 3.973em, -999.997em); top: -4.339em; left: 0.065em;"><span class="mo" id="MathJax-Span-6717" style="font-family: MathJax_Main;">~</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.353em, 1000.87em, 4.346em, -999.997em); top: -3.223em; left: 50%; margin-left: -0.431em;"><span class="mtd" id="MathJax-Span-6718"><span class="mrow" id="MathJax-Span-6719"><span class="msubsup" id="MathJax-Span-6720"><span style="display: inline-block; position: relative; width: 0.872em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.44em, 4.346em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-6721" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.437em;"><span class="mn" id="MathJax-Span-6722" style="font-size: 70.7%; font-family: MathJax_Main;">3</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="mo" id="MathJax-Span-6723" style="vertical-align: 0em;"><span style="font-family: MathJax_Size3;">]</span></span></span></span><span style="display: inline-block; width: 0px; height: 3.353em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -1.227em; border-left: 0px solid; width: 0px; height: 3.158em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>q</mi><mo>=</mo><msub><mi>q</mi><mn>0</mn></msub><mrow class="MJX-TeXAtom-ORD"><mover><mi>ı</mi><mo stretchy="false">~</mo></mover></mrow><mo>+</mo><msub><mi>q</mi><mn>1</mn></msub><mrow class="MJX-TeXAtom-ORD"><mover><mi>ȷ</mi><mo stretchy="false">~</mo></mover></mrow><mo>+</mo><msub><mi>q</mi><mn>2</mn></msub><mrow class="MJX-TeXAtom-ORD"><mover><mi>k</mi><mo stretchy="false">~</mo></mover></mrow><mo>+</mo><msub><mi>q</mi><mn>3</mn></msub><mo>=</mo><mrow><mo>[</mo><mtable rowspacing="4pt" columnspacing="1em"><mtr><mtd><mrow class="MJX-TeXAtom-ORD"><mover><mrow class="MJX-TeXAtom-ORD"><mtext mathvariant="bold">q</mtext></mrow><mo stretchy="false">~</mo></mover></mrow></mtd></mtr><mtr><mtd><msub><mi>q</mi><mn>3</mn></msub></mtd></mtr></mtable><mo>]</mo></mrow></math></span></span><script type="math/tex" id="MathJax-Element-200">q=q_0\tilde{\imath}+q_1\tilde{\jmath}+q_2\tilde{k}+q_3 = \begin{bmatrix} \tilde{\textbf{q}} \\ q_3 \end{bmatrix}</script></p>
<p>You can usually tell which ordering they use by checking which of the variables are bolded (or italicized). The marked variable is usually the imaginary component and the unmarked one (usually with a number subscript) is the real part. For this tutorial, we will be using the first definition where the real part comes first.</p>
<p>The conjugate of a quaternion, <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-201-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/msub&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mover&gt;&lt;mi&gt;&amp;#x0131;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;&amp;#x007E;&lt;/mo&gt;&lt;/mover&gt;&lt;/mrow&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msub&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mover&gt;&lt;mi&gt;&amp;#x0237;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;&amp;#x007E;&lt;/mo&gt;&lt;/mover&gt;&lt;/mrow&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mn&gt;3&lt;/mn&gt;&lt;/msub&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mover&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;&amp;#x007E;&lt;/mo&gt;&lt;/mover&gt;&lt;/mrow&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-6724" style="width: 13.154em; display: inline-block;"><span style="display: inline-block; position: relative; width: 10.611em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(1.244em, 1010.61em, 2.733em, -999.997em); top: -2.354em; left: 0em;"><span class="mrow" id="MathJax-Span-6725"><span class="mi" id="MathJax-Span-6726" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-6727" style="font-family: MathJax_Main; padding-left: 0.251em;">=</span><span class="msubsup" id="MathJax-Span-6728" style="padding-left: 0.251em;"><span style="display: inline-block; position: relative; width: 0.872em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.44em, 4.346em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-6729" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.437em;"><span class="mn" id="MathJax-Span-6730" style="font-size: 70.7%; font-family: MathJax_Main;">0</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="mo" id="MathJax-Span-6731" style="font-family: MathJax_Main; padding-left: 0.251em;">+</span><span class="msubsup" id="MathJax-Span-6732" style="padding-left: 0.251em;"><span style="display: inline-block; position: relative; width: 0.872em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.44em, 4.346em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-6733" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.437em;"><span class="mn" id="MathJax-Span-6734" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="texatom" id="MathJax-Span-6735"><span class="mrow" id="MathJax-Span-6736"><span class="munderover" id="MathJax-Span-6737"><span style="display: inline-block; position: relative; width: 0.561em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.31em, 4.159em, -999.997em); top: -3.967em; left: 0.065em;"><span class="mi" id="MathJax-Span-6738" style="font-family: MathJax_Main-italic;">ı<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.065em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.477em, 1000.44em, 3.973em, -999.997em); top: -4.339em; left: 0.065em;"><span class="mo" id="MathJax-Span-6739" style="font-family: MathJax_Main;">~</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span></span><span class="mo" id="MathJax-Span-6740" style="font-family: MathJax_Main; padding-left: 0.251em;">+</span><span class="msubsup" id="MathJax-Span-6741" style="padding-left: 0.251em;"><span style="display: inline-block; position: relative; width: 0.872em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.44em, 4.346em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-6742" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.437em;"><span class="mn" id="MathJax-Span-6743" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="texatom" id="MathJax-Span-6744"><span class="mrow" id="MathJax-Span-6745"><span class="munderover" id="MathJax-Span-6746"><span style="display: inline-block; position: relative; width: 0.499em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.31em, 4.346em, -999.997em); top: -3.967em; left: 0.065em;"><span class="mi" id="MathJax-Span-6747" style="font-family: MathJax_Main-italic;">ȷ</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.477em, 1000.44em, 3.973em, -999.997em); top: -4.339em; left: 0em;"><span class="mo" id="MathJax-Span-6748" style="font-family: MathJax_Main;">~</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span></span><span class="mo" id="MathJax-Span-6749" style="font-family: MathJax_Main; padding-left: 0.251em;">+</span><span class="msubsup" id="MathJax-Span-6750" style="padding-left: 0.251em;"><span style="display: inline-block; position: relative; width: 0.872em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.44em, 4.346em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-6751" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.437em;"><span class="mn" id="MathJax-Span-6752" style="font-size: 70.7%; font-family: MathJax_Main;">3</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="texatom" id="MathJax-Span-6753"><span class="mrow" id="MathJax-Span-6754"><span class="munderover" id="MathJax-Span-6755"><span style="display: inline-block; position: relative; width: 0.499em; height: 0px;"><span style="position: absolute; clip: rect(3.105em, 1000.5em, 4.159em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-6756" style="font-family: MathJax_Math-italic;">k</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.477em, 1000.44em, 3.973em, -999.997em); top: -4.587em; left: 0.003em;"><span class="mo" id="MathJax-Span-6757" style="font-family: MathJax_Main;">~</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.36em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.304em; border-left: 0px solid; width: 0px; height: 1.619em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>q</mi><mo>=</mo><msub><mi>q</mi><mn>0</mn></msub><mo>+</mo><msub><mi>q</mi><mn>1</mn></msub><mrow class="MJX-TeXAtom-ORD"><mover><mi>ı</mi><mo stretchy="false">~</mo></mover></mrow><mo>+</mo><msub><mi>q</mi><mn>2</mn></msub><mrow class="MJX-TeXAtom-ORD"><mover><mi>ȷ</mi><mo stretchy="false">~</mo></mover></mrow><mo>+</mo><msub><mi>q</mi><mn>3</mn></msub><mrow class="MJX-TeXAtom-ORD"><mover><mi>k</mi><mo stretchy="false">~</mo></mover></mrow></math></span></span><script type="math/tex" id="MathJax-Element-201">q=q_0+q_1\tilde{\imath}+q_2\tilde{\jmath}+q_3\tilde{k}</script>, is defined as follows.</p>
<p style="text-align: center;"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-202-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msup&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mo&gt;&amp;#x2217;&lt;/mo&gt;&lt;/msup&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/msub&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mover&gt;&lt;mi&gt;&amp;#x0131;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;&amp;#x007E;&lt;/mo&gt;&lt;/mover&gt;&lt;/mrow&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msub&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mover&gt;&lt;mi&gt;&amp;#x0237;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;&amp;#x007E;&lt;/mo&gt;&lt;/mover&gt;&lt;/mrow&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mn&gt;3&lt;/mn&gt;&lt;/msub&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mover&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;&amp;#x007E;&lt;/mo&gt;&lt;/mover&gt;&lt;/mrow&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-6758" style="width: 13.775em; display: inline-block;"><span style="display: inline-block; position: relative; width: 11.107em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(1.244em, 1011.11em, 2.733em, -999.997em); top: -2.354em; left: 0em;"><span class="mrow" id="MathJax-Span-6759"><span class="msubsup" id="MathJax-Span-6760"><span style="display: inline-block; position: relative; width: 0.934em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.44em, 4.346em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-6761" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -4.339em; left: 0.499em;"><span class="mo" id="MathJax-Span-6762" style="font-size: 70.7%; font-family: MathJax_Main;">∗</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="mo" id="MathJax-Span-6763" style="font-family: MathJax_Main; padding-left: 0.251em;">=</span><span class="msubsup" id="MathJax-Span-6764" style="padding-left: 0.251em;"><span style="display: inline-block; position: relative; width: 0.872em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.44em, 4.346em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-6765" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.437em;"><span class="mn" id="MathJax-Span-6766" style="font-size: 70.7%; font-family: MathJax_Main;">0</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="mo" id="MathJax-Span-6767" style="font-family: MathJax_Main; padding-left: 0.251em;">−</span><span class="msubsup" id="MathJax-Span-6768" style="padding-left: 0.251em;"><span style="display: inline-block; position: relative; width: 0.872em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.44em, 4.346em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-6769" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.437em;"><span class="mn" id="MathJax-Span-6770" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="texatom" id="MathJax-Span-6771"><span class="mrow" id="MathJax-Span-6772"><span class="munderover" id="MathJax-Span-6773"><span style="display: inline-block; position: relative; width: 0.561em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.31em, 4.159em, -999.997em); top: -3.967em; left: 0.065em;"><span class="mi" id="MathJax-Span-6774" style="font-family: MathJax_Main-italic;">ı<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.065em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.477em, 1000.44em, 3.973em, -999.997em); top: -4.339em; left: 0.065em;"><span class="mo" id="MathJax-Span-6775" style="font-family: MathJax_Main;">~</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span></span><span class="mo" id="MathJax-Span-6776" style="font-family: MathJax_Main; padding-left: 0.251em;">−</span><span class="msubsup" id="MathJax-Span-6777" style="padding-left: 0.251em;"><span style="display: inline-block; position: relative; width: 0.872em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.44em, 4.346em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-6778" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.437em;"><span class="mn" id="MathJax-Span-6779" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="texatom" id="MathJax-Span-6780"><span class="mrow" id="MathJax-Span-6781"><span class="munderover" id="MathJax-Span-6782"><span style="display: inline-block; position: relative; width: 0.499em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.31em, 4.346em, -999.997em); top: -3.967em; left: 0.065em;"><span class="mi" id="MathJax-Span-6783" style="font-family: MathJax_Main-italic;">ȷ</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.477em, 1000.44em, 3.973em, -999.997em); top: -4.339em; left: 0em;"><span class="mo" id="MathJax-Span-6784" style="font-family: MathJax_Main;">~</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span></span><span class="mo" id="MathJax-Span-6785" style="font-family: MathJax_Main; padding-left: 0.251em;">−</span><span class="msubsup" id="MathJax-Span-6786" style="padding-left: 0.251em;"><span style="display: inline-block; position: relative; width: 0.872em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.44em, 4.346em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-6787" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.437em;"><span class="mn" id="MathJax-Span-6788" style="font-size: 70.7%; font-family: MathJax_Main;">3</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="texatom" id="MathJax-Span-6789"><span class="mrow" id="MathJax-Span-6790"><span class="munderover" id="MathJax-Span-6791"><span style="display: inline-block; position: relative; width: 0.499em; height: 0px;"><span style="position: absolute; clip: rect(3.105em, 1000.5em, 4.159em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-6792" style="font-family: MathJax_Math-italic;">k</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.477em, 1000.44em, 3.973em, -999.997em); top: -4.587em; left: 0.003em;"><span class="mo" id="MathJax-Span-6793" style="font-family: MathJax_Main;">~</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.36em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.304em; border-left: 0px solid; width: 0px; height: 1.619em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup><mi>q</mi><mo>∗</mo></msup><mo>=</mo><msub><mi>q</mi><mn>0</mn></msub><mo>−</mo><msub><mi>q</mi><mn>1</mn></msub><mrow class="MJX-TeXAtom-ORD"><mover><mi>ı</mi><mo stretchy="false">~</mo></mover></mrow><mo>−</mo><msub><mi>q</mi><mn>2</mn></msub><mrow class="MJX-TeXAtom-ORD"><mover><mi>ȷ</mi><mo stretchy="false">~</mo></mover></mrow><mo>−</mo><msub><mi>q</mi><mn>3</mn></msub><mrow class="MJX-TeXAtom-ORD"><mover><mi>k</mi><mo stretchy="false">~</mo></mover></mrow></math></span></span><script type="math/tex" id="MathJax-Element-202">q^*=q_0-q_1\tilde{\imath}-q_2\tilde{\jmath}-q_3\tilde{k}</script></p>
<p>Don’t worry about what it is used for yet because you’ll find out soon below.</p>
<p>Nerxt, the magnitude of a quaternion is defined in a similar fashion to vectors.</p>
<p style="text-align: center;"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-203-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;|&lt;/mo&gt;&lt;/mrow&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;|&lt;/mo&gt;&lt;/mrow&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;msubsup&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msubsup&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;msubsup&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msubsup&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;msubsup&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msubsup&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;msubsup&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mn&gt;3&lt;/mn&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msubsup&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-6794" style="width: 12.224em; display: inline-block;"><span style="display: inline-block; position: relative; width: 9.867em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(1.368em, 1009.87em, 2.857em, -999.997em); top: -2.354em; left: 0em;"><span class="mrow" id="MathJax-Span-6795"><span class="texatom" id="MathJax-Span-6796"><span class="mrow" id="MathJax-Span-6797"><span class="mo" id="MathJax-Span-6798" style="font-family: MathJax_Main;">|</span></span></span><span class="mi" id="MathJax-Span-6799" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="texatom" id="MathJax-Span-6800"><span class="mrow" id="MathJax-Span-6801"><span class="mo" id="MathJax-Span-6802" style="font-family: MathJax_Main;">|</span></span></span><span class="mo" id="MathJax-Span-6803" style="font-family: MathJax_Main; padding-left: 0.251em;">=</span><span class="msubsup" id="MathJax-Span-6804" style="padding-left: 0.251em;"><span style="display: inline-block; position: relative; width: 0.934em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.44em, 4.346em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-6805" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.291em, 1000.44em, 4.159em, -999.997em); top: -4.339em; left: 0.499em;"><span class="mn" id="MathJax-Span-6806" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.291em, 1000.44em, 4.159em, -999.997em); top: -3.657em; left: 0.437em;"><span class="mn" id="MathJax-Span-6807" style="font-size: 70.7%; font-family: MathJax_Main;">0</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="mo" id="MathJax-Span-6808" style="font-family: MathJax_Main; padding-left: 0.251em;">+</span><span class="msubsup" id="MathJax-Span-6809" style="padding-left: 0.251em;"><span style="display: inline-block; position: relative; width: 0.934em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.44em, 4.346em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-6810" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.291em, 1000.44em, 4.159em, -999.997em); top: -4.339em; left: 0.499em;"><span class="mn" id="MathJax-Span-6811" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.291em, 1000.44em, 4.159em, -999.997em); top: -3.657em; left: 0.437em;"><span class="mn" id="MathJax-Span-6812" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="mo" id="MathJax-Span-6813" style="font-family: MathJax_Main; padding-left: 0.251em;">+</span><span class="msubsup" id="MathJax-Span-6814" style="padding-left: 0.251em;"><span style="display: inline-block; position: relative; width: 0.934em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.44em, 4.346em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-6815" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.291em, 1000.44em, 4.159em, -999.997em); top: -4.339em; left: 0.499em;"><span class="mn" id="MathJax-Span-6816" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.291em, 1000.44em, 4.159em, -999.997em); top: -3.657em; left: 0.437em;"><span class="mn" id="MathJax-Span-6817" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="mo" id="MathJax-Span-6818" style="font-family: MathJax_Main; padding-left: 0.251em;">+</span><span class="msubsup" id="MathJax-Span-6819" style="padding-left: 0.251em;"><span style="display: inline-block; position: relative; width: 0.934em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.44em, 4.346em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-6820" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.291em, 1000.44em, 4.159em, -999.997em); top: -4.339em; left: 0.499em;"><span class="mn" id="MathJax-Span-6821" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.291em, 1000.44em, 4.159em, -999.997em); top: -3.657em; left: 0.437em;"><span class="mn" id="MathJax-Span-6822" style="font-size: 70.7%; font-family: MathJax_Main;">3</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.36em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.458em; border-left: 0px solid; width: 0px; height: 1.542em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><mi>q</mi><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><mo>=</mo><msubsup><mi>q</mi><mn>0</mn><mn>2</mn></msubsup><mo>+</mo><msubsup><mi>q</mi><mn>1</mn><mn>2</mn></msubsup><mo>+</mo><msubsup><mi>q</mi><mn>2</mn><mn>2</mn></msubsup><mo>+</mo><msubsup><mi>q</mi><mn>3</mn><mn>2</mn></msubsup></math></span></span><script type="math/tex" id="MathJax-Element-203">|q|=q_0^2+q_1^2+q_2^2+q_3^2</script></p>
<p>Therefore, a unit quaternion can then be defined in the following manner.</p>
<p style="text-align: center;"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-204-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mstyle mathsize=&quot;1.44em&quot;&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;U&lt;/mi&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mfrac&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;|&lt;/mo&gt;&lt;/mrow&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;|&lt;/mo&gt;&lt;/mrow&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mfrac&gt;&lt;msub&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/msub&gt;&lt;mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;|&lt;/mo&gt;&lt;/mrow&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;|&lt;/mo&gt;&lt;/mrow&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mfrac&gt;&lt;msub&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;|&lt;/mo&gt;&lt;/mrow&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;|&lt;/mo&gt;&lt;/mrow&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mover&gt;&lt;mi&gt;&amp;#x0131;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;&amp;#x007E;&lt;/mo&gt;&lt;/mover&gt;&lt;/mrow&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mfrac&gt;&lt;msub&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msub&gt;&lt;mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;|&lt;/mo&gt;&lt;/mrow&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;|&lt;/mo&gt;&lt;/mrow&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mover&gt;&lt;mi&gt;&amp;#x0237;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;&amp;#x007E;&lt;/mo&gt;&lt;/mover&gt;&lt;/mrow&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mfrac&gt;&lt;msub&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mn&gt;3&lt;/mn&gt;&lt;/msub&gt;&lt;mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;|&lt;/mo&gt;&lt;/mrow&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;|&lt;/mo&gt;&lt;/mrow&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mover&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;&amp;#x007E;&lt;/mo&gt;&lt;/mover&gt;&lt;/mrow&gt;&lt;/mrow&gt;&lt;/mstyle&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-6823" style="width: 25.996em; display: inline-block;"><span style="display: inline-block; position: relative; width: 20.971em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(1.182em, 1020.97em, 3.725em, -999.997em); top: -2.664em; left: 0em;"><span class="mrow" id="MathJax-Span-6824"><span class="mstyle" id="MathJax-Span-6825"><span class="mrow" id="MathJax-Span-6826"><span class="texatom" id="MathJax-Span-6827"><span class="mrow" id="MathJax-Span-6828"><span class="mi" id="MathJax-Span-6829" style="font-size: 144%; font-family: MathJax_Math-italic;">U<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.065em;"></span></span><span class="mi" id="MathJax-Span-6830" style="font-size: 144%; font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-6831" style="font-size: 144%; font-family: MathJax_Main; padding-left: 0.251em;">=</span><span class="mfrac" id="MathJax-Span-6832" style="padding-left: 0.375em;"><span style="display: inline-block; position: relative; width: 1.182em; height: 0px; margin-right: 0.189em; margin-left: 0.189em;"><span style="position: absolute; clip: rect(3.353em, 1000.5em, 4.346em, -999.997em); top: -4.712em; left: 50%; margin-left: -0.245em;"><span class="mi" id="MathJax-Span-6833" style="font-size: 101.8%; font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.043em, 1000.93em, 4.408em, -999.997em); top: -3.347em; left: 50%; margin-left: -0.493em;"><span class="mrow" id="MathJax-Span-6834"><span class="texatom" id="MathJax-Span-6835"><span class="mrow" id="MathJax-Span-6836"><span class="mo" id="MathJax-Span-6837" style="font-size: 101.8%; font-family: MathJax_Main;">|</span></span></span><span class="mi" id="MathJax-Span-6838" style="font-size: 101.8%; font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="texatom" id="MathJax-Span-6839"><span class="mrow" id="MathJax-Span-6840"><span class="mo" id="MathJax-Span-6841" style="font-size: 101.8%; font-family: MathJax_Main;">|</span></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(0.872em, 1001.18em, 1.306em, -999.997em); top: -1.424em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.4px solid; width: 1.182em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.12em;"></span></span></span></span><span class="mo" id="MathJax-Span-6842" style="font-size: 144%; font-family: MathJax_Main; padding-left: 0.251em;">=</span><span class="mfrac" id="MathJax-Span-6843" style="padding-left: 0.375em;"><span style="display: inline-block; position: relative; width: 1.182em; height: 0px; margin-right: 0.189em; margin-left: 0.189em;"><span style="position: absolute; clip: rect(3.353em, 1000.87em, 4.408em, -999.997em); top: -4.774em; left: 50%; margin-left: -0.431em;"><span class="msubsup" id="MathJax-Span-6844"><span style="display: inline-block; position: relative; width: 0.872em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.5em, 4.346em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-6845" style="font-size: 101.8%; font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.719em; left: 0.437em;"><span class="mn" id="MathJax-Span-6846" style="font-size: 72%; font-family: MathJax_Main;">0</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.043em, 1000.93em, 4.408em, -999.997em); top: -3.347em; left: 50%; margin-left: -0.493em;"><span class="mrow" id="MathJax-Span-6847"><span class="texatom" id="MathJax-Span-6848"><span class="mrow" id="MathJax-Span-6849"><span class="mo" id="MathJax-Span-6850" style="font-size: 101.8%; font-family: MathJax_Main;">|</span></span></span><span class="mi" id="MathJax-Span-6851" style="font-size: 101.8%; font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="texatom" id="MathJax-Span-6852"><span class="mrow" id="MathJax-Span-6853"><span class="mo" id="MathJax-Span-6854" style="font-size: 101.8%; font-family: MathJax_Main;">|</span></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(0.872em, 1001.18em, 1.306em, -999.997em); top: -1.424em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.4px solid; width: 1.182em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.12em;"></span></span></span></span><span class="mo" id="MathJax-Span-6855" style="font-size: 144%; font-family: MathJax_Main; padding-left: 0.251em;">+</span><span class="mfrac" id="MathJax-Span-6856" style="padding-left: 0.313em;"><span style="display: inline-block; position: relative; width: 1.182em; height: 0px; margin-right: 0.189em; margin-left: 0.189em;"><span style="position: absolute; clip: rect(3.353em, 1000.87em, 4.408em, -999.997em); top: -4.774em; left: 50%; margin-left: -0.431em;"><span class="msubsup" id="MathJax-Span-6857"><span style="display: inline-block; position: relative; width: 0.872em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.5em, 4.346em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-6858" style="font-size: 101.8%; font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.719em; left: 0.437em;"><span class="mn" id="MathJax-Span-6859" style="font-size: 72%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.043em, 1000.93em, 4.408em, -999.997em); top: -3.347em; left: 50%; margin-left: -0.493em;"><span class="mrow" id="MathJax-Span-6860"><span class="texatom" id="MathJax-Span-6861"><span class="mrow" id="MathJax-Span-6862"><span class="mo" id="MathJax-Span-6863" style="font-size: 101.8%; font-family: MathJax_Main;">|</span></span></span><span class="mi" id="MathJax-Span-6864" style="font-size: 101.8%; font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="texatom" id="MathJax-Span-6865"><span class="mrow" id="MathJax-Span-6866"><span class="mo" id="MathJax-Span-6867" style="font-size: 101.8%; font-family: MathJax_Main;">|</span></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(0.872em, 1001.18em, 1.306em, -999.997em); top: -1.424em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.4px solid; width: 1.182em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.12em;"></span></span></span></span><span class="texatom" id="MathJax-Span-6868"><span class="mrow" id="MathJax-Span-6869"><span class="munderover" id="MathJax-Span-6870"><span style="display: inline-block; position: relative; width: 0.81em; height: 0px;"><span style="position: absolute; clip: rect(3.167em, 1000.5em, 4.159em, -999.997em); top: -3.967em; left: 0.127em;"><span class="mi" id="MathJax-Span-6871" style="font-size: 144%; font-family: MathJax_Main-italic;">ı<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.065em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.353em, 1000.62em, 3.849em, -999.997em); top: -4.463em; left: 0.065em;"><span class="mo" id="MathJax-Span-6872" style="font-size: 144%; font-family: MathJax_Main;">~</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span></span><span class="mo" id="MathJax-Span-6873" style="font-size: 144%; font-family: MathJax_Main; padding-left: 0.251em;">+</span><span class="mfrac" id="MathJax-Span-6874" style="padding-left: 0.313em;"><span style="display: inline-block; position: relative; width: 1.182em; height: 0px; margin-right: 0.189em; margin-left: 0.189em;"><span style="position: absolute; clip: rect(3.353em, 1000.87em, 4.408em, -999.997em); top: -4.774em; left: 50%; margin-left: -0.431em;"><span class="msubsup" id="MathJax-Span-6875"><span style="display: inline-block; position: relative; width: 0.872em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.5em, 4.346em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-6876" style="font-size: 101.8%; font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.719em; left: 0.437em;"><span class="mn" id="MathJax-Span-6877" style="font-size: 72%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.043em, 1000.93em, 4.408em, -999.997em); top: -3.347em; left: 50%; margin-left: -0.493em;"><span class="mrow" id="MathJax-Span-6878"><span class="texatom" id="MathJax-Span-6879"><span class="mrow" id="MathJax-Span-6880"><span class="mo" id="MathJax-Span-6881" style="font-size: 101.8%; font-family: MathJax_Main;">|</span></span></span><span class="mi" id="MathJax-Span-6882" style="font-size: 101.8%; font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="texatom" id="MathJax-Span-6883"><span class="mrow" id="MathJax-Span-6884"><span class="mo" id="MathJax-Span-6885" style="font-size: 101.8%; font-family: MathJax_Main;">|</span></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(0.872em, 1001.18em, 1.306em, -999.997em); top: -1.424em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.4px solid; width: 1.182em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.12em;"></span></span></span></span><span class="texatom" id="MathJax-Span-6886"><span class="mrow" id="MathJax-Span-6887"><span class="munderover" id="MathJax-Span-6888"><span style="display: inline-block; position: relative; width: 0.748em; height: 0px;"><span style="position: absolute; clip: rect(3.167em, 1000.5em, 4.47em, -999.997em); top: -3.967em; left: 0.127em;"><span class="mi" id="MathJax-Span-6889" style="font-size: 144%; font-family: MathJax_Main-italic;">ȷ</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.353em, 1000.62em, 3.849em, -999.997em); top: -4.463em; left: 0em;"><span class="mo" id="MathJax-Span-6890" style="font-size: 144%; font-family: MathJax_Main;">~</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span></span><span class="mo" id="MathJax-Span-6891" style="font-size: 144%; font-family: MathJax_Main; padding-left: 0.251em;">+</span><span class="mfrac" id="MathJax-Span-6892" style="padding-left: 0.313em;"><span style="display: inline-block; position: relative; width: 1.182em; height: 0px; margin-right: 0.189em; margin-left: 0.189em;"><span style="position: absolute; clip: rect(3.353em, 1000.87em, 4.408em, -999.997em); top: -4.774em; left: 50%; margin-left: -0.431em;"><span class="msubsup" id="MathJax-Span-6893"><span style="display: inline-block; position: relative; width: 0.872em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.5em, 4.346em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-6894" style="font-size: 101.8%; font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.719em; left: 0.437em;"><span class="mn" id="MathJax-Span-6895" style="font-size: 72%; font-family: MathJax_Main;">3</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.043em, 1000.93em, 4.408em, -999.997em); top: -3.347em; left: 50%; margin-left: -0.493em;"><span class="mrow" id="MathJax-Span-6896"><span class="texatom" id="MathJax-Span-6897"><span class="mrow" id="MathJax-Span-6898"><span class="mo" id="MathJax-Span-6899" style="font-size: 101.8%; font-family: MathJax_Main;">|</span></span></span><span class="mi" id="MathJax-Span-6900" style="font-size: 101.8%; font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="texatom" id="MathJax-Span-6901"><span class="mrow" id="MathJax-Span-6902"><span class="mo" id="MathJax-Span-6903" style="font-size: 101.8%; font-family: MathJax_Main;">|</span></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(0.872em, 1001.18em, 1.306em, -999.997em); top: -1.424em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.4px solid; width: 1.182em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.12em;"></span></span></span></span><span class="texatom" id="MathJax-Span-6904"><span class="mrow" id="MathJax-Span-6905"><span class="munderover" id="MathJax-Span-6906"><span style="display: inline-block; position: relative; width: 0.748em; height: 0px;"><span style="position: absolute; clip: rect(2.795em, 1000.75em, 4.159em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-6907" style="font-size: 144%; font-family: MathJax_Math-italic;">k</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.353em, 1000.62em, 3.849em, -999.997em); top: -4.836em; left: 0.003em;"><span class="mo" id="MathJax-Span-6908" style="font-size: 144%; font-family: MathJax_Main;">~</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.671em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -1.15em; border-left: 0px solid; width: 0px; height: 2.85em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mstyle mathsize="1.44em"><mrow class="MJX-TeXAtom-ORD"><mi>U</mi><mi>q</mi><mo>=</mo><mfrac><mi>q</mi><mrow><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><mi>q</mi><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow></mrow></mfrac><mo>=</mo><mfrac><msub><mi>q</mi><mn>0</mn></msub><mrow><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><mi>q</mi><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow></mrow></mfrac><mo>+</mo><mfrac><msub><mi>q</mi><mn>1</mn></msub><mrow><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><mi>q</mi><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow></mrow></mfrac><mrow class="MJX-TeXAtom-ORD"><mover><mi>ı</mi><mo stretchy="false">~</mo></mover></mrow><mo>+</mo><mfrac><msub><mi>q</mi><mn>2</mn></msub><mrow><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><mi>q</mi><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow></mrow></mfrac><mrow class="MJX-TeXAtom-ORD"><mover><mi>ȷ</mi><mo stretchy="false">~</mo></mover></mrow><mo>+</mo><mfrac><msub><mi>q</mi><mn>3</mn></msub><mrow><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><mi>q</mi><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow></mrow></mfrac><mrow class="MJX-TeXAtom-ORD"><mover><mi>k</mi><mo stretchy="false">~</mo></mover></mrow></mrow></mstyle></math></span></span><script type="math/tex" id="MathJax-Element-204">\Large{Uq=\frac{q}{|q|}=\frac{q_0}{|q|}+\frac{q_1}{|q|}\tilde{\imath}+\frac{q_2}{|q|}\tilde{\jmath}+\frac{q_3}{|q|}\tilde{k}}</script></p>
<p>where <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-205-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;U&lt;/mi&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-6909" style="width: 1.492em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.182em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(1.492em, 1001.18em, 2.733em, -999.997em); top: -2.354em; left: 0em;"><span class="mrow" id="MathJax-Span-6910"><span class="mi" id="MathJax-Span-6911" style="font-family: MathJax_Math-italic;">U<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.065em;"></span></span><span class="mi" id="MathJax-Span-6912" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.36em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.304em; border-left: 0px solid; width: 0px; height: 1.235em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>U</mi><mi>q</mi></math></span></span><script type="math/tex" id="MathJax-Element-205">Uq</script> refers to a unit quaternion.</p>
<p>Moving on, below is the definition for quaternion addition and subtraction (simply replace the “+” with “-“)</p>
<p style="text-align: center;"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-206-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mrow&gt;&lt;mo&gt;[&lt;/mo&gt;&lt;mtable rowspacing=&quot;4pt&quot; columnspacing=&quot;1em&quot;&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/msub&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msub&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mn&gt;3&lt;/mn&gt;&lt;/msub&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mn&gt;3&lt;/mn&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;/mtable&gt;&lt;mo&gt;]&lt;/mo&gt;&lt;/mrow&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-6913" style="width: 10.425em; display: inline-block;"><span style="display: inline-block; position: relative; width: 8.378em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(2.174em, 1008.07em, 7.757em, -999.997em); top: -5.208em; left: 0em;"><span class="mrow" id="MathJax-Span-6914"><span class="mi" id="MathJax-Span-6915" style="font-family: MathJax_Math-italic;">p</span><span class="mo" id="MathJax-Span-6916" style="font-family: MathJax_Main; padding-left: 0.251em;">+</span><span class="mi" id="MathJax-Span-6917" style="font-family: MathJax_Math-italic; padding-left: 0.251em;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-6918" style="font-family: MathJax_Main; padding-left: 0.251em;">=</span><span class="mrow" id="MathJax-Span-6919" style="padding-left: 0.251em;"><span class="mo" id="MathJax-Span-6920" style="vertical-align: 2.857em;"><span style="display: inline-block; position: relative; width: 0.685em; height: 0px;"><span style="position: absolute; font-family: MathJax_Size4; top: -2.788em; left: 0em;">⎡<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; font-family: MathJax_Size4; top: 0.561em; left: 0em;">⎣<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -1.61em; left: 0em;">⎢<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -1.051em; left: 0em;">⎢<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -0.493em; left: 0em;">⎢<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="mtable" id="MathJax-Span-6921" style="padding-right: 0.189em; padding-left: 0.189em;"><span style="display: inline-block; position: relative; width: 3.105em; height: 0px;"><span style="position: absolute; clip: rect(3.167em, 1003.11em, 8.502em, -999.997em); top: -5.952em; left: 0em;"><span style="display: inline-block; position: relative; width: 3.105em; height: 0px;"><span style="position: absolute; clip: rect(3.229em, 1003.11em, 4.346em, -999.997em); top: -6.014em; left: 50%; margin-left: -1.548em;"><span class="mtd" id="MathJax-Span-6922"><span class="mrow" id="MathJax-Span-6923"><span class="msubsup" id="MathJax-Span-6924"><span style="display: inline-block; position: relative; width: 0.934em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.5em, 4.346em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-6925" style="font-family: MathJax_Math-italic;">p</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.499em;"><span class="mn" id="MathJax-Span-6926" style="font-size: 70.7%; font-family: MathJax_Main;">0</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="mo" id="MathJax-Span-6927" style="font-family: MathJax_Main; padding-left: 0.251em;">+</span><span class="msubsup" id="MathJax-Span-6928" style="padding-left: 0.251em;"><span style="display: inline-block; position: relative; width: 0.872em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.44em, 4.346em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-6929" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.437em;"><span class="mn" id="MathJax-Span-6930" style="font-size: 70.7%; font-family: MathJax_Main;">0</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.229em, 1003.11em, 4.346em, -999.997em); top: -4.587em; left: 50%; margin-left: -1.548em;"><span class="mtd" id="MathJax-Span-6931"><span class="mrow" id="MathJax-Span-6932"><span class="msubsup" id="MathJax-Span-6933"><span style="display: inline-block; position: relative; width: 0.934em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.5em, 4.346em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-6934" style="font-family: MathJax_Math-italic;">p</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.499em;"><span class="mn" id="MathJax-Span-6935" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="mo" id="MathJax-Span-6936" style="font-family: MathJax_Main; padding-left: 0.251em;">+</span><span class="msubsup" id="MathJax-Span-6937" style="padding-left: 0.251em;"><span style="display: inline-block; position: relative; width: 0.872em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.44em, 4.346em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-6938" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.437em;"><span class="mn" id="MathJax-Span-6939" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.229em, 1003.11em, 4.346em, -999.997em); top: -3.223em; left: 50%; margin-left: -1.548em;"><span class="mtd" id="MathJax-Span-6940"><span class="mrow" id="MathJax-Span-6941"><span class="msubsup" id="MathJax-Span-6942"><span style="display: inline-block; position: relative; width: 0.934em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.5em, 4.346em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-6943" style="font-family: MathJax_Math-italic;">p</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.499em;"><span class="mn" id="MathJax-Span-6944" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="mo" id="MathJax-Span-6945" style="font-family: MathJax_Main; padding-left: 0.251em;">+</span><span class="msubsup" id="MathJax-Span-6946" style="padding-left: 0.251em;"><span style="display: inline-block; position: relative; width: 0.872em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.44em, 4.346em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-6947" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.437em;"><span class="mn" id="MathJax-Span-6948" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.229em, 1003.11em, 4.346em, -999.997em); top: -1.796em; left: 50%; margin-left: -1.548em;"><span class="mtd" id="MathJax-Span-6949"><span class="mrow" id="MathJax-Span-6950"><span class="msubsup" id="MathJax-Span-6951"><span style="display: inline-block; position: relative; width: 0.934em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.5em, 4.346em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-6952" style="font-family: MathJax_Math-italic;">p</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.499em;"><span class="mn" id="MathJax-Span-6953" style="font-size: 70.7%; font-family: MathJax_Main;">3</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="mo" id="MathJax-Span-6954" style="font-family: MathJax_Main; padding-left: 0.251em;">+</span><span class="msubsup" id="MathJax-Span-6955" style="padding-left: 0.251em;"><span style="display: inline-block; position: relative; width: 0.872em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.44em, 4.346em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-6956" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.437em;"><span class="mn" id="MathJax-Span-6957" style="font-size: 70.7%; font-family: MathJax_Main;">3</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span><span style="display: inline-block; width: 0px; height: 5.958em;"></span></span></span></span><span class="mo" id="MathJax-Span-6958" style="vertical-align: 2.857em;"><span style="display: inline-block; position: relative; width: 0.685em; height: 0px;"><span style="position: absolute; font-family: MathJax_Size4; top: -2.788em; left: 0em;">⎤<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; font-family: MathJax_Size4; top: 0.561em; left: 0em;">⎦<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -1.61em; left: 0em;">⎥<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -1.051em; left: 0em;">⎥<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -0.493em; left: 0em;">⎥<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 5.214em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -2.996em; border-left: 0px solid; width: 0px; height: 6.619em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>p</mi><mo>+</mo><mi>q</mi><mo>=</mo><mrow><mo>[</mo><mtable rowspacing="4pt" columnspacing="1em"><mtr><mtd><msub><mi>p</mi><mn>0</mn></msub><mo>+</mo><msub><mi>q</mi><mn>0</mn></msub></mtd></mtr><mtr><mtd><msub><mi>p</mi><mn>1</mn></msub><mo>+</mo><msub><mi>q</mi><mn>1</mn></msub></mtd></mtr><mtr><mtd><msub><mi>p</mi><mn>2</mn></msub><mo>+</mo><msub><mi>q</mi><mn>2</mn></msub></mtd></mtr><mtr><mtd><msub><mi>p</mi><mn>3</mn></msub><mo>+</mo><msub><mi>q</mi><mn>3</mn></msub></mtd></mtr></mtable><mo>]</mo></mrow></math></span></span><script type="math/tex" id="MathJax-Element-206">p+q=\begin{bmatrix} p_0+q_0 \\ p_1+q_1 \\ p_2+q_2 \\ p_3+q_3\end{bmatrix}</script></p>
<p>Next comes the definitions of the imaginary part</p>
<p style="text-align: center;"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-207-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mover&gt;&lt;mi&gt;&amp;#x0131;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;&amp;#x007E;&lt;/mo&gt;&lt;/mover&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mover&gt;&lt;mi&gt;&amp;#x0131;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;&amp;#x007E;&lt;/mo&gt;&lt;/mover&gt;&lt;/mrow&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mover&gt;&lt;mi&gt;&amp;#x0237;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;&amp;#x007E;&lt;/mo&gt;&lt;/mover&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mover&gt;&lt;mi&gt;&amp;#x0237;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;&amp;#x007E;&lt;/mo&gt;&lt;/mover&gt;&lt;/mrow&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mover&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;&amp;#x007E;&lt;/mo&gt;&lt;/mover&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mover&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;&amp;#x007E;&lt;/mo&gt;&lt;/mover&gt;&lt;/mrow&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-6959" style="width: 10.239em; display: inline-block;"><span style="display: inline-block; position: relative; width: 8.254em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(1.244em, 1008.19em, 2.733em, -999.997em); top: -2.354em; left: 0em;"><span class="mrow" id="MathJax-Span-6960"><span class="texatom" id="MathJax-Span-6961"><span class="mrow" id="MathJax-Span-6962"><span class="munderover" id="MathJax-Span-6963"><span style="display: inline-block; position: relative; width: 0.561em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.31em, 4.159em, -999.997em); top: -3.967em; left: 0.065em;"><span class="mi" id="MathJax-Span-6964" style="font-family: MathJax_Main-italic;">ı<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.065em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.477em, 1000.44em, 3.973em, -999.997em); top: -4.339em; left: 0.065em;"><span class="mo" id="MathJax-Span-6965" style="font-family: MathJax_Main;">~</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span></span><span class="texatom" id="MathJax-Span-6966"><span class="mrow" id="MathJax-Span-6967"><span class="munderover" id="MathJax-Span-6968"><span style="display: inline-block; position: relative; width: 0.561em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.31em, 4.159em, -999.997em); top: -3.967em; left: 0.065em;"><span class="mi" id="MathJax-Span-6969" style="font-family: MathJax_Main-italic;">ı<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.065em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.477em, 1000.44em, 3.973em, -999.997em); top: -4.339em; left: 0.065em;"><span class="mo" id="MathJax-Span-6970" style="font-family: MathJax_Main;">~</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span></span><span class="mo" id="MathJax-Span-6971" style="font-family: MathJax_Main; padding-left: 0.251em;">=</span><span class="texatom" id="MathJax-Span-6972" style="padding-left: 0.251em;"><span class="mrow" id="MathJax-Span-6973"><span class="munderover" id="MathJax-Span-6974"><span style="display: inline-block; position: relative; width: 0.499em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.31em, 4.346em, -999.997em); top: -3.967em; left: 0.065em;"><span class="mi" id="MathJax-Span-6975" style="font-family: MathJax_Main-italic;">ȷ</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.477em, 1000.44em, 3.973em, -999.997em); top: -4.339em; left: 0em;"><span class="mo" id="MathJax-Span-6976" style="font-family: MathJax_Main;">~</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span></span><span class="texatom" id="MathJax-Span-6977"><span class="mrow" id="MathJax-Span-6978"><span class="munderover" id="MathJax-Span-6979"><span style="display: inline-block; position: relative; width: 0.499em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.31em, 4.346em, -999.997em); top: -3.967em; left: 0.065em;"><span class="mi" id="MathJax-Span-6980" style="font-family: MathJax_Main-italic;">ȷ</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.477em, 1000.44em, 3.973em, -999.997em); top: -4.339em; left: 0em;"><span class="mo" id="MathJax-Span-6981" style="font-family: MathJax_Main;">~</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span></span><span class="mo" id="MathJax-Span-6982" style="font-family: MathJax_Main; padding-left: 0.251em;">=</span><span class="texatom" id="MathJax-Span-6983" style="padding-left: 0.251em;"><span class="mrow" id="MathJax-Span-6984"><span class="munderover" id="MathJax-Span-6985"><span style="display: inline-block; position: relative; width: 0.499em; height: 0px;"><span style="position: absolute; clip: rect(3.105em, 1000.5em, 4.159em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-6986" style="font-family: MathJax_Math-italic;">k</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.477em, 1000.44em, 3.973em, -999.997em); top: -4.587em; left: 0.003em;"><span class="mo" id="MathJax-Span-6987" style="font-family: MathJax_Main;">~</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span></span><span class="texatom" id="MathJax-Span-6988"><span class="mrow" id="MathJax-Span-6989"><span class="munderover" id="MathJax-Span-6990"><span style="display: inline-block; position: relative; width: 0.499em; height: 0px;"><span style="position: absolute; clip: rect(3.105em, 1000.5em, 4.159em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-6991" style="font-family: MathJax_Math-italic;">k</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.477em, 1000.44em, 3.973em, -999.997em); top: -4.587em; left: 0.003em;"><span class="mo" id="MathJax-Span-6992" style="font-family: MathJax_Main;">~</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span></span><span class="mo" id="MathJax-Span-6993" style="font-family: MathJax_Main; padding-left: 0.251em;">=</span><span class="mo" id="MathJax-Span-6994" style="font-family: MathJax_Main; padding-left: 0.251em;">−</span><span class="mn" id="MathJax-Span-6995" style="font-family: MathJax_Main;">1</span></span><span style="display: inline-block; width: 0px; height: 2.36em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.304em; border-left: 0px solid; width: 0px; height: 1.619em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow class="MJX-TeXAtom-ORD"><mover><mi>ı</mi><mo stretchy="false">~</mo></mover></mrow><mrow class="MJX-TeXAtom-ORD"><mover><mi>ı</mi><mo stretchy="false">~</mo></mover></mrow><mo>=</mo><mrow class="MJX-TeXAtom-ORD"><mover><mi>ȷ</mi><mo stretchy="false">~</mo></mover></mrow><mrow class="MJX-TeXAtom-ORD"><mover><mi>ȷ</mi><mo stretchy="false">~</mo></mover></mrow><mo>=</mo><mrow class="MJX-TeXAtom-ORD"><mover><mi>k</mi><mo stretchy="false">~</mo></mover></mrow><mrow class="MJX-TeXAtom-ORD"><mover><mi>k</mi><mo stretchy="false">~</mo></mover></mrow><mo>=</mo><mo>−</mo><mn>1</mn></math></span></span><script type="math/tex" id="MathJax-Element-207">\tilde{\imath}\tilde{\imath}=\tilde{\jmath}\tilde{\jmath}=\tilde{k}\tilde{k}=-1</script></p>
<p style="text-align: center;"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-208-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mover&gt;&lt;mi&gt;&amp;#x0131;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;&amp;#x007E;&lt;/mo&gt;&lt;/mover&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mover&gt;&lt;mi&gt;&amp;#x0237;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;&amp;#x007E;&lt;/mo&gt;&lt;/mover&gt;&lt;/mrow&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mover&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;&amp;#x007E;&lt;/mo&gt;&lt;/mover&gt;&lt;/mrow&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mover&gt;&lt;mi&gt;&amp;#x0237;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;&amp;#x007E;&lt;/mo&gt;&lt;/mover&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mover&gt;&lt;mi&gt;&amp;#x0131;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;&amp;#x007E;&lt;/mo&gt;&lt;/mover&gt;&lt;/mrow&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-6996" style="width: 7.385em; display: inline-block;"><span style="display: inline-block; position: relative; width: 5.958em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(1.244em, 1005.9em, 2.733em, -999.997em); top: -2.354em; left: 0em;"><span class="mrow" id="MathJax-Span-6997"><span class="texatom" id="MathJax-Span-6998"><span class="mrow" id="MathJax-Span-6999"><span class="munderover" id="MathJax-Span-7000"><span style="display: inline-block; position: relative; width: 0.561em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.31em, 4.159em, -999.997em); top: -3.967em; left: 0.065em;"><span class="mi" id="MathJax-Span-7001" style="font-family: MathJax_Main-italic;">ı<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.065em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.477em, 1000.44em, 3.973em, -999.997em); top: -4.339em; left: 0.065em;"><span class="mo" id="MathJax-Span-7002" style="font-family: MathJax_Main;">~</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span></span><span class="texatom" id="MathJax-Span-7003"><span class="mrow" id="MathJax-Span-7004"><span class="munderover" id="MathJax-Span-7005"><span style="display: inline-block; position: relative; width: 0.499em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.31em, 4.346em, -999.997em); top: -3.967em; left: 0.065em;"><span class="mi" id="MathJax-Span-7006" style="font-family: MathJax_Main-italic;">ȷ</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.477em, 1000.44em, 3.973em, -999.997em); top: -4.339em; left: 0em;"><span class="mo" id="MathJax-Span-7007" style="font-family: MathJax_Main;">~</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span></span><span class="mo" id="MathJax-Span-7008" style="font-family: MathJax_Main; padding-left: 0.251em;">=</span><span class="texatom" id="MathJax-Span-7009" style="padding-left: 0.251em;"><span class="mrow" id="MathJax-Span-7010"><span class="munderover" id="MathJax-Span-7011"><span style="display: inline-block; position: relative; width: 0.499em; height: 0px;"><span style="position: absolute; clip: rect(3.105em, 1000.5em, 4.159em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-7012" style="font-family: MathJax_Math-italic;">k</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.477em, 1000.44em, 3.973em, -999.997em); top: -4.587em; left: 0.003em;"><span class="mo" id="MathJax-Span-7013" style="font-family: MathJax_Main;">~</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span></span><span class="mo" id="MathJax-Span-7014" style="font-family: MathJax_Main; padding-left: 0.251em;">=</span><span class="mo" id="MathJax-Span-7015" style="font-family: MathJax_Main; padding-left: 0.251em;">−</span><span class="texatom" id="MathJax-Span-7016"><span class="mrow" id="MathJax-Span-7017"><span class="munderover" id="MathJax-Span-7018"><span style="display: inline-block; position: relative; width: 0.499em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.31em, 4.346em, -999.997em); top: -3.967em; left: 0.065em;"><span class="mi" id="MathJax-Span-7019" style="font-family: MathJax_Main-italic;">ȷ</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.477em, 1000.44em, 3.973em, -999.997em); top: -4.339em; left: 0em;"><span class="mo" id="MathJax-Span-7020" style="font-family: MathJax_Main;">~</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span></span><span class="texatom" id="MathJax-Span-7021"><span class="mrow" id="MathJax-Span-7022"><span class="munderover" id="MathJax-Span-7023"><span style="display: inline-block; position: relative; width: 0.561em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.31em, 4.159em, -999.997em); top: -3.967em; left: 0.065em;"><span class="mi" id="MathJax-Span-7024" style="font-family: MathJax_Main-italic;">ı<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.065em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.477em, 1000.44em, 3.973em, -999.997em); top: -4.339em; left: 0.065em;"><span class="mo" id="MathJax-Span-7025" style="font-family: MathJax_Main;">~</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.36em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.304em; border-left: 0px solid; width: 0px; height: 1.619em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow class="MJX-TeXAtom-ORD"><mover><mi>ı</mi><mo stretchy="false">~</mo></mover></mrow><mrow class="MJX-TeXAtom-ORD"><mover><mi>ȷ</mi><mo stretchy="false">~</mo></mover></mrow><mo>=</mo><mrow class="MJX-TeXAtom-ORD"><mover><mi>k</mi><mo stretchy="false">~</mo></mover></mrow><mo>=</mo><mo>−</mo><mrow class="MJX-TeXAtom-ORD"><mover><mi>ȷ</mi><mo stretchy="false">~</mo></mover></mrow><mrow class="MJX-TeXAtom-ORD"><mover><mi>ı</mi><mo stretchy="false">~</mo></mover></mrow></math></span></span><script type="math/tex" id="MathJax-Element-208">\tilde{\imath}\tilde{\jmath}=\tilde{k}=-\tilde{\jmath}\tilde{\imath}</script></p>
<p style="text-align: center;"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-209-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mover&gt;&lt;mi&gt;&amp;#x0237;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;&amp;#x007E;&lt;/mo&gt;&lt;/mover&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mover&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;&amp;#x007E;&lt;/mo&gt;&lt;/mover&gt;&lt;/mrow&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mover&gt;&lt;mi&gt;&amp;#x0131;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;&amp;#x007E;&lt;/mo&gt;&lt;/mover&gt;&lt;/mrow&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mover&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;&amp;#x007E;&lt;/mo&gt;&lt;/mover&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mover&gt;&lt;mi&gt;&amp;#x0237;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;&amp;#x007E;&lt;/mo&gt;&lt;/mover&gt;&lt;/mrow&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-7026" style="width: 7.323em; display: inline-block;"><span style="display: inline-block; position: relative; width: 5.896em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(1.244em, 1005.83em, 2.733em, -999.997em); top: -2.354em; left: 0em;"><span class="mrow" id="MathJax-Span-7027"><span class="texatom" id="MathJax-Span-7028"><span class="mrow" id="MathJax-Span-7029"><span class="munderover" id="MathJax-Span-7030"><span style="display: inline-block; position: relative; width: 0.499em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.31em, 4.346em, -999.997em); top: -3.967em; left: 0.065em;"><span class="mi" id="MathJax-Span-7031" style="font-family: MathJax_Main-italic;">ȷ</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.477em, 1000.44em, 3.973em, -999.997em); top: -4.339em; left: 0em;"><span class="mo" id="MathJax-Span-7032" style="font-family: MathJax_Main;">~</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span></span><span class="texatom" id="MathJax-Span-7033"><span class="mrow" id="MathJax-Span-7034"><span class="munderover" id="MathJax-Span-7035"><span style="display: inline-block; position: relative; width: 0.499em; height: 0px;"><span style="position: absolute; clip: rect(3.105em, 1000.5em, 4.159em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-7036" style="font-family: MathJax_Math-italic;">k</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.477em, 1000.44em, 3.973em, -999.997em); top: -4.587em; left: 0.003em;"><span class="mo" id="MathJax-Span-7037" style="font-family: MathJax_Main;">~</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span></span><span class="mo" id="MathJax-Span-7038" style="font-family: MathJax_Main; padding-left: 0.251em;">=</span><span class="texatom" id="MathJax-Span-7039" style="padding-left: 0.251em;"><span class="mrow" id="MathJax-Span-7040"><span class="munderover" id="MathJax-Span-7041"><span style="display: inline-block; position: relative; width: 0.561em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.31em, 4.159em, -999.997em); top: -3.967em; left: 0.065em;"><span class="mi" id="MathJax-Span-7042" style="font-family: MathJax_Main-italic;">ı<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.065em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.477em, 1000.44em, 3.973em, -999.997em); top: -4.339em; left: 0.065em;"><span class="mo" id="MathJax-Span-7043" style="font-family: MathJax_Main;">~</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span></span><span class="mo" id="MathJax-Span-7044" style="font-family: MathJax_Main; padding-left: 0.251em;">=</span><span class="mo" id="MathJax-Span-7045" style="font-family: MathJax_Main; padding-left: 0.251em;">−</span><span class="texatom" id="MathJax-Span-7046"><span class="mrow" id="MathJax-Span-7047"><span class="munderover" id="MathJax-Span-7048"><span style="display: inline-block; position: relative; width: 0.499em; height: 0px;"><span style="position: absolute; clip: rect(3.105em, 1000.5em, 4.159em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-7049" style="font-family: MathJax_Math-italic;">k</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.477em, 1000.44em, 3.973em, -999.997em); top: -4.587em; left: 0.003em;"><span class="mo" id="MathJax-Span-7050" style="font-family: MathJax_Main;">~</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span></span><span class="texatom" id="MathJax-Span-7051"><span class="mrow" id="MathJax-Span-7052"><span class="munderover" id="MathJax-Span-7053"><span style="display: inline-block; position: relative; width: 0.499em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.31em, 4.346em, -999.997em); top: -3.967em; left: 0.065em;"><span class="mi" id="MathJax-Span-7054" style="font-family: MathJax_Main-italic;">ȷ</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.477em, 1000.44em, 3.973em, -999.997em); top: -4.339em; left: 0em;"><span class="mo" id="MathJax-Span-7055" style="font-family: MathJax_Main;">~</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.36em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.304em; border-left: 0px solid; width: 0px; height: 1.619em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow class="MJX-TeXAtom-ORD"><mover><mi>ȷ</mi><mo stretchy="false">~</mo></mover></mrow><mrow class="MJX-TeXAtom-ORD"><mover><mi>k</mi><mo stretchy="false">~</mo></mover></mrow><mo>=</mo><mrow class="MJX-TeXAtom-ORD"><mover><mi>ı</mi><mo stretchy="false">~</mo></mover></mrow><mo>=</mo><mo>−</mo><mrow class="MJX-TeXAtom-ORD"><mover><mi>k</mi><mo stretchy="false">~</mo></mover></mrow><mrow class="MJX-TeXAtom-ORD"><mover><mi>ȷ</mi><mo stretchy="false">~</mo></mover></mrow></math></span></span><script type="math/tex" id="MathJax-Element-209">\tilde{\jmath}\tilde{k}=\tilde{\imath}=-\tilde{k}\tilde{\jmath}</script></p>
<p style="text-align: center;"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-210-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mover&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;&amp;#x007E;&lt;/mo&gt;&lt;/mover&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mover&gt;&lt;mi&gt;&amp;#x0131;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;&amp;#x007E;&lt;/mo&gt;&lt;/mover&gt;&lt;/mrow&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mover&gt;&lt;mi&gt;&amp;#x0237;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;&amp;#x007E;&lt;/mo&gt;&lt;/mover&gt;&lt;/mrow&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mover&gt;&lt;mi&gt;&amp;#x0131;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;&amp;#x007E;&lt;/mo&gt;&lt;/mover&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mover&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;&amp;#x007E;&lt;/mo&gt;&lt;/mover&gt;&lt;/mrow&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-7056" style="width: 7.385em; display: inline-block;"><span style="display: inline-block; position: relative; width: 5.958em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(1.244em, 1005.96em, 2.733em, -999.997em); top: -2.354em; left: 0em;"><span class="mrow" id="MathJax-Span-7057"><span class="texatom" id="MathJax-Span-7058"><span class="mrow" id="MathJax-Span-7059"><span class="munderover" id="MathJax-Span-7060"><span style="display: inline-block; position: relative; width: 0.499em; height: 0px;"><span style="position: absolute; clip: rect(3.105em, 1000.5em, 4.159em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-7061" style="font-family: MathJax_Math-italic;">k</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.477em, 1000.44em, 3.973em, -999.997em); top: -4.587em; left: 0.003em;"><span class="mo" id="MathJax-Span-7062" style="font-family: MathJax_Main;">~</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span></span><span class="texatom" id="MathJax-Span-7063"><span class="mrow" id="MathJax-Span-7064"><span class="munderover" id="MathJax-Span-7065"><span style="display: inline-block; position: relative; width: 0.561em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.31em, 4.159em, -999.997em); top: -3.967em; left: 0.065em;"><span class="mi" id="MathJax-Span-7066" style="font-family: MathJax_Main-italic;">ı<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.065em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.477em, 1000.44em, 3.973em, -999.997em); top: -4.339em; left: 0.065em;"><span class="mo" id="MathJax-Span-7067" style="font-family: MathJax_Main;">~</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span></span><span class="mo" id="MathJax-Span-7068" style="font-family: MathJax_Main; padding-left: 0.251em;">=</span><span class="texatom" id="MathJax-Span-7069" style="padding-left: 0.251em;"><span class="mrow" id="MathJax-Span-7070"><span class="munderover" id="MathJax-Span-7071"><span style="display: inline-block; position: relative; width: 0.499em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.31em, 4.346em, -999.997em); top: -3.967em; left: 0.065em;"><span class="mi" id="MathJax-Span-7072" style="font-family: MathJax_Main-italic;">ȷ</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.477em, 1000.44em, 3.973em, -999.997em); top: -4.339em; left: 0em;"><span class="mo" id="MathJax-Span-7073" style="font-family: MathJax_Main;">~</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span></span><span class="mo" id="MathJax-Span-7074" style="font-family: MathJax_Main; padding-left: 0.251em;">=</span><span class="mo" id="MathJax-Span-7075" style="font-family: MathJax_Main; padding-left: 0.251em;">−</span><span class="texatom" id="MathJax-Span-7076"><span class="mrow" id="MathJax-Span-7077"><span class="munderover" id="MathJax-Span-7078"><span style="display: inline-block; position: relative; width: 0.561em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.31em, 4.159em, -999.997em); top: -3.967em; left: 0.065em;"><span class="mi" id="MathJax-Span-7079" style="font-family: MathJax_Main-italic;">ı<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.065em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.477em, 1000.44em, 3.973em, -999.997em); top: -4.339em; left: 0.065em;"><span class="mo" id="MathJax-Span-7080" style="font-family: MathJax_Main;">~</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span></span><span class="texatom" id="MathJax-Span-7081"><span class="mrow" id="MathJax-Span-7082"><span class="munderover" id="MathJax-Span-7083"><span style="display: inline-block; position: relative; width: 0.499em; height: 0px;"><span style="position: absolute; clip: rect(3.105em, 1000.5em, 4.159em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-7084" style="font-family: MathJax_Math-italic;">k</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.477em, 1000.44em, 3.973em, -999.997em); top: -4.587em; left: 0.003em;"><span class="mo" id="MathJax-Span-7085" style="font-family: MathJax_Main;">~</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.36em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.304em; border-left: 0px solid; width: 0px; height: 1.619em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow class="MJX-TeXAtom-ORD"><mover><mi>k</mi><mo stretchy="false">~</mo></mover></mrow><mrow class="MJX-TeXAtom-ORD"><mover><mi>ı</mi><mo stretchy="false">~</mo></mover></mrow><mo>=</mo><mrow class="MJX-TeXAtom-ORD"><mover><mi>ȷ</mi><mo stretchy="false">~</mo></mover></mrow><mo>=</mo><mo>−</mo><mrow class="MJX-TeXAtom-ORD"><mover><mi>ı</mi><mo stretchy="false">~</mo></mover></mrow><mrow class="MJX-TeXAtom-ORD"><mover><mi>k</mi><mo stretchy="false">~</mo></mover></mrow></math></span></span><script type="math/tex" id="MathJax-Element-210">\tilde{k}\tilde{\imath}=\tilde{\jmath}=-\tilde{\imath}\tilde{k}</script></p>
<p>With this, you will then be able to do quaternion multiplications . This is done the same way as when you multiply a 4 variable algebra by another 4 variable algebra. The derivation gets quite long so I am going to skip it and just post the answer.</p>
<p style="text-align: center;"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-211-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo&gt;&amp;#x2297;&lt;/mo&gt;&lt;/mrow&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mrow&gt;&lt;mo&gt;[&lt;/mo&gt;&lt;mtable rowspacing=&quot;4pt&quot; columnspacing=&quot;1em&quot;&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/msub&gt;&lt;msub&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/msub&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;msub&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msub&gt;&lt;msub&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msub&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mn&gt;3&lt;/mn&gt;&lt;/msub&gt;&lt;msub&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mn&gt;3&lt;/mn&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;msub&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/msub&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/msub&gt;&lt;msub&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mn&gt;3&lt;/mn&gt;&lt;/msub&gt;&lt;msub&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msub&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msub&gt;&lt;msub&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mn&gt;3&lt;/mn&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msub&gt;&lt;msub&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/msub&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mn&gt;3&lt;/mn&gt;&lt;/msub&gt;&lt;msub&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/msub&gt;&lt;msub&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msub&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;msub&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mn&gt;3&lt;/mn&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mn&gt;3&lt;/mn&gt;&lt;/msub&gt;&lt;msub&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/msub&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msub&gt;&lt;msub&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;msub&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msub&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/msub&gt;&lt;msub&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mn&gt;3&lt;/mn&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;/mtable&gt;&lt;mo&gt;]&lt;/mo&gt;&lt;/mrow&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-7086" style="width: 19.668em; display: inline-block;"><span style="display: inline-block; position: relative; width: 15.822em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(2.174em, 1015.51em, 7.757em, -999.997em); top: -5.208em; left: 0em;"><span class="mrow" id="MathJax-Span-7087"><span class="mi" id="MathJax-Span-7088" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="texatom" id="MathJax-Span-7089"><span class="mrow" id="MathJax-Span-7090"><span class="mo" id="MathJax-Span-7091" style="font-family: MathJax_Main;">⊗</span></span></span><span class="mi" id="MathJax-Span-7092" style="font-family: MathJax_Math-italic;">p</span><span class="mo" id="MathJax-Span-7093" style="font-family: MathJax_Main; padding-left: 0.251em;">=</span><span class="mrow" id="MathJax-Span-7094" style="padding-left: 0.251em;"><span class="mo" id="MathJax-Span-7095" style="vertical-align: 2.857em;"><span style="display: inline-block; position: relative; width: 0.685em; height: 0px;"><span style="position: absolute; font-family: MathJax_Size4; top: -2.788em; left: 0em;">⎡<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; font-family: MathJax_Size4; top: 0.561em; left: 0em;">⎣<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -1.61em; left: 0em;">⎢<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -1.051em; left: 0em;">⎢<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -0.493em; left: 0em;">⎢<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="mtable" id="MathJax-Span-7096" style="padding-right: 0.189em; padding-left: 0.189em;"><span style="display: inline-block; position: relative; width: 11.045em; height: 0px;"><span style="position: absolute; clip: rect(3.167em, 1011.04em, 8.502em, -999.997em); top: -5.952em; left: 0em;"><span style="display: inline-block; position: relative; width: 11.045em; height: 0px;"><span style="position: absolute; clip: rect(3.229em, 1011.04em, 4.346em, -999.997em); top: -6.014em; left: 50%; margin-left: -5.518em;"><span class="mtd" id="MathJax-Span-7097"><span class="mrow" id="MathJax-Span-7098"><span class="msubsup" id="MathJax-Span-7099"><span style="display: inline-block; position: relative; width: 0.872em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.44em, 4.346em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-7100" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.437em;"><span class="mn" id="MathJax-Span-7101" style="font-size: 70.7%; font-family: MathJax_Main;">0</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-7102"><span style="display: inline-block; position: relative; width: 0.934em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.5em, 4.346em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-7103" style="font-family: MathJax_Math-italic;">p</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.499em;"><span class="mn" id="MathJax-Span-7104" style="font-size: 70.7%; font-family: MathJax_Main;">0</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="mo" id="MathJax-Span-7105" style="font-family: MathJax_Main; padding-left: 0.251em;">−</span><span class="msubsup" id="MathJax-Span-7106" style="padding-left: 0.251em;"><span style="display: inline-block; position: relative; width: 0.872em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.44em, 4.346em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-7107" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.437em;"><span class="mn" id="MathJax-Span-7108" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-7109"><span style="display: inline-block; position: relative; width: 0.934em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.5em, 4.346em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-7110" style="font-family: MathJax_Math-italic;">p</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.499em;"><span class="mn" id="MathJax-Span-7111" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="mo" id="MathJax-Span-7112" style="font-family: MathJax_Main; padding-left: 0.251em;">−</span><span class="msubsup" id="MathJax-Span-7113" style="padding-left: 0.251em;"><span style="display: inline-block; position: relative; width: 0.872em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.44em, 4.346em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-7114" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.437em;"><span class="mn" id="MathJax-Span-7115" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-7116"><span style="display: inline-block; position: relative; width: 0.934em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.5em, 4.346em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-7117" style="font-family: MathJax_Math-italic;">p</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.499em;"><span class="mn" id="MathJax-Span-7118" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="mo" id="MathJax-Span-7119" style="font-family: MathJax_Main; padding-left: 0.251em;">−</span><span class="msubsup" id="MathJax-Span-7120" style="padding-left: 0.251em;"><span style="display: inline-block; position: relative; width: 0.872em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.44em, 4.346em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-7121" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.437em;"><span class="mn" id="MathJax-Span-7122" style="font-size: 70.7%; font-family: MathJax_Main;">3</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-7123"><span style="display: inline-block; position: relative; width: 0.934em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.5em, 4.346em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-7124" style="font-family: MathJax_Math-italic;">p</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.499em;"><span class="mn" id="MathJax-Span-7125" style="font-size: 70.7%; font-family: MathJax_Main;">3</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.229em, 1011.04em, 4.346em, -999.997em); top: -4.587em; left: 50%; margin-left: -5.518em;"><span class="mtd" id="MathJax-Span-7126"><span class="mrow" id="MathJax-Span-7127"><span class="msubsup" id="MathJax-Span-7128"><span style="display: inline-block; position: relative; width: 0.872em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.44em, 4.346em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-7129" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.437em;"><span class="mn" id="MathJax-Span-7130" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-7131"><span style="display: inline-block; position: relative; width: 0.934em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.5em, 4.346em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-7132" style="font-family: MathJax_Math-italic;">p</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.499em;"><span class="mn" id="MathJax-Span-7133" style="font-size: 70.7%; font-family: MathJax_Main;">0</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="mo" id="MathJax-Span-7134" style="font-family: MathJax_Main; padding-left: 0.251em;">+</span><span class="msubsup" id="MathJax-Span-7135" style="padding-left: 0.251em;"><span style="display: inline-block; position: relative; width: 0.872em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.44em, 4.346em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-7136" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.437em;"><span class="mn" id="MathJax-Span-7137" style="font-size: 70.7%; font-family: MathJax_Main;">0</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-7138"><span style="display: inline-block; position: relative; width: 0.934em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.5em, 4.346em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-7139" style="font-family: MathJax_Math-italic;">p</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.499em;"><span class="mn" id="MathJax-Span-7140" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="mo" id="MathJax-Span-7141" style="font-family: MathJax_Main; padding-left: 0.251em;">−</span><span class="msubsup" id="MathJax-Span-7142" style="padding-left: 0.251em;"><span style="display: inline-block; position: relative; width: 0.872em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.44em, 4.346em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-7143" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.437em;"><span class="mn" id="MathJax-Span-7144" style="font-size: 70.7%; font-family: MathJax_Main;">3</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-7145"><span style="display: inline-block; position: relative; width: 0.934em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.5em, 4.346em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-7146" style="font-family: MathJax_Math-italic;">p</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.499em;"><span class="mn" id="MathJax-Span-7147" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="mo" id="MathJax-Span-7148" style="font-family: MathJax_Main; padding-left: 0.251em;">+</span><span class="msubsup" id="MathJax-Span-7149" style="padding-left: 0.251em;"><span style="display: inline-block; position: relative; width: 0.872em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.44em, 4.346em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-7150" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.437em;"><span class="mn" id="MathJax-Span-7151" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-7152"><span style="display: inline-block; position: relative; width: 0.934em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.5em, 4.346em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-7153" style="font-family: MathJax_Math-italic;">p</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.499em;"><span class="mn" id="MathJax-Span-7154" style="font-size: 70.7%; font-family: MathJax_Main;">3</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.229em, 1011.04em, 4.346em, -999.997em); top: -3.223em; left: 50%; margin-left: -5.518em;"><span class="mtd" id="MathJax-Span-7155"><span class="mrow" id="MathJax-Span-7156"><span class="msubsup" id="MathJax-Span-7157"><span style="display: inline-block; position: relative; width: 0.872em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.44em, 4.346em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-7158" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.437em;"><span class="mn" id="MathJax-Span-7159" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-7160"><span style="display: inline-block; position: relative; width: 0.934em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.5em, 4.346em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-7161" style="font-family: MathJax_Math-italic;">p</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.499em;"><span class="mn" id="MathJax-Span-7162" style="font-size: 70.7%; font-family: MathJax_Main;">0</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="mo" id="MathJax-Span-7163" style="font-family: MathJax_Main; padding-left: 0.251em;">+</span><span class="msubsup" id="MathJax-Span-7164" style="padding-left: 0.251em;"><span style="display: inline-block; position: relative; width: 0.872em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.44em, 4.346em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-7165" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.437em;"><span class="mn" id="MathJax-Span-7166" style="font-size: 70.7%; font-family: MathJax_Main;">3</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-7167"><span style="display: inline-block; position: relative; width: 0.934em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.5em, 4.346em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-7168" style="font-family: MathJax_Math-italic;">p</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.499em;"><span class="mn" id="MathJax-Span-7169" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="mo" id="MathJax-Span-7170" style="font-family: MathJax_Main; padding-left: 0.251em;">+</span><span class="msubsup" id="MathJax-Span-7171" style="padding-left: 0.251em;"><span style="display: inline-block; position: relative; width: 0.872em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.44em, 4.346em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-7172" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.437em;"><span class="mn" id="MathJax-Span-7173" style="font-size: 70.7%; font-family: MathJax_Main;">0</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-7174"><span style="display: inline-block; position: relative; width: 0.934em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.5em, 4.346em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-7175" style="font-family: MathJax_Math-italic;">p</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.499em;"><span class="mn" id="MathJax-Span-7176" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="mo" id="MathJax-Span-7177" style="font-family: MathJax_Main; padding-left: 0.251em;">−</span><span class="msubsup" id="MathJax-Span-7178" style="padding-left: 0.251em;"><span style="display: inline-block; position: relative; width: 0.872em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.44em, 4.346em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-7179" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.437em;"><span class="mn" id="MathJax-Span-7180" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-7181"><span style="display: inline-block; position: relative; width: 0.934em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.5em, 4.346em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-7182" style="font-family: MathJax_Math-italic;">p</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.499em;"><span class="mn" id="MathJax-Span-7183" style="font-size: 70.7%; font-family: MathJax_Main;">3</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.229em, 1011.04em, 4.346em, -999.997em); top: -1.796em; left: 50%; margin-left: -5.518em;"><span class="mtd" id="MathJax-Span-7184"><span class="mrow" id="MathJax-Span-7185"><span class="msubsup" id="MathJax-Span-7186"><span style="display: inline-block; position: relative; width: 0.872em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.44em, 4.346em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-7187" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.437em;"><span class="mn" id="MathJax-Span-7188" style="font-size: 70.7%; font-family: MathJax_Main;">3</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-7189"><span style="display: inline-block; position: relative; width: 0.934em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.5em, 4.346em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-7190" style="font-family: MathJax_Math-italic;">p</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.499em;"><span class="mn" id="MathJax-Span-7191" style="font-size: 70.7%; font-family: MathJax_Main;">0</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="mo" id="MathJax-Span-7192" style="font-family: MathJax_Main; padding-left: 0.251em;">−</span><span class="msubsup" id="MathJax-Span-7193" style="padding-left: 0.251em;"><span style="display: inline-block; position: relative; width: 0.872em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.44em, 4.346em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-7194" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.437em;"><span class="mn" id="MathJax-Span-7195" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-7196"><span style="display: inline-block; position: relative; width: 0.934em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.5em, 4.346em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-7197" style="font-family: MathJax_Math-italic;">p</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.499em;"><span class="mn" id="MathJax-Span-7198" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="mo" id="MathJax-Span-7199" style="font-family: MathJax_Main; padding-left: 0.251em;">+</span><span class="msubsup" id="MathJax-Span-7200" style="padding-left: 0.251em;"><span style="display: inline-block; position: relative; width: 0.872em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.44em, 4.346em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-7201" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.437em;"><span class="mn" id="MathJax-Span-7202" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-7203"><span style="display: inline-block; position: relative; width: 0.934em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.5em, 4.346em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-7204" style="font-family: MathJax_Math-italic;">p</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.499em;"><span class="mn" id="MathJax-Span-7205" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="mo" id="MathJax-Span-7206" style="font-family: MathJax_Main; padding-left: 0.251em;">+</span><span class="msubsup" id="MathJax-Span-7207" style="padding-left: 0.251em;"><span style="display: inline-block; position: relative; width: 0.872em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.44em, 4.346em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-7208" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.437em;"><span class="mn" id="MathJax-Span-7209" style="font-size: 70.7%; font-family: MathJax_Main;">0</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-7210"><span style="display: inline-block; position: relative; width: 0.934em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.5em, 4.346em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-7211" style="font-family: MathJax_Math-italic;">p</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.499em;"><span class="mn" id="MathJax-Span-7212" style="font-size: 70.7%; font-family: MathJax_Main;">3</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span><span style="display: inline-block; width: 0px; height: 5.958em;"></span></span></span></span><span class="mo" id="MathJax-Span-7213" style="vertical-align: 2.857em;"><span style="display: inline-block; position: relative; width: 0.685em; height: 0px;"><span style="position: absolute; font-family: MathJax_Size4; top: -2.788em; left: 0em;">⎤<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; font-family: MathJax_Size4; top: 0.561em; left: 0em;">⎦<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -1.61em; left: 0em;">⎥<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -1.051em; left: 0em;">⎥<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -0.493em; left: 0em;">⎥<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 5.214em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -2.996em; border-left: 0px solid; width: 0px; height: 6.619em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>q</mi><mrow class="MJX-TeXAtom-ORD"><mo>⊗</mo></mrow><mi>p</mi><mo>=</mo><mrow><mo>[</mo><mtable rowspacing="4pt" columnspacing="1em"><mtr><mtd><msub><mi>q</mi><mn>0</mn></msub><msub><mi>p</mi><mn>0</mn></msub><mo>−</mo><msub><mi>q</mi><mn>1</mn></msub><msub><mi>p</mi><mn>1</mn></msub><mo>−</mo><msub><mi>q</mi><mn>2</mn></msub><msub><mi>p</mi><mn>2</mn></msub><mo>−</mo><msub><mi>q</mi><mn>3</mn></msub><msub><mi>p</mi><mn>3</mn></msub></mtd></mtr><mtr><mtd><msub><mi>q</mi><mn>1</mn></msub><msub><mi>p</mi><mn>0</mn></msub><mo>+</mo><msub><mi>q</mi><mn>0</mn></msub><msub><mi>p</mi><mn>1</mn></msub><mo>−</mo><msub><mi>q</mi><mn>3</mn></msub><msub><mi>p</mi><mn>2</mn></msub><mo>+</mo><msub><mi>q</mi><mn>2</mn></msub><msub><mi>p</mi><mn>3</mn></msub></mtd></mtr><mtr><mtd><msub><mi>q</mi><mn>2</mn></msub><msub><mi>p</mi><mn>0</mn></msub><mo>+</mo><msub><mi>q</mi><mn>3</mn></msub><msub><mi>p</mi><mn>1</mn></msub><mo>+</mo><msub><mi>q</mi><mn>0</mn></msub><msub><mi>p</mi><mn>2</mn></msub><mo>−</mo><msub><mi>q</mi><mn>1</mn></msub><msub><mi>p</mi><mn>3</mn></msub></mtd></mtr><mtr><mtd><msub><mi>q</mi><mn>3</mn></msub><msub><mi>p</mi><mn>0</mn></msub><mo>−</mo><msub><mi>q</mi><mn>2</mn></msub><msub><mi>p</mi><mn>1</mn></msub><mo>+</mo><msub><mi>q</mi><mn>1</mn></msub><msub><mi>p</mi><mn>2</mn></msub><mo>+</mo><msub><mi>q</mi><mn>0</mn></msub><msub><mi>p</mi><mn>3</mn></msub></mtd></mtr></mtable><mo>]</mo></mrow></math></span></span><script type="math/tex" id="MathJax-Element-211">q{\otimes}p=\begin{bmatrix} q_0p_0-q_1p_1-q_2p_2-q_3p_3 \\ q_1p_0+q_0p_1-q_3p_2+q_2p_3 \\ q_2p_0+q_3p_1+q_0p_2-q_1p_3 \\ q_3p_0-q_2p_1+q_1p_2+q_0p_3\end{bmatrix}</script></p>
<p>The above multiplication can also be written in the form of a matrix multiplication as follows:</p>
<p style="text-align: center;"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-212-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo&gt;&amp;#x2297;&lt;/mo&gt;&lt;/mrow&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;Q&lt;/mi&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mrow&gt;&lt;mo&gt;[&lt;/mo&gt;&lt;mtable rowspacing=&quot;4pt&quot; columnspacing=&quot;1em&quot;&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mn&gt;3&lt;/mn&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mn&gt;3&lt;/mn&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mn&gt;3&lt;/mn&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mn&gt;3&lt;/mn&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;/mtable&gt;&lt;mo&gt;]&lt;/mo&gt;&lt;/mrow&gt;&lt;mrow&gt;&lt;mo&gt;[&lt;/mo&gt;&lt;mtable rowspacing=&quot;4pt&quot; columnspacing=&quot;1em&quot;&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mn&gt;3&lt;/mn&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;/mtable&gt;&lt;mo&gt;]&lt;/mo&gt;&lt;/mrow&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-7214" style="width: 23.638em; display: inline-block;"><span style="display: inline-block; position: relative; width: 19.048em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(2.174em, 1018.74em, 7.757em, -999.997em); top: -5.208em; left: 0em;"><span class="mrow" id="MathJax-Span-7215"><span class="mi" id="MathJax-Span-7216" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="texatom" id="MathJax-Span-7217"><span class="mrow" id="MathJax-Span-7218"><span class="mo" id="MathJax-Span-7219" style="font-family: MathJax_Main;">⊗</span></span></span><span class="mi" id="MathJax-Span-7220" style="font-family: MathJax_Math-italic;">p</span><span class="mo" id="MathJax-Span-7221" style="font-family: MathJax_Main; padding-left: 0.251em;">=</span><span class="mi" id="MathJax-Span-7222" style="font-family: MathJax_Math-italic; padding-left: 0.251em;">Q</span><span class="mi" id="MathJax-Span-7223" style="font-family: MathJax_Math-italic;">p</span><span class="mo" id="MathJax-Span-7224" style="font-family: MathJax_Main; padding-left: 0.251em;">=</span><span class="mrow" id="MathJax-Span-7225" style="padding-left: 0.251em;"><span class="mo" id="MathJax-Span-7226" style="vertical-align: 2.857em;"><span style="display: inline-block; position: relative; width: 0.685em; height: 0px;"><span style="position: absolute; font-family: MathJax_Size4; top: -2.788em; left: 0em;">⎡<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; font-family: MathJax_Size4; top: 0.561em; left: 0em;">⎣<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -1.61em; left: 0em;">⎢<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -1.051em; left: 0em;">⎢<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -0.493em; left: 0em;">⎢<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="mtable" id="MathJax-Span-7227" style="padding-right: 0.189em; padding-left: 0.189em;"><span style="display: inline-block; position: relative; width: 8.812em; height: 0px;"><span style="position: absolute; clip: rect(3.167em, 1000.87em, 8.378em, -999.997em); top: -5.828em; left: 0em;"><span style="display: inline-block; position: relative; width: 0.872em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.87em, 4.346em, -999.997em); top: -6.014em; left: 50%; margin-left: -0.431em;"><span class="mtd" id="MathJax-Span-7228"><span class="mrow" id="MathJax-Span-7229"><span class="msubsup" id="MathJax-Span-7230"><span style="display: inline-block; position: relative; width: 0.872em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.44em, 4.346em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-7231" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.437em;"><span class="mn" id="MathJax-Span-7232" style="font-size: 70.7%; font-family: MathJax_Main;">0</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.353em, 1000.87em, 4.346em, -999.997em); top: -4.587em; left: 50%; margin-left: -0.431em;"><span class="mtd" id="MathJax-Span-7251"><span class="mrow" id="MathJax-Span-7252"><span class="msubsup" id="MathJax-Span-7253"><span style="display: inline-block; position: relative; width: 0.872em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.44em, 4.346em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-7254" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.437em;"><span class="mn" id="MathJax-Span-7255" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.353em, 1000.87em, 4.346em, -999.997em); top: -3.223em; left: 50%; margin-left: -0.431em;"><span class="mtd" id="MathJax-Span-7272"><span class="mrow" id="MathJax-Span-7273"><span class="msubsup" id="MathJax-Span-7274"><span style="display: inline-block; position: relative; width: 0.872em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.44em, 4.346em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-7275" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.437em;"><span class="mn" id="MathJax-Span-7276" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.353em, 1000.87em, 4.346em, -999.997em); top: -1.796em; left: 50%; margin-left: -0.431em;"><span class="mtd" id="MathJax-Span-7293"><span class="mrow" id="MathJax-Span-7294"><span class="msubsup" id="MathJax-Span-7295"><span style="display: inline-block; position: relative; width: 0.872em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.44em, 4.346em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-7296" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.437em;"><span class="mn" id="MathJax-Span-7297" style="font-size: 70.7%; font-family: MathJax_Main;">3</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span><span style="display: inline-block; width: 0px; height: 5.834em;"></span></span><span style="position: absolute; clip: rect(3.167em, 1001.68em, 8.502em, -999.997em); top: -5.952em; left: 1.864em;"><span style="display: inline-block; position: relative; width: 1.678em; height: 0px;"><span style="position: absolute; clip: rect(3.229em, 1001.68em, 4.346em, -999.997em); top: -6.014em; left: 50%; margin-left: -0.803em;"><span class="mtd" id="MathJax-Span-7233"><span class="mrow" id="MathJax-Span-7234"><span class="mo" id="MathJax-Span-7235" style="font-family: MathJax_Main;">−</span><span class="msubsup" id="MathJax-Span-7236"><span style="display: inline-block; position: relative; width: 0.872em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.44em, 4.346em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-7237" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.437em;"><span class="mn" id="MathJax-Span-7238" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.353em, 1000.87em, 4.346em, -999.997em); top: -4.587em; left: 50%; margin-left: -0.431em;"><span class="mtd" id="MathJax-Span-7256"><span class="mrow" id="MathJax-Span-7257"><span class="msubsup" id="MathJax-Span-7258"><span style="display: inline-block; position: relative; width: 0.872em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.44em, 4.346em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-7259" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.437em;"><span class="mn" id="MathJax-Span-7260" style="font-size: 70.7%; font-family: MathJax_Main;">0</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.353em, 1000.87em, 4.346em, -999.997em); top: -3.223em; left: 50%; margin-left: -0.431em;"><span class="mtd" id="MathJax-Span-7277"><span class="mrow" id="MathJax-Span-7278"><span class="msubsup" id="MathJax-Span-7279"><span style="display: inline-block; position: relative; width: 0.872em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.44em, 4.346em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-7280" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.437em;"><span class="mn" id="MathJax-Span-7281" style="font-size: 70.7%; font-family: MathJax_Main;">3</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.229em, 1001.68em, 4.346em, -999.997em); top: -1.796em; left: 50%; margin-left: -0.803em;"><span class="mtd" id="MathJax-Span-7298"><span class="mrow" id="MathJax-Span-7299"><span class="mo" id="MathJax-Span-7300" style="font-family: MathJax_Main;">−</span><span class="msubsup" id="MathJax-Span-7301"><span style="display: inline-block; position: relative; width: 0.872em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.44em, 4.346em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-7302" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.437em;"><span class="mn" id="MathJax-Span-7303" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span><span style="display: inline-block; width: 0px; height: 5.958em;"></span></span><span style="position: absolute; clip: rect(3.167em, 1001.68em, 8.502em, -999.997em); top: -5.952em; left: 4.532em;"><span style="display: inline-block; position: relative; width: 1.678em; height: 0px;"><span style="position: absolute; clip: rect(3.229em, 1001.68em, 4.346em, -999.997em); top: -6.014em; left: 50%; margin-left: -0.803em;"><span class="mtd" id="MathJax-Span-7239"><span class="mrow" id="MathJax-Span-7240"><span class="mo" id="MathJax-Span-7241" style="font-family: MathJax_Main;">−</span><span class="msubsup" id="MathJax-Span-7242"><span style="display: inline-block; position: relative; width: 0.872em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.44em, 4.346em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-7243" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.437em;"><span class="mn" id="MathJax-Span-7244" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.229em, 1001.68em, 4.346em, -999.997em); top: -4.587em; left: 50%; margin-left: -0.803em;"><span class="mtd" id="MathJax-Span-7261"><span class="mrow" id="MathJax-Span-7262"><span class="mo" id="MathJax-Span-7263" style="font-family: MathJax_Main;">−</span><span class="msubsup" id="MathJax-Span-7264"><span style="display: inline-block; position: relative; width: 0.872em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.44em, 4.346em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-7265" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.437em;"><span class="mn" id="MathJax-Span-7266" style="font-size: 70.7%; font-family: MathJax_Main;">3</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.353em, 1000.87em, 4.346em, -999.997em); top: -3.223em; left: 50%; margin-left: -0.431em;"><span class="mtd" id="MathJax-Span-7282"><span class="mrow" id="MathJax-Span-7283"><span class="msubsup" id="MathJax-Span-7284"><span style="display: inline-block; position: relative; width: 0.872em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.44em, 4.346em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-7285" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.437em;"><span class="mn" id="MathJax-Span-7286" style="font-size: 70.7%; font-family: MathJax_Main;">0</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.353em, 1000.87em, 4.346em, -999.997em); top: -1.796em; left: 50%; margin-left: -0.431em;"><span class="mtd" id="MathJax-Span-7304"><span class="mrow" id="MathJax-Span-7305"><span class="msubsup" id="MathJax-Span-7306"><span style="display: inline-block; position: relative; width: 0.872em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.44em, 4.346em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-7307" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.437em;"><span class="mn" id="MathJax-Span-7308" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span><span style="display: inline-block; width: 0px; height: 5.958em;"></span></span><span style="position: absolute; clip: rect(3.167em, 1001.68em, 8.502em, -999.997em); top: -5.952em; left: 7.199em;"><span style="display: inline-block; position: relative; width: 1.678em; height: 0px;"><span style="position: absolute; clip: rect(3.229em, 1001.68em, 4.346em, -999.997em); top: -6.014em; left: 50%; margin-left: -0.803em;"><span class="mtd" id="MathJax-Span-7245"><span class="mrow" id="MathJax-Span-7246"><span class="mo" id="MathJax-Span-7247" style="font-family: MathJax_Main;">−</span><span class="msubsup" id="MathJax-Span-7248"><span style="display: inline-block; position: relative; width: 0.872em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.44em, 4.346em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-7249" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.437em;"><span class="mn" id="MathJax-Span-7250" style="font-size: 70.7%; font-family: MathJax_Main;">3</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.353em, 1000.87em, 4.346em, -999.997em); top: -4.587em; left: 50%; margin-left: -0.431em;"><span class="mtd" id="MathJax-Span-7267"><span class="mrow" id="MathJax-Span-7268"><span class="msubsup" id="MathJax-Span-7269"><span style="display: inline-block; position: relative; width: 0.872em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.44em, 4.346em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-7270" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.437em;"><span class="mn" id="MathJax-Span-7271" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.229em, 1001.68em, 4.346em, -999.997em); top: -3.223em; left: 50%; margin-left: -0.803em;"><span class="mtd" id="MathJax-Span-7287"><span class="mrow" id="MathJax-Span-7288"><span class="mo" id="MathJax-Span-7289" style="font-family: MathJax_Main;">−</span><span class="msubsup" id="MathJax-Span-7290"><span style="display: inline-block; position: relative; width: 0.872em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.44em, 4.346em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-7291" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.437em;"><span class="mn" id="MathJax-Span-7292" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.353em, 1000.87em, 4.346em, -999.997em); top: -1.796em; left: 50%; margin-left: -0.431em;"><span class="mtd" id="MathJax-Span-7309"><span class="mrow" id="MathJax-Span-7310"><span class="msubsup" id="MathJax-Span-7311"><span style="display: inline-block; position: relative; width: 0.872em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.44em, 4.346em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-7312" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.437em;"><span class="mn" id="MathJax-Span-7313" style="font-size: 70.7%; font-family: MathJax_Main;">0</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span><span style="display: inline-block; width: 0px; height: 5.958em;"></span></span></span></span><span class="mo" id="MathJax-Span-7314" style="vertical-align: 2.857em;"><span style="display: inline-block; position: relative; width: 0.685em; height: 0px;"><span style="position: absolute; font-family: MathJax_Size4; top: -2.788em; left: 0em;">⎤<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; font-family: MathJax_Size4; top: 0.561em; left: 0em;">⎦<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -1.61em; left: 0em;">⎥<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -1.051em; left: 0em;">⎥<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -0.493em; left: 0em;">⎥<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span><span class="mrow" id="MathJax-Span-7315" style="padding-left: 0.189em;"><span class="mo" id="MathJax-Span-7316" style="vertical-align: 2.857em;"><span style="display: inline-block; position: relative; width: 0.685em; height: 0px;"><span style="position: absolute; font-family: MathJax_Size4; top: -2.788em; left: 0em;">⎡<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; font-family: MathJax_Size4; top: 0.561em; left: 0em;">⎣<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -1.61em; left: 0em;">⎢<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -1.051em; left: 0em;">⎢<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -0.493em; left: 0em;">⎢<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="mtable" id="MathJax-Span-7317" style="padding-right: 0.189em; padding-left: 0.189em;"><span style="display: inline-block; position: relative; width: 0.934em; height: 0px;"><span style="position: absolute; clip: rect(3.167em, 1000.93em, 8.378em, -999.997em); top: -5.828em; left: 0em;"><span style="display: inline-block; position: relative; width: 0.934em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.93em, 4.346em, -999.997em); top: -6.014em; left: 50%; margin-left: -0.493em;"><span class="mtd" id="MathJax-Span-7318"><span class="mrow" id="MathJax-Span-7319"><span class="msubsup" id="MathJax-Span-7320"><span style="display: inline-block; position: relative; width: 0.934em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.5em, 4.346em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-7321" style="font-family: MathJax_Math-italic;">p</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.499em;"><span class="mn" id="MathJax-Span-7322" style="font-size: 70.7%; font-family: MathJax_Main;">0</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.353em, 1000.93em, 4.346em, -999.997em); top: -4.587em; left: 50%; margin-left: -0.493em;"><span class="mtd" id="MathJax-Span-7323"><span class="mrow" id="MathJax-Span-7324"><span class="msubsup" id="MathJax-Span-7325"><span style="display: inline-block; position: relative; width: 0.934em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.5em, 4.346em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-7326" style="font-family: MathJax_Math-italic;">p</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.499em;"><span class="mn" id="MathJax-Span-7327" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.353em, 1000.93em, 4.346em, -999.997em); top: -3.223em; left: 50%; margin-left: -0.493em;"><span class="mtd" id="MathJax-Span-7328"><span class="mrow" id="MathJax-Span-7329"><span class="msubsup" id="MathJax-Span-7330"><span style="display: inline-block; position: relative; width: 0.934em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.5em, 4.346em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-7331" style="font-family: MathJax_Math-italic;">p</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.499em;"><span class="mn" id="MathJax-Span-7332" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.353em, 1000.93em, 4.346em, -999.997em); top: -1.796em; left: 50%; margin-left: -0.493em;"><span class="mtd" id="MathJax-Span-7333"><span class="mrow" id="MathJax-Span-7334"><span class="msubsup" id="MathJax-Span-7335"><span style="display: inline-block; position: relative; width: 0.934em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.5em, 4.346em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-7336" style="font-family: MathJax_Math-italic;">p</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.499em;"><span class="mn" id="MathJax-Span-7337" style="font-size: 70.7%; font-family: MathJax_Main;">3</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span><span style="display: inline-block; width: 0px; height: 5.834em;"></span></span></span></span><span class="mo" id="MathJax-Span-7338" style="vertical-align: 2.857em;"><span style="display: inline-block; position: relative; width: 0.685em; height: 0px;"><span style="position: absolute; font-family: MathJax_Size4; top: -2.788em; left: 0em;">⎤<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; font-family: MathJax_Size4; top: 0.561em; left: 0em;">⎦<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -1.61em; left: 0em;">⎥<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -1.051em; left: 0em;">⎥<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -0.493em; left: 0em;">⎥<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 5.214em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -2.996em; border-left: 0px solid; width: 0px; height: 6.619em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>q</mi><mrow class="MJX-TeXAtom-ORD"><mo>⊗</mo></mrow><mi>p</mi><mo>=</mo><mi>Q</mi><mi>p</mi><mo>=</mo><mrow><mo>[</mo><mtable rowspacing="4pt" columnspacing="1em"><mtr><mtd><msub><mi>q</mi><mn>0</mn></msub></mtd><mtd><mo>−</mo><msub><mi>q</mi><mn>1</mn></msub></mtd><mtd><mo>−</mo><msub><mi>q</mi><mn>2</mn></msub></mtd><mtd><mo>−</mo><msub><mi>q</mi><mn>3</mn></msub></mtd></mtr><mtr><mtd><msub><mi>q</mi><mn>1</mn></msub></mtd><mtd><msub><mi>q</mi><mn>0</mn></msub></mtd><mtd><mo>−</mo><msub><mi>q</mi><mn>3</mn></msub></mtd><mtd><msub><mi>q</mi><mn>2</mn></msub></mtd></mtr><mtr><mtd><msub><mi>q</mi><mn>2</mn></msub></mtd><mtd><msub><mi>q</mi><mn>3</mn></msub></mtd><mtd><msub><mi>q</mi><mn>0</mn></msub></mtd><mtd><mo>−</mo><msub><mi>q</mi><mn>1</mn></msub></mtd></mtr><mtr><mtd><msub><mi>q</mi><mn>3</mn></msub></mtd><mtd><mo>−</mo><msub><mi>q</mi><mn>2</mn></msub></mtd><mtd><msub><mi>q</mi><mn>1</mn></msub></mtd><mtd><msub><mi>q</mi><mn>0</mn></msub></mtd></mtr></mtable><mo>]</mo></mrow><mrow><mo>[</mo><mtable rowspacing="4pt" columnspacing="1em"><mtr><mtd><msub><mi>p</mi><mn>0</mn></msub></mtd></mtr><mtr><mtd><msub><mi>p</mi><mn>1</mn></msub></mtd></mtr><mtr><mtd><msub><mi>p</mi><mn>2</mn></msub></mtd></mtr><mtr><mtd><msub><mi>p</mi><mn>3</mn></msub></mtd></mtr></mtable><mo>]</mo></mrow></math></span></span><script type="math/tex" id="MathJax-Element-212">q{\otimes}p=Qp=\begin{bmatrix} q_0 & -q_1 & -q_2 & -q_3 \\ q_1 & q_0 & -q_3 & q_2 \\ q_2 & q_3 & q_0 & -q_1 \\ q_3 & -q_2 & q_1 & q_0\end{bmatrix}\begin{bmatrix} p_0 \\ p_1 \\ p_2 \\ p_3\end{bmatrix}</script></p>
<p>Now, we are finally ready to talk about rotations. If we define a quaternion in the following manner:</p>
<p style="text-align: center;"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-213-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mrow&gt;&lt;mo&gt;[&lt;/mo&gt;&lt;mtable rowspacing=&quot;4pt&quot; columnspacing=&quot;1em&quot;&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mi&gt;c&lt;/mi&gt;&lt;mi&gt;o&lt;/mi&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo&gt;/&lt;/mo&gt;&lt;/mrow&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mover&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mtext mathvariant=&quot;bold&quot;&gt;u&lt;/mtext&gt;&lt;/mrow&gt;&lt;mo stretchy=&quot;false&quot;&gt;&amp;#x007E;&lt;/mo&gt;&lt;/mover&gt;&lt;/mrow&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo&gt;/&lt;/mo&gt;&lt;/mrow&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;/mtable&gt;&lt;mo&gt;]&lt;/mo&gt;&lt;/mrow&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-7339" style="width: 9.246em; display: inline-block;"><span style="display: inline-block; position: relative; width: 7.447em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(1.678em, 1007.2em, 4.532em, -999.997em); top: -3.347em; left: 0em;"><span class="mrow" id="MathJax-Span-7340"><span class="mi" id="MathJax-Span-7341" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-7342" style="font-family: MathJax_Main; padding-left: 0.251em;">=</span><span class="mrow" id="MathJax-Span-7343" style="padding-left: 0.251em;"><span class="mo" id="MathJax-Span-7344" style="vertical-align: 0em;"><span style="font-family: MathJax_Size3;">[</span></span><span class="mtable" id="MathJax-Span-7345" style="padding-right: 0.189em; padding-left: 0.189em;"><span style="display: inline-block; position: relative; width: 4.283em; height: 0px;"><span style="position: absolute; clip: rect(2.36em, 1004.22em, 5.152em, -999.997em); top: -3.967em; left: 0em;"><span style="display: inline-block; position: relative; width: 4.283em; height: 0px;"><span style="position: absolute; clip: rect(3.043em, 1003.54em, 4.408em, -999.997em); top: -4.65em; left: 50%; margin-left: -1.796em;"><span class="mtd" id="MathJax-Span-7346"><span class="mrow" id="MathJax-Span-7347"><span class="mi" id="MathJax-Span-7348" style="font-family: MathJax_Math-italic;">c</span><span class="mi" id="MathJax-Span-7349" style="font-family: MathJax_Math-italic;">o</span><span class="mi" id="MathJax-Span-7350" style="font-family: MathJax_Math-italic;">s</span><span class="mo" id="MathJax-Span-7351" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-7352" style="font-family: MathJax_Math-italic;">θ</span><span class="texatom" id="MathJax-Span-7353"><span class="mrow" id="MathJax-Span-7354"><span class="mo" id="MathJax-Span-7355" style="font-family: MathJax_Main;">/</span></span></span><span class="mn" id="MathJax-Span-7356" style="font-family: MathJax_Main;">2</span><span class="mo" id="MathJax-Span-7357" style="font-family: MathJax_Main;">)</span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.043em, 1004.22em, 4.408em, -999.997em); top: -3.223em; left: 50%; margin-left: -2.168em;"><span class="mtd" id="MathJax-Span-7358"><span class="mrow" id="MathJax-Span-7359"><span class="texatom" id="MathJax-Span-7360"><span class="mrow" id="MathJax-Span-7361"><span class="munderover" id="MathJax-Span-7362"><span style="display: inline-block; position: relative; width: 0.623em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.62em, 4.159em, -999.997em); top: -3.967em; left: 0em;"><span class="texatom" id="MathJax-Span-7363"><span class="mrow" id="MathJax-Span-7364"><span class="mtext" id="MathJax-Span-7365" style="font-family: MathJax_Main-bold;">u</span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.477em, 1000.44em, 3.973em, -999.997em); top: -4.339em; left: 0.065em;"><span class="mo" id="MathJax-Span-7366" style="font-family: MathJax_Main;">~</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span></span><span class="mi" id="MathJax-Span-7367" style="font-family: MathJax_Math-italic;">s</span><span class="mi" id="MathJax-Span-7368" style="font-family: MathJax_Math-italic;">i</span><span class="mi" id="MathJax-Span-7369" style="font-family: MathJax_Math-italic;">n</span><span class="mo" id="MathJax-Span-7370" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-7371" style="font-family: MathJax_Math-italic;">θ</span><span class="texatom" id="MathJax-Span-7372"><span class="mrow" id="MathJax-Span-7373"><span class="mo" id="MathJax-Span-7374" style="font-family: MathJax_Main;">/</span></span></span><span class="mn" id="MathJax-Span-7375" style="font-family: MathJax_Main;">2</span><span class="mo" id="MathJax-Span-7376" style="font-family: MathJax_Main;">)</span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="mo" id="MathJax-Span-7377" style="vertical-align: 0em;"><span style="font-family: MathJax_Size3;">]</span></span></span></span><span style="display: inline-block; width: 0px; height: 3.353em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -1.304em; border-left: 0px solid; width: 0px; height: 3.235em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>q</mi><mo>=</mo><mrow><mo>[</mo><mtable rowspacing="4pt" columnspacing="1em"><mtr><mtd><mi>c</mi><mi>o</mi><mi>s</mi><mo stretchy="false">(</mo><mi>θ</mi><mrow class="MJX-TeXAtom-ORD"><mo>/</mo></mrow><mn>2</mn><mo stretchy="false">)</mo></mtd></mtr><mtr><mtd><mrow class="MJX-TeXAtom-ORD"><mover><mrow class="MJX-TeXAtom-ORD"><mtext mathvariant="bold">u</mtext></mrow><mo stretchy="false">~</mo></mover></mrow><mi>s</mi><mi>i</mi><mi>n</mi><mo stretchy="false">(</mo><mi>θ</mi><mrow class="MJX-TeXAtom-ORD"><mo>/</mo></mrow><mn>2</mn><mo stretchy="false">)</mo></mtd></mtr></mtable><mo>]</mo></mrow></math></span></span><script type="math/tex" id="MathJax-Element-213">q=\begin{bmatrix} cos(\theta/2) \\ \tilde{\textbf{u}}sin(\theta/2) \end{bmatrix}</script></p>
<p>Then,</p>
<p style="text-align: center;"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-214-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msup&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mo&gt;&amp;#x2032;&lt;/mo&gt;&lt;/msup&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo&gt;&amp;#x2297;&lt;/mo&gt;&lt;/mrow&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo&gt;&amp;#x2297;&lt;/mo&gt;&lt;/mrow&gt;&lt;msup&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mo&gt;&amp;#x2217;&lt;/mo&gt;&lt;/msup&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-7378" style="width: 6.703em; display: inline-block;"><span style="display: inline-block; position: relative; width: 5.4em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(1.43em, 1005.4em, 2.733em, -999.997em); top: -2.354em; left: 0em;"><span class="mrow" id="MathJax-Span-7379"><span class="msup" id="MathJax-Span-7380"><span style="display: inline-block; position: relative; width: 0.748em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.44em, 4.159em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-7381" style="font-family: MathJax_Math-italic;">r</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -4.339em; left: 0.437em;"><span class="mo" id="MathJax-Span-7382" style="font-size: 70.7%; font-family: MathJax_Main;">′</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="mo" id="MathJax-Span-7383" style="font-family: MathJax_Main; padding-left: 0.251em;">=</span><span class="mi" id="MathJax-Span-7384" style="font-family: MathJax_Math-italic; padding-left: 0.251em;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="texatom" id="MathJax-Span-7385"><span class="mrow" id="MathJax-Span-7386"><span class="mo" id="MathJax-Span-7387" style="font-family: MathJax_Main;">⊗</span></span></span><span class="mi" id="MathJax-Span-7388" style="font-family: MathJax_Math-italic;">r</span><span class="texatom" id="MathJax-Span-7389"><span class="mrow" id="MathJax-Span-7390"><span class="mo" id="MathJax-Span-7391" style="font-family: MathJax_Main;">⊗</span></span></span><span class="msubsup" id="MathJax-Span-7392"><span style="display: inline-block; position: relative; width: 0.934em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.44em, 4.346em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-7393" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -4.339em; left: 0.499em;"><span class="mo" id="MathJax-Span-7394" style="font-size: 70.7%; font-family: MathJax_Main;">∗</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.36em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.304em; border-left: 0px solid; width: 0px; height: 1.312em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup><mi>r</mi><mo>′</mo></msup><mo>=</mo><mi>q</mi><mrow class="MJX-TeXAtom-ORD"><mo>⊗</mo></mrow><mi>r</mi><mrow class="MJX-TeXAtom-ORD"><mo>⊗</mo></mrow><msup><mi>q</mi><mo>∗</mo></msup></math></span></span><script type="math/tex" id="MathJax-Element-214">r’=q{\otimes}r{\otimes}q^*</script></p>
<p>refers to a rotation of the vector r, <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-215-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-7395" style="width: 0.623em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.499em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(1.492em, 1000.5em, 2.547em, -999.997em); top: -2.354em; left: 0em;"><span class="mrow" id="MathJax-Span-7396"><span class="mi" id="MathJax-Span-7397" style="font-family: MathJax_Math-italic;">θ</span></span><span style="display: inline-block; width: 0px; height: 2.36em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.073em; border-left: 0px solid; width: 0px; height: 1.081em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>θ</mi></math></span></span><script type="math/tex" id="MathJax-Element-215">\theta</script> degrees about the vector <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-216-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mover&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mtext mathvariant=&quot;bold&quot;&gt;u&lt;/mtext&gt;&lt;/mrow&gt;&lt;mo stretchy=&quot;false&quot;&gt;&amp;#x007E;&lt;/mo&gt;&lt;/mover&gt;&lt;/mrow&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-7398" style="width: 0.81em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.623em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(1.492em, 1000.62em, 2.547em, -999.997em); top: -2.354em; left: 0em;"><span class="mrow" id="MathJax-Span-7399"><span class="texatom" id="MathJax-Span-7400"><span class="mrow" id="MathJax-Span-7401"><span class="munderover" id="MathJax-Span-7402"><span style="display: inline-block; position: relative; width: 0.623em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.62em, 4.159em, -999.997em); top: -3.967em; left: 0em;"><span class="texatom" id="MathJax-Span-7403"><span class="mrow" id="MathJax-Span-7404"><span class="mtext" id="MathJax-Span-7405" style="font-family: MathJax_Main-bold;">u</span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.477em, 1000.44em, 3.973em, -999.997em); top: -4.339em; left: 0.065em;"><span class="mo" id="MathJax-Span-7406" style="font-family: MathJax_Main;">~</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.36em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.073em; border-left: 0px solid; width: 0px; height: 1.081em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow class="MJX-TeXAtom-ORD"><mover><mrow class="MJX-TeXAtom-ORD"><mtext mathvariant="bold">u</mtext></mrow><mo stretchy="false">~</mo></mover></mrow></math></span></span><script type="math/tex" id="MathJax-Element-216">\tilde{\textbf{u}}</script>. <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-217-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msup&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mo&gt;&amp;#x2032;&lt;/mo&gt;&lt;/msup&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-7407" style="width: 0.934em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.748em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(1.43em, 1000.75em, 2.547em, -999.997em); top: -2.354em; left: 0em;"><span class="mrow" id="MathJax-Span-7408"><span class="msup" id="MathJax-Span-7409"><span style="display: inline-block; position: relative; width: 0.748em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.44em, 4.159em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-7410" style="font-family: MathJax_Math-italic;">r</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -4.339em; left: 0.437em;"><span class="mo" id="MathJax-Span-7411" style="font-size: 70.7%; font-family: MathJax_Main;">′</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.36em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.073em; border-left: 0px solid; width: 0px; height: 1.081em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup><mi>r</mi><mo>′</mo></msup></math></span></span><script type="math/tex" id="MathJax-Element-217">r’</script> is thus the rotated vector. The above can once again be written as a matrix multiplication instead of a quaternion multiplication. The math is tedious so I am just going to post the result once again. You can always try deriving it yourself if you don’t believe (: Anyway, the matrix equivalent of the above is</p>
<p style="text-align: center;"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-218-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msup&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mo&gt;&amp;#x2032;&lt;/mo&gt;&lt;/msup&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;C&lt;/mi&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-7412" style="width: 4.097em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.291em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(1.43em, 1003.29em, 2.547em, -999.997em); top: -2.354em; left: 0em;"><span class="mrow" id="MathJax-Span-7413"><span class="msup" id="MathJax-Span-7414"><span style="display: inline-block; position: relative; width: 0.748em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.44em, 4.159em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-7415" style="font-family: MathJax_Math-italic;">r</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -4.339em; left: 0.437em;"><span class="mo" id="MathJax-Span-7416" style="font-size: 70.7%; font-family: MathJax_Main;">′</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="mo" id="MathJax-Span-7417" style="font-family: MathJax_Main; padding-left: 0.251em;">=</span><span class="mi" id="MathJax-Span-7418" style="font-family: MathJax_Math-italic; padding-left: 0.251em;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.065em;"></span></span><span class="mi" id="MathJax-Span-7419" style="font-family: MathJax_Math-italic;">r</span></span><span style="display: inline-block; width: 0px; height: 2.36em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.073em; border-left: 0px solid; width: 0px; height: 1.158em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup><mi>r</mi><mo>′</mo></msup><mo>=</mo><mi>C</mi><mi>r</mi></math></span></span><script type="math/tex" id="MathJax-Element-218">r’=Cr</script>&nbsp; &nbsp; &nbsp;——————–&nbsp; &nbsp; &nbsp;(1)</p>
<p>where</p>
<p style="text-align: left;"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-219-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;C&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mrow&gt;&lt;mo&gt;[&lt;/mo&gt;&lt;mtable rowspacing=&quot;4pt&quot; columnspacing=&quot;1em&quot;&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;msubsup&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msubsup&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;msubsup&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msubsup&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;msubsup&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msubsup&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;msubsup&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mn&gt;3&lt;/mn&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msubsup&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;msub&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msub&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/msub&gt;&lt;msub&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mn&gt;3&lt;/mn&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;msub&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mn&gt;3&lt;/mn&gt;&lt;/msub&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/msub&gt;&lt;msub&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;msub&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msub&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/msub&gt;&lt;msub&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mn&gt;3&lt;/mn&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;msubsup&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msubsup&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;msubsup&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msubsup&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;msubsup&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msubsup&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;msubsup&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mn&gt;3&lt;/mn&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msubsup&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msub&gt;&lt;msub&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mn&gt;3&lt;/mn&gt;&lt;/msub&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/msub&gt;&lt;msub&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;msub&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mn&gt;3&lt;/mn&gt;&lt;/msub&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/msub&gt;&lt;msub&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msub&gt;&lt;msub&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mn&gt;3&lt;/mn&gt;&lt;/msub&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/msub&gt;&lt;msub&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;msubsup&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msubsup&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;msubsup&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msubsup&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;msubsup&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msubsup&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;msubsup&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mn&gt;3&lt;/mn&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msubsup&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;/mtable&gt;&lt;mo&gt;]&lt;/mo&gt;&lt;/mrow&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-7420" style="width: 35.549em; display: inline-block;"><span style="display: inline-block; position: relative; width: 28.663em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(2.174em, 1028.35em, 6.765em, -999.997em); top: -4.712em; left: 0em;"><span class="mrow" id="MathJax-Span-7421"><span class="mi" id="MathJax-Span-7422" style="font-family: MathJax_Math-italic;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.065em;"></span></span><span class="mo" id="MathJax-Span-7423" style="font-family: MathJax_Main; padding-left: 0.251em;">=</span><span class="mrow" id="MathJax-Span-7424" style="padding-left: 0.251em;"><span class="mo" id="MathJax-Span-7425" style="vertical-align: 2.36em;"><span style="display: inline-block; position: relative; width: 0.685em; height: 0px;"><span style="position: absolute; font-family: MathJax_Size4; top: -2.788em; left: 0em;">⎡<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; font-family: MathJax_Size4; top: -0.369em; left: 0em;">⎣<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -1.734em; left: 0em;">⎢<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -1.362em; left: 0em;">⎢<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="mtable" id="MathJax-Span-7426" style="padding-right: 0.189em; padding-left: 0.189em;"><span style="display: inline-block; position: relative; width: 24.817em; height: 0px;"><span style="position: absolute; clip: rect(2.609em, 1007.63em, 7.137em, -999.997em); top: -5.146em; left: 0em;"><span style="display: inline-block; position: relative; width: 7.633em; height: 0px;"><span style="position: absolute; clip: rect(2.981em, 1007.63em, 4.47em, -999.997em); top: -5.518em; left: 50%; margin-left: -3.781em;"><span class="mtd" id="MathJax-Span-7427"><span class="mrow" id="MathJax-Span-7428"><span class="msubsup" id="MathJax-Span-7429"><span style="display: inline-block; position: relative; width: 0.934em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.44em, 4.346em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-7430" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.291em, 1000.44em, 4.159em, -999.997em); top: -4.339em; left: 0.499em;"><span class="mn" id="MathJax-Span-7431" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.291em, 1000.44em, 4.159em, -999.997em); top: -3.657em; left: 0.437em;"><span class="mn" id="MathJax-Span-7432" style="font-size: 70.7%; font-family: MathJax_Main;">0</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="mo" id="MathJax-Span-7433" style="font-family: MathJax_Main; padding-left: 0.251em;">+</span><span class="msubsup" id="MathJax-Span-7434" style="padding-left: 0.251em;"><span style="display: inline-block; position: relative; width: 0.934em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.44em, 4.346em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-7435" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.291em, 1000.44em, 4.159em, -999.997em); top: -4.339em; left: 0.499em;"><span class="mn" id="MathJax-Span-7436" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.291em, 1000.44em, 4.159em, -999.997em); top: -3.657em; left: 0.437em;"><span class="mn" id="MathJax-Span-7437" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="mo" id="MathJax-Span-7438" style="font-family: MathJax_Main; padding-left: 0.251em;">−</span><span class="msubsup" id="MathJax-Span-7439" style="padding-left: 0.251em;"><span style="display: inline-block; position: relative; width: 0.934em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.44em, 4.346em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-7440" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.291em, 1000.44em, 4.159em, -999.997em); top: -4.339em; left: 0.499em;"><span class="mn" id="MathJax-Span-7441" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.291em, 1000.44em, 4.159em, -999.997em); top: -3.657em; left: 0.437em;"><span class="mn" id="MathJax-Span-7442" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="mo" id="MathJax-Span-7443" style="font-family: MathJax_Main; padding-left: 0.251em;">−</span><span class="msubsup" id="MathJax-Span-7444" style="padding-left: 0.251em;"><span style="display: inline-block; position: relative; width: 0.934em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.44em, 4.346em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-7445" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.291em, 1000.44em, 4.159em, -999.997em); top: -4.339em; left: 0.499em;"><span class="mn" id="MathJax-Span-7446" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.291em, 1000.44em, 4.159em, -999.997em); top: -3.657em; left: 0.437em;"><span class="mn" id="MathJax-Span-7447" style="font-size: 70.7%; font-family: MathJax_Main;">3</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.043em, 1005.96em, 4.408em, -999.997em); top: -3.967em; left: 50%; margin-left: -3.037em;"><span class="mtd" id="MathJax-Span-7484"><span class="mrow" id="MathJax-Span-7485"><span class="mn" id="MathJax-Span-7486" style="font-family: MathJax_Main;">2</span><span class="mo" id="MathJax-Span-7487" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-7488"><span style="display: inline-block; position: relative; width: 0.872em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.44em, 4.346em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-7489" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.437em;"><span class="mn" id="MathJax-Span-7490" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-7491"><span style="display: inline-block; position: relative; width: 0.872em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.44em, 4.346em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-7492" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.437em;"><span class="mn" id="MathJax-Span-7493" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="mo" id="MathJax-Span-7494" style="font-family: MathJax_Main; padding-left: 0.251em;">+</span><span class="msubsup" id="MathJax-Span-7495" style="padding-left: 0.251em;"><span style="display: inline-block; position: relative; width: 0.872em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.44em, 4.346em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-7496" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.437em;"><span class="mn" id="MathJax-Span-7497" style="font-size: 70.7%; font-family: MathJax_Main;">0</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-7498"><span style="display: inline-block; position: relative; width: 0.872em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.44em, 4.346em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-7499" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.437em;"><span class="mn" id="MathJax-Span-7500" style="font-size: 70.7%; font-family: MathJax_Main;">3</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="mo" id="MathJax-Span-7501" style="font-family: MathJax_Main;">)</span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.043em, 1005.96em, 4.408em, -999.997em); top: -2.416em; left: 50%; margin-left: -3.037em;"><span class="mtd" id="MathJax-Span-7541"><span class="mrow" id="MathJax-Span-7542"><span class="mn" id="MathJax-Span-7543" style="font-family: MathJax_Main;">2</span><span class="mo" id="MathJax-Span-7544" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-7545"><span style="display: inline-block; position: relative; width: 0.872em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.44em, 4.346em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-7546" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.437em;"><span class="mn" id="MathJax-Span-7547" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-7548"><span style="display: inline-block; position: relative; width: 0.872em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.44em, 4.346em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-7549" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.437em;"><span class="mn" id="MathJax-Span-7550" style="font-size: 70.7%; font-family: MathJax_Main;">3</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="mo" id="MathJax-Span-7551" style="font-family: MathJax_Main; padding-left: 0.251em;">−</span><span class="msubsup" id="MathJax-Span-7552" style="padding-left: 0.251em;"><span style="display: inline-block; position: relative; width: 0.872em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.44em, 4.346em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-7553" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.437em;"><span class="mn" id="MathJax-Span-7554" style="font-size: 70.7%; font-family: MathJax_Main;">0</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-7555"><span style="display: inline-block; position: relative; width: 0.872em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.44em, 4.346em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-7556" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.437em;"><span class="mn" id="MathJax-Span-7557" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="mo" id="MathJax-Span-7558" style="font-family: MathJax_Main;">)</span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span><span style="display: inline-block; width: 0px; height: 5.152em;"></span></span><span style="position: absolute; clip: rect(2.609em, 1007.63em, 7.075em, -999.997em); top: -5.084em; left: 8.626em;"><span style="display: inline-block; position: relative; width: 7.633em; height: 0px;"><span style="position: absolute; clip: rect(3.043em, 1005.96em, 4.408em, -999.997em); top: -5.518em; left: 50%; margin-left: -3.037em;"><span class="mtd" id="MathJax-Span-7448"><span class="mrow" id="MathJax-Span-7449"><span class="mn" id="MathJax-Span-7450" style="font-family: MathJax_Main;">2</span><span class="mo" id="MathJax-Span-7451" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-7452"><span style="display: inline-block; position: relative; width: 0.872em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.44em, 4.346em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-7453" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.437em;"><span class="mn" id="MathJax-Span-7454" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-7455"><span style="display: inline-block; position: relative; width: 0.872em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.44em, 4.346em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-7456" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.437em;"><span class="mn" id="MathJax-Span-7457" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="mo" id="MathJax-Span-7458" style="font-family: MathJax_Main; padding-left: 0.251em;">−</span><span class="msubsup" id="MathJax-Span-7459" style="padding-left: 0.251em;"><span style="display: inline-block; position: relative; width: 0.872em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.44em, 4.346em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-7460" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.437em;"><span class="mn" id="MathJax-Span-7461" style="font-size: 70.7%; font-family: MathJax_Main;">0</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-7462"><span style="display: inline-block; position: relative; width: 0.872em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.44em, 4.346em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-7463" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.437em;"><span class="mn" id="MathJax-Span-7464" style="font-size: 70.7%; font-family: MathJax_Main;">3</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="mo" id="MathJax-Span-7465" style="font-family: MathJax_Main;">)</span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(2.981em, 1007.63em, 4.47em, -999.997em); top: -3.967em; left: 50%; margin-left: -3.781em;"><span class="mtd" id="MathJax-Span-7502"><span class="mrow" id="MathJax-Span-7503"><span class="msubsup" id="MathJax-Span-7504"><span style="display: inline-block; position: relative; width: 0.934em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.44em, 4.346em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-7505" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.291em, 1000.44em, 4.159em, -999.997em); top: -4.339em; left: 0.499em;"><span class="mn" id="MathJax-Span-7506" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.291em, 1000.44em, 4.159em, -999.997em); top: -3.657em; left: 0.437em;"><span class="mn" id="MathJax-Span-7507" style="font-size: 70.7%; font-family: MathJax_Main;">0</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="mo" id="MathJax-Span-7508" style="font-family: MathJax_Main; padding-left: 0.251em;">−</span><span class="msubsup" id="MathJax-Span-7509" style="padding-left: 0.251em;"><span style="display: inline-block; position: relative; width: 0.934em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.44em, 4.346em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-7510" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.291em, 1000.44em, 4.159em, -999.997em); top: -4.339em; left: 0.499em;"><span class="mn" id="MathJax-Span-7511" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.291em, 1000.44em, 4.159em, -999.997em); top: -3.657em; left: 0.437em;"><span class="mn" id="MathJax-Span-7512" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="mo" id="MathJax-Span-7513" style="font-family: MathJax_Main; padding-left: 0.251em;">+</span><span class="msubsup" id="MathJax-Span-7514" style="padding-left: 0.251em;"><span style="display: inline-block; position: relative; width: 0.934em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.44em, 4.346em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-7515" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.291em, 1000.44em, 4.159em, -999.997em); top: -4.339em; left: 0.499em;"><span class="mn" id="MathJax-Span-7516" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.291em, 1000.44em, 4.159em, -999.997em); top: -3.657em; left: 0.437em;"><span class="mn" id="MathJax-Span-7517" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="mo" id="MathJax-Span-7518" style="font-family: MathJax_Main; padding-left: 0.251em;">−</span><span class="msubsup" id="MathJax-Span-7519" style="padding-left: 0.251em;"><span style="display: inline-block; position: relative; width: 0.934em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.44em, 4.346em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-7520" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.291em, 1000.44em, 4.159em, -999.997em); top: -4.339em; left: 0.499em;"><span class="mn" id="MathJax-Span-7521" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.291em, 1000.44em, 4.159em, -999.997em); top: -3.657em; left: 0.437em;"><span class="mn" id="MathJax-Span-7522" style="font-size: 70.7%; font-family: MathJax_Main;">3</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.043em, 1005.96em, 4.408em, -999.997em); top: -2.416em; left: 50%; margin-left: -3.037em;"><span class="mtd" id="MathJax-Span-7559"><span class="mrow" id="MathJax-Span-7560"><span class="mn" id="MathJax-Span-7561" style="font-family: MathJax_Main;">2</span><span class="mo" id="MathJax-Span-7562" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-7563"><span style="display: inline-block; position: relative; width: 0.872em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.44em, 4.346em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-7564" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.437em;"><span class="mn" id="MathJax-Span-7565" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-7566"><span style="display: inline-block; position: relative; width: 0.872em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.44em, 4.346em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-7567" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.437em;"><span class="mn" id="MathJax-Span-7568" style="font-size: 70.7%; font-family: MathJax_Main;">3</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="mo" id="MathJax-Span-7569" style="font-family: MathJax_Main; padding-left: 0.251em;">+</span><span class="msubsup" id="MathJax-Span-7570" style="padding-left: 0.251em;"><span style="display: inline-block; position: relative; width: 0.872em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.44em, 4.346em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-7571" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.437em;"><span class="mn" id="MathJax-Span-7572" style="font-size: 70.7%; font-family: MathJax_Main;">0</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-7573"><span style="display: inline-block; position: relative; width: 0.872em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.44em, 4.346em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-7574" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.437em;"><span class="mn" id="MathJax-Span-7575" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="mo" id="MathJax-Span-7576" style="font-family: MathJax_Main;">)</span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span><span style="display: inline-block; width: 0px; height: 5.09em;"></span></span><span style="position: absolute; clip: rect(2.671em, 1007.63em, 7.199em, -999.997em); top: -5.146em; left: 17.249em;"><span style="display: inline-block; position: relative; width: 7.633em; height: 0px;"><span style="position: absolute; clip: rect(3.043em, 1005.96em, 4.408em, -999.997em); top: -5.518em; left: 50%; margin-left: -3.037em;"><span class="mtd" id="MathJax-Span-7466"><span class="mrow" id="MathJax-Span-7467"><span class="mn" id="MathJax-Span-7468" style="font-family: MathJax_Main;">2</span><span class="mo" id="MathJax-Span-7469" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-7470"><span style="display: inline-block; position: relative; width: 0.872em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.44em, 4.346em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-7471" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.437em;"><span class="mn" id="MathJax-Span-7472" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-7473"><span style="display: inline-block; position: relative; width: 0.872em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.44em, 4.346em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-7474" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.437em;"><span class="mn" id="MathJax-Span-7475" style="font-size: 70.7%; font-family: MathJax_Main;">3</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="mo" id="MathJax-Span-7476" style="font-family: MathJax_Main; padding-left: 0.251em;">+</span><span class="msubsup" id="MathJax-Span-7477" style="padding-left: 0.251em;"><span style="display: inline-block; position: relative; width: 0.872em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.44em, 4.346em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-7478" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.437em;"><span class="mn" id="MathJax-Span-7479" style="font-size: 70.7%; font-family: MathJax_Main;">0</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-7480"><span style="display: inline-block; position: relative; width: 0.872em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.44em, 4.346em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-7481" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.437em;"><span class="mn" id="MathJax-Span-7482" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="mo" id="MathJax-Span-7483" style="font-family: MathJax_Main;">)</span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.043em, 1005.96em, 4.408em, -999.997em); top: -3.967em; left: 50%; margin-left: -3.037em;"><span class="mtd" id="MathJax-Span-7523"><span class="mrow" id="MathJax-Span-7524"><span class="mn" id="MathJax-Span-7525" style="font-family: MathJax_Main;">2</span><span class="mo" id="MathJax-Span-7526" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-7527"><span style="display: inline-block; position: relative; width: 0.872em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.44em, 4.346em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-7528" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.437em;"><span class="mn" id="MathJax-Span-7529" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-7530"><span style="display: inline-block; position: relative; width: 0.872em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.44em, 4.346em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-7531" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.437em;"><span class="mn" id="MathJax-Span-7532" style="font-size: 70.7%; font-family: MathJax_Main;">3</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="mo" id="MathJax-Span-7533" style="font-family: MathJax_Main; padding-left: 0.251em;">−</span><span class="msubsup" id="MathJax-Span-7534" style="padding-left: 0.251em;"><span style="display: inline-block; position: relative; width: 0.872em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.44em, 4.346em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-7535" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.437em;"><span class="mn" id="MathJax-Span-7536" style="font-size: 70.7%; font-family: MathJax_Main;">0</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-7537"><span style="display: inline-block; position: relative; width: 0.872em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.44em, 4.346em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-7538" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.437em;"><span class="mn" id="MathJax-Span-7539" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="mo" id="MathJax-Span-7540" style="font-family: MathJax_Main;">)</span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(2.981em, 1007.63em, 4.47em, -999.997em); top: -2.416em; left: 50%; margin-left: -3.781em;"><span class="mtd" id="MathJax-Span-7577"><span class="mrow" id="MathJax-Span-7578"><span class="msubsup" id="MathJax-Span-7579"><span style="display: inline-block; position: relative; width: 0.934em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.44em, 4.346em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-7580" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.291em, 1000.44em, 4.159em, -999.997em); top: -4.339em; left: 0.499em;"><span class="mn" id="MathJax-Span-7581" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.291em, 1000.44em, 4.159em, -999.997em); top: -3.657em; left: 0.437em;"><span class="mn" id="MathJax-Span-7582" style="font-size: 70.7%; font-family: MathJax_Main;">0</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="mo" id="MathJax-Span-7583" style="font-family: MathJax_Main; padding-left: 0.251em;">−</span><span class="msubsup" id="MathJax-Span-7584" style="padding-left: 0.251em;"><span style="display: inline-block; position: relative; width: 0.934em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.44em, 4.346em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-7585" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.291em, 1000.44em, 4.159em, -999.997em); top: -4.339em; left: 0.499em;"><span class="mn" id="MathJax-Span-7586" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.291em, 1000.44em, 4.159em, -999.997em); top: -3.657em; left: 0.437em;"><span class="mn" id="MathJax-Span-7587" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="mo" id="MathJax-Span-7588" style="font-family: MathJax_Main; padding-left: 0.251em;">−</span><span class="msubsup" id="MathJax-Span-7589" style="padding-left: 0.251em;"><span style="display: inline-block; position: relative; width: 0.934em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.44em, 4.346em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-7590" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.291em, 1000.44em, 4.159em, -999.997em); top: -4.339em; left: 0.499em;"><span class="mn" id="MathJax-Span-7591" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.291em, 1000.44em, 4.159em, -999.997em); top: -3.657em; left: 0.437em;"><span class="mn" id="MathJax-Span-7592" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="mo" id="MathJax-Span-7593" style="font-family: MathJax_Main; padding-left: 0.251em;">+</span><span class="msubsup" id="MathJax-Span-7594" style="padding-left: 0.251em;"><span style="display: inline-block; position: relative; width: 0.934em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.44em, 4.346em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-7595" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.291em, 1000.44em, 4.159em, -999.997em); top: -4.339em; left: 0.499em;"><span class="mn" id="MathJax-Span-7596" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.291em, 1000.44em, 4.159em, -999.997em); top: -3.657em; left: 0.437em;"><span class="mn" id="MathJax-Span-7597" style="font-size: 70.7%; font-family: MathJax_Main;">3</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span><span style="display: inline-block; width: 0px; height: 5.152em;"></span></span></span></span><span class="mo" id="MathJax-Span-7598" style="vertical-align: 2.36em;"><span style="display: inline-block; position: relative; width: 0.685em; height: 0px;"><span style="position: absolute; font-family: MathJax_Size4; top: -2.788em; left: 0em;">⎤<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; font-family: MathJax_Size4; top: -0.369em; left: 0em;">⎦<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -1.734em; left: 0em;">⎥<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -1.362em; left: 0em;">⎥<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.718em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -2.381em; border-left: 0px solid; width: 0px; height: 5.388em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>C</mi><mo>=</mo><mrow><mo>[</mo><mtable rowspacing="4pt" columnspacing="1em"><mtr><mtd><msubsup><mi>q</mi><mn>0</mn><mn>2</mn></msubsup><mo>+</mo><msubsup><mi>q</mi><mn>1</mn><mn>2</mn></msubsup><mo>−</mo><msubsup><mi>q</mi><mn>2</mn><mn>2</mn></msubsup><mo>−</mo><msubsup><mi>q</mi><mn>3</mn><mn>2</mn></msubsup></mtd><mtd><mn>2</mn><mo stretchy="false">(</mo><msub><mi>q</mi><mn>1</mn></msub><msub><mi>q</mi><mn>2</mn></msub><mo>−</mo><msub><mi>q</mi><mn>0</mn></msub><msub><mi>q</mi><mn>3</mn></msub><mo stretchy="false">)</mo></mtd><mtd><mn>2</mn><mo stretchy="false">(</mo><msub><mi>q</mi><mn>1</mn></msub><msub><mi>q</mi><mn>3</mn></msub><mo>+</mo><msub><mi>q</mi><mn>0</mn></msub><msub><mi>q</mi><mn>2</mn></msub><mo stretchy="false">)</mo></mtd></mtr><mtr><mtd><mn>2</mn><mo stretchy="false">(</mo><msub><mi>q</mi><mn>1</mn></msub><msub><mi>q</mi><mn>2</mn></msub><mo>+</mo><msub><mi>q</mi><mn>0</mn></msub><msub><mi>q</mi><mn>3</mn></msub><mo stretchy="false">)</mo></mtd><mtd><msubsup><mi>q</mi><mn>0</mn><mn>2</mn></msubsup><mo>−</mo><msubsup><mi>q</mi><mn>1</mn><mn>2</mn></msubsup><mo>+</mo><msubsup><mi>q</mi><mn>2</mn><mn>2</mn></msubsup><mo>−</mo><msubsup><mi>q</mi><mn>3</mn><mn>2</mn></msubsup></mtd><mtd><mn>2</mn><mo stretchy="false">(</mo><msub><mi>q</mi><mn>2</mn></msub><msub><mi>q</mi><mn>3</mn></msub><mo>−</mo><msub><mi>q</mi><mn>0</mn></msub><msub><mi>q</mi><mn>1</mn></msub><mo stretchy="false">)</mo></mtd></mtr><mtr><mtd><mn>2</mn><mo stretchy="false">(</mo><msub><mi>q</mi><mn>1</mn></msub><msub><mi>q</mi><mn>3</mn></msub><mo>−</mo><msub><mi>q</mi><mn>0</mn></msub><msub><mi>q</mi><mn>2</mn></msub><mo stretchy="false">)</mo></mtd><mtd><mn>2</mn><mo stretchy="false">(</mo><msub><mi>q</mi><mn>2</mn></msub><msub><mi>q</mi><mn>3</mn></msub><mo>+</mo><msub><mi>q</mi><mn>0</mn></msub><msub><mi>q</mi><mn>1</mn></msub><mo stretchy="false">)</mo></mtd><mtd><msubsup><mi>q</mi><mn>0</mn><mn>2</mn></msubsup><mo>−</mo><msubsup><mi>q</mi><mn>1</mn><mn>2</mn></msubsup><mo>−</mo><msubsup><mi>q</mi><mn>2</mn><mn>2</mn></msubsup><mo>+</mo><msubsup><mi>q</mi><mn>3</mn><mn>2</mn></msubsup></mtd></mtr></mtable><mo>]</mo></mrow></math></span></span><script type="math/tex" id="MathJax-Element-219">C=\begin{bmatrix} q_0^2+q_1^2-q_2^2-q_3^2 & 2(q_1q_2-q_0q_3) & 2(q_1q_3+q_0q_2) \\ 2(q_1q_2+q_0q_3) & q_0^2-q_1^2+q_2^2-q_3^2 & 2(q_2q_3-q_0q_1) \\ 2(q_1q_3-q_0q_2) & 2(q_2q_3+q_0q_1) & q_0^2-q_1^2-q_2^2+q_3^2 \end{bmatrix}</script></p>
<p>This matrix form is important because it allows us to make a comparison with the rotation matrix derived from Euler Angles in order to determine the attitude (yaw, pitch, roll) of the object.</p>
<p>Last is the most exciting equation of all.</p>
<p style="text-align: center;"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-220-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mover&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mo&gt;&amp;#x02D9;&lt;/mo&gt;&lt;/mover&gt;&lt;/mrow&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mfrac&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/mfrac&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo&gt;&amp;#x2297;&lt;/mo&gt;&lt;/mrow&gt;&lt;mi&gt;w&lt;/mi&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-7599" style="width: 5.71em; display: inline-block;"><span style="display: inline-block; position: relative; width: 4.594em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(1.306em, 1004.59em, 2.919em, -999.997em); top: -2.354em; left: 0em;"><span class="mrow" id="MathJax-Span-7600"><span class="texatom" id="MathJax-Span-7601"><span class="mrow" id="MathJax-Span-7602"><span class="munderover" id="MathJax-Span-7603"><span style="display: inline-block; position: relative; width: 0.623em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.44em, 4.346em, -999.997em); top: -3.967em; left: 0.003em;"><span class="mi" id="MathJax-Span-7604" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.105em, 1000.31em, 3.601em, -999.997em); top: -4.029em; left: 0.127em;"><span class="mo" id="MathJax-Span-7605" style="font-family: MathJax_Main;">˙</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span></span><span class="mo" id="MathJax-Span-7606" style="font-family: MathJax_Main; padding-left: 0.251em;">=</span><span class="mfrac" id="MathJax-Span-7607" style="padding-left: 0.251em;"><span style="display: inline-block; position: relative; width: 0.499em; height: 0px; margin-right: 0.127em; margin-left: 0.127em;"><span style="position: absolute; clip: rect(3.291em, 1000.31em, 4.159em, -999.997em); top: -4.401em; left: 50%; margin-left: -0.183em;"><span class="mn" id="MathJax-Span-7608" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.291em, 1000.31em, 4.159em, -999.997em); top: -3.595em; left: 50%; margin-left: -0.183em;"><span class="mn" id="MathJax-Span-7609" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(0.81em, 1000.5em, 1.244em, -999.997em); top: -1.3em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 0.499em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.058em;"></span></span></span></span><span class="mi" id="MathJax-Span-7610" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="texatom" id="MathJax-Span-7611"><span class="mrow" id="MathJax-Span-7612"><span class="mo" id="MathJax-Span-7613" style="font-family: MathJax_Main;">⊗</span></span></span><span class="mi" id="MathJax-Span-7614" style="font-family: MathJax_Math-italic;">w</span></span><span style="display: inline-block; width: 0px; height: 2.36em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.535em; border-left: 0px solid; width: 0px; height: 1.773em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow class="MJX-TeXAtom-ORD"><mover><mi>q</mi><mo>˙</mo></mover></mrow><mo>=</mo><mfrac><mn>1</mn><mn>2</mn></mfrac><mi>q</mi><mrow class="MJX-TeXAtom-ORD"><mo>⊗</mo></mrow><mi>w</mi></math></span></span><script type="math/tex" id="MathJax-Element-220">\dot{q}=\frac{1}{2}q{\otimes}w</script></p>
<p>where</p>
<p><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-221-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;w&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;w&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mover&gt;&lt;mi&gt;&amp;#x0131;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;&amp;#x007E;&lt;/mo&gt;&lt;/mover&gt;&lt;/mrow&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;w&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msub&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mover&gt;&lt;mi&gt;&amp;#x0237;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;&amp;#x007E;&lt;/mo&gt;&lt;/mover&gt;&lt;/mrow&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;w&lt;/mi&gt;&lt;mn&gt;3&lt;/mn&gt;&lt;/msub&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mover&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;&amp;#x007E;&lt;/mo&gt;&lt;/mover&gt;&lt;/mrow&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-7615" style="width: 14.023em; display: inline-block;"><span style="display: inline-block; position: relative; width: 11.293em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(1.244em, 1011.29em, 2.733em, -999.997em); top: -2.354em; left: 0em;"><span class="mrow" id="MathJax-Span-7616"><span class="mi" id="MathJax-Span-7617" style="font-family: MathJax_Math-italic;">w</span><span class="mo" id="MathJax-Span-7618" style="font-family: MathJax_Main; padding-left: 0.251em;">=</span><span class="mn" id="MathJax-Span-7619" style="font-family: MathJax_Main; padding-left: 0.251em;">0</span><span class="mo" id="MathJax-Span-7620" style="font-family: MathJax_Main; padding-left: 0.251em;">+</span><span class="msubsup" id="MathJax-Span-7621" style="padding-left: 0.251em;"><span style="display: inline-block; position: relative; width: 1.12em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.68em, 4.159em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-7622" style="font-family: MathJax_Math-italic;">w</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.748em;"><span class="mn" id="MathJax-Span-7623" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="texatom" id="MathJax-Span-7624"><span class="mrow" id="MathJax-Span-7625"><span class="munderover" id="MathJax-Span-7626"><span style="display: inline-block; position: relative; width: 0.561em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.31em, 4.159em, -999.997em); top: -3.967em; left: 0.065em;"><span class="mi" id="MathJax-Span-7627" style="font-family: MathJax_Main-italic;">ı<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.065em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.477em, 1000.44em, 3.973em, -999.997em); top: -4.339em; left: 0.065em;"><span class="mo" id="MathJax-Span-7628" style="font-family: MathJax_Main;">~</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span></span><span class="mo" id="MathJax-Span-7629" style="font-family: MathJax_Main; padding-left: 0.251em;">+</span><span class="msubsup" id="MathJax-Span-7630" style="padding-left: 0.251em;"><span style="display: inline-block; position: relative; width: 1.12em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.68em, 4.159em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-7631" style="font-family: MathJax_Math-italic;">w</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.748em;"><span class="mn" id="MathJax-Span-7632" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="texatom" id="MathJax-Span-7633"><span class="mrow" id="MathJax-Span-7634"><span class="munderover" id="MathJax-Span-7635"><span style="display: inline-block; position: relative; width: 0.499em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.31em, 4.346em, -999.997em); top: -3.967em; left: 0.065em;"><span class="mi" id="MathJax-Span-7636" style="font-family: MathJax_Main-italic;">ȷ</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.477em, 1000.44em, 3.973em, -999.997em); top: -4.339em; left: 0em;"><span class="mo" id="MathJax-Span-7637" style="font-family: MathJax_Main;">~</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span></span><span class="mo" id="MathJax-Span-7638" style="font-family: MathJax_Main; padding-left: 0.251em;">+</span><span class="msubsup" id="MathJax-Span-7639" style="padding-left: 0.251em;"><span style="display: inline-block; position: relative; width: 1.12em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.68em, 4.159em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-7640" style="font-family: MathJax_Math-italic;">w</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.748em;"><span class="mn" id="MathJax-Span-7641" style="font-size: 70.7%; font-family: MathJax_Main;">3</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="texatom" id="MathJax-Span-7642"><span class="mrow" id="MathJax-Span-7643"><span class="munderover" id="MathJax-Span-7644"><span style="display: inline-block; position: relative; width: 0.499em; height: 0px;"><span style="position: absolute; clip: rect(3.105em, 1000.5em, 4.159em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-7645" style="font-family: MathJax_Math-italic;">k</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.477em, 1000.44em, 3.973em, -999.997em); top: -4.587em; left: 0.003em;"><span class="mo" id="MathJax-Span-7646" style="font-family: MathJax_Main;">~</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.36em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.304em; border-left: 0px solid; width: 0px; height: 1.619em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>w</mi><mo>=</mo><mn>0</mn><mo>+</mo><msub><mi>w</mi><mn>1</mn></msub><mrow class="MJX-TeXAtom-ORD"><mover><mi>ı</mi><mo stretchy="false">~</mo></mover></mrow><mo>+</mo><msub><mi>w</mi><mn>2</mn></msub><mrow class="MJX-TeXAtom-ORD"><mover><mi>ȷ</mi><mo stretchy="false">~</mo></mover></mrow><mo>+</mo><msub><mi>w</mi><mn>3</mn></msub><mrow class="MJX-TeXAtom-ORD"><mover><mi>k</mi><mo stretchy="false">~</mo></mover></mrow></math></span></span><script type="math/tex" id="MathJax-Element-221">w=0+w_1\tilde{\imath}+w_2\tilde{\jmath}+w_3\tilde{k}</script></p>
<p><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-222-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;w&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;w&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msub&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;w&lt;/mi&gt;&lt;mn&gt;3&lt;/mn&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-7647" style="width: 5.338em; display: inline-block;"><span style="display: inline-block; position: relative; width: 4.283em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(1.74em, 1004.28em, 2.733em, -999.997em); top: -2.354em; left: 0em;"><span class="mrow" id="MathJax-Span-7648"><span class="msubsup" id="MathJax-Span-7649"><span style="display: inline-block; position: relative; width: 1.12em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.68em, 4.159em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-7650" style="font-family: MathJax_Math-italic;">w</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.748em;"><span class="mn" id="MathJax-Span-7651" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="mo" id="MathJax-Span-7652" style="font-family: MathJax_Main;">,</span><span class="msubsup" id="MathJax-Span-7653" style="padding-left: 0.189em;"><span style="display: inline-block; position: relative; width: 1.12em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.68em, 4.159em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-7654" style="font-family: MathJax_Math-italic;">w</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.748em;"><span class="mn" id="MathJax-Span-7655" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="mo" id="MathJax-Span-7656" style="font-family: MathJax_Main;">,</span><span class="msubsup" id="MathJax-Span-7657" style="padding-left: 0.189em;"><span style="display: inline-block; position: relative; width: 1.12em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.68em, 4.159em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-7658" style="font-family: MathJax_Math-italic;">w</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.748em;"><span class="mn" id="MathJax-Span-7659" style="font-size: 70.7%; font-family: MathJax_Main;">3</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.36em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.304em; border-left: 0px solid; width: 0px; height: 0.927em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>w</mi><mn>1</mn></msub><mo>,</mo><msub><mi>w</mi><mn>2</mn></msub><mo>,</mo><msub><mi>w</mi><mn>3</mn></msub></math></span></span><script type="math/tex" id="MathJax-Element-222">w_1, w_2, w_3</script> is the angular velocity in the x, y and z direction respectively. This equation gives us a way to use the values directly from our gyrometer to transform it into a rotation! Once again, it is more intuitive to work in matrix so we are going to convert the above into matrix from. Notice that the same equation can be expressed in 2 different ways here.</p>
<p style="text-align: center;"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-223-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mover&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mo&gt;&amp;#x02D9;&lt;/mo&gt;&lt;/mover&gt;&lt;/mrow&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mfrac&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/mfrac&gt;&lt;mi&gt;S&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;w&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mfrac&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/mfrac&gt;&lt;mi&gt;S&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mi&gt;w&lt;/mi&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-7660" style="width: 12.348em; display: inline-block;"><span style="display: inline-block; position: relative; width: 9.929em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(1.306em, 1009.93em, 2.919em, -999.997em); top: -2.354em; left: 0em;"><span class="mrow" id="MathJax-Span-7661"><span class="texatom" id="MathJax-Span-7662"><span class="mrow" id="MathJax-Span-7663"><span class="munderover" id="MathJax-Span-7664"><span style="display: inline-block; position: relative; width: 0.623em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.44em, 4.346em, -999.997em); top: -3.967em; left: 0.003em;"><span class="mi" id="MathJax-Span-7665" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.105em, 1000.31em, 3.601em, -999.997em); top: -4.029em; left: 0.127em;"><span class="mo" id="MathJax-Span-7666" style="font-family: MathJax_Main;">˙</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span></span><span class="mo" id="MathJax-Span-7667" style="font-family: MathJax_Main; padding-left: 0.251em;">=</span><span class="mfrac" id="MathJax-Span-7668" style="padding-left: 0.251em;"><span style="display: inline-block; position: relative; width: 0.499em; height: 0px; margin-right: 0.127em; margin-left: 0.127em;"><span style="position: absolute; clip: rect(3.291em, 1000.31em, 4.159em, -999.997em); top: -4.401em; left: 50%; margin-left: -0.183em;"><span class="mn" id="MathJax-Span-7669" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.291em, 1000.31em, 4.159em, -999.997em); top: -3.595em; left: 50%; margin-left: -0.183em;"><span class="mn" id="MathJax-Span-7670" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(0.81em, 1000.5em, 1.244em, -999.997em); top: -1.3em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 0.499em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.058em;"></span></span></span></span><span class="mi" id="MathJax-Span-7671" style="font-family: MathJax_Math-italic;">S<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.065em;"></span></span><span class="mo" id="MathJax-Span-7672" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-7673" style="font-family: MathJax_Math-italic;">w</span><span class="mo" id="MathJax-Span-7674" style="font-family: MathJax_Main;">)</span><span class="mi" id="MathJax-Span-7675" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-7676" style="font-family: MathJax_Main; padding-left: 0.251em;">=</span><span class="mfrac" id="MathJax-Span-7677" style="padding-left: 0.251em;"><span style="display: inline-block; position: relative; width: 0.499em; height: 0px; margin-right: 0.127em; margin-left: 0.127em;"><span style="position: absolute; clip: rect(3.291em, 1000.31em, 4.159em, -999.997em); top: -4.401em; left: 50%; margin-left: -0.183em;"><span class="mn" id="MathJax-Span-7678" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.291em, 1000.31em, 4.159em, -999.997em); top: -3.595em; left: 50%; margin-left: -0.183em;"><span class="mn" id="MathJax-Span-7679" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(0.81em, 1000.5em, 1.244em, -999.997em); top: -1.3em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 0.499em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.058em;"></span></span></span></span><span class="mi" id="MathJax-Span-7680" style="font-family: MathJax_Math-italic;">S<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.065em;"></span></span><span class="mo" id="MathJax-Span-7681" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-7682" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-7683" style="font-family: MathJax_Main;">)</span><span class="mi" id="MathJax-Span-7684" style="font-family: MathJax_Math-italic;">w</span></span><span style="display: inline-block; width: 0px; height: 2.36em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.535em; border-left: 0px solid; width: 0px; height: 1.773em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow class="MJX-TeXAtom-ORD"><mover><mi>q</mi><mo>˙</mo></mover></mrow><mo>=</mo><mfrac><mn>1</mn><mn>2</mn></mfrac><mi>S</mi><mo stretchy="false">(</mo><mi>w</mi><mo stretchy="false">)</mo><mi>q</mi><mo>=</mo><mfrac><mn>1</mn><mn>2</mn></mfrac><mi>S</mi><mo stretchy="false">(</mo><mi>q</mi><mo stretchy="false">)</mo><mi>w</mi></math></span></span><script type="math/tex" id="MathJax-Element-223">\dot{q}=\frac{1}{2}S(w)q=\frac{1}{2}S(q)w</script>&nbsp; &nbsp; &nbsp;——————–&nbsp; &nbsp; &nbsp;(2)</p>
<p>where</p>
<p><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-224-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mtable columnalign=&quot;right left right left right left right left right left right left&quot; rowspacing=&quot;3pt&quot; columnspacing=&quot;0em 2em 0em 2em 0em 2em 0em 2em 0em 2em 0em&quot; displaystyle=&quot;true&quot;&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mi&gt;S&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;w&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mi&gt;&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mrow&gt;&lt;mo&gt;[&lt;/mo&gt;&lt;mtable rowspacing=&quot;4pt&quot; columnspacing=&quot;1em&quot;&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;w&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;w&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;w&lt;/mi&gt;&lt;mn&gt;3&lt;/mn&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mi&gt;w&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mi&gt;w&lt;/mi&gt;&lt;mn&gt;3&lt;/mn&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;w&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mi&gt;w&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;w&lt;/mi&gt;&lt;mn&gt;3&lt;/mn&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mi&gt;w&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mi&gt;w&lt;/mi&gt;&lt;mn&gt;3&lt;/mn&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mi&gt;w&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;w&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;/mtable&gt;&lt;mo&gt;]&lt;/mo&gt;&lt;/mrow&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mi&gt;&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mrow&gt;&lt;mo&gt;[&lt;/mo&gt;&lt;mtable rowspacing=&quot;4pt&quot; columnspacing=&quot;1em&quot;&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mn&gt;3&lt;/mn&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;/mtable&gt;&lt;mo&gt;]&lt;/mo&gt;&lt;/mrow&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mi&gt;S&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mi&gt;&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mrow&gt;&lt;mo&gt;[&lt;/mo&gt;&lt;mtable rowspacing=&quot;4pt&quot; columnspacing=&quot;1em&quot;&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mn&gt;3&lt;/mn&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mn&gt;3&lt;/mn&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mn&gt;3&lt;/mn&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;/mtable&gt;&lt;mo&gt;]&lt;/mo&gt;&lt;/mrow&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mi&gt;w&lt;/mi&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mi&gt;&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mrow&gt;&lt;mo&gt;[&lt;/mo&gt;&lt;mtable rowspacing=&quot;4pt&quot; columnspacing=&quot;1em&quot;&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mi&gt;w&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mi&gt;w&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mi&gt;w&lt;/mi&gt;&lt;mn&gt;3&lt;/mn&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;/mtable&gt;&lt;mo&gt;]&lt;/mo&gt;&lt;/mrow&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;/mtable&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-7685" style="width: 19.11em; display: inline-block;"><span style="display: inline-block; position: relative; width: 15.388em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(-8.248em, 1014.89em, 12.472em, -999.997em); top: -2.354em; left: 0em;"><span class="mrow" id="MathJax-Span-7686"><span class="mtable" id="MathJax-Span-7687" style="padding-right: 0.189em; padding-left: 0.189em;"><span style="display: inline-block; position: relative; width: 15.016em; height: 0px;"><span style="position: absolute; clip: rect(9.06em, 1002.05em, 25.996em, -999.997em); top: -17.553em; left: 0em;"><span style="display: inline-block; position: relative; width: 2.112em; height: 0px;"><span style="position: absolute; clip: rect(3.043em, 1002.05em, 4.408em, -999.997em); top: -11.535em; right: 0em;"><span class="mtd" id="MathJax-Span-7688"><span class="mrow" id="MathJax-Span-7689"><span class="mi" id="MathJax-Span-7690" style="font-family: MathJax_Math-italic;">S<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.065em;"></span></span><span class="mo" id="MathJax-Span-7691" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-7692" style="font-family: MathJax_Math-italic;">w</span><span class="mo" id="MathJax-Span-7693" style="font-family: MathJax_Main;">)</span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.353em, 1000.44em, 4.346em, -999.997em); top: -6.014em; right: 0em;"><span class="mtd" id="MathJax-Span-7780"><span class="mrow" id="MathJax-Span-7781"><span class="mi" id="MathJax-Span-7782" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.043em, 1001.8em, 4.408em, -999.997em); top: -0.493em; right: 0em;"><span class="mtd" id="MathJax-Span-7811"><span class="mrow" id="MathJax-Span-7812"><span class="mi" id="MathJax-Span-7813" style="font-family: MathJax_Math-italic;">S<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.065em;"></span></span><span class="mo" id="MathJax-Span-7814" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-7815" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-7816" style="font-family: MathJax_Main;">)</span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.353em, 1000.68em, 4.159em, -999.997em); top: 4.283em; right: 0em;"><span class="mtd" id="MathJax-Span-7891"><span class="mrow" id="MathJax-Span-7892"><span class="mi" id="MathJax-Span-7893" style="font-family: MathJax_Math-italic;">w</span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span><span style="display: inline-block; width: 0px; height: 17.559em;"></span></span><span style="position: absolute; clip: rect(10.673em, 1012.6em, 31.393em, -999.997em); top: -21.275em; left: 2.112em;"><span style="display: inline-block; position: relative; width: 12.906em; height: 0px;"><span style="position: absolute; clip: rect(3.167em, 1012.6em, 8.75em, -999.997em); top: -13.769em; left: 0em;"><span class="mtd" id="MathJax-Span-7694"><span class="mrow" id="MathJax-Span-7695"><span class="mi" id="MathJax-Span-7696"></span><span class="mo" id="MathJax-Span-7697" style="font-family: MathJax_Main; padding-left: 0.251em;">=</span><span class="mrow" id="MathJax-Span-7698" style="padding-left: 0.251em;"><span class="mo" id="MathJax-Span-7699" style="vertical-align: 2.857em;"><span style="display: inline-block; position: relative; width: 0.685em; height: 0px;"><span style="position: absolute; font-family: MathJax_Size4; top: -2.788em; left: 0em;">⎡<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; font-family: MathJax_Size4; top: 0.561em; left: 0em;">⎣<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -1.61em; left: 0em;">⎢<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -1.051em; left: 0em;">⎢<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -0.493em; left: 0em;">⎢<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="mtable" id="MathJax-Span-7700" style="padding-right: 0.189em; padding-left: 0.189em;"><span style="display: inline-block; position: relative; width: 9.929em; height: 0px;"><span style="position: absolute; clip: rect(3.105em, 1001.12em, 8.502em, -999.997em); top: -6.014em; left: 0em;"><span style="display: inline-block; position: relative; width: 1.12em; height: 0px;"><span style="position: absolute; clip: rect(3.105em, 1000.44em, 4.159em, -999.997em); top: -6.014em; left: 50%; margin-left: -0.245em;"><span class="mtd" id="MathJax-Span-7701"><span class="mrow" id="MathJax-Span-7702"><span class="mn" id="MathJax-Span-7703" style="font-family: MathJax_Main;">0</span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.353em, 1001.12em, 4.283em, -999.997em); top: -4.587em; left: 50%; margin-left: -0.555em;"><span class="mtd" id="MathJax-Span-7722"><span class="mrow" id="MathJax-Span-7723"><span class="msubsup" id="MathJax-Span-7724"><span style="display: inline-block; position: relative; width: 1.12em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.68em, 4.159em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-7725" style="font-family: MathJax_Math-italic;">w</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.748em;"><span class="mn" id="MathJax-Span-7726" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.353em, 1001.12em, 4.283em, -999.997em); top: -3.223em; left: 50%; margin-left: -0.555em;"><span class="mtd" id="MathJax-Span-7741"><span class="mrow" id="MathJax-Span-7742"><span class="msubsup" id="MathJax-Span-7743"><span style="display: inline-block; position: relative; width: 1.12em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.68em, 4.159em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-7744" style="font-family: MathJax_Math-italic;">w</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.748em;"><span class="mn" id="MathJax-Span-7745" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.353em, 1001.12em, 4.346em, -999.997em); top: -1.796em; left: 50%; margin-left: -0.555em;"><span class="mtd" id="MathJax-Span-7760"><span class="mrow" id="MathJax-Span-7761"><span class="msubsup" id="MathJax-Span-7762"><span style="display: inline-block; position: relative; width: 1.12em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.68em, 4.159em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-7763" style="font-family: MathJax_Math-italic;">w</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.748em;"><span class="mn" id="MathJax-Span-7764" style="font-size: 70.7%; font-family: MathJax_Main;">3</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span><span style="display: inline-block; width: 0px; height: 6.02em;"></span></span><span style="position: absolute; clip: rect(3.167em, 1001.93em, 8.44em, -999.997em); top: -5.952em; left: 2.174em;"><span style="display: inline-block; position: relative; width: 1.926em; height: 0px;"><span style="position: absolute; clip: rect(3.229em, 1001.93em, 4.283em, -999.997em); top: -6.014em; left: 50%; margin-left: -0.927em;"><span class="mtd" id="MathJax-Span-7704"><span class="mrow" id="MathJax-Span-7705"><span class="mo" id="MathJax-Span-7706" style="font-family: MathJax_Main;">−</span><span class="msubsup" id="MathJax-Span-7707"><span style="display: inline-block; position: relative; width: 1.12em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.68em, 4.159em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-7708" style="font-family: MathJax_Math-italic;">w</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.748em;"><span class="mn" id="MathJax-Span-7709" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.105em, 1000.44em, 4.159em, -999.997em); top: -4.587em; left: 50%; margin-left: -0.245em;"><span class="mtd" id="MathJax-Span-7727"><span class="mrow" id="MathJax-Span-7728"><span class="mn" id="MathJax-Span-7729" style="font-family: MathJax_Main;">0</span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.229em, 1001.93em, 4.346em, -999.997em); top: -3.223em; left: 50%; margin-left: -0.927em;"><span class="mtd" id="MathJax-Span-7746"><span class="mrow" id="MathJax-Span-7747"><span class="mo" id="MathJax-Span-7748" style="font-family: MathJax_Main;">−</span><span class="msubsup" id="MathJax-Span-7749"><span style="display: inline-block; position: relative; width: 1.12em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.68em, 4.159em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-7750" style="font-family: MathJax_Math-italic;">w</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.748em;"><span class="mn" id="MathJax-Span-7751" style="font-size: 70.7%; font-family: MathJax_Main;">3</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.353em, 1001.12em, 4.283em, -999.997em); top: -1.796em; left: 50%; margin-left: -0.555em;"><span class="mtd" id="MathJax-Span-7765"><span class="mrow" id="MathJax-Span-7766"><span class="msubsup" id="MathJax-Span-7767"><span style="display: inline-block; position: relative; width: 1.12em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.68em, 4.159em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-7768" style="font-family: MathJax_Math-italic;">w</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.748em;"><span class="mn" id="MathJax-Span-7769" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span><span style="display: inline-block; width: 0px; height: 5.958em;"></span></span><span style="position: absolute; clip: rect(3.167em, 1001.93em, 8.44em, -999.997em); top: -5.952em; left: 5.09em;"><span style="display: inline-block; position: relative; width: 1.926em; height: 0px;"><span style="position: absolute; clip: rect(3.229em, 1001.93em, 4.283em, -999.997em); top: -6.014em; left: 50%; margin-left: -0.927em;"><span class="mtd" id="MathJax-Span-7710"><span class="mrow" id="MathJax-Span-7711"><span class="mo" id="MathJax-Span-7712" style="font-family: MathJax_Main;">−</span><span class="msubsup" id="MathJax-Span-7713"><span style="display: inline-block; position: relative; width: 1.12em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.68em, 4.159em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-7714" style="font-family: MathJax_Math-italic;">w</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.748em;"><span class="mn" id="MathJax-Span-7715" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.353em, 1001.12em, 4.346em, -999.997em); top: -4.587em; left: 50%; margin-left: -0.555em;"><span class="mtd" id="MathJax-Span-7730"><span class="mrow" id="MathJax-Span-7731"><span class="msubsup" id="MathJax-Span-7732"><span style="display: inline-block; position: relative; width: 1.12em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.68em, 4.159em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-7733" style="font-family: MathJax_Math-italic;">w</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.748em;"><span class="mn" id="MathJax-Span-7734" style="font-size: 70.7%; font-family: MathJax_Main;">3</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.105em, 1000.44em, 4.159em, -999.997em); top: -3.223em; left: 50%; margin-left: -0.245em;"><span class="mtd" id="MathJax-Span-7752"><span class="mrow" id="MathJax-Span-7753"><span class="mn" id="MathJax-Span-7754" style="font-family: MathJax_Main;">0</span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.229em, 1001.93em, 4.283em, -999.997em); top: -1.796em; left: 50%; margin-left: -0.927em;"><span class="mtd" id="MathJax-Span-7770"><span class="mrow" id="MathJax-Span-7771"><span class="mo" id="MathJax-Span-7772" style="font-family: MathJax_Main;">−</span><span class="msubsup" id="MathJax-Span-7773"><span style="display: inline-block; position: relative; width: 1.12em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.68em, 4.159em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-7774" style="font-family: MathJax_Math-italic;">w</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.748em;"><span class="mn" id="MathJax-Span-7775" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span><span style="display: inline-block; width: 0px; height: 5.958em;"></span></span><span style="position: absolute; clip: rect(3.043em, 1001.93em, 8.192em, -999.997em); top: -5.828em; left: 8.006em;"><span style="display: inline-block; position: relative; width: 1.926em; height: 0px;"><span style="position: absolute; clip: rect(3.229em, 1001.93em, 4.346em, -999.997em); top: -6.014em; left: 50%; margin-left: -0.927em;"><span class="mtd" id="MathJax-Span-7716"><span class="mrow" id="MathJax-Span-7717"><span class="mo" id="MathJax-Span-7718" style="font-family: MathJax_Main;">−</span><span class="msubsup" id="MathJax-Span-7719"><span style="display: inline-block; position: relative; width: 1.12em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.68em, 4.159em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-7720" style="font-family: MathJax_Math-italic;">w</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.748em;"><span class="mn" id="MathJax-Span-7721" style="font-size: 70.7%; font-family: MathJax_Main;">3</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.229em, 1001.93em, 4.283em, -999.997em); top: -4.587em; left: 50%; margin-left: -0.927em;"><span class="mtd" id="MathJax-Span-7735"><span class="mrow" id="MathJax-Span-7736"><span class="mo" id="MathJax-Span-7737" style="font-family: MathJax_Main;">−</span><span class="msubsup" id="MathJax-Span-7738"><span style="display: inline-block; position: relative; width: 1.12em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.68em, 4.159em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-7739" style="font-family: MathJax_Math-italic;">w</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.748em;"><span class="mn" id="MathJax-Span-7740" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.353em, 1001.12em, 4.283em, -999.997em); top: -3.223em; left: 50%; margin-left: -0.555em;"><span class="mtd" id="MathJax-Span-7755"><span class="mrow" id="MathJax-Span-7756"><span class="msubsup" id="MathJax-Span-7757"><span style="display: inline-block; position: relative; width: 1.12em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.68em, 4.159em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-7758" style="font-family: MathJax_Math-italic;">w</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.748em;"><span class="mn" id="MathJax-Span-7759" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.105em, 1000.44em, 4.159em, -999.997em); top: -1.796em; left: 50%; margin-left: -0.245em;"><span class="mtd" id="MathJax-Span-7776"><span class="mrow" id="MathJax-Span-7777"><span class="mn" id="MathJax-Span-7778" style="font-family: MathJax_Main;">0</span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span><span style="display: inline-block; width: 0px; height: 5.834em;"></span></span></span></span><span class="mo" id="MathJax-Span-7779" style="vertical-align: 2.857em;"><span style="display: inline-block; position: relative; width: 0.685em; height: 0px;"><span style="position: absolute; font-family: MathJax_Size4; top: -2.788em; left: 0em;">⎤<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; font-family: MathJax_Size4; top: 0.561em; left: 0em;">⎦<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -1.61em; left: 0em;">⎥<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -1.051em; left: 0em;">⎥<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -0.493em; left: 0em;">⎥<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 6.207em;"></span></span><span style="position: absolute; clip: rect(3.167em, 1003.54em, 8.75em, -999.997em); top: -8.248em; left: 0em;"><span class="mtd" id="MathJax-Span-7783"><span class="mrow" id="MathJax-Span-7784"><span class="mi" id="MathJax-Span-7785"></span><span class="mo" id="MathJax-Span-7786" style="font-family: MathJax_Main; padding-left: 0.251em;">=</span><span class="mrow" id="MathJax-Span-7787" style="padding-left: 0.251em;"><span class="mo" id="MathJax-Span-7788" style="vertical-align: 2.857em;"><span style="display: inline-block; position: relative; width: 0.685em; height: 0px;"><span style="position: absolute; font-family: MathJax_Size4; top: -2.788em; left: 0em;">⎡<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; font-family: MathJax_Size4; top: 0.561em; left: 0em;">⎣<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -1.61em; left: 0em;">⎢<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -1.051em; left: 0em;">⎢<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -0.493em; left: 0em;">⎢<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="mtable" id="MathJax-Span-7789" style="padding-right: 0.189em; padding-left: 0.189em;"><span style="display: inline-block; position: relative; width: 0.872em; height: 0px;"><span style="position: absolute; clip: rect(3.167em, 1000.87em, 8.378em, -999.997em); top: -5.828em; left: 0em;"><span style="display: inline-block; position: relative; width: 0.872em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.87em, 4.346em, -999.997em); top: -6.014em; left: 50%; margin-left: -0.431em;"><span class="mtd" id="MathJax-Span-7790"><span class="mrow" id="MathJax-Span-7791"><span class="msubsup" id="MathJax-Span-7792"><span style="display: inline-block; position: relative; width: 0.872em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.44em, 4.346em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-7793" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.437em;"><span class="mn" id="MathJax-Span-7794" style="font-size: 70.7%; font-family: MathJax_Main;">0</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.353em, 1000.87em, 4.346em, -999.997em); top: -4.587em; left: 50%; margin-left: -0.431em;"><span class="mtd" id="MathJax-Span-7795"><span class="mrow" id="MathJax-Span-7796"><span class="msubsup" id="MathJax-Span-7797"><span style="display: inline-block; position: relative; width: 0.872em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.44em, 4.346em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-7798" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.437em;"><span class="mn" id="MathJax-Span-7799" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.353em, 1000.87em, 4.346em, -999.997em); top: -3.223em; left: 50%; margin-left: -0.431em;"><span class="mtd" id="MathJax-Span-7800"><span class="mrow" id="MathJax-Span-7801"><span class="msubsup" id="MathJax-Span-7802"><span style="display: inline-block; position: relative; width: 0.872em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.44em, 4.346em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-7803" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.437em;"><span class="mn" id="MathJax-Span-7804" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.353em, 1000.87em, 4.346em, -999.997em); top: -1.796em; left: 50%; margin-left: -0.431em;"><span class="mtd" id="MathJax-Span-7805"><span class="mrow" id="MathJax-Span-7806"><span class="msubsup" id="MathJax-Span-7807"><span style="display: inline-block; position: relative; width: 0.872em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.44em, 4.346em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-7808" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.437em;"><span class="mn" id="MathJax-Span-7809" style="font-size: 70.7%; font-family: MathJax_Main;">3</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span><span style="display: inline-block; width: 0px; height: 5.834em;"></span></span></span></span><span class="mo" id="MathJax-Span-7810" style="vertical-align: 2.857em;"><span style="display: inline-block; position: relative; width: 0.685em; height: 0px;"><span style="position: absolute; font-family: MathJax_Size4; top: -2.788em; left: 0em;">⎤<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; font-family: MathJax_Size4; top: 0.561em; left: 0em;">⎦<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -1.61em; left: 0em;">⎥<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -1.051em; left: 0em;">⎥<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -0.493em; left: 0em;">⎥<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 6.207em;"></span></span><span style="position: absolute; clip: rect(3.167em, 1009.62em, 8.75em, -999.997em); top: -2.726em; left: 0em;"><span class="mtd" id="MathJax-Span-7817"><span class="mrow" id="MathJax-Span-7818"><span class="mi" id="MathJax-Span-7819"></span><span class="mo" id="MathJax-Span-7820" style="font-family: MathJax_Main; padding-left: 0.251em;">=</span><span class="mrow" id="MathJax-Span-7821" style="padding-left: 0.251em;"><span class="mo" id="MathJax-Span-7822" style="vertical-align: 2.857em;"><span style="display: inline-block; position: relative; width: 0.685em; height: 0px;"><span style="position: absolute; font-family: MathJax_Size4; top: -2.788em; left: 0em;">⎡<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; font-family: MathJax_Size4; top: 0.561em; left: 0em;">⎣<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -1.61em; left: 0em;">⎢<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -1.051em; left: 0em;">⎢<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -0.493em; left: 0em;">⎢<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="mtable" id="MathJax-Span-7823" style="padding-right: 0.189em; padding-left: 0.189em;"><span style="display: inline-block; position: relative; width: 6.951em; height: 0px;"><span style="position: absolute; clip: rect(3.167em, 1001.68em, 8.502em, -999.997em); top: -5.952em; left: 0em;"><span style="display: inline-block; position: relative; width: 1.678em; height: 0px;"><span style="position: absolute; clip: rect(3.229em, 1001.68em, 4.346em, -999.997em); top: -6.014em; left: 50%; margin-left: -0.803em;"><span class="mtd" id="MathJax-Span-7824"><span class="mrow" id="MathJax-Span-7825"><span class="mo" id="MathJax-Span-7826" style="font-family: MathJax_Main;">−</span><span class="msubsup" id="MathJax-Span-7827"><span style="display: inline-block; position: relative; width: 0.872em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.44em, 4.346em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-7828" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.437em;"><span class="mn" id="MathJax-Span-7829" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.353em, 1000.87em, 4.346em, -999.997em); top: -4.587em; left: 50%; margin-left: -0.431em;"><span class="mtd" id="MathJax-Span-7842"><span class="mrow" id="MathJax-Span-7843"><span class="msubsup" id="MathJax-Span-7844"><span style="display: inline-block; position: relative; width: 0.872em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.44em, 4.346em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-7845" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.437em;"><span class="mn" id="MathJax-Span-7846" style="font-size: 70.7%; font-family: MathJax_Main;">0</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.353em, 1000.87em, 4.346em, -999.997em); top: -3.223em; left: 50%; margin-left: -0.431em;"><span class="mtd" id="MathJax-Span-7858"><span class="mrow" id="MathJax-Span-7859"><span class="msubsup" id="MathJax-Span-7860"><span style="display: inline-block; position: relative; width: 0.872em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.44em, 4.346em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-7861" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.437em;"><span class="mn" id="MathJax-Span-7862" style="font-size: 70.7%; font-family: MathJax_Main;">3</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.229em, 1001.68em, 4.346em, -999.997em); top: -1.796em; left: 50%; margin-left: -0.803em;"><span class="mtd" id="MathJax-Span-7874"><span class="mrow" id="MathJax-Span-7875"><span class="mo" id="MathJax-Span-7876" style="font-family: MathJax_Main;">−</span><span class="msubsup" id="MathJax-Span-7877"><span style="display: inline-block; position: relative; width: 0.872em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.44em, 4.346em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-7878" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.437em;"><span class="mn" id="MathJax-Span-7879" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span><span style="display: inline-block; width: 0px; height: 5.958em;"></span></span><span style="position: absolute; clip: rect(3.167em, 1001.68em, 8.502em, -999.997em); top: -5.952em; left: 2.671em;"><span style="display: inline-block; position: relative; width: 1.678em; height: 0px;"><span style="position: absolute; clip: rect(3.229em, 1001.68em, 4.346em, -999.997em); top: -6.014em; left: 50%; margin-left: -0.803em;"><span class="mtd" id="MathJax-Span-7830"><span class="mrow" id="MathJax-Span-7831"><span class="mo" id="MathJax-Span-7832" style="font-family: MathJax_Main;">−</span><span class="msubsup" id="MathJax-Span-7833"><span style="display: inline-block; position: relative; width: 0.872em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.44em, 4.346em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-7834" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.437em;"><span class="mn" id="MathJax-Span-7835" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.229em, 1001.68em, 4.346em, -999.997em); top: -4.587em; left: 50%; margin-left: -0.803em;"><span class="mtd" id="MathJax-Span-7847"><span class="mrow" id="MathJax-Span-7848"><span class="mo" id="MathJax-Span-7849" style="font-family: MathJax_Main;">−</span><span class="msubsup" id="MathJax-Span-7850"><span style="display: inline-block; position: relative; width: 0.872em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.44em, 4.346em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-7851" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.437em;"><span class="mn" id="MathJax-Span-7852" style="font-size: 70.7%; font-family: MathJax_Main;">3</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.353em, 1000.87em, 4.346em, -999.997em); top: -3.223em; left: 50%; margin-left: -0.431em;"><span class="mtd" id="MathJax-Span-7863"><span class="mrow" id="MathJax-Span-7864"><span class="msubsup" id="MathJax-Span-7865"><span style="display: inline-block; position: relative; width: 0.872em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.44em, 4.346em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-7866" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.437em;"><span class="mn" id="MathJax-Span-7867" style="font-size: 70.7%; font-family: MathJax_Main;">0</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.353em, 1000.87em, 4.346em, -999.997em); top: -1.796em; left: 50%; margin-left: -0.431em;"><span class="mtd" id="MathJax-Span-7880"><span class="mrow" id="MathJax-Span-7881"><span class="msubsup" id="MathJax-Span-7882"><span style="display: inline-block; position: relative; width: 0.872em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.44em, 4.346em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-7883" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.437em;"><span class="mn" id="MathJax-Span-7884" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span><span style="display: inline-block; width: 0px; height: 5.958em;"></span></span><span style="position: absolute; clip: rect(3.167em, 1001.68em, 8.502em, -999.997em); top: -5.952em; left: 5.338em;"><span style="display: inline-block; position: relative; width: 1.678em; height: 0px;"><span style="position: absolute; clip: rect(3.229em, 1001.68em, 4.346em, -999.997em); top: -6.014em; left: 50%; margin-left: -0.803em;"><span class="mtd" id="MathJax-Span-7836"><span class="mrow" id="MathJax-Span-7837"><span class="mo" id="MathJax-Span-7838" style="font-family: MathJax_Main;">−</span><span class="msubsup" id="MathJax-Span-7839"><span style="display: inline-block; position: relative; width: 0.872em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.44em, 4.346em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-7840" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.437em;"><span class="mn" id="MathJax-Span-7841" style="font-size: 70.7%; font-family: MathJax_Main;">3</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.353em, 1000.87em, 4.346em, -999.997em); top: -4.587em; left: 50%; margin-left: -0.431em;"><span class="mtd" id="MathJax-Span-7853"><span class="mrow" id="MathJax-Span-7854"><span class="msubsup" id="MathJax-Span-7855"><span style="display: inline-block; position: relative; width: 0.872em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.44em, 4.346em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-7856" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.437em;"><span class="mn" id="MathJax-Span-7857" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.229em, 1001.68em, 4.346em, -999.997em); top: -3.223em; left: 50%; margin-left: -0.803em;"><span class="mtd" id="MathJax-Span-7868"><span class="mrow" id="MathJax-Span-7869"><span class="mo" id="MathJax-Span-7870" style="font-family: MathJax_Main;">−</span><span class="msubsup" id="MathJax-Span-7871"><span style="display: inline-block; position: relative; width: 0.872em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.44em, 4.346em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-7872" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.437em;"><span class="mn" id="MathJax-Span-7873" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.353em, 1000.87em, 4.346em, -999.997em); top: -1.796em; left: 50%; margin-left: -0.431em;"><span class="mtd" id="MathJax-Span-7885"><span class="mrow" id="MathJax-Span-7886"><span class="msubsup" id="MathJax-Span-7887"><span style="display: inline-block; position: relative; width: 0.872em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.44em, 4.346em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-7888" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.437em;"><span class="mn" id="MathJax-Span-7889" style="font-size: 70.7%; font-family: MathJax_Main;">0</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span><span style="display: inline-block; width: 0px; height: 5.958em;"></span></span></span></span><span class="mo" id="MathJax-Span-7890" style="vertical-align: 2.857em;"><span style="display: inline-block; position: relative; width: 0.685em; height: 0px;"><span style="position: absolute; font-family: MathJax_Size4; top: -2.788em; left: 0em;">⎤<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; font-family: MathJax_Size4; top: 0.561em; left: 0em;">⎦<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -1.61em; left: 0em;">⎥<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -1.051em; left: 0em;">⎥<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -0.493em; left: 0em;">⎥<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 6.207em;"></span></span><span style="position: absolute; clip: rect(2.422em, 1003.85em, 6.641em, -999.997em); top: 3.477em; left: 0em;"><span class="mtd" id="MathJax-Span-7894"><span class="mrow" id="MathJax-Span-7895"><span class="mi" id="MathJax-Span-7896"></span><span class="mo" id="MathJax-Span-7897" style="font-family: MathJax_Main; padding-left: 0.251em;">=</span><span class="mrow" id="MathJax-Span-7898" style="padding-left: 0.251em;"><span class="mo" id="MathJax-Span-7899" style="vertical-align: 2.174em;"><span style="display: inline-block; position: relative; width: 0.685em; height: 0px;"><span style="position: absolute; font-family: MathJax_Size4; top: -2.788em; left: 0em;">⎡<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; font-family: MathJax_Size4; top: -0.803em; left: 0em;">⎣<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -1.796em; left: 0em;">⎢<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="mtable" id="MathJax-Span-7900" style="padding-right: 0.189em; padding-left: 0.189em;"><span style="display: inline-block; position: relative; width: 1.12em; height: 0px;"><span style="position: absolute; clip: rect(2.422em, 1001.12em, 6.207em, -999.997em); top: -4.401em; left: 0em;"><span style="display: inline-block; position: relative; width: 1.12em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1001.12em, 4.283em, -999.997em); top: -5.332em; left: 50%; margin-left: -0.555em;"><span class="mtd" id="MathJax-Span-7901"><span class="mrow" id="MathJax-Span-7902"><span class="msubsup" id="MathJax-Span-7903"><span style="display: inline-block; position: relative; width: 1.12em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.68em, 4.159em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-7904" style="font-family: MathJax_Math-italic;">w</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.748em;"><span class="mn" id="MathJax-Span-7905" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.353em, 1001.12em, 4.283em, -999.997em); top: -3.905em; left: 50%; margin-left: -0.555em;"><span class="mtd" id="MathJax-Span-7906"><span class="mrow" id="MathJax-Span-7907"><span class="msubsup" id="MathJax-Span-7908"><span style="display: inline-block; position: relative; width: 1.12em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.68em, 4.159em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-7909" style="font-family: MathJax_Math-italic;">w</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.748em;"><span class="mn" id="MathJax-Span-7910" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.353em, 1001.12em, 4.346em, -999.997em); top: -2.54em; left: 50%; margin-left: -0.555em;"><span class="mtd" id="MathJax-Span-7911"><span class="mrow" id="MathJax-Span-7912"><span class="msubsup" id="MathJax-Span-7913"><span style="display: inline-block; position: relative; width: 1.12em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.68em, 4.159em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-7914" style="font-family: MathJax_Math-italic;">w</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.748em;"><span class="mn" id="MathJax-Span-7915" style="font-size: 70.7%; font-family: MathJax_Main;">3</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.408em;"></span></span></span></span><span class="mo" id="MathJax-Span-7916" style="vertical-align: 2.174em;"><span style="display: inline-block; position: relative; width: 0.685em; height: 0px;"><span style="position: absolute; font-family: MathJax_Size4; top: -2.788em; left: 0em;">⎤<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; font-family: MathJax_Size4; top: -0.803em; left: 0em;">⎦<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -1.796em; left: 0em;">⎥<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.78em;"></span></span></span><span style="display: inline-block; width: 0px; height: 21.281em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.36em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -12.381em; border-left: 0px solid; width: 0px; height: 25.312em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mtable columnalign="right left right left right left right left right left right left" rowspacing="3pt" columnspacing="0em 2em 0em 2em 0em 2em 0em 2em 0em 2em 0em" displaystyle="true"><mtr><mtd><mi>S</mi><mo stretchy="false">(</mo><mi>w</mi><mo stretchy="false">)</mo></mtd><mtd><mi></mi><mo>=</mo><mrow><mo>[</mo><mtable rowspacing="4pt" columnspacing="1em"><mtr><mtd><mn>0</mn></mtd><mtd><mo>−</mo><msub><mi>w</mi><mn>1</mn></msub></mtd><mtd><mo>−</mo><msub><mi>w</mi><mn>2</mn></msub></mtd><mtd><mo>−</mo><msub><mi>w</mi><mn>3</mn></msub></mtd></mtr><mtr><mtd><msub><mi>w</mi><mn>1</mn></msub></mtd><mtd><mn>0</mn></mtd><mtd><msub><mi>w</mi><mn>3</mn></msub></mtd><mtd><mo>−</mo><msub><mi>w</mi><mn>2</mn></msub></mtd></mtr><mtr><mtd><msub><mi>w</mi><mn>2</mn></msub></mtd><mtd><mo>−</mo><msub><mi>w</mi><mn>3</mn></msub></mtd><mtd><mn>0</mn></mtd><mtd><msub><mi>w</mi><mn>1</mn></msub></mtd></mtr><mtr><mtd><msub><mi>w</mi><mn>3</mn></msub></mtd><mtd><msub><mi>w</mi><mn>2</mn></msub></mtd><mtd><mo>−</mo><msub><mi>w</mi><mn>1</mn></msub></mtd><mtd><mn>0</mn></mtd></mtr></mtable><mo>]</mo></mrow></mtd></mtr><mtr><mtd><mi>q</mi></mtd><mtd><mi></mi><mo>=</mo><mrow><mo>[</mo><mtable rowspacing="4pt" columnspacing="1em"><mtr><mtd><msub><mi>q</mi><mn>0</mn></msub></mtd></mtr><mtr><mtd><msub><mi>q</mi><mn>1</mn></msub></mtd></mtr><mtr><mtd><msub><mi>q</mi><mn>2</mn></msub></mtd></mtr><mtr><mtd><msub><mi>q</mi><mn>3</mn></msub></mtd></mtr></mtable><mo>]</mo></mrow></mtd></mtr><mtr><mtd><mi>S</mi><mo stretchy="false">(</mo><mi>q</mi><mo stretchy="false">)</mo></mtd><mtd><mi></mi><mo>=</mo><mrow><mo>[</mo><mtable rowspacing="4pt" columnspacing="1em"><mtr><mtd><mo>−</mo><msub><mi>q</mi><mn>1</mn></msub></mtd><mtd><mo>−</mo><msub><mi>q</mi><mn>2</mn></msub></mtd><mtd><mo>−</mo><msub><mi>q</mi><mn>3</mn></msub></mtd></mtr><mtr><mtd><msub><mi>q</mi><mn>0</mn></msub></mtd><mtd><mo>−</mo><msub><mi>q</mi><mn>3</mn></msub></mtd><mtd><msub><mi>q</mi><mn>2</mn></msub></mtd></mtr><mtr><mtd><msub><mi>q</mi><mn>3</mn></msub></mtd><mtd><msub><mi>q</mi><mn>0</mn></msub></mtd><mtd><mo>−</mo><msub><mi>q</mi><mn>1</mn></msub></mtd></mtr><mtr><mtd><mo>−</mo><msub><mi>q</mi><mn>2</mn></msub></mtd><mtd><msub><mi>q</mi><mn>1</mn></msub></mtd><mtd><msub><mi>q</mi><mn>0</mn></msub></mtd></mtr></mtable><mo>]</mo></mrow></mtd></mtr><mtr><mtd><mi>w</mi></mtd><mtd><mi></mi><mo>=</mo><mrow><mo>[</mo><mtable rowspacing="4pt" columnspacing="1em"><mtr><mtd><msub><mi>w</mi><mn>1</mn></msub></mtd></mtr><mtr><mtd><msub><mi>w</mi><mn>2</mn></msub></mtd></mtr><mtr><mtd><msub><mi>w</mi><mn>3</mn></msub></mtd></mtr></mtable><mo>]</mo></mrow></mtd></mtr></mtable></math></span></span><script type="math/tex" id="MathJax-Element-224">\begin{align}S(w)&=\begin{bmatrix} 0 & -w_1 & -w_2 & -w_3 \\ w_1 & 0 & w_3 & -w_2 \\ w_2 & -w_3 & 0 & w_1 \\ w_3 & w_2 & -w_1 & 0 \end{bmatrix} \\ q&=\begin{bmatrix} q_0 \\ q_1 \\ q_2 \\ q_3\end{bmatrix} \\ S(q)&=\begin{bmatrix} -q_1 & -q_2 & -q_3 \\ q_0 & -q_3 & q_2 \\ q_3 & q_0 & -q_1 \\ -q_2 & q_1 & q_0 \end{bmatrix} \\ w&=\begin{bmatrix} w_1 \\ w_2 \\ w_3\end{bmatrix}\end{align}</script></p>
<p>Now, let us test out this method of rotation with the Pygame rectangular block that we created in the <strong><a href="https://thepoorengineer.com/en/graphics/">previous section</a></strong>.</p>
<div id="testRotation"></div>
<hr>
<h2>Testing Quaternion Rotation in Pygame</h2>
<p>Here are the sample code for this section. It is built based on the previous post so if you are looking to understand the code, you should read up the <strong><a href="https://thepoorengineer.com/en/graphics/">previous post</a></strong>.</p>
<ul>
<li><a href="https://thepoorengineer.com/wp-content/uploads/2018/07/PygameQuaternionRotationSimple.zip"><span style="font-size: 12pt;">Python&nbsp;Simple Quaternion Rotation Code</span></a></li>
</ul>
<p>The BoardDisplay code references the Wireframe code, and the Wireframe code references the Quaternion code. In order to let the Pycharm know where it can find all the relevant files, you will need to mark the folder containing the all the files as the sources root. You can do this by right clicking the folder in Pycharm, the select “Mark Directory as”, then “sources root”. If you do this right, the folder should be marked blue in Pycharm.</p>
<p>The aim of this section is to convert angular velocity into a rotation of the object. To test things out, we are going to use a constant angular velocity as an input, and see how an object will rotate in Pygame. We can use equation (1) and (2) from above to achieve this but they are in continuous time form so we have to discretize it first.</p>
<p>In order to discretize equation (2), we are going to take the first order Taylor Series Transformation. This can be done rather simply as shown:</p>
<p style="text-align: center;"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-225-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mover&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mo&gt;&amp;#x02D9;&lt;/mo&gt;&lt;/mover&gt;&lt;/mrow&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mfrac&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/mfrac&gt;&lt;mi&gt;S&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;w&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-7917" style="width: 6.579em; display: inline-block;"><span style="display: inline-block; position: relative; width: 5.276em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(1.306em, 1005.28em, 2.919em, -999.997em); top: -2.354em; left: 0em;"><span class="mrow" id="MathJax-Span-7918"><span class="texatom" id="MathJax-Span-7919"><span class="mrow" id="MathJax-Span-7920"><span class="munderover" id="MathJax-Span-7921"><span style="display: inline-block; position: relative; width: 0.623em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.44em, 4.346em, -999.997em); top: -3.967em; left: 0.003em;"><span class="mi" id="MathJax-Span-7922" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.105em, 1000.31em, 3.601em, -999.997em); top: -4.029em; left: 0.127em;"><span class="mo" id="MathJax-Span-7923" style="font-family: MathJax_Main;">˙</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span></span><span class="mo" id="MathJax-Span-7924" style="font-family: MathJax_Main; padding-left: 0.251em;">=</span><span class="mfrac" id="MathJax-Span-7925" style="padding-left: 0.251em;"><span style="display: inline-block; position: relative; width: 0.499em; height: 0px; margin-right: 0.127em; margin-left: 0.127em;"><span style="position: absolute; clip: rect(3.291em, 1000.31em, 4.159em, -999.997em); top: -4.401em; left: 50%; margin-left: -0.183em;"><span class="mn" id="MathJax-Span-7926" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.291em, 1000.31em, 4.159em, -999.997em); top: -3.595em; left: 50%; margin-left: -0.183em;"><span class="mn" id="MathJax-Span-7927" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(0.81em, 1000.5em, 1.244em, -999.997em); top: -1.3em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 0.499em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.058em;"></span></span></span></span><span class="mi" id="MathJax-Span-7928" style="font-family: MathJax_Math-italic;">S<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.065em;"></span></span><span class="mo" id="MathJax-Span-7929" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-7930" style="font-family: MathJax_Math-italic;">w</span><span class="mo" id="MathJax-Span-7931" style="font-family: MathJax_Main;">)</span><span class="mi" id="MathJax-Span-7932" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.36em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.535em; border-left: 0px solid; width: 0px; height: 1.773em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow class="MJX-TeXAtom-ORD"><mover><mi>q</mi><mo>˙</mo></mover></mrow><mo>=</mo><mfrac><mn>1</mn><mn>2</mn></mfrac><mi>S</mi><mo stretchy="false">(</mo><mi>w</mi><mo stretchy="false">)</mo><mi>q</mi></math></span></span><script type="math/tex" id="MathJax-Element-225">\dot{q}=\frac{1}{2}S(w)q</script></p>
<p style="text-align: center;"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-226-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo&gt;/&lt;/mo&gt;&lt;/mrow&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mfrac&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/mfrac&gt;&lt;mi&gt;S&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;w&lt;/mi&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-7933" style="width: 14.457em; display: inline-block;"><span style="display: inline-block; position: relative; width: 11.666em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(1.306em, 1011.67em, 2.919em, -999.997em); top: -2.354em; left: 0em;"><span class="mrow" id="MathJax-Span-7934"><span class="mo" id="MathJax-Span-7935" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-7936"><span style="display: inline-block; position: relative; width: 1.802em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.44em, 4.346em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-7937" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.437em;"><span class="texatom" id="MathJax-Span-7938"><span class="mrow" id="MathJax-Span-7939"><span class="mi" id="MathJax-Span-7940" style="font-size: 70.7%; font-family: MathJax_Math-italic;">k</span><span class="mo" id="MathJax-Span-7941" style="font-size: 70.7%; font-family: MathJax_Main;">+</span><span class="mn" id="MathJax-Span-7942" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="mo" id="MathJax-Span-7943" style="font-family: MathJax_Main; padding-left: 0.251em;">−</span><span class="msubsup" id="MathJax-Span-7944" style="padding-left: 0.251em;"><span style="display: inline-block; position: relative; width: 0.872em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.44em, 4.346em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-7945" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.437em;"><span class="mi" id="MathJax-Span-7946" style="font-size: 70.7%; font-family: MathJax_Math-italic;">k</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="mo" id="MathJax-Span-7947" style="font-family: MathJax_Main;">)</span><span class="texatom" id="MathJax-Span-7948"><span class="mrow" id="MathJax-Span-7949"><span class="mo" id="MathJax-Span-7950" style="font-family: MathJax_Main;">/</span></span></span><span class="mi" id="MathJax-Span-7951" style="font-family: MathJax_Math-italic;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mi" id="MathJax-Span-7952" style="font-family: MathJax_Math-italic;">t</span><span class="mo" id="MathJax-Span-7953" style="font-family: MathJax_Main; padding-left: 0.251em;">=</span><span class="mfrac" id="MathJax-Span-7954" style="padding-left: 0.251em;"><span style="display: inline-block; position: relative; width: 0.499em; height: 0px; margin-right: 0.127em; margin-left: 0.127em;"><span style="position: absolute; clip: rect(3.291em, 1000.31em, 4.159em, -999.997em); top: -4.401em; left: 50%; margin-left: -0.183em;"><span class="mn" id="MathJax-Span-7955" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.291em, 1000.31em, 4.159em, -999.997em); top: -3.595em; left: 50%; margin-left: -0.183em;"><span class="mn" id="MathJax-Span-7956" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(0.81em, 1000.5em, 1.244em, -999.997em); top: -1.3em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 0.499em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.058em;"></span></span></span></span><span class="mi" id="MathJax-Span-7957" style="font-family: MathJax_Math-italic;">S<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.065em;"></span></span><span class="mo" id="MathJax-Span-7958" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-7959"><span style="display: inline-block; position: relative; width: 1.182em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.68em, 4.159em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-7960" style="font-family: MathJax_Math-italic;">w</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.748em;"><span class="mi" id="MathJax-Span-7961" style="font-size: 70.7%; font-family: MathJax_Math-italic;">k</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="mo" id="MathJax-Span-7962" style="font-family: MathJax_Main;">)</span><span class="msubsup" id="MathJax-Span-7963"><span style="display: inline-block; position: relative; width: 0.872em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.44em, 4.346em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-7964" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.437em;"><span class="mi" id="MathJax-Span-7965" style="font-size: 70.7%; font-family: MathJax_Math-italic;">k</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.36em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.535em; border-left: 0px solid; width: 0px; height: 1.773em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo stretchy="false">(</mo><msub><mi>q</mi><mrow class="MJX-TeXAtom-ORD"><mi>k</mi><mo>+</mo><mn>1</mn></mrow></msub><mo>−</mo><msub><mi>q</mi><mi>k</mi></msub><mo stretchy="false">)</mo><mrow class="MJX-TeXAtom-ORD"><mo>/</mo></mrow><mi>d</mi><mi>t</mi><mo>=</mo><mfrac><mn>1</mn><mn>2</mn></mfrac><mi>S</mi><mo stretchy="false">(</mo><msub><mi>w</mi><mi>k</mi></msub><mo stretchy="false">)</mo><msub><mi>q</mi><mi>k</mi></msub></math></span></span><script type="math/tex" id="MathJax-Element-226">(q_{k+1}-q_k) / dt=\frac{1}{2}S(w_k)q_k</script></p>
<p style="text-align: center;"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-227-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mfrac&gt;&lt;mrow&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/mrow&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/mfrac&gt;&lt;mi&gt;S&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;w&lt;/mi&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-7966" style="width: 12.1em; display: inline-block;"><span style="display: inline-block; position: relative; width: 9.743em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(1.244em, 1009.74em, 2.919em, -999.997em); top: -2.354em; left: 0em;"><span class="mrow" id="MathJax-Span-7967"><span class="msubsup" id="MathJax-Span-7968"><span style="display: inline-block; position: relative; width: 1.802em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.44em, 4.346em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-7969" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.437em;"><span class="texatom" id="MathJax-Span-7970"><span class="mrow" id="MathJax-Span-7971"><span class="mi" id="MathJax-Span-7972" style="font-size: 70.7%; font-family: MathJax_Math-italic;">k</span><span class="mo" id="MathJax-Span-7973" style="font-size: 70.7%; font-family: MathJax_Main;">+</span><span class="mn" id="MathJax-Span-7974" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="mo" id="MathJax-Span-7975" style="font-family: MathJax_Main; padding-left: 0.251em;">=</span><span class="mfrac" id="MathJax-Span-7976" style="padding-left: 0.251em;"><span style="display: inline-block; position: relative; width: 0.748em; height: 0px; margin-right: 0.127em; margin-left: 0.127em;"><span style="position: absolute; clip: rect(3.291em, 1000.62em, 4.159em, -999.997em); top: -4.401em; left: 50%; margin-left: -0.307em;"><span class="mrow" id="MathJax-Span-7977"><span class="mi" id="MathJax-Span-7978" style="font-size: 70.7%; font-family: MathJax_Math-italic;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mi" id="MathJax-Span-7979" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.291em, 1000.31em, 4.159em, -999.997em); top: -3.595em; left: 50%; margin-left: -0.183em;"><span class="mn" id="MathJax-Span-7980" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(0.81em, 1000.75em, 1.244em, -999.997em); top: -1.3em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 0.748em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.058em;"></span></span></span></span><span class="mi" id="MathJax-Span-7981" style="font-family: MathJax_Math-italic;">S<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.065em;"></span></span><span class="mo" id="MathJax-Span-7982" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-7983"><span style="display: inline-block; position: relative; width: 1.182em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.68em, 4.159em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-7984" style="font-family: MathJax_Math-italic;">w</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.748em;"><span class="mi" id="MathJax-Span-7985" style="font-size: 70.7%; font-family: MathJax_Math-italic;">k</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="mo" id="MathJax-Span-7986" style="font-family: MathJax_Main;">)</span><span class="msubsup" id="MathJax-Span-7987"><span style="display: inline-block; position: relative; width: 0.872em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.44em, 4.346em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-7988" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.437em;"><span class="mi" id="MathJax-Span-7989" style="font-size: 70.7%; font-family: MathJax_Math-italic;">k</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="mo" id="MathJax-Span-7990" style="font-family: MathJax_Main; padding-left: 0.251em;">+</span><span class="msubsup" id="MathJax-Span-7991" style="padding-left: 0.251em;"><span style="display: inline-block; position: relative; width: 0.872em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.44em, 4.346em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-7992" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.437em;"><span class="mi" id="MathJax-Span-7993" style="font-size: 70.7%; font-family: MathJax_Math-italic;">k</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.36em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.535em; border-left: 0px solid; width: 0px; height: 1.773em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>q</mi><mrow class="MJX-TeXAtom-ORD"><mi>k</mi><mo>+</mo><mn>1</mn></mrow></msub><mo>=</mo><mfrac><mrow><mi>d</mi><mi>t</mi></mrow><mn>2</mn></mfrac><mi>S</mi><mo stretchy="false">(</mo><msub><mi>w</mi><mi>k</mi></msub><mo stretchy="false">)</mo><msub><mi>q</mi><mi>k</mi></msub><mo>+</mo><msub><mi>q</mi><mi>k</mi></msub></math></span></span><script type="math/tex" id="MathJax-Element-227">q_{k+1}=\frac{dt}{2}S(w_k)q_k+q_k</script></p>
<p>where <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-228-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-7994" style="width: 1.12em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.872em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(1.492em, 1000.87em, 2.547em, -999.997em); top: -2.354em; left: 0em;"><span class="mrow" id="MathJax-Span-7995"><span class="mi" id="MathJax-Span-7996" style="font-family: MathJax_Math-italic;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mi" id="MathJax-Span-7997" style="font-family: MathJax_Math-italic;">t</span></span><span style="display: inline-block; width: 0px; height: 2.36em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.073em; border-left: 0px solid; width: 0px; height: 1.004em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>d</mi><mi>t</mi></math></span></span><script type="math/tex" id="MathJax-Element-228">dt</script> is the time between sample <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-229-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-7998" style="width: 2.857em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.298em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(1.492em, 1002.24em, 2.609em, -999.997em); top: -2.354em; left: 0em;"><span class="mrow" id="MathJax-Span-7999"><span class="mi" id="MathJax-Span-8000" style="font-family: MathJax_Math-italic;">k</span><span class="mo" id="MathJax-Span-8001" style="font-family: MathJax_Main; padding-left: 0.251em;">+</span><span class="mn" id="MathJax-Span-8002" style="font-family: MathJax_Main; padding-left: 0.251em;">1</span></span><span style="display: inline-block; width: 0px; height: 2.36em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.15em; border-left: 0px solid; width: 0px; height: 1.158em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>k</mi><mo>+</mo><mn>1</mn></math></span></span><script type="math/tex" id="MathJax-Element-229">k+1</script> and <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-230-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-8003" style="width: 0.623em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.499em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(1.492em, 1000.5em, 2.547em, -999.997em); top: -2.354em; left: 0em;"><span class="mrow" id="MathJax-Span-8004"><span class="mi" id="MathJax-Span-8005" style="font-family: MathJax_Math-italic;">k</span></span><span style="display: inline-block; width: 0px; height: 2.36em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.073em; border-left: 0px solid; width: 0px; height: 1.004em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>k</mi></math></span></span><script type="math/tex" id="MathJax-Element-230">k</script>.</p>
<p>The same can be applied to the other form in equation (2) as well. Doing so will yield this result:</p>
<p style="text-align: center;"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-231-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mfrac&gt;&lt;mrow&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/mrow&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/mfrac&gt;&lt;mi&gt;S&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;w&lt;/mi&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-8006" style="width: 12.1em; display: inline-block;"><span style="display: inline-block; position: relative; width: 9.743em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(1.244em, 1009.74em, 2.919em, -999.997em); top: -2.354em; left: 0em;"><span class="mrow" id="MathJax-Span-8007"><span class="msubsup" id="MathJax-Span-8008"><span style="display: inline-block; position: relative; width: 1.802em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.44em, 4.346em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-8009" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.437em;"><span class="texatom" id="MathJax-Span-8010"><span class="mrow" id="MathJax-Span-8011"><span class="mi" id="MathJax-Span-8012" style="font-size: 70.7%; font-family: MathJax_Math-italic;">k</span><span class="mo" id="MathJax-Span-8013" style="font-size: 70.7%; font-family: MathJax_Main;">+</span><span class="mn" id="MathJax-Span-8014" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="mo" id="MathJax-Span-8015" style="font-family: MathJax_Main; padding-left: 0.251em;">=</span><span class="mfrac" id="MathJax-Span-8016" style="padding-left: 0.251em;"><span style="display: inline-block; position: relative; width: 0.748em; height: 0px; margin-right: 0.127em; margin-left: 0.127em;"><span style="position: absolute; clip: rect(3.291em, 1000.62em, 4.159em, -999.997em); top: -4.401em; left: 50%; margin-left: -0.307em;"><span class="mrow" id="MathJax-Span-8017"><span class="mi" id="MathJax-Span-8018" style="font-size: 70.7%; font-family: MathJax_Math-italic;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mi" id="MathJax-Span-8019" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.291em, 1000.31em, 4.159em, -999.997em); top: -3.595em; left: 50%; margin-left: -0.183em;"><span class="mn" id="MathJax-Span-8020" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(0.81em, 1000.75em, 1.244em, -999.997em); top: -1.3em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 0.748em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.058em;"></span></span></span></span><span class="mi" id="MathJax-Span-8021" style="font-family: MathJax_Math-italic;">S<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.065em;"></span></span><span class="mo" id="MathJax-Span-8022" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-8023"><span style="display: inline-block; position: relative; width: 0.872em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.44em, 4.346em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-8024" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.437em;"><span class="mi" id="MathJax-Span-8025" style="font-size: 70.7%; font-family: MathJax_Math-italic;">k</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="mo" id="MathJax-Span-8026" style="font-family: MathJax_Main;">)</span><span class="msubsup" id="MathJax-Span-8027"><span style="display: inline-block; position: relative; width: 1.182em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.68em, 4.159em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-8028" style="font-family: MathJax_Math-italic;">w</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.748em;"><span class="mi" id="MathJax-Span-8029" style="font-size: 70.7%; font-family: MathJax_Math-italic;">k</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="mo" id="MathJax-Span-8030" style="font-family: MathJax_Main; padding-left: 0.251em;">+</span><span class="msubsup" id="MathJax-Span-8031" style="padding-left: 0.251em;"><span style="display: inline-block; position: relative; width: 0.872em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1000.44em, 4.346em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-8032" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.437em;"><span class="mi" id="MathJax-Span-8033" style="font-size: 70.7%; font-family: MathJax_Math-italic;">k</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.36em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.535em; border-left: 0px solid; width: 0px; height: 1.773em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>q</mi><mrow class="MJX-TeXAtom-ORD"><mi>k</mi><mo>+</mo><mn>1</mn></mrow></msub><mo>=</mo><mfrac><mrow><mi>d</mi><mi>t</mi></mrow><mn>2</mn></mfrac><mi>S</mi><mo stretchy="false">(</mo><msub><mi>q</mi><mi>k</mi></msub><mo stretchy="false">)</mo><msub><mi>w</mi><mi>k</mi></msub><mo>+</mo><msub><mi>q</mi><mi>k</mi></msub></math></span></span><script type="math/tex" id="MathJax-Element-231">q_{k+1}=\frac{dt}{2}S(q_k)w_k+q_k</script></p>
<p>You can see that in the Quaternion code, this is actually the equation that I was implementing in the rotate method.</p>
<pre class="theme:monokai lang:default decode:true" title="Quaternion">class Quaternion:
    def __init__(self):
        self.q = np.array([1, 0, 0, 0])  # Initial state of the quaternion

    def rotate(self, w, dt):
        q = self.q
        Sq = np.array([[-q[1], -q[2], -q[3]],
                       [q[0], -q[3], q[2]],
                       [q[3], q[0], -q[1]],
                       [-q[2], q[1], q[0]]])
        self.q = np.matmul(dt/2 * Sq, np.array(w).transpose()) + q
</pre>
<p>Now I had some problems understanding what <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-232-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-8034" style="width: 0.561em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.437em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(1.74em, 1000.44em, 2.733em, -999.997em); top: -2.354em; left: 0em;"><span class="mrow" id="MathJax-Span-8035"><span class="mi" id="MathJax-Span-8036" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.36em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.304em; border-left: 0px solid; width: 0px; height: 0.927em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>q</mi></math></span></span><script type="math/tex" id="MathJax-Element-232">q</script> actually represented because sometimes they can take on the form of a vector (scalar part is 0). In here, <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-233-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-8037" style="width: 0.561em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.437em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(1.74em, 1000.44em, 2.733em, -999.997em); top: -2.354em; left: 0em;"><span class="mrow" id="MathJax-Span-8038"><span class="mi" id="MathJax-Span-8039" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.36em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.304em; border-left: 0px solid; width: 0px; height: 0.927em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>q</mi></math></span></span><script type="math/tex" id="MathJax-Element-233">q</script> represents the quaternion that maps the original orientation of the object with the current orientation of the object. As such, when I initialized <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-234-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-8040" style="width: 0.561em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.437em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(1.74em, 1000.44em, 2.733em, -999.997em); top: -2.354em; left: 0em;"><span class="mrow" id="MathJax-Span-8041"><span class="mi" id="MathJax-Span-8042" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.36em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.304em; border-left: 0px solid; width: 0px; height: 0.927em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>q</mi></math></span></span><script type="math/tex" id="MathJax-Element-234">q</script> as&nbsp;[1, 0, 0, 0], I was actually implying that the starting orientation of the object is the orientation of the object in Pygame. We don’t really have a physical object to test with right now so it sounds a little weird but once we get to the next section, it should become clearer. It just means that the object in real life is in the same orientation as the object shown in Pygame at time 0.</p>
<h5><span style="text-decoration: underline;">Determining the Euler Angles</span></h5>
<p>Next, we need a way for us to determine the Euler Angles because they are more intuitive to deal with. Equation (1) provides us with a rotation matrix using quaternion, but we can actually determine the same rotation matrix using Euler angles as well (except for the singularity points encountered during Gimbal Lock). We are going to use the Yaw, Pitch, Roll convention so take note that if you use any other order, you will get a different result.</p>
<p>A positive yaw is defined as counter-clockwise rotation about the z-axis. The rotation matrix for a yaw angle of <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-235-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;&amp;#x03B1;&lt;/mi&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-8043" style="width: 0.81em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.623em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(1.74em, 1000.56em, 2.547em, -999.997em); top: -2.354em; left: 0em;"><span class="mrow" id="MathJax-Span-8044"><span class="mi" id="MathJax-Span-8045" style="font-family: MathJax_Math-italic;">α</span></span><span style="display: inline-block; width: 0px; height: 2.36em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.073em; border-left: 0px solid; width: 0px; height: 0.696em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>α</mi></math></span></span><script type="math/tex" id="MathJax-Element-235">\alpha</script> is:</p>
<p style="text-align: center;"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-236-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;R&lt;/mi&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;&amp;#x03B1;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mrow&gt;&lt;mo&gt;[&lt;/mo&gt;&lt;mtable rowspacing=&quot;4pt&quot; columnspacing=&quot;1em&quot;&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mi&gt;cos&lt;/mi&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;&amp;#x03B1;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mtd&gt;&lt;mtd /&gt;&lt;mtd&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mi&gt;sin&lt;/mi&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;&amp;#x03B1;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mtd&gt;&lt;mtd /&gt;&lt;mtd&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mi&gt;sin&lt;/mi&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;&amp;#x03B1;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mtd&gt;&lt;mtd /&gt;&lt;mtd&gt;&lt;mi&gt;cos&lt;/mi&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;&amp;#x03B1;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mtd&gt;&lt;mtd /&gt;&lt;mtd&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd /&gt;&lt;mtd&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd /&gt;&lt;mtd&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;/mtable&gt;&lt;mo&gt;]&lt;/mo&gt;&lt;/mrow&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-8046" style="width: 20.475em; display: inline-block;"><span style="display: inline-block; position: relative; width: 16.504em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(2.174em, 1016.19em, 6.393em, -999.997em); top: -4.525em; left: 0em;"><span class="mrow" id="MathJax-Span-8047"><span class="msubsup" id="MathJax-Span-8048"><span style="display: inline-block; position: relative; width: 1.182em; height: 0px;"><span style="position: absolute; clip: rect(3.105em, 1000.75em, 4.159em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-8049" style="font-family: MathJax_Math-italic;">R</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.748em;"><span class="mi" id="MathJax-Span-8050" style="font-size: 70.7%; font-family: MathJax_Math-italic;">z<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="mo" id="MathJax-Span-8051" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-8052" style="font-family: MathJax_Math-italic;">α</span><span class="mo" id="MathJax-Span-8053" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-8054" style="font-family: MathJax_Main; padding-left: 0.251em;">=</span><span class="mrow" id="MathJax-Span-8055" style="padding-left: 0.251em;"><span class="mo" id="MathJax-Span-8056" style="vertical-align: 2.174em;"><span style="display: inline-block; position: relative; width: 0.685em; height: 0px;"><span style="position: absolute; font-family: MathJax_Size4; top: -2.788em; left: 0em;">⎡<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; font-family: MathJax_Size4; top: -0.741em; left: 0em;">⎣<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -1.734em; left: 0em;">⎢<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="mtable" id="MathJax-Span-8057" style="padding-right: 0.189em; padding-left: 0.189em;"><span style="display: inline-block; position: relative; width: 10.859em; height: 0px;"><span style="position: absolute; clip: rect(2.298em, 1002.67em, 6.393em, -999.997em); top: -4.65em; left: 0em;"><span style="display: inline-block; position: relative; width: 2.733em; height: 0px;"><span style="position: absolute; clip: rect(3.043em, 1002.67em, 4.408em, -999.997em); top: -5.394em; left: 50%; margin-left: -1.362em;"><span class="mtd" id="MathJax-Span-8058"><span class="mrow" id="MathJax-Span-8059"><span class="mi" id="MathJax-Span-8060" style="font-family: MathJax_Main;">cos</span><span class="mo" id="MathJax-Span-8061"></span><span class="mo" id="MathJax-Span-8062" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-8063" style="font-family: MathJax_Math-italic;">α</span><span class="mo" id="MathJax-Span-8064" style="font-family: MathJax_Main;">)</span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.043em, 1002.55em, 4.408em, -999.997em); top: -3.905em; left: 50%; margin-left: -1.3em;"><span class="mtd" id="MathJax-Span-8080"><span class="mrow" id="MathJax-Span-8081"><span class="mi" id="MathJax-Span-8082" style="font-family: MathJax_Main;">sin</span><span class="mo" id="MathJax-Span-8083"></span><span class="mo" id="MathJax-Span-8084" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-8085" style="font-family: MathJax_Math-italic;">α</span><span class="mo" id="MathJax-Span-8086" style="font-family: MathJax_Main;">)</span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.105em, 1000.44em, 4.159em, -999.997em); top: -2.478em; left: 50%; margin-left: -0.245em;"><span class="mtd" id="MathJax-Span-8101"><span class="mrow" id="MathJax-Span-8102"><span class="mn" id="MathJax-Span-8103" style="font-family: MathJax_Main;">0</span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.656em;"></span></span><span style="position: absolute; clip: rect(2.36em, 1000em, 5.648em, -999.997em); top: -3.967em; left: 3.787em;"><span style="display: inline-block; position: relative; width: 0em; height: 0px;"><span style="position: absolute; clip: rect(3.787em, 1000em, 4.159em, -999.997em); top: -5.394em; left: 50%; margin-left: 0em;"><span class="mtd" id="MathJax-Span-8065"><span class="mrow" id="MathJax-Span-8066"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.787em, 1000em, 4.159em, -999.997em); top: -3.905em; left: 50%; margin-left: 0em;"><span class="mtd" id="MathJax-Span-8087"><span class="mrow" id="MathJax-Span-8088"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.787em, 1000em, 4.159em, -999.997em); top: -2.478em; left: 50%; margin-left: 0em;"><span class="mtd" id="MathJax-Span-8104"><span class="mrow" id="MathJax-Span-8105"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(2.298em, 1003.54em, 6.393em, -999.997em); top: -4.65em; left: 4.78em;"><span style="display: inline-block; position: relative; width: 3.601em; height: 0px;"><span style="position: absolute; clip: rect(3.043em, 1003.54em, 4.408em, -999.997em); top: -5.394em; left: 50%; margin-left: -1.796em;"><span class="mtd" id="MathJax-Span-8067"><span class="mrow" id="MathJax-Span-8068"><span class="mo" id="MathJax-Span-8069" style="font-family: MathJax_Main;">−</span><span class="mi" id="MathJax-Span-8070" style="font-family: MathJax_Main; padding-left: 0.189em;">sin</span><span class="mo" id="MathJax-Span-8071"></span><span class="mo" id="MathJax-Span-8072" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-8073" style="font-family: MathJax_Math-italic;">α</span><span class="mo" id="MathJax-Span-8074" style="font-family: MathJax_Main;">)</span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.043em, 1002.67em, 4.408em, -999.997em); top: -3.905em; left: 50%; margin-left: -1.362em;"><span class="mtd" id="MathJax-Span-8089"><span class="mrow" id="MathJax-Span-8090"><span class="mi" id="MathJax-Span-8091" style="font-family: MathJax_Main;">cos</span><span class="mo" id="MathJax-Span-8092"></span><span class="mo" id="MathJax-Span-8093" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-8094" style="font-family: MathJax_Math-italic;">α</span><span class="mo" id="MathJax-Span-8095" style="font-family: MathJax_Main;">)</span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.105em, 1000.44em, 4.159em, -999.997em); top: -2.478em; left: 50%; margin-left: -0.245em;"><span class="mtd" id="MathJax-Span-8106"><span class="mrow" id="MathJax-Span-8107"><span class="mn" id="MathJax-Span-8108" style="font-family: MathJax_Main;">0</span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.656em;"></span></span><span style="position: absolute; clip: rect(2.36em, 1000em, 5.648em, -999.997em); top: -3.967em; left: 9.37em;"><span style="display: inline-block; position: relative; width: 0em; height: 0px;"><span style="position: absolute; clip: rect(3.787em, 1000em, 4.159em, -999.997em); top: -5.394em; left: 50%; margin-left: 0em;"><span class="mtd" id="MathJax-Span-8075"><span class="mrow" id="MathJax-Span-8076"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.787em, 1000em, 4.159em, -999.997em); top: -3.905em; left: 50%; margin-left: 0em;"><span class="mtd" id="MathJax-Span-8096"><span class="mrow" id="MathJax-Span-8097"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.787em, 1000em, 4.159em, -999.997em); top: -2.478em; left: 50%; margin-left: 0em;"><span class="mtd" id="MathJax-Span-8109"><span class="mrow" id="MathJax-Span-8110"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(2.36em, 1000.44em, 6.269em, -999.997em); top: -4.587em; left: 10.363em;"><span style="display: inline-block; position: relative; width: 0.499em; height: 0px;"><span style="position: absolute; clip: rect(3.105em, 1000.44em, 4.159em, -999.997em); top: -5.394em; left: 50%; margin-left: -0.245em;"><span class="mtd" id="MathJax-Span-8077"><span class="mrow" id="MathJax-Span-8078"><span class="mn" id="MathJax-Span-8079" style="font-family: MathJax_Main;">0</span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.105em, 1000.44em, 4.159em, -999.997em); top: -3.905em; left: 50%; margin-left: -0.245em;"><span class="mtd" id="MathJax-Span-8098"><span class="mrow" id="MathJax-Span-8099"><span class="mn" id="MathJax-Span-8100" style="font-family: MathJax_Main;">0</span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.105em, 1000.44em, 4.159em, -999.997em); top: -2.478em; left: 50%; margin-left: -0.245em;"><span class="mtd" id="MathJax-Span-8111"><span class="mrow" id="MathJax-Span-8112"><span class="mn" id="MathJax-Span-8113" style="font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.594em;"></span></span></span></span><span class="mo" id="MathJax-Span-8114" style="vertical-align: 2.174em;"><span style="display: inline-block; position: relative; width: 0.685em; height: 0px;"><span style="position: absolute; font-family: MathJax_Size4; top: -2.788em; left: 0em;">⎤<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; font-family: MathJax_Size4; top: -0.741em; left: 0em;">⎦<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -1.734em; left: 0em;">⎥<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.532em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -2.15em; border-left: 0px solid; width: 0px; height: 5.004em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>R</mi><mi>z</mi></msub><mo stretchy="false">(</mo><mi>α</mi><mo stretchy="false">)</mo><mo>=</mo><mrow><mo>[</mo><mtable rowspacing="4pt" columnspacing="1em"><mtr><mtd><mi>cos</mi><mo>⁡</mo><mo stretchy="false">(</mo><mi>α</mi><mo stretchy="false">)</mo></mtd><mtd></mtd><mtd><mo>−</mo><mi>sin</mi><mo>⁡</mo><mo stretchy="false">(</mo><mi>α</mi><mo stretchy="false">)</mo></mtd><mtd></mtd><mtd><mn>0</mn></mtd></mtr><mtr><mtd><mi>sin</mi><mo>⁡</mo><mo stretchy="false">(</mo><mi>α</mi><mo stretchy="false">)</mo></mtd><mtd></mtd><mtd><mi>cos</mi><mo>⁡</mo><mo stretchy="false">(</mo><mi>α</mi><mo stretchy="false">)</mo></mtd><mtd></mtd><mtd><mn>0</mn></mtd></mtr><mtr><mtd><mn>0</mn></mtd><mtd></mtd><mtd><mn>0</mn></mtd><mtd></mtd><mtd><mn>1</mn></mtd></mtr></mtable><mo>]</mo></mrow></math></span></span><script type="math/tex" id="MathJax-Element-236">R_z(\alpha)=\begin{bmatrix} \cos(\alpha) && -\sin(\alpha) && 0 \\ \sin(\alpha) && \cos(\alpha) && 0 \\ 0 && 0 && 1 \end{bmatrix}</script></p>
<p>A positive pitch is defined as counter-clockwise rotation about the y-axis.The rotation matrix for a pitch angle of <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-237-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;&amp;#x03B2;&lt;/mi&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-8115" style="width: 0.685em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.561em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(1.492em, 1000.56em, 2.733em, -999.997em); top: -2.354em; left: 0em;"><span class="mrow" id="MathJax-Span-8116"><span class="mi" id="MathJax-Span-8117" style="font-family: MathJax_Math-italic;">β<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.36em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.304em; border-left: 0px solid; width: 0px; height: 1.235em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>β</mi></math></span></span><script type="math/tex" id="MathJax-Element-237">\beta</script> is:</p>
<p style="text-align: center;"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-238-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;R&lt;/mi&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;&amp;#x03B2;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mrow&gt;&lt;mo&gt;[&lt;/mo&gt;&lt;mtable rowspacing=&quot;4pt&quot; columnspacing=&quot;1em&quot;&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mi&gt;cos&lt;/mi&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;&amp;#x03B2;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mtd&gt;&lt;mtd /&gt;&lt;mtd&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd /&gt;&lt;mtd&gt;&lt;mi&gt;sin&lt;/mi&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;&amp;#x03B2;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd /&gt;&lt;mtd&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd /&gt;&lt;mtd&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mi&gt;sin&lt;/mi&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;&amp;#x03B2;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mtd&gt;&lt;mtd /&gt;&lt;mtd&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd /&gt;&lt;mtd&gt;&lt;mi&gt;cos&lt;/mi&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;&amp;#x03B2;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;/mtable&gt;&lt;mo&gt;]&lt;/mo&gt;&lt;/mrow&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-8118" style="width: 20.226em; display: inline-block;"><span style="display: inline-block; position: relative; width: 16.318em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(2.174em, 1016.01em, 6.393em, -999.997em); top: -4.525em; left: 0em;"><span class="mrow" id="MathJax-Span-8119"><span class="msubsup" id="MathJax-Span-8120"><span style="display: inline-block; position: relative; width: 1.182em; height: 0px;"><span style="position: absolute; clip: rect(3.105em, 1000.75em, 4.159em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-8121" style="font-family: MathJax_Math-italic;">R</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.748em;"><span class="mi" id="MathJax-Span-8122" style="font-size: 70.7%; font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="mo" id="MathJax-Span-8123" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-8124" style="font-family: MathJax_Math-italic;">β<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-8125" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-8126" style="font-family: MathJax_Main; padding-left: 0.251em;">=</span><span class="mrow" id="MathJax-Span-8127" style="padding-left: 0.251em;"><span class="mo" id="MathJax-Span-8128" style="vertical-align: 2.174em;"><span style="display: inline-block; position: relative; width: 0.685em; height: 0px;"><span style="position: absolute; font-family: MathJax_Size4; top: -2.788em; left: 0em;">⎡<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; font-family: MathJax_Size4; top: -0.741em; left: 0em;">⎣<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -1.734em; left: 0em;">⎢<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="mtable" id="MathJax-Span-8129" style="padding-right: 0.189em; padding-left: 0.189em;"><span style="display: inline-block; position: relative; width: 10.735em; height: 0px;"><span style="position: absolute; clip: rect(2.484em, 1003.48em, 6.703em, -999.997em); top: -4.836em; left: 0em;"><span style="display: inline-block; position: relative; width: 3.539em; height: 0px;"><span style="position: absolute; clip: rect(3.043em, 1002.61em, 4.408em, -999.997em); top: -5.394em; left: 50%; margin-left: -1.362em;"><span class="mtd" id="MathJax-Span-8130"><span class="mrow" id="MathJax-Span-8131"><span class="mi" id="MathJax-Span-8132" style="font-family: MathJax_Main;">cos</span><span class="mo" id="MathJax-Span-8133"></span><span class="mo" id="MathJax-Span-8134" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-8135" style="font-family: MathJax_Math-italic;">β<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-8136" style="font-family: MathJax_Main;">)</span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.105em, 1000.44em, 4.159em, -999.997em); top: -3.905em; left: 50%; margin-left: -0.245em;"><span class="mtd" id="MathJax-Span-8151"><span class="mrow" id="MathJax-Span-8152"><span class="mn" id="MathJax-Span-8153" style="font-family: MathJax_Main;">0</span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.043em, 1003.48em, 4.408em, -999.997em); top: -2.54em; left: 50%; margin-left: -1.796em;"><span class="mtd" id="MathJax-Span-8164"><span class="mrow" id="MathJax-Span-8165"><span class="mo" id="MathJax-Span-8166" style="font-family: MathJax_Main;">−</span><span class="mi" id="MathJax-Span-8167" style="font-family: MathJax_Main; padding-left: 0.189em;">sin</span><span class="mo" id="MathJax-Span-8168"></span><span class="mo" id="MathJax-Span-8169" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-8170" style="font-family: MathJax_Math-italic;">β<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-8171" style="font-family: MathJax_Main;">)</span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.842em;"></span></span><span style="position: absolute; clip: rect(2.36em, 1000em, 5.586em, -999.997em); top: -3.967em; left: 4.532em;"><span style="display: inline-block; position: relative; width: 0em; height: 0px;"><span style="position: absolute; clip: rect(3.787em, 1000em, 4.159em, -999.997em); top: -5.394em; left: 50%; margin-left: 0em;"><span class="mtd" id="MathJax-Span-8137"><span class="mrow" id="MathJax-Span-8138"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.787em, 1000em, 4.159em, -999.997em); top: -3.905em; left: 50%; margin-left: 0em;"><span class="mtd" id="MathJax-Span-8154"><span class="mrow" id="MathJax-Span-8155"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.787em, 1000em, 4.159em, -999.997em); top: -2.54em; left: 50%; margin-left: 0em;"><span class="mtd" id="MathJax-Span-8172"><span class="mrow" id="MathJax-Span-8173"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(2.298em, 1000.44em, 6.207em, -999.997em); top: -4.525em; left: 5.524em;"><span style="display: inline-block; position: relative; width: 0.499em; height: 0px;"><span style="position: absolute; clip: rect(3.105em, 1000.44em, 4.159em, -999.997em); top: -5.394em; left: 50%; margin-left: -0.245em;"><span class="mtd" id="MathJax-Span-8139"><span class="mrow" id="MathJax-Span-8140"><span class="mn" id="MathJax-Span-8141" style="font-family: MathJax_Main;">0</span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.105em, 1000.44em, 4.159em, -999.997em); top: -3.905em; left: 50%; margin-left: -0.245em;"><span class="mtd" id="MathJax-Span-8156"><span class="mrow" id="MathJax-Span-8157"><span class="mn" id="MathJax-Span-8158" style="font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.105em, 1000.44em, 4.159em, -999.997em); top: -2.54em; left: 50%; margin-left: -0.245em;"><span class="mtd" id="MathJax-Span-8174"><span class="mrow" id="MathJax-Span-8175"><span class="mn" id="MathJax-Span-8176" style="font-family: MathJax_Main;">0</span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.532em;"></span></span><span style="position: absolute; clip: rect(2.36em, 1000em, 5.586em, -999.997em); top: -3.967em; left: 7.075em;"><span style="display: inline-block; position: relative; width: 0em; height: 0px;"><span style="position: absolute; clip: rect(3.787em, 1000em, 4.159em, -999.997em); top: -5.394em; left: 50%; margin-left: 0em;"><span class="mtd" id="MathJax-Span-8142"><span class="mrow" id="MathJax-Span-8143"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.787em, 1000em, 4.159em, -999.997em); top: -3.905em; left: 50%; margin-left: 0em;"><span class="mtd" id="MathJax-Span-8159"><span class="mrow" id="MathJax-Span-8160"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.787em, 1000em, 4.159em, -999.997em); top: -2.54em; left: 50%; margin-left: 0em;"><span class="mtd" id="MathJax-Span-8177"><span class="mrow" id="MathJax-Span-8178"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(2.484em, 1002.61em, 6.703em, -999.997em); top: -4.836em; left: 8.068em;"><span style="display: inline-block; position: relative; width: 2.671em; height: 0px;"><span style="position: absolute; clip: rect(3.043em, 1002.48em, 4.408em, -999.997em); top: -5.394em; left: 50%; margin-left: -1.3em;"><span class="mtd" id="MathJax-Span-8144"><span class="mrow" id="MathJax-Span-8145"><span class="mi" id="MathJax-Span-8146" style="font-family: MathJax_Main;">sin</span><span class="mo" id="MathJax-Span-8147"></span><span class="mo" id="MathJax-Span-8148" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-8149" style="font-family: MathJax_Math-italic;">β<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-8150" style="font-family: MathJax_Main;">)</span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.105em, 1000.44em, 4.159em, -999.997em); top: -3.905em; left: 50%; margin-left: -0.245em;"><span class="mtd" id="MathJax-Span-8161"><span class="mrow" id="MathJax-Span-8162"><span class="mn" id="MathJax-Span-8163" style="font-family: MathJax_Main;">0</span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.043em, 1002.61em, 4.408em, -999.997em); top: -2.54em; left: 50%; margin-left: -1.362em;"><span class="mtd" id="MathJax-Span-8179"><span class="mrow" id="MathJax-Span-8180"><span class="mi" id="MathJax-Span-8181" style="font-family: MathJax_Main;">cos</span><span class="mo" id="MathJax-Span-8182"></span><span class="mo" id="MathJax-Span-8183" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-8184" style="font-family: MathJax_Math-italic;">β<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-8185" style="font-family: MathJax_Main;">)</span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.842em;"></span></span></span></span><span class="mo" id="MathJax-Span-8186" style="vertical-align: 2.174em;"><span style="display: inline-block; position: relative; width: 0.685em; height: 0px;"><span style="position: absolute; font-family: MathJax_Size4; top: -2.788em; left: 0em;">⎤<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; font-family: MathJax_Size4; top: -0.741em; left: 0em;">⎦<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -1.734em; left: 0em;">⎥<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.532em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -2.15em; border-left: 0px solid; width: 0px; height: 5.004em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>R</mi><mi>y</mi></msub><mo stretchy="false">(</mo><mi>β</mi><mo stretchy="false">)</mo><mo>=</mo><mrow><mo>[</mo><mtable rowspacing="4pt" columnspacing="1em"><mtr><mtd><mi>cos</mi><mo>⁡</mo><mo stretchy="false">(</mo><mi>β</mi><mo stretchy="false">)</mo></mtd><mtd></mtd><mtd><mn>0</mn></mtd><mtd></mtd><mtd><mi>sin</mi><mo>⁡</mo><mo stretchy="false">(</mo><mi>β</mi><mo stretchy="false">)</mo></mtd></mtr><mtr><mtd><mn>0</mn></mtd><mtd></mtd><mtd><mn>1</mn></mtd><mtd></mtd><mtd><mn>0</mn></mtd></mtr><mtr><mtd><mo>−</mo><mi>sin</mi><mo>⁡</mo><mo stretchy="false">(</mo><mi>β</mi><mo stretchy="false">)</mo></mtd><mtd></mtd><mtd><mn>0</mn></mtd><mtd></mtd><mtd><mi>cos</mi><mo>⁡</mo><mo stretchy="false">(</mo><mi>β</mi><mo stretchy="false">)</mo></mtd></mtr></mtable><mo>]</mo></mrow></math></span></span><script type="math/tex" id="MathJax-Element-238">R_y(\beta)=\begin{bmatrix} \cos(\beta) && 0 && \sin(\beta) \\ 0 && 1 && 0 \\-\sin(\beta) && 0 && \cos(\beta) \end{bmatrix}</script></p>
<p>A positive roll is defined as counter-clockwise rotation about the x-axis.The rotation matrix for a roll angle of <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-239-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;&amp;#x03B3;&lt;/mi&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-8187" style="width: 0.623em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.499em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(1.74em, 1000.5em, 2.733em, -999.997em); top: -2.354em; left: 0em;"><span class="mrow" id="MathJax-Span-8188"><span class="mi" id="MathJax-Span-8189" style="font-family: MathJax_Math-italic;">γ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.36em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.304em; border-left: 0px solid; width: 0px; height: 1.004em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>γ</mi></math></span></span><script type="math/tex" id="MathJax-Element-239">\gamma</script> is:</p>
<p style="text-align: center;"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-240-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;R&lt;/mi&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;&amp;#x03B3;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mrow&gt;&lt;mo&gt;[&lt;/mo&gt;&lt;mtable rowspacing=&quot;4pt&quot; columnspacing=&quot;1em&quot;&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd /&gt;&lt;mtd&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd /&gt;&lt;mtd&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd /&gt;&lt;mtd&gt;&lt;mi&gt;cos&lt;/mi&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;&amp;#x03B3;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mtd&gt;&lt;mtd /&gt;&lt;mtd&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mi&gt;sin&lt;/mi&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;&amp;#x03B3;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd /&gt;&lt;mtd&gt;&lt;mi&gt;sin&lt;/mi&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;&amp;#x03B3;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mtd&gt;&lt;mtd /&gt;&lt;mtd&gt;&lt;mi&gt;cos&lt;/mi&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;&amp;#x03B3;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;/mtable&gt;&lt;mo&gt;]&lt;/mo&gt;&lt;/mrow&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-8190" style="width: 20.164em; display: inline-block;"><span style="display: inline-block; position: relative; width: 16.256em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(2.174em, 1015.95em, 6.393em, -999.997em); top: -4.525em; left: 0em;"><span class="mrow" id="MathJax-Span-8191"><span class="msubsup" id="MathJax-Span-8192"><span style="display: inline-block; position: relative; width: 1.244em; height: 0px;"><span style="position: absolute; clip: rect(3.105em, 1000.75em, 4.159em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-8193" style="font-family: MathJax_Math-italic;">R</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.748em;"><span class="mi" id="MathJax-Span-8194" style="font-size: 70.7%; font-family: MathJax_Math-italic;">x</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="mo" id="MathJax-Span-8195" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-8196" style="font-family: MathJax_Math-italic;">γ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-8197" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-8198" style="font-family: MathJax_Main; padding-left: 0.251em;">=</span><span class="mrow" id="MathJax-Span-8199" style="padding-left: 0.251em;"><span class="mo" id="MathJax-Span-8200" style="vertical-align: 2.174em;"><span style="display: inline-block; position: relative; width: 0.685em; height: 0px;"><span style="position: absolute; font-family: MathJax_Size4; top: -2.788em; left: 0em;">⎡<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; font-family: MathJax_Size4; top: -0.741em; left: 0em;">⎣<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -1.734em; left: 0em;">⎢<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="mtable" id="MathJax-Span-8201" style="padding-right: 0.189em; padding-left: 0.189em;"><span style="display: inline-block; position: relative; width: 10.673em; height: 0px;"><span style="position: absolute; clip: rect(2.298em, 1000.44em, 6.207em, -999.997em); top: -4.525em; left: 0em;"><span style="display: inline-block; position: relative; width: 0.499em; height: 0px;"><span style="position: absolute; clip: rect(3.105em, 1000.44em, 4.159em, -999.997em); top: -5.394em; left: 50%; margin-left: -0.245em;"><span class="mtd" id="MathJax-Span-8202"><span class="mrow" id="MathJax-Span-8203"><span class="mn" id="MathJax-Span-8204" style="font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.105em, 1000.44em, 4.159em, -999.997em); top: -3.967em; left: 50%; margin-left: -0.245em;"><span class="mtd" id="MathJax-Span-8215"><span class="mrow" id="MathJax-Span-8216"><span class="mn" id="MathJax-Span-8217" style="font-family: MathJax_Main;">0</span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.105em, 1000.44em, 4.159em, -999.997em); top: -2.54em; left: 50%; margin-left: -0.245em;"><span class="mtd" id="MathJax-Span-8237"><span class="mrow" id="MathJax-Span-8238"><span class="mn" id="MathJax-Span-8239" style="font-family: MathJax_Main;">0</span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.532em;"></span></span><span style="position: absolute; clip: rect(2.36em, 1000em, 5.586em, -999.997em); top: -3.967em; left: 1.492em;"><span style="display: inline-block; position: relative; width: 0em; height: 0px;"><span style="position: absolute; clip: rect(3.787em, 1000em, 4.159em, -999.997em); top: -5.394em; left: 50%; margin-left: 0em;"><span class="mtd" id="MathJax-Span-8205"><span class="mrow" id="MathJax-Span-8206"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.787em, 1000em, 4.159em, -999.997em); top: -3.967em; left: 50%; margin-left: 0em;"><span class="mtd" id="MathJax-Span-8218"><span class="mrow" id="MathJax-Span-8219"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.787em, 1000em, 4.159em, -999.997em); top: -2.54em; left: 50%; margin-left: 0em;"><span class="mtd" id="MathJax-Span-8240"><span class="mrow" id="MathJax-Span-8241"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(2.547em, 1002.55em, 6.641em, -999.997em); top: -4.774em; left: 2.484em;"><span style="display: inline-block; position: relative; width: 2.671em; height: 0px;"><span style="position: absolute; clip: rect(3.105em, 1000.44em, 4.159em, -999.997em); top: -5.394em; left: 50%; margin-left: -0.245em;"><span class="mtd" id="MathJax-Span-8207"><span class="mrow" id="MathJax-Span-8208"><span class="mn" id="MathJax-Span-8209" style="font-family: MathJax_Main;">0</span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.043em, 1002.55em, 4.408em, -999.997em); top: -3.967em; left: 50%; margin-left: -1.3em;"><span class="mtd" id="MathJax-Span-8220"><span class="mrow" id="MathJax-Span-8221"><span class="mi" id="MathJax-Span-8222" style="font-family: MathJax_Main;">cos</span><span class="mo" id="MathJax-Span-8223"></span><span class="mo" id="MathJax-Span-8224" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-8225" style="font-family: MathJax_Math-italic;">γ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-8226" style="font-family: MathJax_Main;">)</span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.043em, 1002.48em, 4.408em, -999.997em); top: -2.54em; left: 50%; margin-left: -1.3em;"><span class="mtd" id="MathJax-Span-8242"><span class="mrow" id="MathJax-Span-8243"><span class="mi" id="MathJax-Span-8244" style="font-family: MathJax_Main;">sin</span><span class="mo" id="MathJax-Span-8245"></span><span class="mo" id="MathJax-Span-8246" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-8247" style="font-family: MathJax_Math-italic;">γ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-8248" style="font-family: MathJax_Main;">)</span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.78em;"></span></span><span style="position: absolute; clip: rect(2.36em, 1000em, 5.586em, -999.997em); top: -3.967em; left: 6.145em;"><span style="display: inline-block; position: relative; width: 0em; height: 0px;"><span style="position: absolute; clip: rect(3.787em, 1000em, 4.159em, -999.997em); top: -5.394em; left: 50%; margin-left: 0em;"><span class="mtd" id="MathJax-Span-8210"><span class="mrow" id="MathJax-Span-8211"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.787em, 1000em, 4.159em, -999.997em); top: -3.967em; left: 50%; margin-left: 0em;"><span class="mtd" id="MathJax-Span-8227"><span class="mrow" id="MathJax-Span-8228"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.787em, 1000em, 4.159em, -999.997em); top: -2.54em; left: 50%; margin-left: 0em;"><span class="mtd" id="MathJax-Span-8249"><span class="mrow" id="MathJax-Span-8250"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(2.547em, 1003.41em, 6.641em, -999.997em); top: -4.774em; left: 7.137em;"><span style="display: inline-block; position: relative; width: 3.539em; height: 0px;"><span style="position: absolute; clip: rect(3.105em, 1000.44em, 4.159em, -999.997em); top: -5.394em; left: 50%; margin-left: -0.245em;"><span class="mtd" id="MathJax-Span-8212"><span class="mrow" id="MathJax-Span-8213"><span class="mn" id="MathJax-Span-8214" style="font-family: MathJax_Main;">0</span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.043em, 1003.41em, 4.408em, -999.997em); top: -3.967em; left: 50%; margin-left: -1.734em;"><span class="mtd" id="MathJax-Span-8229"><span class="mrow" id="MathJax-Span-8230"><span class="mo" id="MathJax-Span-8231" style="font-family: MathJax_Main;">−</span><span class="mi" id="MathJax-Span-8232" style="font-family: MathJax_Main; padding-left: 0.189em;">sin</span><span class="mo" id="MathJax-Span-8233"></span><span class="mo" id="MathJax-Span-8234" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-8235" style="font-family: MathJax_Math-italic;">γ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-8236" style="font-family: MathJax_Main;">)</span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.043em, 1002.55em, 4.408em, -999.997em); top: -2.54em; left: 50%; margin-left: -1.3em;"><span class="mtd" id="MathJax-Span-8251"><span class="mrow" id="MathJax-Span-8252"><span class="mi" id="MathJax-Span-8253" style="font-family: MathJax_Main;">cos</span><span class="mo" id="MathJax-Span-8254"></span><span class="mo" id="MathJax-Span-8255" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-8256" style="font-family: MathJax_Math-italic;">γ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-8257" style="font-family: MathJax_Main;">)</span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.78em;"></span></span></span></span><span class="mo" id="MathJax-Span-8258" style="vertical-align: 2.174em;"><span style="display: inline-block; position: relative; width: 0.685em; height: 0px;"><span style="position: absolute; font-family: MathJax_Size4; top: -2.788em; left: 0em;">⎤<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; font-family: MathJax_Size4; top: -0.741em; left: 0em;">⎦<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -1.734em; left: 0em;">⎥<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.532em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -2.15em; border-left: 0px solid; width: 0px; height: 5.004em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>R</mi><mi>x</mi></msub><mo stretchy="false">(</mo><mi>γ</mi><mo stretchy="false">)</mo><mo>=</mo><mrow><mo>[</mo><mtable rowspacing="4pt" columnspacing="1em"><mtr><mtd><mn>1</mn></mtd><mtd></mtd><mtd><mn>0</mn></mtd><mtd></mtd><mtd><mn>0</mn></mtd></mtr><mtr><mtd><mn>0</mn></mtd><mtd></mtd><mtd><mi>cos</mi><mo>⁡</mo><mo stretchy="false">(</mo><mi>γ</mi><mo stretchy="false">)</mo></mtd><mtd></mtd><mtd><mo>−</mo><mi>sin</mi><mo>⁡</mo><mo stretchy="false">(</mo><mi>γ</mi><mo stretchy="false">)</mo></mtd></mtr><mtr><mtd><mn>0</mn></mtd><mtd></mtd><mtd><mi>sin</mi><mo>⁡</mo><mo stretchy="false">(</mo><mi>γ</mi><mo stretchy="false">)</mo></mtd><mtd></mtd><mtd><mi>cos</mi><mo>⁡</mo><mo stretchy="false">(</mo><mi>γ</mi><mo stretchy="false">)</mo></mtd></mtr></mtable><mo>]</mo></mrow></math></span></span><script type="math/tex" id="MathJax-Element-240">R_x(\gamma)=\begin{bmatrix} 1 && 0 && 0 \\ 0 && \cos(\gamma) && -\sin(\gamma) \\0 && \sin(\gamma) && \cos(\gamma) \end{bmatrix}</script></p>
<p>Any rotations can be decomposed into these 3 elemental rotations so a roll, pitch, yaw rotation (note the order of rotation here) can be described by the following matrix:</p>
<p style="text-align: center;"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-241-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mtable columnalign=&quot;right left right left right left right left right left right left&quot; rowspacing=&quot;3pt&quot; columnspacing=&quot;0em 2em 0em 2em 0em 2em 0em 2em 0em 2em 0em&quot; displaystyle=&quot;true&quot;&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mi&gt;R&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;&amp;#x03B1;&lt;/mi&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;&amp;#x03B2;&lt;/mi&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;&amp;#x03B3;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mi&gt;&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;R&lt;/mi&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;&amp;#x03B1;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;R&lt;/mi&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;&amp;#x03B2;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;R&lt;/mi&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;&amp;#x03B3;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd /&gt;&lt;mtd&gt;&lt;mi&gt;&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mrow&gt;&lt;mo&gt;[&lt;/mo&gt;&lt;mtable rowspacing=&quot;4pt&quot; columnspacing=&quot;1em&quot;&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mi&gt;cos&lt;/mi&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;&amp;#x03B1;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mi&gt;cos&lt;/mi&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;&amp;#x03B2;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mtd&gt;&lt;mtd /&gt;&lt;mtd&gt;&lt;mi&gt;cos&lt;/mi&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;&amp;#x03B1;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mi&gt;sin&lt;/mi&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;&amp;#x03B2;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mi&gt;sin&lt;/mi&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;&amp;#x03B3;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mi&gt;sin&lt;/mi&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;&amp;#x03B1;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mi&gt;cos&lt;/mi&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;&amp;#x03B3;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mtd&gt;&lt;mtd /&gt;&lt;mtd&gt;&lt;mi&gt;cos&lt;/mi&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;&amp;#x03B1;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mi&gt;sin&lt;/mi&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;&amp;#x03B2;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mi&gt;cos&lt;/mi&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;&amp;#x03B3;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mi&gt;sin&lt;/mi&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;&amp;#x03B1;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mi&gt;sin&lt;/mi&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;&amp;#x03B3;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mi&gt;sin&lt;/mi&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;&amp;#x03B1;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mi&gt;cos&lt;/mi&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;&amp;#x03B2;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mtd&gt;&lt;mtd /&gt;&lt;mtd&gt;&lt;mi&gt;sin&lt;/mi&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;&amp;#x03B1;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mi&gt;sin&lt;/mi&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;&amp;#x03B2;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mi&gt;sin&lt;/mi&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;&amp;#x03B3;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mi&gt;cos&lt;/mi&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;&amp;#x03B1;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mi&gt;cos&lt;/mi&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;&amp;#x03B3;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mtd&gt;&lt;mtd /&gt;&lt;mtd&gt;&lt;mi&gt;sin&lt;/mi&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;&amp;#x03B1;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mi&gt;sin&lt;/mi&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;&amp;#x03B2;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mi&gt;cos&lt;/mi&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;&amp;#x03B3;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mi&gt;cos&lt;/mi&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;&amp;#x03B1;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mi&gt;sin&lt;/mi&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;&amp;#x03B3;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mi&gt;sin&lt;/mi&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;&amp;#x03B2;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mtd&gt;&lt;mtd /&gt;&lt;mtd&gt;&lt;mi&gt;cos&lt;/mi&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;&amp;#x03B2;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mi&gt;sin&lt;/mi&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;&amp;#x03B3;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mtd&gt;&lt;mtd /&gt;&lt;mtd&gt;&lt;mi&gt;cos&lt;/mi&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;&amp;#x03B2;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mi&gt;cos&lt;/mi&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;&amp;#x03B3;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;/mtable&gt;&lt;mo&gt;]&lt;/mo&gt;&lt;/mrow&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;/mtable&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-8259" style="width: 58.688em; display: inline-block;"><span style="display: inline-block; position: relative; width: 47.336em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(-0.741em, 1046.84em, 4.966em, -999.997em); top: -2.354em; left: 0em;"><span class="mrow" id="MathJax-Span-8260"><span class="mtable" id="MathJax-Span-8261" style="padding-right: 0.189em; padding-left: 0.189em;"><span style="display: inline-block; position: relative; width: 46.901em; height: 0px;"><span style="position: absolute; clip: rect(1.554em, 1004.16em, 5.462em, -999.997em); top: -4.587em; left: 0em;"><span style="display: inline-block; position: relative; width: 4.221em; height: 0px;"><span style="position: absolute; clip: rect(3.043em, 1004.16em, 4.408em, -999.997em); top: -6.076em; right: 0em;"><span class="mtd" id="MathJax-Span-8262"><span class="mrow" id="MathJax-Span-8263"><span class="mi" id="MathJax-Span-8264" style="font-family: MathJax_Math-italic;">R</span><span class="mo" id="MathJax-Span-8265" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-8266" style="font-family: MathJax_Math-italic;">α</span><span class="mo" id="MathJax-Span-8267" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-8268" style="font-family: MathJax_Math-italic; padding-left: 0.189em;">β<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-8269" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-8270" style="font-family: MathJax_Math-italic; padding-left: 0.189em;">γ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-8271" style="font-family: MathJax_Main;">)</span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.787em, 1000em, 4.159em, -999.997em); top: -3.285em; right: 0em;"><span class="mtd" id="MathJax-Span-8294"><span class="mrow" id="MathJax-Span-8295"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.594em;"></span></span><span style="position: absolute; clip: rect(3.229em, 1042.37em, 8.874em, -999.997em); top: -6.262em; left: 4.221em;"><span style="display: inline-block; position: relative; width: 42.683em; height: 0px;"><span style="position: absolute; clip: rect(3.043em, 1008.87em, 4.47em, -999.997em); top: -6.076em; left: 0em;"><span class="mtd" id="MathJax-Span-8272"><span class="mrow" id="MathJax-Span-8273"><span class="mi" id="MathJax-Span-8274"></span><span class="mo" id="MathJax-Span-8275" style="font-family: MathJax_Main; padding-left: 0.251em;">=</span><span class="msubsup" id="MathJax-Span-8276" style="padding-left: 0.251em;"><span style="display: inline-block; position: relative; width: 1.182em; height: 0px;"><span style="position: absolute; clip: rect(3.105em, 1000.75em, 4.159em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-8277" style="font-family: MathJax_Math-italic;">R</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.748em;"><span class="mi" id="MathJax-Span-8278" style="font-size: 70.7%; font-family: MathJax_Math-italic;">z<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="mo" id="MathJax-Span-8279" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-8280" style="font-family: MathJax_Math-italic;">α</span><span class="mo" id="MathJax-Span-8281" style="font-family: MathJax_Main;">)</span><span class="msubsup" id="MathJax-Span-8282"><span style="display: inline-block; position: relative; width: 1.182em; height: 0px;"><span style="position: absolute; clip: rect(3.105em, 1000.75em, 4.159em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-8283" style="font-family: MathJax_Math-italic;">R</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.748em;"><span class="mi" id="MathJax-Span-8284" style="font-size: 70.7%; font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="mo" id="MathJax-Span-8285" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-8286" style="font-family: MathJax_Math-italic;">β<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-8287" style="font-family: MathJax_Main;">)</span><span class="msubsup" id="MathJax-Span-8288"><span style="display: inline-block; position: relative; width: 1.244em; height: 0px;"><span style="position: absolute; clip: rect(3.105em, 1000.75em, 4.159em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-8289" style="font-family: MathJax_Math-italic;">R</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.748em;"><span class="mi" id="MathJax-Span-8290" style="font-size: 70.7%; font-family: MathJax_Math-italic;">x</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="mo" id="MathJax-Span-8291" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-8292" style="font-family: MathJax_Math-italic;">γ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-8293" style="font-family: MathJax_Main;">)</span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(2.547em, 1042.37em, 6.889em, -999.997em); top: -4.277em; left: 0em;"><span class="mtd" id="MathJax-Span-8296"><span class="mrow" id="MathJax-Span-8297"><span class="mi" id="MathJax-Span-8298"></span><span class="mo" id="MathJax-Span-8299" style="font-family: MathJax_Main; padding-left: 0.251em;">=</span><span class="mrow" id="MathJax-Span-8300" style="padding-left: 0.251em;"><span class="mo" id="MathJax-Span-8301" style="vertical-align: 2.236em;"><span style="display: inline-block; position: relative; width: 0.685em; height: 0px;"><span style="position: absolute; font-family: MathJax_Size4; top: -2.788em; left: 0em;">⎡<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; font-family: MathJax_Size4; top: -0.679em; left: 0em;">⎣<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -1.672em; left: 0em;">⎢<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="mtable" id="MathJax-Span-8302" style="padding-right: 0.189em; padding-left: 0.189em;"><span style="display: inline-block; position: relative; width: 39.705em; height: 0px;"><span style="position: absolute; clip: rect(2.547em, 1005.52em, 6.827em, -999.997em); top: -4.898em; left: 0em;"><span style="display: inline-block; position: relative; width: 5.648em; height: 0px;"><span style="position: absolute; clip: rect(3.043em, 1005.52em, 4.408em, -999.997em); top: -5.394em; left: 50%; margin-left: -2.788em;"><span class="mtd" id="MathJax-Span-8303"><span class="mrow" id="MathJax-Span-8304"><span class="mi" id="MathJax-Span-8305" style="font-family: MathJax_Main;">cos</span><span class="mo" id="MathJax-Span-8306"></span><span class="mo" id="MathJax-Span-8307" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-8308" style="font-family: MathJax_Math-italic;">α</span><span class="mo" id="MathJax-Span-8309" style="font-family: MathJax_Main;">)</span><span class="mi" id="MathJax-Span-8310" style="font-family: MathJax_Main; padding-left: 0.189em;">cos</span><span class="mo" id="MathJax-Span-8311"></span><span class="mo" id="MathJax-Span-8312" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-8313" style="font-family: MathJax_Math-italic;">β<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-8314" style="font-family: MathJax_Main;">)</span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.043em, 1005.46em, 4.408em, -999.997em); top: -3.967em; left: 50%; margin-left: -2.788em;"><span class="mtd" id="MathJax-Span-8375"><span class="mrow" id="MathJax-Span-8376"><span class="mi" id="MathJax-Span-8377" style="font-family: MathJax_Main;">sin</span><span class="mo" id="MathJax-Span-8378"></span><span class="mo" id="MathJax-Span-8379" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-8380" style="font-family: MathJax_Math-italic;">α</span><span class="mo" id="MathJax-Span-8381" style="font-family: MathJax_Main;">)</span><span class="mi" id="MathJax-Span-8382" style="font-family: MathJax_Main; padding-left: 0.189em;">cos</span><span class="mo" id="MathJax-Span-8383"></span><span class="mo" id="MathJax-Span-8384" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-8385" style="font-family: MathJax_Math-italic;">β<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-8386" style="font-family: MathJax_Main;">)</span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.043em, 1003.48em, 4.408em, -999.997em); top: -2.478em; left: 50%; margin-left: -1.796em;"><span class="mtd" id="MathJax-Span-8447"><span class="mrow" id="MathJax-Span-8448"><span class="mo" id="MathJax-Span-8449" style="font-family: MathJax_Main;">−</span><span class="mi" id="MathJax-Span-8450" style="font-family: MathJax_Main; padding-left: 0.189em;">sin</span><span class="mo" id="MathJax-Span-8451"></span><span class="mo" id="MathJax-Span-8452" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-8453" style="font-family: MathJax_Math-italic;">β<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-8454" style="font-family: MathJax_Main;">)</span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.904em;"></span></span><span style="position: absolute; clip: rect(2.36em, 1000em, 5.648em, -999.997em); top: -3.967em; left: 6.641em;"><span style="display: inline-block; position: relative; width: 0em; height: 0px;"><span style="position: absolute; clip: rect(3.787em, 1000em, 4.159em, -999.997em); top: -5.394em; left: 50%; margin-left: 0em;"><span class="mtd" id="MathJax-Span-8315"><span class="mrow" id="MathJax-Span-8316"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.787em, 1000em, 4.159em, -999.997em); top: -3.967em; left: 50%; margin-left: 0em;"><span class="mtd" id="MathJax-Span-8387"><span class="mrow" id="MathJax-Span-8388"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.787em, 1000em, 4.159em, -999.997em); top: -2.478em; left: 50%; margin-left: 0em;"><span class="mtd" id="MathJax-Span-8455"><span class="mrow" id="MathJax-Span-8456"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(2.547em, 1014.95em, 6.827em, -999.997em); top: -4.898em; left: 7.633em;"><span style="display: inline-block; position: relative; width: 15.016em; height: 0px;"><span style="position: absolute; clip: rect(3.043em, 1014.95em, 4.408em, -999.997em); top: -5.394em; left: 50%; margin-left: -7.503em;"><span class="mtd" id="MathJax-Span-8317"><span class="mrow" id="MathJax-Span-8318"><span class="mi" id="MathJax-Span-8319" style="font-family: MathJax_Main;">cos</span><span class="mo" id="MathJax-Span-8320"></span><span class="mo" id="MathJax-Span-8321" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-8322" style="font-family: MathJax_Math-italic;">α</span><span class="mo" id="MathJax-Span-8323" style="font-family: MathJax_Main;">)</span><span class="mi" id="MathJax-Span-8324" style="font-family: MathJax_Main; padding-left: 0.189em;">sin</span><span class="mo" id="MathJax-Span-8325"></span><span class="mo" id="MathJax-Span-8326" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-8327" style="font-family: MathJax_Math-italic;">β<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-8328" style="font-family: MathJax_Main;">)</span><span class="mi" id="MathJax-Span-8329" style="font-family: MathJax_Main; padding-left: 0.189em;">sin</span><span class="mo" id="MathJax-Span-8330"></span><span class="mo" id="MathJax-Span-8331" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-8332" style="font-family: MathJax_Math-italic;">γ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-8333" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-8334" style="font-family: MathJax_Main; padding-left: 0.251em;">−</span><span class="mi" id="MathJax-Span-8335" style="font-family: MathJax_Main; padding-left: 0.251em;">sin</span><span class="mo" id="MathJax-Span-8336"></span><span class="mo" id="MathJax-Span-8337" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-8338" style="font-family: MathJax_Math-italic;">α</span><span class="mo" id="MathJax-Span-8339" style="font-family: MathJax_Main;">)</span><span class="mi" id="MathJax-Span-8340" style="font-family: MathJax_Main; padding-left: 0.189em;">cos</span><span class="mo" id="MathJax-Span-8341"></span><span class="mo" id="MathJax-Span-8342" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-8343" style="font-family: MathJax_Math-italic;">γ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-8344" style="font-family: MathJax_Main;">)</span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.043em, 1014.95em, 4.408em, -999.997em); top: -3.967em; left: 50%; margin-left: -7.503em;"><span class="mtd" id="MathJax-Span-8389"><span class="mrow" id="MathJax-Span-8390"><span class="mi" id="MathJax-Span-8391" style="font-family: MathJax_Main;">sin</span><span class="mo" id="MathJax-Span-8392"></span><span class="mo" id="MathJax-Span-8393" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-8394" style="font-family: MathJax_Math-italic;">α</span><span class="mo" id="MathJax-Span-8395" style="font-family: MathJax_Main;">)</span><span class="mi" id="MathJax-Span-8396" style="font-family: MathJax_Main; padding-left: 0.189em;">sin</span><span class="mo" id="MathJax-Span-8397"></span><span class="mo" id="MathJax-Span-8398" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-8399" style="font-family: MathJax_Math-italic;">β<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-8400" style="font-family: MathJax_Main;">)</span><span class="mi" id="MathJax-Span-8401" style="font-family: MathJax_Main; padding-left: 0.189em;">sin</span><span class="mo" id="MathJax-Span-8402"></span><span class="mo" id="MathJax-Span-8403" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-8404" style="font-family: MathJax_Math-italic;">γ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-8405" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-8406" style="font-family: MathJax_Main; padding-left: 0.251em;">+</span><span class="mi" id="MathJax-Span-8407" style="font-family: MathJax_Main; padding-left: 0.251em;">cos</span><span class="mo" id="MathJax-Span-8408"></span><span class="mo" id="MathJax-Span-8409" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-8410" style="font-family: MathJax_Math-italic;">α</span><span class="mo" id="MathJax-Span-8411" style="font-family: MathJax_Main;">)</span><span class="mi" id="MathJax-Span-8412" style="font-family: MathJax_Main; padding-left: 0.189em;">cos</span><span class="mo" id="MathJax-Span-8413"></span><span class="mo" id="MathJax-Span-8414" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-8415" style="font-family: MathJax_Math-italic;">γ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-8416" style="font-family: MathJax_Main;">)</span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.043em, 1005.34em, 4.408em, -999.997em); top: -2.478em; left: 50%; margin-left: -2.726em;"><span class="mtd" id="MathJax-Span-8457"><span class="mrow" id="MathJax-Span-8458"><span class="mi" id="MathJax-Span-8459" style="font-family: MathJax_Main;">cos</span><span class="mo" id="MathJax-Span-8460"></span><span class="mo" id="MathJax-Span-8461" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-8462" style="font-family: MathJax_Math-italic;">β<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-8463" style="font-family: MathJax_Main;">)</span><span class="mi" id="MathJax-Span-8464" style="font-family: MathJax_Main; padding-left: 0.189em;">sin</span><span class="mo" id="MathJax-Span-8465"></span><span class="mo" id="MathJax-Span-8466" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-8467" style="font-family: MathJax_Math-italic;">γ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-8468" style="font-family: MathJax_Main;">)</span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.904em;"></span></span><span style="position: absolute; clip: rect(2.36em, 1000em, 5.648em, -999.997em); top: -3.967em; left: 23.7em;"><span style="display: inline-block; position: relative; width: 0em; height: 0px;"><span style="position: absolute; clip: rect(3.787em, 1000em, 4.159em, -999.997em); top: -5.394em; left: 50%; margin-left: 0em;"><span class="mtd" id="MathJax-Span-8345"><span class="mrow" id="MathJax-Span-8346"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.787em, 1000em, 4.159em, -999.997em); top: -3.967em; left: 50%; margin-left: 0em;"><span class="mtd" id="MathJax-Span-8417"><span class="mrow" id="MathJax-Span-8418"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.787em, 1000em, 4.159em, -999.997em); top: -2.478em; left: 50%; margin-left: 0em;"><span class="mtd" id="MathJax-Span-8469"><span class="mrow" id="MathJax-Span-8470"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(2.547em, 1014.95em, 6.827em, -999.997em); top: -4.898em; left: 24.693em;"><span style="display: inline-block; position: relative; width: 15.016em; height: 0px;"><span style="position: absolute; clip: rect(3.043em, 1014.95em, 4.408em, -999.997em); top: -5.394em; left: 50%; margin-left: -7.503em;"><span class="mtd" id="MathJax-Span-8347"><span class="mrow" id="MathJax-Span-8348"><span class="mi" id="MathJax-Span-8349" style="font-family: MathJax_Main;">cos</span><span class="mo" id="MathJax-Span-8350"></span><span class="mo" id="MathJax-Span-8351" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-8352" style="font-family: MathJax_Math-italic;">α</span><span class="mo" id="MathJax-Span-8353" style="font-family: MathJax_Main;">)</span><span class="mi" id="MathJax-Span-8354" style="font-family: MathJax_Main; padding-left: 0.189em;">sin</span><span class="mo" id="MathJax-Span-8355"></span><span class="mo" id="MathJax-Span-8356" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-8357" style="font-family: MathJax_Math-italic;">β<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-8358" style="font-family: MathJax_Main;">)</span><span class="mi" id="MathJax-Span-8359" style="font-family: MathJax_Main; padding-left: 0.189em;">cos</span><span class="mo" id="MathJax-Span-8360"></span><span class="mo" id="MathJax-Span-8361" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-8362" style="font-family: MathJax_Math-italic;">γ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-8363" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-8364" style="font-family: MathJax_Main; padding-left: 0.251em;">+</span><span class="mi" id="MathJax-Span-8365" style="font-family: MathJax_Main; padding-left: 0.251em;">sin</span><span class="mo" id="MathJax-Span-8366"></span><span class="mo" id="MathJax-Span-8367" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-8368" style="font-family: MathJax_Math-italic;">α</span><span class="mo" id="MathJax-Span-8369" style="font-family: MathJax_Main;">)</span><span class="mi" id="MathJax-Span-8370" style="font-family: MathJax_Main; padding-left: 0.189em;">sin</span><span class="mo" id="MathJax-Span-8371"></span><span class="mo" id="MathJax-Span-8372" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-8373" style="font-family: MathJax_Math-italic;">γ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-8374" style="font-family: MathJax_Main;">)</span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.043em, 1014.95em, 4.408em, -999.997em); top: -3.967em; left: 50%; margin-left: -7.503em;"><span class="mtd" id="MathJax-Span-8419"><span class="mrow" id="MathJax-Span-8420"><span class="mi" id="MathJax-Span-8421" style="font-family: MathJax_Main;">sin</span><span class="mo" id="MathJax-Span-8422"></span><span class="mo" id="MathJax-Span-8423" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-8424" style="font-family: MathJax_Math-italic;">α</span><span class="mo" id="MathJax-Span-8425" style="font-family: MathJax_Main;">)</span><span class="mi" id="MathJax-Span-8426" style="font-family: MathJax_Main; padding-left: 0.189em;">sin</span><span class="mo" id="MathJax-Span-8427"></span><span class="mo" id="MathJax-Span-8428" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-8429" style="font-family: MathJax_Math-italic;">β<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-8430" style="font-family: MathJax_Main;">)</span><span class="mi" id="MathJax-Span-8431" style="font-family: MathJax_Main; padding-left: 0.189em;">cos</span><span class="mo" id="MathJax-Span-8432"></span><span class="mo" id="MathJax-Span-8433" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-8434" style="font-family: MathJax_Math-italic;">γ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-8435" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-8436" style="font-family: MathJax_Main; padding-left: 0.251em;">−</span><span class="mi" id="MathJax-Span-8437" style="font-family: MathJax_Main; padding-left: 0.251em;">cos</span><span class="mo" id="MathJax-Span-8438"></span><span class="mo" id="MathJax-Span-8439" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-8440" style="font-family: MathJax_Math-italic;">α</span><span class="mo" id="MathJax-Span-8441" style="font-family: MathJax_Main;">)</span><span class="mi" id="MathJax-Span-8442" style="font-family: MathJax_Main; padding-left: 0.189em;">sin</span><span class="mo" id="MathJax-Span-8443"></span><span class="mo" id="MathJax-Span-8444" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-8445" style="font-family: MathJax_Math-italic;">γ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-8446" style="font-family: MathJax_Main;">)</span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.043em, 1005.46em, 4.408em, -999.997em); top: -2.478em; left: 50%; margin-left: -2.788em;"><span class="mtd" id="MathJax-Span-8471"><span class="mrow" id="MathJax-Span-8472"><span class="mi" id="MathJax-Span-8473" style="font-family: MathJax_Main;">cos</span><span class="mo" id="MathJax-Span-8474"></span><span class="mo" id="MathJax-Span-8475" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-8476" style="font-family: MathJax_Math-italic;">β<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-8477" style="font-family: MathJax_Main;">)</span><span class="mi" id="MathJax-Span-8478" style="font-family: MathJax_Main; padding-left: 0.189em;">cos</span><span class="mo" id="MathJax-Span-8479"></span><span class="mo" id="MathJax-Span-8480" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-8481" style="font-family: MathJax_Math-italic;">γ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-8482" style="font-family: MathJax_Main;">)</span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.904em;"></span></span></span></span><span class="mo" id="MathJax-Span-8483" style="vertical-align: 2.236em;"><span style="display: inline-block; position: relative; width: 0.685em; height: 0px;"><span style="position: absolute; font-family: MathJax_Size4; top: -2.788em; left: 0em;">⎤<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; font-family: MathJax_Size4; top: -0.679em; left: 0em;">⎦<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -1.672em; left: 0em;">⎥<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.966em;"></span></span></span><span style="display: inline-block; width: 0px; height: 6.269em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.36em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -3.073em; border-left: 0px solid; width: 0px; height: 6.773em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mtable columnalign="right left right left right left right left right left right left" rowspacing="3pt" columnspacing="0em 2em 0em 2em 0em 2em 0em 2em 0em 2em 0em" displaystyle="true"><mtr><mtd><mi>R</mi><mo stretchy="false">(</mo><mi>α</mi><mo>,</mo><mi>β</mi><mo>,</mo><mi>γ</mi><mo stretchy="false">)</mo></mtd><mtd><mi></mi><mo>=</mo><msub><mi>R</mi><mi>z</mi></msub><mo stretchy="false">(</mo><mi>α</mi><mo stretchy="false">)</mo><msub><mi>R</mi><mi>y</mi></msub><mo stretchy="false">(</mo><mi>β</mi><mo stretchy="false">)</mo><msub><mi>R</mi><mi>x</mi></msub><mo stretchy="false">(</mo><mi>γ</mi><mo stretchy="false">)</mo></mtd></mtr><mtr><mtd></mtd><mtd><mi></mi><mo>=</mo><mrow><mo>[</mo><mtable rowspacing="4pt" columnspacing="1em"><mtr><mtd><mi>cos</mi><mo>⁡</mo><mo stretchy="false">(</mo><mi>α</mi><mo stretchy="false">)</mo><mi>cos</mi><mo>⁡</mo><mo stretchy="false">(</mo><mi>β</mi><mo stretchy="false">)</mo></mtd><mtd></mtd><mtd><mi>cos</mi><mo>⁡</mo><mo stretchy="false">(</mo><mi>α</mi><mo stretchy="false">)</mo><mi>sin</mi><mo>⁡</mo><mo stretchy="false">(</mo><mi>β</mi><mo stretchy="false">)</mo><mi>sin</mi><mo>⁡</mo><mo stretchy="false">(</mo><mi>γ</mi><mo stretchy="false">)</mo><mo>−</mo><mi>sin</mi><mo>⁡</mo><mo stretchy="false">(</mo><mi>α</mi><mo stretchy="false">)</mo><mi>cos</mi><mo>⁡</mo><mo stretchy="false">(</mo><mi>γ</mi><mo stretchy="false">)</mo></mtd><mtd></mtd><mtd><mi>cos</mi><mo>⁡</mo><mo stretchy="false">(</mo><mi>α</mi><mo stretchy="false">)</mo><mi>sin</mi><mo>⁡</mo><mo stretchy="false">(</mo><mi>β</mi><mo stretchy="false">)</mo><mi>cos</mi><mo>⁡</mo><mo stretchy="false">(</mo><mi>γ</mi><mo stretchy="false">)</mo><mo>+</mo><mi>sin</mi><mo>⁡</mo><mo stretchy="false">(</mo><mi>α</mi><mo stretchy="false">)</mo><mi>sin</mi><mo>⁡</mo><mo stretchy="false">(</mo><mi>γ</mi><mo stretchy="false">)</mo></mtd></mtr><mtr><mtd><mi>sin</mi><mo>⁡</mo><mo stretchy="false">(</mo><mi>α</mi><mo stretchy="false">)</mo><mi>cos</mi><mo>⁡</mo><mo stretchy="false">(</mo><mi>β</mi><mo stretchy="false">)</mo></mtd><mtd></mtd><mtd><mi>sin</mi><mo>⁡</mo><mo stretchy="false">(</mo><mi>α</mi><mo stretchy="false">)</mo><mi>sin</mi><mo>⁡</mo><mo stretchy="false">(</mo><mi>β</mi><mo stretchy="false">)</mo><mi>sin</mi><mo>⁡</mo><mo stretchy="false">(</mo><mi>γ</mi><mo stretchy="false">)</mo><mo>+</mo><mi>cos</mi><mo>⁡</mo><mo stretchy="false">(</mo><mi>α</mi><mo stretchy="false">)</mo><mi>cos</mi><mo>⁡</mo><mo stretchy="false">(</mo><mi>γ</mi><mo stretchy="false">)</mo></mtd><mtd></mtd><mtd><mi>sin</mi><mo>⁡</mo><mo stretchy="false">(</mo><mi>α</mi><mo stretchy="false">)</mo><mi>sin</mi><mo>⁡</mo><mo stretchy="false">(</mo><mi>β</mi><mo stretchy="false">)</mo><mi>cos</mi><mo>⁡</mo><mo stretchy="false">(</mo><mi>γ</mi><mo stretchy="false">)</mo><mo>−</mo><mi>cos</mi><mo>⁡</mo><mo stretchy="false">(</mo><mi>α</mi><mo stretchy="false">)</mo><mi>sin</mi><mo>⁡</mo><mo stretchy="false">(</mo><mi>γ</mi><mo stretchy="false">)</mo></mtd></mtr><mtr><mtd><mo>−</mo><mi>sin</mi><mo>⁡</mo><mo stretchy="false">(</mo><mi>β</mi><mo stretchy="false">)</mo></mtd><mtd></mtd><mtd><mi>cos</mi><mo>⁡</mo><mo stretchy="false">(</mo><mi>β</mi><mo stretchy="false">)</mo><mi>sin</mi><mo>⁡</mo><mo stretchy="false">(</mo><mi>γ</mi><mo stretchy="false">)</mo></mtd><mtd></mtd><mtd><mi>cos</mi><mo>⁡</mo><mo stretchy="false">(</mo><mi>β</mi><mo stretchy="false">)</mo><mi>cos</mi><mo>⁡</mo><mo stretchy="false">(</mo><mi>γ</mi><mo stretchy="false">)</mo></mtd></mtr></mtable><mo>]</mo></mrow></mtd></mtr></mtable></math></span></span><script type="math/tex" id="MathJax-Element-241">\begin{align}R(\alpha,\beta,\gamma) &= R_z(\alpha)R_y(\beta)R_x(\gamma) \\ &= \begin{bmatrix} \cos(\alpha)\cos(\beta) && \cos(\alpha)\sin(\beta)\sin(\gamma)-\sin(\alpha)\cos(\gamma) && \cos(\alpha)\sin(\beta)\cos(\gamma)+\sin(\alpha)\sin(\gamma) \\ \sin(\alpha)\cos(\beta) && \sin(\alpha)\sin(\beta)\sin(\gamma)+\cos(\alpha)\cos(\gamma) && \sin(\alpha)\sin(\beta)\cos(\gamma)-\cos(\alpha)\sin(\gamma) \\ -\sin(\beta) && \cos(\beta)\sin(\gamma) &&\cos(\beta)\cos(\gamma) \end{bmatrix}\end{align}</script></p>
<p>Take note that the above equation only applies for a rotation that performs the roll first, the pitch, then yaw last. If the order is changed, you will end up with a different rotation matrix. Now, if the quaternion rotation matrix is correct, which of course it is since it has been used by so many people around the world, then we can use the above roll, pitch, yaw rotation matrix to get the corresponding Euler angles from the quaternion rotation matrix.</p>
<p>From equation (1), lets give each cell in matrix <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-242-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;C&lt;/mi&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-8484" style="width: 0.996em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.81em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(1.492em, 1000.81em, 2.547em, -999.997em); top: -2.354em; left: 0em;"><span class="mrow" id="MathJax-Span-8485"><span class="mi" id="MathJax-Span-8486" style="font-family: MathJax_Math-italic;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.065em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.36em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.073em; border-left: 0px solid; width: 0px; height: 1.081em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>C</mi></math></span></span><script type="math/tex" id="MathJax-Element-242">C</script> an index:</p>
<p><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-243-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;C&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mrow&gt;&lt;mo&gt;[&lt;/mo&gt;&lt;mtable rowspacing=&quot;4pt&quot; columnspacing=&quot;1em&quot;&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mi&gt;C&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mn&gt;00&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;mtd /&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mi&gt;C&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mn&gt;01&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;mtd /&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mi&gt;C&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mn&gt;02&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mi&gt;C&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mn&gt;10&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;mtd /&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mi&gt;C&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mn&gt;11&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;mtd /&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mi&gt;C&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mn&gt;12&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mi&gt;C&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mn&gt;20&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;mtd /&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mi&gt;C&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mn&gt;21&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;mtd /&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mi&gt;C&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mn&gt;22&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;/mtable&gt;&lt;mo&gt;]&lt;/mo&gt;&lt;/mrow&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-8487" style="width: 15.326em; display: inline-block;"><span style="display: inline-block; position: relative; width: 12.348em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(2.174em, 1012.04em, 6.393em, -999.997em); top: -4.525em; left: 0em;"><span class="mrow" id="MathJax-Span-8488"><span class="mi" id="MathJax-Span-8489" style="font-family: MathJax_Math-italic;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.065em;"></span></span><span class="mo" id="MathJax-Span-8490" style="font-family: MathJax_Main; padding-left: 0.251em;">=</span><span class="mrow" id="MathJax-Span-8491" style="padding-left: 0.251em;"><span class="mo" id="MathJax-Span-8492" style="vertical-align: 2.174em;"><span style="display: inline-block; position: relative; width: 0.685em; height: 0px;"><span style="position: absolute; font-family: MathJax_Size4; top: -2.788em; left: 0em;">⎡<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; font-family: MathJax_Size4; top: -0.803em; left: 0em;">⎣<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -1.796em; left: 0em;">⎢<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="mtable" id="MathJax-Span-8493" style="padding-right: 0.189em; padding-left: 0.189em;"><span style="display: inline-block; position: relative; width: 8.502em; height: 0px;"><span style="position: absolute; clip: rect(2.422em, 1001.49em, 6.455em, -999.997em); top: -4.65em; left: 0em;"><span style="display: inline-block; position: relative; width: 1.492em; height: 0px;"><span style="position: absolute; clip: rect(3.105em, 1001.49em, 4.346em, -999.997em); top: -5.332em; left: 50%; margin-left: -0.741em;"><span class="mtd" id="MathJax-Span-8494"><span class="mrow" id="MathJax-Span-8495"><span class="msubsup" id="MathJax-Span-8496"><span style="display: inline-block; position: relative; width: 1.492em; height: 0px;"><span style="position: absolute; clip: rect(3.105em, 1000.75em, 4.159em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-8497" style="font-family: MathJax_Math-italic;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.065em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.748em;"><span class="texatom" id="MathJax-Span-8498"><span class="mrow" id="MathJax-Span-8499"><span class="mn" id="MathJax-Span-8500" style="font-size: 70.7%; font-family: MathJax_Main;">00</span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.105em, 1001.49em, 4.346em, -999.997em); top: -3.905em; left: 50%; margin-left: -0.741em;"><span class="mtd" id="MathJax-Span-8519"><span class="mrow" id="MathJax-Span-8520"><span class="msubsup" id="MathJax-Span-8521"><span style="display: inline-block; position: relative; width: 1.492em; height: 0px;"><span style="position: absolute; clip: rect(3.105em, 1000.75em, 4.159em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-8522" style="font-family: MathJax_Math-italic;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.065em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.748em;"><span class="texatom" id="MathJax-Span-8523"><span class="mrow" id="MathJax-Span-8524"><span class="mn" id="MathJax-Span-8525" style="font-size: 70.7%; font-family: MathJax_Main;">10</span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.105em, 1001.49em, 4.346em, -999.997em); top: -2.54em; left: 50%; margin-left: -0.741em;"><span class="mtd" id="MathJax-Span-8544"><span class="mrow" id="MathJax-Span-8545"><span class="msubsup" id="MathJax-Span-8546"><span style="display: inline-block; position: relative; width: 1.492em; height: 0px;"><span style="position: absolute; clip: rect(3.105em, 1000.75em, 4.159em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-8547" style="font-family: MathJax_Math-italic;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.065em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.748em;"><span class="texatom" id="MathJax-Span-8548"><span class="mrow" id="MathJax-Span-8549"><span class="mn" id="MathJax-Span-8550" style="font-size: 70.7%; font-family: MathJax_Main;">20</span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.656em;"></span></span><span style="position: absolute; clip: rect(2.422em, 1000em, 5.586em, -999.997em); top: -3.967em; left: 2.484em;"><span style="display: inline-block; position: relative; width: 0em; height: 0px;"><span style="position: absolute; clip: rect(3.787em, 1000em, 4.159em, -999.997em); top: -5.332em; left: 50%; margin-left: 0em;"><span class="mtd" id="MathJax-Span-8501"><span class="mrow" id="MathJax-Span-8502"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.787em, 1000em, 4.159em, -999.997em); top: -3.905em; left: 50%; margin-left: 0em;"><span class="mtd" id="MathJax-Span-8526"><span class="mrow" id="MathJax-Span-8527"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.787em, 1000em, 4.159em, -999.997em); top: -2.54em; left: 50%; margin-left: 0em;"><span class="mtd" id="MathJax-Span-8551"><span class="mrow" id="MathJax-Span-8552"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(2.422em, 1001.49em, 6.455em, -999.997em); top: -4.65em; left: 3.477em;"><span style="display: inline-block; position: relative; width: 1.492em; height: 0px;"><span style="position: absolute; clip: rect(3.105em, 1001.49em, 4.346em, -999.997em); top: -5.332em; left: 50%; margin-left: -0.741em;"><span class="mtd" id="MathJax-Span-8503"><span class="mrow" id="MathJax-Span-8504"><span class="msubsup" id="MathJax-Span-8505"><span style="display: inline-block; position: relative; width: 1.492em; height: 0px;"><span style="position: absolute; clip: rect(3.105em, 1000.75em, 4.159em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-8506" style="font-family: MathJax_Math-italic;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.065em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.748em;"><span class="texatom" id="MathJax-Span-8507"><span class="mrow" id="MathJax-Span-8508"><span class="mn" id="MathJax-Span-8509" style="font-size: 70.7%; font-family: MathJax_Main;">01</span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.105em, 1001.49em, 4.283em, -999.997em); top: -3.905em; left: 50%; margin-left: -0.741em;"><span class="mtd" id="MathJax-Span-8528"><span class="mrow" id="MathJax-Span-8529"><span class="msubsup" id="MathJax-Span-8530"><span style="display: inline-block; position: relative; width: 1.492em; height: 0px;"><span style="position: absolute; clip: rect(3.105em, 1000.75em, 4.159em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-8531" style="font-family: MathJax_Math-italic;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.065em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.748em;"><span class="texatom" id="MathJax-Span-8532"><span class="mrow" id="MathJax-Span-8533"><span class="mn" id="MathJax-Span-8534" style="font-size: 70.7%; font-family: MathJax_Main;">11</span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.105em, 1001.49em, 4.283em, -999.997em); top: -2.54em; left: 50%; margin-left: -0.741em;"><span class="mtd" id="MathJax-Span-8553"><span class="mrow" id="MathJax-Span-8554"><span class="msubsup" id="MathJax-Span-8555"><span style="display: inline-block; position: relative; width: 1.492em; height: 0px;"><span style="position: absolute; clip: rect(3.105em, 1000.75em, 4.159em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-8556" style="font-family: MathJax_Math-italic;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.065em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.748em;"><span class="texatom" id="MathJax-Span-8557"><span class="mrow" id="MathJax-Span-8558"><span class="mn" id="MathJax-Span-8559" style="font-size: 70.7%; font-family: MathJax_Main;">21</span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.656em;"></span></span><span style="position: absolute; clip: rect(2.422em, 1000em, 5.586em, -999.997em); top: -3.967em; left: 6.02em;"><span style="display: inline-block; position: relative; width: 0em; height: 0px;"><span style="position: absolute; clip: rect(3.787em, 1000em, 4.159em, -999.997em); top: -5.332em; left: 50%; margin-left: 0em;"><span class="mtd" id="MathJax-Span-8510"><span class="mrow" id="MathJax-Span-8511"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.787em, 1000em, 4.159em, -999.997em); top: -3.905em; left: 50%; margin-left: 0em;"><span class="mtd" id="MathJax-Span-8535"><span class="mrow" id="MathJax-Span-8536"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.787em, 1000em, 4.159em, -999.997em); top: -2.54em; left: 50%; margin-left: 0em;"><span class="mtd" id="MathJax-Span-8560"><span class="mrow" id="MathJax-Span-8561"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(2.422em, 1001.49em, 6.455em, -999.997em); top: -4.65em; left: 7.013em;"><span style="display: inline-block; position: relative; width: 1.492em; height: 0px;"><span style="position: absolute; clip: rect(3.105em, 1001.49em, 4.346em, -999.997em); top: -5.332em; left: 50%; margin-left: -0.741em;"><span class="mtd" id="MathJax-Span-8512"><span class="mrow" id="MathJax-Span-8513"><span class="msubsup" id="MathJax-Span-8514"><span style="display: inline-block; position: relative; width: 1.492em; height: 0px;"><span style="position: absolute; clip: rect(3.105em, 1000.75em, 4.159em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-8515" style="font-family: MathJax_Math-italic;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.065em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.748em;"><span class="texatom" id="MathJax-Span-8516"><span class="mrow" id="MathJax-Span-8517"><span class="mn" id="MathJax-Span-8518" style="font-size: 70.7%; font-family: MathJax_Main;">02</span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.105em, 1001.49em, 4.283em, -999.997em); top: -3.905em; left: 50%; margin-left: -0.741em;"><span class="mtd" id="MathJax-Span-8537"><span class="mrow" id="MathJax-Span-8538"><span class="msubsup" id="MathJax-Span-8539"><span style="display: inline-block; position: relative; width: 1.492em; height: 0px;"><span style="position: absolute; clip: rect(3.105em, 1000.75em, 4.159em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-8540" style="font-family: MathJax_Math-italic;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.065em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.748em;"><span class="texatom" id="MathJax-Span-8541"><span class="mrow" id="MathJax-Span-8542"><span class="mn" id="MathJax-Span-8543" style="font-size: 70.7%; font-family: MathJax_Main;">12</span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.105em, 1001.49em, 4.283em, -999.997em); top: -2.54em; left: 50%; margin-left: -0.741em;"><span class="mtd" id="MathJax-Span-8562"><span class="mrow" id="MathJax-Span-8563"><span class="msubsup" id="MathJax-Span-8564"><span style="display: inline-block; position: relative; width: 1.492em; height: 0px;"><span style="position: absolute; clip: rect(3.105em, 1000.75em, 4.159em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-8565" style="font-family: MathJax_Math-italic;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.065em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.748em;"><span class="texatom" id="MathJax-Span-8566"><span class="mrow" id="MathJax-Span-8567"><span class="mn" id="MathJax-Span-8568" style="font-size: 70.7%; font-family: MathJax_Main;">22</span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.656em;"></span></span></span></span><span class="mo" id="MathJax-Span-8569" style="vertical-align: 2.174em;"><span style="display: inline-block; position: relative; width: 0.685em; height: 0px;"><span style="position: absolute; font-family: MathJax_Size4; top: -2.788em; left: 0em;">⎤<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; font-family: MathJax_Size4; top: -0.803em; left: 0em;">⎦<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -1.796em; left: 0em;">⎥<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.532em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -2.15em; border-left: 0px solid; width: 0px; height: 4.85em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>C</mi><mo>=</mo><mrow><mo>[</mo><mtable rowspacing="4pt" columnspacing="1em"><mtr><mtd><msub><mi>C</mi><mrow class="MJX-TeXAtom-ORD"><mn>00</mn></mrow></msub></mtd><mtd></mtd><mtd><msub><mi>C</mi><mrow class="MJX-TeXAtom-ORD"><mn>01</mn></mrow></msub></mtd><mtd></mtd><mtd><msub><mi>C</mi><mrow class="MJX-TeXAtom-ORD"><mn>02</mn></mrow></msub></mtd></mtr><mtr><mtd><msub><mi>C</mi><mrow class="MJX-TeXAtom-ORD"><mn>10</mn></mrow></msub></mtd><mtd></mtd><mtd><msub><mi>C</mi><mrow class="MJX-TeXAtom-ORD"><mn>11</mn></mrow></msub></mtd><mtd></mtd><mtd><msub><mi>C</mi><mrow class="MJX-TeXAtom-ORD"><mn>12</mn></mrow></msub></mtd></mtr><mtr><mtd><msub><mi>C</mi><mrow class="MJX-TeXAtom-ORD"><mn>20</mn></mrow></msub></mtd><mtd></mtd><mtd><msub><mi>C</mi><mrow class="MJX-TeXAtom-ORD"><mn>21</mn></mrow></msub></mtd><mtd></mtd><mtd><msub><mi>C</mi><mrow class="MJX-TeXAtom-ORD"><mn>22</mn></mrow></msub></mtd></mtr></mtable><mo>]</mo></mrow></math></span></span><script type="math/tex" id="MathJax-Element-243">C=\begin{bmatrix} C_{00} && C_{01} && C_{02} \\ C_{10} && C_{11} && C_{12} \\ C_{20} && C_{21} && C_{22} \end{bmatrix}</script></p>
<p>It is then possible to solve for the roll, pitch, yaw angles!</p>
<p><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-244-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mtable columnalign=&quot;right left right left right left right left right left right left&quot; rowspacing=&quot;3pt&quot; columnspacing=&quot;0em 2em 0em 2em 0em 2em 0em 2em 0em 2em 0em&quot; displaystyle=&quot;true&quot;&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mi&gt;C&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mn&gt;20&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mi&gt;&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mi&gt;sin&lt;/mi&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;&amp;#x03B2;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mi&gt;&amp;#x03B2;&lt;/mi&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mi&gt;&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;msup&gt;&lt;mi&gt;sin&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;C&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mn&gt;20&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mspace width=&quot;2em&quot; /&gt;&lt;mo&gt;&amp;#x2014;&lt;/mo&gt;&lt;mo&gt;&amp;#x2014;&lt;/mo&gt;&lt;mo&gt;&amp;#x2014;&lt;/mo&gt;&lt;mo&gt;&amp;#x2014;&lt;/mo&gt;&lt;mo&gt;&amp;#x2014;&lt;/mo&gt;&lt;mo&gt;&amp;#x2014;&lt;/mo&gt;&lt;mo&gt;&amp;#x2013;&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mn&gt;3&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;/mtable&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-8570" style="width: 24.259em; display: inline-block;"><span style="display: inline-block; position: relative; width: 19.544em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(0.685em, 1019.23em, 3.539em, -999.997em); top: -2.354em; left: 0em;"><span class="mrow" id="MathJax-Span-8571"><span class="mtable" id="MathJax-Span-8572" style="padding-right: 0.189em; padding-left: 0.189em;"><span style="display: inline-block; position: relative; width: 19.172em; height: 0px;"><span style="position: absolute; clip: rect(2.36em, 1001.49em, 5.09em, -999.997em); top: -3.967em; left: 0em;"><span style="display: inline-block; position: relative; width: 1.492em; height: 0px;"><span style="position: absolute; clip: rect(3.105em, 1001.49em, 4.346em, -999.997em); top: -4.65em; right: 0em;"><span class="mtd" id="MathJax-Span-8573"><span class="mrow" id="MathJax-Span-8574"><span class="msubsup" id="MathJax-Span-8575"><span style="display: inline-block; position: relative; width: 1.492em; height: 0px;"><span style="position: absolute; clip: rect(3.105em, 1000.75em, 4.159em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-8576" style="font-family: MathJax_Math-italic;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.065em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.748em;"><span class="texatom" id="MathJax-Span-8577"><span class="mrow" id="MathJax-Span-8578"><span class="mn" id="MathJax-Span-8579" style="font-size: 70.7%; font-family: MathJax_Main;">20</span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.105em, 1000.56em, 4.346em, -999.997em); top: -3.223em; right: 0em;"><span class="mtd" id="MathJax-Span-8590"><span class="mrow" id="MathJax-Span-8591"><span class="mi" id="MathJax-Span-8592" style="font-family: MathJax_Math-italic;">β<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(2.36em, 1017.56em, 5.152em, -999.997em); top: -3.967em; left: 1.492em;"><span style="display: inline-block; position: relative; width: 17.621em; height: 0px;"><span style="position: absolute; clip: rect(3.043em, 1004.72em, 4.408em, -999.997em); top: -4.65em; left: 0em;"><span class="mtd" id="MathJax-Span-8580"><span class="mrow" id="MathJax-Span-8581"><span class="mi" id="MathJax-Span-8582"></span><span class="mo" id="MathJax-Span-8583" style="font-family: MathJax_Main; padding-left: 0.251em;">=</span><span class="mo" id="MathJax-Span-8584" style="font-family: MathJax_Main; padding-left: 0.251em;">−</span><span class="mi" id="MathJax-Span-8585" style="font-family: MathJax_Main; padding-left: 0.189em;">sin</span><span class="mo" id="MathJax-Span-8586"></span><span class="mo" id="MathJax-Span-8587" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-8588" style="font-family: MathJax_Math-italic;">β<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-8589" style="font-family: MathJax_Main;">)</span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(2.919em, 1017.56em, 4.408em, -999.997em); top: -3.223em; left: 0em;"><span class="mtd" id="MathJax-Span-8593"><span class="mrow" id="MathJax-Span-8594"><span class="mi" id="MathJax-Span-8595"></span><span class="mo" id="MathJax-Span-8596" style="font-family: MathJax_Main; padding-left: 0.251em;">=</span><span class="msubsup" id="MathJax-Span-8597" style="padding-left: 0.251em;"><span style="display: inline-block; position: relative; width: 2.236em; height: 0px;"><span style="position: absolute; clip: rect(3.105em, 1001.24em, 4.159em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-8598" style="font-family: MathJax_Main;">sin</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -4.401em; left: 1.244em;"><span class="texatom" id="MathJax-Span-8599"><span class="mrow" id="MathJax-Span-8600"><span class="mo" id="MathJax-Span-8601" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="mn" id="MathJax-Span-8602" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="mo" id="MathJax-Span-8603"></span><span class="mo" id="MathJax-Span-8604" style="font-family: MathJax_Main;">(</span><span class="mo" id="MathJax-Span-8605" style="font-family: MathJax_Main;">−</span><span class="msubsup" id="MathJax-Span-8606"><span style="display: inline-block; position: relative; width: 1.492em; height: 0px;"><span style="position: absolute; clip: rect(3.105em, 1000.75em, 4.159em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-8607" style="font-family: MathJax_Math-italic;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.065em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.748em;"><span class="texatom" id="MathJax-Span-8608"><span class="mrow" id="MathJax-Span-8609"><span class="mn" id="MathJax-Span-8610" style="font-size: 70.7%; font-family: MathJax_Main;">20</span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="mo" id="MathJax-Span-8611" style="font-family: MathJax_Main;">)</span><span class="mspace" id="MathJax-Span-8612" style="height: 0em; vertical-align: 0em; width: 1.988em; display: inline-block; overflow: hidden;"></span><span class="mo" id="MathJax-Span-8613" style="font-family: MathJax_Main;">—</span><span class="mo" id="MathJax-Span-8614" style="font-family: MathJax_Main; padding-left: 0.189em;">—</span><span class="mo" id="MathJax-Span-8615" style="font-family: MathJax_Main; padding-left: 0.189em;">—</span><span class="mo" id="MathJax-Span-8616" style="font-family: MathJax_Main; padding-left: 0.189em;">—</span><span class="mo" id="MathJax-Span-8617" style="font-family: MathJax_Main; padding-left: 0.189em;">—</span><span class="mo" id="MathJax-Span-8618" style="font-family: MathJax_Main; padding-left: 0.189em;">—</span><span class="mo" id="MathJax-Span-8619" style="font-family: MathJax_Main; padding-left: 0.189em;">–</span><span class="mo" id="MathJax-Span-8620" style="font-family: MathJax_Main; padding-left: 0.189em;">(</span><span class="mn" id="MathJax-Span-8621" style="font-family: MathJax_Main;">3</span><span class="mo" id="MathJax-Span-8622" style="font-family: MathJax_Main;">)</span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.36em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -1.304em; border-left: 0px solid; width: 0px; height: 3.235em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mtable columnalign="right left right left right left right left right left right left" rowspacing="3pt" columnspacing="0em 2em 0em 2em 0em 2em 0em 2em 0em 2em 0em" displaystyle="true"><mtr><mtd><msub><mi>C</mi><mrow class="MJX-TeXAtom-ORD"><mn>20</mn></mrow></msub></mtd><mtd><mi></mi><mo>=</mo><mo>−</mo><mi>sin</mi><mo>⁡</mo><mo stretchy="false">(</mo><mi>β</mi><mo stretchy="false">)</mo></mtd></mtr><mtr><mtd><mi>β</mi></mtd><mtd><mi></mi><mo>=</mo><msup><mi>sin</mi><mrow class="MJX-TeXAtom-ORD"><mo>−</mo><mn>1</mn></mrow></msup><mo>⁡</mo><mo stretchy="false">(</mo><mo>−</mo><msub><mi>C</mi><mrow class="MJX-TeXAtom-ORD"><mn>20</mn></mrow></msub><mo stretchy="false">)</mo><mspace width="2em"></mspace><mo>—</mo><mo>—</mo><mo>—</mo><mo>—</mo><mo>—</mo><mo>—</mo><mo>–</mo><mo stretchy="false">(</mo><mn>3</mn><mo stretchy="false">)</mo></mtd></mtr></mtable></math></span></span><script type="math/tex" id="MathJax-Element-244">\begin{align}C_{20}&=-\sin(\beta) \\ \beta&=\sin^{-1}(-C_{20})\qquad     ——————–     (3)\end{align}</script></p>
<p>Thus pitch is given by the above equation (3).</p>
<h6><span style="text-decoration: underline;">CASE 1</span></h6>
<p><span style="color: #ff0000;">If <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-245-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;cos&lt;/mi&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;&amp;#x03B2;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;&amp;#x2260;&lt;/mo&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-8623" style="width: 5.586em; display: inline-block;"><span style="display: inline-block; position: relative; width: 4.47em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(1.43em, 1004.41em, 2.795em, -999.997em); top: -2.354em; left: 0em;"><span class="mrow" id="MathJax-Span-8624"><span class="mi" id="MathJax-Span-8625" style="font-family: MathJax_Main;">cos</span><span class="mo" id="MathJax-Span-8626"></span><span class="mo" id="MathJax-Span-8627" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-8628" style="font-family: MathJax_Math-italic;">β<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-8629" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-8630" style="font-family: MathJax_Main; padding-left: 0.251em;">≠</span><span class="mn" id="MathJax-Span-8631" style="font-family: MathJax_Main; padding-left: 0.251em;">0</span></span><span style="display: inline-block; width: 0px; height: 2.36em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.381em; border-left: 0px solid; width: 0px; height: 1.388em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>cos</mi><mo>⁡</mo><mo stretchy="false">(</mo><mi>β</mi><mo stretchy="false">)</mo><mo>≠</mo><mn>0</mn></math></span></span><script type="math/tex" id="MathJax-Element-245">\cos(\beta)\neq0</script></span>,</p>
<p><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-246-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mtable columnalign=&quot;right left right left right left right left right left right left&quot; rowspacing=&quot;3pt&quot; columnspacing=&quot;0em 2em 0em 2em 0em 2em 0em 2em 0em 2em 0em&quot; displaystyle=&quot;true&quot;&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mfrac&gt;&lt;msub&gt;&lt;mi&gt;C&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mn&gt;10&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;msub&gt;&lt;mi&gt;C&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mn&gt;00&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mfrac&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mi&gt;&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mfrac&gt;&lt;mrow&gt;&lt;mi&gt;sin&lt;/mi&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;&amp;#x03B1;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mi&gt;cos&lt;/mi&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;&amp;#x03B2;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;mrow&gt;&lt;mi&gt;cos&lt;/mi&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;&amp;#x03B1;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mi&gt;cos&lt;/mi&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;&amp;#x03B2;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;tan&lt;/mi&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;&amp;#x03B1;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mi&gt;&amp;#x03B1;&lt;/mi&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mi&gt;&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;msup&gt;&lt;mi&gt;tan&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;mrow&gt;&lt;mo&gt;(&lt;/mo&gt;&lt;mfrac&gt;&lt;msub&gt;&lt;mi&gt;C&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mn&gt;10&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;msub&gt;&lt;mi&gt;C&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mn&gt;00&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mfrac&gt;&lt;mo&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;mspace width=&quot;2em&quot; /&gt;&lt;mo&gt;&amp;#x2014;&lt;/mo&gt;&lt;mo&gt;&amp;#x2014;&lt;/mo&gt;&lt;mo&gt;&amp;#x2014;&lt;/mo&gt;&lt;mo&gt;&amp;#x2014;&lt;/mo&gt;&lt;mo&gt;&amp;#x2014;&lt;/mo&gt;&lt;mo&gt;&amp;#x2014;&lt;/mo&gt;&lt;mo&gt;&amp;#x2013;&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mn&gt;4&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;/mtable&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-8632" style="width: 25.251em; display: inline-block;"><span style="display: inline-block; position: relative; width: 20.35em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(-0.679em, 1020.04em, 4.904em, -999.997em); top: -2.354em; left: 0em;"><span class="mrow" id="MathJax-Span-8633"><span class="mtable" id="MathJax-Span-8634" style="padding-right: 0.189em; padding-left: 0.189em;"><span style="display: inline-block; position: relative; width: 19.978em; height: 0px;"><span style="position: absolute; clip: rect(2.236em, 1001.86em, 6.765em, -999.997em); top: -5.146em; left: 0em;"><span style="display: inline-block; position: relative; width: 1.864em; height: 0px;"><span style="position: absolute; clip: rect(2.422em, 1001.86em, 5.028em, -999.997em); top: -5.332em; right: 0em;"><span class="mtd" id="MathJax-Span-8635"><span class="mrow" id="MathJax-Span-8636"><span class="mfrac" id="MathJax-Span-8637"><span style="display: inline-block; position: relative; width: 1.616em; height: 0px; margin-right: 0.127em; margin-left: 0.127em;"><span style="position: absolute; clip: rect(3.105em, 1001.49em, 4.346em, -999.997em); top: -4.65em; left: 50%; margin-left: -0.741em;"><span class="msubsup" id="MathJax-Span-8638"><span style="display: inline-block; position: relative; width: 1.492em; height: 0px;"><span style="position: absolute; clip: rect(3.105em, 1000.75em, 4.159em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-8639" style="font-family: MathJax_Math-italic;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.065em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.748em;"><span class="texatom" id="MathJax-Span-8640"><span class="mrow" id="MathJax-Span-8641"><span class="mn" id="MathJax-Span-8642" style="font-size: 70.7%; font-family: MathJax_Main;">10</span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.105em, 1001.49em, 4.346em, -999.997em); top: -3.285em; left: 50%; margin-left: -0.741em;"><span class="msubsup" id="MathJax-Span-8643"><span style="display: inline-block; position: relative; width: 1.492em; height: 0px;"><span style="position: absolute; clip: rect(3.105em, 1000.75em, 4.159em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-8644" style="font-family: MathJax_Math-italic;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.065em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.748em;"><span class="texatom" id="MathJax-Span-8645"><span class="mrow" id="MathJax-Span-8646"><span class="mn" id="MathJax-Span-8647" style="font-size: 70.7%; font-family: MathJax_Main;">00</span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(0.81em, 1001.62em, 1.244em, -999.997em); top: -1.3em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 1.616em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.058em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.353em, 1000.62em, 4.159em, -999.997em); top: -2.602em; right: 0em;"><span class="mtd" id="MathJax-Span-8681"><span class="mrow" id="MathJax-Span-8682"><span class="mi" id="MathJax-Span-8683" style="font-family: MathJax_Math-italic;">α</span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span><span style="display: inline-block; width: 0px; height: 5.152em;"></span></span><span style="position: absolute; clip: rect(3.167em, 1018.05em, 8.75em, -999.997em); top: -6.2em; left: 1.864em;"><span style="display: inline-block; position: relative; width: 18.117em; height: 0px;"><span style="position: absolute; clip: rect(2.298em, 1011.36em, 5.152em, -999.997em); top: -5.332em; left: 0em;"><span class="mtd" id="MathJax-Span-8648"><span class="mrow" id="MathJax-Span-8649"><span class="mi" id="MathJax-Span-8650"></span><span class="mo" id="MathJax-Span-8651" style="font-family: MathJax_Main; padding-left: 0.251em;">=</span><span class="mfrac" id="MathJax-Span-8652" style="padding-left: 0.251em;"><span style="display: inline-block; position: relative; width: 5.772em; height: 0px; margin-right: 0.127em; margin-left: 0.127em;"><span style="position: absolute; clip: rect(3.043em, 1005.46em, 4.408em, -999.997em); top: -4.712em; left: 50%; margin-left: -2.788em;"><span class="mrow" id="MathJax-Span-8653"><span class="mi" id="MathJax-Span-8654" style="font-family: MathJax_Main;">sin</span><span class="mo" id="MathJax-Span-8655"></span><span class="mo" id="MathJax-Span-8656" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-8657" style="font-family: MathJax_Math-italic;">α</span><span class="mo" id="MathJax-Span-8658" style="font-family: MathJax_Main;">)</span><span class="mi" id="MathJax-Span-8659" style="font-family: MathJax_Main; padding-left: 0.189em;">cos</span><span class="mo" id="MathJax-Span-8660"></span><span class="mo" id="MathJax-Span-8661" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-8662" style="font-family: MathJax_Math-italic;">β<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-8663" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.043em, 1005.52em, 4.408em, -999.997em); top: -3.223em; left: 50%; margin-left: -2.788em;"><span class="mrow" id="MathJax-Span-8664"><span class="mi" id="MathJax-Span-8665" style="font-family: MathJax_Main;">cos</span><span class="mo" id="MathJax-Span-8666"></span><span class="mo" id="MathJax-Span-8667" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-8668" style="font-family: MathJax_Math-italic;">α</span><span class="mo" id="MathJax-Span-8669" style="font-family: MathJax_Main;">)</span><span class="mi" id="MathJax-Span-8670" style="font-family: MathJax_Main; padding-left: 0.189em;">cos</span><span class="mo" id="MathJax-Span-8671"></span><span class="mo" id="MathJax-Span-8672" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-8673" style="font-family: MathJax_Math-italic;">β<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-8674" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(0.81em, 1005.77em, 1.244em, -999.997em); top: -1.3em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 5.772em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.058em;"></span></span></span></span><span class="mo" id="MathJax-Span-8675" style="font-family: MathJax_Main; padding-left: 0.251em;">=</span><span class="mi" id="MathJax-Span-8676" style="font-family: MathJax_Main; padding-left: 0.251em;">tan</span><span class="mo" id="MathJax-Span-8677"></span><span class="mo" id="MathJax-Span-8678" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-8679" style="font-family: MathJax_Math-italic;">α</span><span class="mo" id="MathJax-Span-8680" style="font-family: MathJax_Main;">)</span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(2.36em, 1018.05em, 5.09em, -999.997em); top: -2.602em; left: 0em;"><span class="mtd" id="MathJax-Span-8684"><span class="mrow" id="MathJax-Span-8685"><span class="mi" id="MathJax-Span-8686"></span><span class="mo" id="MathJax-Span-8687" style="font-family: MathJax_Main; padding-left: 0.251em;">=</span><span class="msubsup" id="MathJax-Span-8688" style="padding-left: 0.251em;"><span style="display: inline-block; position: relative; width: 2.422em; height: 0px;"><span style="position: absolute; clip: rect(3.167em, 1001.43em, 4.159em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-8689" style="font-family: MathJax_Main;">tan</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -4.401em; left: 1.43em;"><span class="texatom" id="MathJax-Span-8690"><span class="mrow" id="MathJax-Span-8691"><span class="mo" id="MathJax-Span-8692" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="mn" id="MathJax-Span-8693" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="mo" id="MathJax-Span-8694"></span><span class="mrow" id="MathJax-Span-8695"><span class="mo" id="MathJax-Span-8696" style="vertical-align: 0em;"><span style="font-family: MathJax_Size3;">(</span></span><span class="mfrac" id="MathJax-Span-8697"><span style="display: inline-block; position: relative; width: 1.616em; height: 0px; margin-right: 0.127em; margin-left: 0.127em;"><span style="position: absolute; clip: rect(3.105em, 1001.49em, 4.346em, -999.997em); top: -4.65em; left: 50%; margin-left: -0.741em;"><span class="msubsup" id="MathJax-Span-8698"><span style="display: inline-block; position: relative; width: 1.492em; height: 0px;"><span style="position: absolute; clip: rect(3.105em, 1000.75em, 4.159em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-8699" style="font-family: MathJax_Math-italic;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.065em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.748em;"><span class="texatom" id="MathJax-Span-8700"><span class="mrow" id="MathJax-Span-8701"><span class="mn" id="MathJax-Span-8702" style="font-size: 70.7%; font-family: MathJax_Main;">10</span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.105em, 1001.49em, 4.346em, -999.997em); top: -3.285em; left: 50%; margin-left: -0.741em;"><span class="msubsup" id="MathJax-Span-8703"><span style="display: inline-block; position: relative; width: 1.492em; height: 0px;"><span style="position: absolute; clip: rect(3.105em, 1000.75em, 4.159em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-8704" style="font-family: MathJax_Math-italic;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.065em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.748em;"><span class="texatom" id="MathJax-Span-8705"><span class="mrow" id="MathJax-Span-8706"><span class="mn" id="MathJax-Span-8707" style="font-size: 70.7%; font-family: MathJax_Main;">00</span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(0.81em, 1001.62em, 1.244em, -999.997em); top: -1.3em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 1.616em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.058em;"></span></span></span></span><span class="mo" id="MathJax-Span-8708" style="vertical-align: 0em;"><span style="font-family: MathJax_Size3;">)</span></span></span><span class="mspace" id="MathJax-Span-8709" style="height: 0em; vertical-align: 0em; width: 1.988em; display: inline-block; overflow: hidden;"></span><span class="mo" id="MathJax-Span-8710" style="font-family: MathJax_Main;">—</span><span class="mo" id="MathJax-Span-8711" style="font-family: MathJax_Main; padding-left: 0.189em;">—</span><span class="mo" id="MathJax-Span-8712" style="font-family: MathJax_Main; padding-left: 0.189em;">—</span><span class="mo" id="MathJax-Span-8713" style="font-family: MathJax_Main; padding-left: 0.189em;">—</span><span class="mo" id="MathJax-Span-8714" style="font-family: MathJax_Main; padding-left: 0.189em;">—</span><span class="mo" id="MathJax-Span-8715" style="font-family: MathJax_Main; padding-left: 0.189em;">—</span><span class="mo" id="MathJax-Span-8716" style="font-family: MathJax_Main; padding-left: 0.189em;">–</span><span class="mo" id="MathJax-Span-8717" style="font-family: MathJax_Main; padding-left: 0.189em;">(</span><span class="mn" id="MathJax-Span-8718" style="font-family: MathJax_Main;">4</span><span class="mo" id="MathJax-Span-8719" style="font-family: MathJax_Main;">)</span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span><span style="display: inline-block; width: 0px; height: 6.207em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.36em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -2.996em; border-left: 0px solid; width: 0px; height: 6.619em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mtable columnalign="right left right left right left right left right left right left" rowspacing="3pt" columnspacing="0em 2em 0em 2em 0em 2em 0em 2em 0em 2em 0em" displaystyle="true"><mtr><mtd><mfrac><msub><mi>C</mi><mrow class="MJX-TeXAtom-ORD"><mn>10</mn></mrow></msub><msub><mi>C</mi><mrow class="MJX-TeXAtom-ORD"><mn>00</mn></mrow></msub></mfrac></mtd><mtd><mi></mi><mo>=</mo><mfrac><mrow><mi>sin</mi><mo>⁡</mo><mo stretchy="false">(</mo><mi>α</mi><mo stretchy="false">)</mo><mi>cos</mi><mo>⁡</mo><mo stretchy="false">(</mo><mi>β</mi><mo stretchy="false">)</mo></mrow><mrow><mi>cos</mi><mo>⁡</mo><mo stretchy="false">(</mo><mi>α</mi><mo stretchy="false">)</mo><mi>cos</mi><mo>⁡</mo><mo stretchy="false">(</mo><mi>β</mi><mo stretchy="false">)</mo></mrow></mfrac><mo>=</mo><mi>tan</mi><mo>⁡</mo><mo stretchy="false">(</mo><mi>α</mi><mo stretchy="false">)</mo></mtd></mtr><mtr><mtd><mi>α</mi></mtd><mtd><mi></mi><mo>=</mo><msup><mi>tan</mi><mrow class="MJX-TeXAtom-ORD"><mo>−</mo><mn>1</mn></mrow></msup><mo>⁡</mo><mrow><mo>(</mo><mfrac><msub><mi>C</mi><mrow class="MJX-TeXAtom-ORD"><mn>10</mn></mrow></msub><msub><mi>C</mi><mrow class="MJX-TeXAtom-ORD"><mn>00</mn></mrow></msub></mfrac><mo>)</mo></mrow><mspace width="2em"></mspace><mo>—</mo><mo>—</mo><mo>—</mo><mo>—</mo><mo>—</mo><mo>—</mo><mo>–</mo><mo stretchy="false">(</mo><mn>4</mn><mo stretchy="false">)</mo></mtd></mtr></mtable></math></span></span><script type="math/tex" id="MathJax-Element-246">\begin{align}\frac{C_{10}}{C_{00}} &= \frac{\sin(\alpha)\cos(\beta)}{\cos(\alpha)\cos(\beta)} = \tan(\alpha) \\ \alpha&=\tan^{-1}\left(\frac{C_{10}}{C_{00}}\right)\qquad     ——————–     (4)\end{align}</script></p>
<p><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-247-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mtable columnalign=&quot;right left right left right left right left right left right left&quot; rowspacing=&quot;3pt&quot; columnspacing=&quot;0em 2em 0em 2em 0em 2em 0em 2em 0em 2em 0em&quot; displaystyle=&quot;true&quot;&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mfrac&gt;&lt;msub&gt;&lt;mi&gt;C&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mn&gt;21&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;msub&gt;&lt;mi&gt;C&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mn&gt;22&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mfrac&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mi&gt;&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mfrac&gt;&lt;mrow&gt;&lt;mi&gt;cos&lt;/mi&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;&amp;#x03B2;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mi&gt;sin&lt;/mi&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;&amp;#x03B3;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;mrow&gt;&lt;mi&gt;cos&lt;/mi&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;&amp;#x03B2;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mi&gt;cos&lt;/mi&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;&amp;#x03B3;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;tan&lt;/mi&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;&amp;#x03B3;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mi&gt;&amp;#x03B3;&lt;/mi&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mi&gt;&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;msup&gt;&lt;mi&gt;tan&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;mrow&gt;&lt;mo&gt;(&lt;/mo&gt;&lt;mfrac&gt;&lt;msub&gt;&lt;mi&gt;C&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mn&gt;21&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;msub&gt;&lt;mi&gt;C&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mn&gt;22&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mfrac&gt;&lt;mo&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;mspace width=&quot;2em&quot; /&gt;&lt;mo&gt;&amp;#x2014;&lt;/mo&gt;&lt;mo&gt;&amp;#x2014;&lt;/mo&gt;&lt;mo&gt;&amp;#x2014;&lt;/mo&gt;&lt;mo&gt;&amp;#x2014;&lt;/mo&gt;&lt;mo&gt;&amp;#x2014;&lt;/mo&gt;&lt;mo&gt;&amp;#x2014;&lt;/mo&gt;&lt;mo&gt;&amp;#x2013;&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mn&gt;5&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;/mtable&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-8720" style="width: 25.251em; display: inline-block;"><span style="display: inline-block; position: relative; width: 20.35em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(-0.679em, 1020.04em, 4.904em, -999.997em); top: -2.354em; left: 0em;"><span class="mrow" id="MathJax-Span-8721"><span class="mtable" id="MathJax-Span-8722" style="padding-right: 0.189em; padding-left: 0.189em;"><span style="display: inline-block; position: relative; width: 19.978em; height: 0px;"><span style="position: absolute; clip: rect(2.422em, 1001.86em, 7.137em, -999.997em); top: -5.332em; left: 0em;"><span style="display: inline-block; position: relative; width: 1.864em; height: 0px;"><span style="position: absolute; clip: rect(2.422em, 1001.86em, 5.028em, -999.997em); top: -5.332em; right: 0em;"><span class="mtd" id="MathJax-Span-8723"><span class="mrow" id="MathJax-Span-8724"><span class="mfrac" id="MathJax-Span-8725"><span style="display: inline-block; position: relative; width: 1.616em; height: 0px; margin-right: 0.127em; margin-left: 0.127em;"><span style="position: absolute; clip: rect(3.105em, 1001.49em, 4.283em, -999.997em); top: -4.65em; left: 50%; margin-left: -0.741em;"><span class="msubsup" id="MathJax-Span-8726"><span style="display: inline-block; position: relative; width: 1.492em; height: 0px;"><span style="position: absolute; clip: rect(3.105em, 1000.75em, 4.159em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-8727" style="font-family: MathJax_Math-italic;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.065em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.748em;"><span class="texatom" id="MathJax-Span-8728"><span class="mrow" id="MathJax-Span-8729"><span class="mn" id="MathJax-Span-8730" style="font-size: 70.7%; font-family: MathJax_Main;">21</span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.105em, 1001.49em, 4.283em, -999.997em); top: -3.285em; left: 50%; margin-left: -0.741em;"><span class="msubsup" id="MathJax-Span-8731"><span style="display: inline-block; position: relative; width: 1.492em; height: 0px;"><span style="position: absolute; clip: rect(3.105em, 1000.75em, 4.159em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-8732" style="font-family: MathJax_Math-italic;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.065em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.748em;"><span class="texatom" id="MathJax-Span-8733"><span class="mrow" id="MathJax-Span-8734"><span class="mn" id="MathJax-Span-8735" style="font-size: 70.7%; font-family: MathJax_Main;">22</span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(0.81em, 1001.62em, 1.244em, -999.997em); top: -1.3em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 1.616em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.058em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.353em, 1000.56em, 4.346em, -999.997em); top: -2.602em; right: 0em;"><span class="mtd" id="MathJax-Span-8769"><span class="mrow" id="MathJax-Span-8770"><span class="mi" id="MathJax-Span-8771" style="font-family: MathJax_Math-italic;">γ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span><span style="display: inline-block; width: 0px; height: 5.338em;"></span></span><span style="position: absolute; clip: rect(3.167em, 1018.05em, 8.75em, -999.997em); top: -6.2em; left: 1.864em;"><span style="display: inline-block; position: relative; width: 18.117em; height: 0px;"><span style="position: absolute; clip: rect(2.298em, 1011.11em, 5.152em, -999.997em); top: -5.332em; left: 0em;"><span class="mtd" id="MathJax-Span-8736"><span class="mrow" id="MathJax-Span-8737"><span class="mi" id="MathJax-Span-8738"></span><span class="mo" id="MathJax-Span-8739" style="font-family: MathJax_Main; padding-left: 0.251em;">=</span><span class="mfrac" id="MathJax-Span-8740" style="padding-left: 0.251em;"><span style="display: inline-block; position: relative; width: 5.648em; height: 0px; margin-right: 0.127em; margin-left: 0.127em;"><span style="position: absolute; clip: rect(3.043em, 1005.34em, 4.408em, -999.997em); top: -4.712em; left: 50%; margin-left: -2.726em;"><span class="mrow" id="MathJax-Span-8741"><span class="mi" id="MathJax-Span-8742" style="font-family: MathJax_Main;">cos</span><span class="mo" id="MathJax-Span-8743"></span><span class="mo" id="MathJax-Span-8744" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-8745" style="font-family: MathJax_Math-italic;">β<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-8746" style="font-family: MathJax_Main;">)</span><span class="mi" id="MathJax-Span-8747" style="font-family: MathJax_Main; padding-left: 0.189em;">sin</span><span class="mo" id="MathJax-Span-8748"></span><span class="mo" id="MathJax-Span-8749" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-8750" style="font-family: MathJax_Math-italic;">γ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-8751" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.043em, 1005.46em, 4.408em, -999.997em); top: -3.223em; left: 50%; margin-left: -2.788em;"><span class="mrow" id="MathJax-Span-8752"><span class="mi" id="MathJax-Span-8753" style="font-family: MathJax_Main;">cos</span><span class="mo" id="MathJax-Span-8754"></span><span class="mo" id="MathJax-Span-8755" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-8756" style="font-family: MathJax_Math-italic;">β<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-8757" style="font-family: MathJax_Main;">)</span><span class="mi" id="MathJax-Span-8758" style="font-family: MathJax_Main; padding-left: 0.189em;">cos</span><span class="mo" id="MathJax-Span-8759"></span><span class="mo" id="MathJax-Span-8760" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-8761" style="font-family: MathJax_Math-italic;">γ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-8762" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(0.81em, 1005.65em, 1.244em, -999.997em); top: -1.3em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 5.648em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.058em;"></span></span></span></span><span class="mo" id="MathJax-Span-8763" style="font-family: MathJax_Main; padding-left: 0.251em;">=</span><span class="mi" id="MathJax-Span-8764" style="font-family: MathJax_Main; padding-left: 0.251em;">tan</span><span class="mo" id="MathJax-Span-8765"></span><span class="mo" id="MathJax-Span-8766" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-8767" style="font-family: MathJax_Math-italic;">γ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-8768" style="font-family: MathJax_Main;">)</span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(2.36em, 1018.05em, 5.09em, -999.997em); top: -2.602em; left: 0em;"><span class="mtd" id="MathJax-Span-8772"><span class="mrow" id="MathJax-Span-8773"><span class="mi" id="MathJax-Span-8774"></span><span class="mo" id="MathJax-Span-8775" style="font-family: MathJax_Main; padding-left: 0.251em;">=</span><span class="msubsup" id="MathJax-Span-8776" style="padding-left: 0.251em;"><span style="display: inline-block; position: relative; width: 2.422em; height: 0px;"><span style="position: absolute; clip: rect(3.167em, 1001.43em, 4.159em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-8777" style="font-family: MathJax_Main;">tan</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -4.401em; left: 1.43em;"><span class="texatom" id="MathJax-Span-8778"><span class="mrow" id="MathJax-Span-8779"><span class="mo" id="MathJax-Span-8780" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="mn" id="MathJax-Span-8781" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="mo" id="MathJax-Span-8782"></span><span class="mrow" id="MathJax-Span-8783"><span class="mo" id="MathJax-Span-8784" style="vertical-align: 0em;"><span style="font-family: MathJax_Size3;">(</span></span><span class="mfrac" id="MathJax-Span-8785"><span style="display: inline-block; position: relative; width: 1.616em; height: 0px; margin-right: 0.127em; margin-left: 0.127em;"><span style="position: absolute; clip: rect(3.105em, 1001.49em, 4.283em, -999.997em); top: -4.65em; left: 50%; margin-left: -0.741em;"><span class="msubsup" id="MathJax-Span-8786"><span style="display: inline-block; position: relative; width: 1.492em; height: 0px;"><span style="position: absolute; clip: rect(3.105em, 1000.75em, 4.159em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-8787" style="font-family: MathJax_Math-italic;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.065em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.748em;"><span class="texatom" id="MathJax-Span-8788"><span class="mrow" id="MathJax-Span-8789"><span class="mn" id="MathJax-Span-8790" style="font-size: 70.7%; font-family: MathJax_Main;">21</span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.105em, 1001.49em, 4.283em, -999.997em); top: -3.285em; left: 50%; margin-left: -0.741em;"><span class="msubsup" id="MathJax-Span-8791"><span style="display: inline-block; position: relative; width: 1.492em; height: 0px;"><span style="position: absolute; clip: rect(3.105em, 1000.75em, 4.159em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-8792" style="font-family: MathJax_Math-italic;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.065em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.748em;"><span class="texatom" id="MathJax-Span-8793"><span class="mrow" id="MathJax-Span-8794"><span class="mn" id="MathJax-Span-8795" style="font-size: 70.7%; font-family: MathJax_Main;">22</span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(0.81em, 1001.62em, 1.244em, -999.997em); top: -1.3em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 1.616em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.058em;"></span></span></span></span><span class="mo" id="MathJax-Span-8796" style="vertical-align: 0em;"><span style="font-family: MathJax_Size3;">)</span></span></span><span class="mspace" id="MathJax-Span-8797" style="height: 0em; vertical-align: 0em; width: 1.988em; display: inline-block; overflow: hidden;"></span><span class="mo" id="MathJax-Span-8798" style="font-family: MathJax_Main;">—</span><span class="mo" id="MathJax-Span-8799" style="font-family: MathJax_Main; padding-left: 0.189em;">—</span><span class="mo" id="MathJax-Span-8800" style="font-family: MathJax_Main; padding-left: 0.189em;">—</span><span class="mo" id="MathJax-Span-8801" style="font-family: MathJax_Main; padding-left: 0.189em;">—</span><span class="mo" id="MathJax-Span-8802" style="font-family: MathJax_Main; padding-left: 0.189em;">—</span><span class="mo" id="MathJax-Span-8803" style="font-family: MathJax_Main; padding-left: 0.189em;">—</span><span class="mo" id="MathJax-Span-8804" style="font-family: MathJax_Main; padding-left: 0.189em;">–</span><span class="mo" id="MathJax-Span-8805" style="font-family: MathJax_Main; padding-left: 0.189em;">(</span><span class="mn" id="MathJax-Span-8806" style="font-family: MathJax_Main;">5</span><span class="mo" id="MathJax-Span-8807" style="font-family: MathJax_Main;">)</span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span><span style="display: inline-block; width: 0px; height: 6.207em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.36em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -2.996em; border-left: 0px solid; width: 0px; height: 6.619em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mtable columnalign="right left right left right left right left right left right left" rowspacing="3pt" columnspacing="0em 2em 0em 2em 0em 2em 0em 2em 0em 2em 0em" displaystyle="true"><mtr><mtd><mfrac><msub><mi>C</mi><mrow class="MJX-TeXAtom-ORD"><mn>21</mn></mrow></msub><msub><mi>C</mi><mrow class="MJX-TeXAtom-ORD"><mn>22</mn></mrow></msub></mfrac></mtd><mtd><mi></mi><mo>=</mo><mfrac><mrow><mi>cos</mi><mo>⁡</mo><mo stretchy="false">(</mo><mi>β</mi><mo stretchy="false">)</mo><mi>sin</mi><mo>⁡</mo><mo stretchy="false">(</mo><mi>γ</mi><mo stretchy="false">)</mo></mrow><mrow><mi>cos</mi><mo>⁡</mo><mo stretchy="false">(</mo><mi>β</mi><mo stretchy="false">)</mo><mi>cos</mi><mo>⁡</mo><mo stretchy="false">(</mo><mi>γ</mi><mo stretchy="false">)</mo></mrow></mfrac><mo>=</mo><mi>tan</mi><mo>⁡</mo><mo stretchy="false">(</mo><mi>γ</mi><mo stretchy="false">)</mo></mtd></mtr><mtr><mtd><mi>γ</mi></mtd><mtd><mi></mi><mo>=</mo><msup><mi>tan</mi><mrow class="MJX-TeXAtom-ORD"><mo>−</mo><mn>1</mn></mrow></msup><mo>⁡</mo><mrow><mo>(</mo><mfrac><msub><mi>C</mi><mrow class="MJX-TeXAtom-ORD"><mn>21</mn></mrow></msub><msub><mi>C</mi><mrow class="MJX-TeXAtom-ORD"><mn>22</mn></mrow></msub></mfrac><mo>)</mo></mrow><mspace width="2em"></mspace><mo>—</mo><mo>—</mo><mo>—</mo><mo>—</mo><mo>—</mo><mo>—</mo><mo>–</mo><mo stretchy="false">(</mo><mn>5</mn><mo stretchy="false">)</mo></mtd></mtr></mtable></math></span></span><script type="math/tex" id="MathJax-Element-247">\begin{align}\frac{C_{21}}{C_{22}} &= \frac{\cos(\beta)\sin(\gamma)}{\cos(\beta)\cos(\gamma)} = \tan(\gamma) \\ \gamma&=\tan^{-1}\left(\frac{C_{21}}{C_{22}}\right)\qquad      ——————–     (5)\end{align}</script></p>
<p>Thus the yaw angle is given by the equation (4), and the roll angle is given by equation (5).</p>
<p><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-248-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mtable columnalign=&quot;right left right left right left right left right left right left&quot; rowspacing=&quot;3pt&quot; columnspacing=&quot;0em 2em 0em 2em 0em 2em 0em 2em 0em 2em 0em&quot; displaystyle=&quot;true&quot;&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mi&gt;w&lt;/mi&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mi&gt;&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;msup&gt;&lt;mi&gt;tan&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;mrow&gt;&lt;mo&gt;(&lt;/mo&gt;&lt;mfrac&gt;&lt;msub&gt;&lt;mi&gt;C&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mn&gt;10&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;msub&gt;&lt;mi&gt;C&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mn&gt;00&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mfrac&gt;&lt;mo&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mi&gt;c&lt;/mi&gt;&lt;mi&gt;h&lt;/mi&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mi&gt;&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;msup&gt;&lt;mi&gt;sin&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;C&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mn&gt;20&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mi&gt;o&lt;/mi&gt;&lt;mi&gt;l&lt;/mi&gt;&lt;mi&gt;l&lt;/mi&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mi&gt;&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;msup&gt;&lt;mi&gt;tan&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;mrow&gt;&lt;mo&gt;(&lt;/mo&gt;&lt;mfrac&gt;&lt;msub&gt;&lt;mi&gt;C&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mn&gt;21&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;msub&gt;&lt;mi&gt;C&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mn&gt;22&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mfrac&gt;&lt;mo&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;/mtable&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-8808" style="width: 11.976em; display: inline-block;"><span style="display: inline-block; position: relative; width: 9.618em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(-1.362em, 1009.25em, 5.586em, -999.997em); top: -2.354em; left: 0em;"><span class="mrow" id="MathJax-Span-8809"><span class="mtable" id="MathJax-Span-8810" style="padding-right: 0.189em; padding-left: 0.189em;"><span style="display: inline-block; position: relative; width: 9.246em; height: 0px;"><span style="position: absolute; clip: rect(2.919em, 1002.17em, 7.819em, -999.997em); top: -5.58em; left: 0em;"><span style="display: inline-block; position: relative; width: 2.236em; height: 0px;"><span style="position: absolute; clip: rect(3.353em, 1001.74em, 4.346em, -999.997em); top: -6.014em; right: 0em;"><span class="mtd" id="MathJax-Span-8811"><span class="mrow" id="MathJax-Span-8812"><span class="mi" id="MathJax-Span-8813" style="font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mi" id="MathJax-Span-8814" style="font-family: MathJax_Math-italic;">a</span><span class="mi" id="MathJax-Span-8815" style="font-family: MathJax_Math-italic;">w</span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.105em, 1002.17em, 4.346em, -999.997em); top: -3.905em; right: 0em;"><span class="mtd" id="MathJax-Span-8841"><span class="mrow" id="MathJax-Span-8842"><span class="mi" id="MathJax-Span-8843" style="font-family: MathJax_Math-italic;">p</span><span class="mi" id="MathJax-Span-8844" style="font-family: MathJax_Math-italic;">i</span><span class="mi" id="MathJax-Span-8845" style="font-family: MathJax_Math-italic;">t</span><span class="mi" id="MathJax-Span-8846" style="font-family: MathJax_Math-italic;">c</span><span class="mi" id="MathJax-Span-8847" style="font-family: MathJax_Math-italic;">h</span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.105em, 1001.49em, 4.159em, -999.997em); top: -1.92em; right: 0em;"><span class="mtd" id="MathJax-Span-8867"><span class="mrow" id="MathJax-Span-8868"><span class="mi" id="MathJax-Span-8869" style="font-family: MathJax_Math-italic;">r</span><span class="mi" id="MathJax-Span-8870" style="font-family: MathJax_Math-italic;">o</span><span class="mi" id="MathJax-Span-8871" style="font-family: MathJax_Math-italic;">l</span><span class="mi" id="MathJax-Span-8872" style="font-family: MathJax_Math-italic;">l</span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span><span style="display: inline-block; width: 0px; height: 5.586em;"></span></span><span style="position: absolute; clip: rect(3.787em, 1006.83em, 10.735em, -999.997em); top: -7.503em; left: 2.236em;"><span style="display: inline-block; position: relative; width: 7.013em; height: 0px;"><span style="position: absolute; clip: rect(2.36em, 1006.83em, 5.09em, -999.997em); top: -6.014em; left: 0em;"><span class="mtd" id="MathJax-Span-8816"><span class="mrow" id="MathJax-Span-8817"><span class="mi" id="MathJax-Span-8818"></span><span class="mo" id="MathJax-Span-8819" style="font-family: MathJax_Main; padding-left: 0.251em;">=</span><span class="msubsup" id="MathJax-Span-8820" style="padding-left: 0.251em;"><span style="display: inline-block; position: relative; width: 2.422em; height: 0px;"><span style="position: absolute; clip: rect(3.167em, 1001.43em, 4.159em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-8821" style="font-family: MathJax_Main;">tan</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -4.401em; left: 1.43em;"><span class="texatom" id="MathJax-Span-8822"><span class="mrow" id="MathJax-Span-8823"><span class="mo" id="MathJax-Span-8824" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="mn" id="MathJax-Span-8825" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="mo" id="MathJax-Span-8826"></span><span class="mrow" id="MathJax-Span-8827"><span class="mo" id="MathJax-Span-8828" style="vertical-align: 0em;"><span style="font-family: MathJax_Size3;">(</span></span><span class="mfrac" id="MathJax-Span-8829"><span style="display: inline-block; position: relative; width: 1.616em; height: 0px; margin-right: 0.127em; margin-left: 0.127em;"><span style="position: absolute; clip: rect(3.105em, 1001.49em, 4.346em, -999.997em); top: -4.65em; left: 50%; margin-left: -0.741em;"><span class="msubsup" id="MathJax-Span-8830"><span style="display: inline-block; position: relative; width: 1.492em; height: 0px;"><span style="position: absolute; clip: rect(3.105em, 1000.75em, 4.159em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-8831" style="font-family: MathJax_Math-italic;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.065em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.748em;"><span class="texatom" id="MathJax-Span-8832"><span class="mrow" id="MathJax-Span-8833"><span class="mn" id="MathJax-Span-8834" style="font-size: 70.7%; font-family: MathJax_Main;">10</span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.105em, 1001.49em, 4.346em, -999.997em); top: -3.285em; left: 50%; margin-left: -0.741em;"><span class="msubsup" id="MathJax-Span-8835"><span style="display: inline-block; position: relative; width: 1.492em; height: 0px;"><span style="position: absolute; clip: rect(3.105em, 1000.75em, 4.159em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-8836" style="font-family: MathJax_Math-italic;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.065em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.748em;"><span class="texatom" id="MathJax-Span-8837"><span class="mrow" id="MathJax-Span-8838"><span class="mn" id="MathJax-Span-8839" style="font-size: 70.7%; font-family: MathJax_Main;">00</span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(0.81em, 1001.62em, 1.244em, -999.997em); top: -1.3em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 1.616em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.058em;"></span></span></span></span><span class="mo" id="MathJax-Span-8840" style="vertical-align: 0em;"><span style="font-family: MathJax_Size3;">)</span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(2.919em, 1006.46em, 4.408em, -999.997em); top: -3.905em; left: 0em;"><span class="mtd" id="MathJax-Span-8848"><span class="mrow" id="MathJax-Span-8849"><span class="mi" id="MathJax-Span-8850"></span><span class="mo" id="MathJax-Span-8851" style="font-family: MathJax_Main; padding-left: 0.251em;">=</span><span class="msubsup" id="MathJax-Span-8852" style="padding-left: 0.251em;"><span style="display: inline-block; position: relative; width: 2.236em; height: 0px;"><span style="position: absolute; clip: rect(3.105em, 1001.24em, 4.159em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-8853" style="font-family: MathJax_Main;">sin</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -4.401em; left: 1.244em;"><span class="texatom" id="MathJax-Span-8854"><span class="mrow" id="MathJax-Span-8855"><span class="mo" id="MathJax-Span-8856" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="mn" id="MathJax-Span-8857" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="mo" id="MathJax-Span-8858"></span><span class="mo" id="MathJax-Span-8859" style="font-family: MathJax_Main;">(</span><span class="mo" id="MathJax-Span-8860" style="font-family: MathJax_Main;">−</span><span class="msubsup" id="MathJax-Span-8861"><span style="display: inline-block; position: relative; width: 1.492em; height: 0px;"><span style="position: absolute; clip: rect(3.105em, 1000.75em, 4.159em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-8862" style="font-family: MathJax_Math-italic;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.065em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.748em;"><span class="texatom" id="MathJax-Span-8863"><span class="mrow" id="MathJax-Span-8864"><span class="mn" id="MathJax-Span-8865" style="font-size: 70.7%; font-family: MathJax_Main;">20</span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="mo" id="MathJax-Span-8866" style="font-family: MathJax_Main;">)</span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(2.36em, 1006.83em, 5.09em, -999.997em); top: -1.92em; left: 0em;"><span class="mtd" id="MathJax-Span-8873"><span class="mrow" id="MathJax-Span-8874"><span class="mi" id="MathJax-Span-8875"></span><span class="mo" id="MathJax-Span-8876" style="font-family: MathJax_Main; padding-left: 0.251em;">=</span><span class="msubsup" id="MathJax-Span-8877" style="padding-left: 0.251em;"><span style="display: inline-block; position: relative; width: 2.422em; height: 0px;"><span style="position: absolute; clip: rect(3.167em, 1001.43em, 4.159em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-8878" style="font-family: MathJax_Main;">tan</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -4.401em; left: 1.43em;"><span class="texatom" id="MathJax-Span-8879"><span class="mrow" id="MathJax-Span-8880"><span class="mo" id="MathJax-Span-8881" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="mn" id="MathJax-Span-8882" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="mo" id="MathJax-Span-8883"></span><span class="mrow" id="MathJax-Span-8884"><span class="mo" id="MathJax-Span-8885" style="vertical-align: 0em;"><span style="font-family: MathJax_Size3;">(</span></span><span class="mfrac" id="MathJax-Span-8886"><span style="display: inline-block; position: relative; width: 1.616em; height: 0px; margin-right: 0.127em; margin-left: 0.127em;"><span style="position: absolute; clip: rect(3.105em, 1001.49em, 4.283em, -999.997em); top: -4.65em; left: 50%; margin-left: -0.741em;"><span class="msubsup" id="MathJax-Span-8887"><span style="display: inline-block; position: relative; width: 1.492em; height: 0px;"><span style="position: absolute; clip: rect(3.105em, 1000.75em, 4.159em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-8888" style="font-family: MathJax_Math-italic;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.065em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.748em;"><span class="texatom" id="MathJax-Span-8889"><span class="mrow" id="MathJax-Span-8890"><span class="mn" id="MathJax-Span-8891" style="font-size: 70.7%; font-family: MathJax_Main;">21</span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.105em, 1001.49em, 4.283em, -999.997em); top: -3.285em; left: 50%; margin-left: -0.741em;"><span class="msubsup" id="MathJax-Span-8892"><span style="display: inline-block; position: relative; width: 1.492em; height: 0px;"><span style="position: absolute; clip: rect(3.105em, 1000.75em, 4.159em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-8893" style="font-family: MathJax_Math-italic;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.065em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.748em;"><span class="texatom" id="MathJax-Span-8894"><span class="mrow" id="MathJax-Span-8895"><span class="mn" id="MathJax-Span-8896" style="font-size: 70.7%; font-family: MathJax_Main;">22</span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(0.81em, 1001.62em, 1.244em, -999.997em); top: -1.3em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 1.616em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.058em;"></span></span></span></span><span class="mo" id="MathJax-Span-8897" style="vertical-align: 0em;"><span style="font-family: MathJax_Size3;">)</span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span><span style="display: inline-block; width: 0px; height: 7.509em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.36em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -3.842em; border-left: 0px solid; width: 0px; height: 8.235em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mtable columnalign="right left right left right left right left right left right left" rowspacing="3pt" columnspacing="0em 2em 0em 2em 0em 2em 0em 2em 0em 2em 0em" displaystyle="true"><mtr><mtd><mi>y</mi><mi>a</mi><mi>w</mi></mtd><mtd><mi></mi><mo>=</mo><msup><mi>tan</mi><mrow class="MJX-TeXAtom-ORD"><mo>−</mo><mn>1</mn></mrow></msup><mo>⁡</mo><mrow><mo>(</mo><mfrac><msub><mi>C</mi><mrow class="MJX-TeXAtom-ORD"><mn>10</mn></mrow></msub><msub><mi>C</mi><mrow class="MJX-TeXAtom-ORD"><mn>00</mn></mrow></msub></mfrac><mo>)</mo></mrow></mtd></mtr><mtr><mtd><mi>p</mi><mi>i</mi><mi>t</mi><mi>c</mi><mi>h</mi></mtd><mtd><mi></mi><mo>=</mo><msup><mi>sin</mi><mrow class="MJX-TeXAtom-ORD"><mo>−</mo><mn>1</mn></mrow></msup><mo>⁡</mo><mo stretchy="false">(</mo><mo>−</mo><msub><mi>C</mi><mrow class="MJX-TeXAtom-ORD"><mn>20</mn></mrow></msub><mo stretchy="false">)</mo></mtd></mtr><mtr><mtd><mi>r</mi><mi>o</mi><mi>l</mi><mi>l</mi></mtd><mtd><mi></mi><mo>=</mo><msup><mi>tan</mi><mrow class="MJX-TeXAtom-ORD"><mo>−</mo><mn>1</mn></mrow></msup><mo>⁡</mo><mrow><mo>(</mo><mfrac><msub><mi>C</mi><mrow class="MJX-TeXAtom-ORD"><mn>21</mn></mrow></msub><msub><mi>C</mi><mrow class="MJX-TeXAtom-ORD"><mn>22</mn></mrow></msub></mfrac><mo>)</mo></mrow></mtd></mtr></mtable></math></span></span><script type="math/tex" id="MathJax-Element-248">\begin{align}yaw&=\tan^{-1}\left(\frac{C_{10}}{C_{00}}\right) \\ pitch &=\sin^{-1}(-C_{20}) \\ roll&=\tan^{-1}\left(\frac{C_{21}}{C_{22}}\right)\end{align}</script></p>
<p>However, <span style="color: #ff0000;">if&nbsp;<span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-249-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;cos&lt;/mi&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;&amp;#x03B2;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-8898" style="width: 5.586em; display: inline-block;"><span style="display: inline-block; position: relative; width: 4.47em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(1.43em, 1004.41em, 2.795em, -999.997em); top: -2.354em; left: 0em;"><span class="mrow" id="MathJax-Span-8899"><span class="mi" id="MathJax-Span-8900" style="font-family: MathJax_Main;">cos</span><span class="mo" id="MathJax-Span-8901"></span><span class="mo" id="MathJax-Span-8902" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-8903" style="font-family: MathJax_Math-italic;">β<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-8904" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-8905" style="font-family: MathJax_Main; padding-left: 0.251em;">=</span><span class="mn" id="MathJax-Span-8906" style="font-family: MathJax_Main; padding-left: 0.251em;">0</span></span><span style="display: inline-block; width: 0px; height: 2.36em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.381em; border-left: 0px solid; width: 0px; height: 1.388em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>cos</mi><mo>⁡</mo><mo stretchy="false">(</mo><mi>β</mi><mo stretchy="false">)</mo><mo>=</mo><mn>0</mn></math></span></span><script type="math/tex" id="MathJax-Element-249">\cos(\beta)=0</script></span>, the problem of Gimbal lock occurs. With our coordinate system, this occurs when the pitch angle is 90 or -90 degrees.</p>
<h6><span style="text-decoration: underline;">Case 2</span></h6>
<p>For the case of a pitch angle of 90 degrees, the rotation matrix simplifies to:</p>
<p><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-250-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;R&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;&amp;#x03B1;&lt;/mi&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;&amp;#x03B2;&lt;/mi&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;&amp;#x03B3;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mrow&gt;&lt;mo&gt;[&lt;/mo&gt;&lt;mtable rowspacing=&quot;4pt&quot; columnspacing=&quot;1em&quot;&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd /&gt;&lt;mtd&gt;&lt;mi&gt;cos&lt;/mi&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;&amp;#x03B1;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mi&gt;sin&lt;/mi&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;&amp;#x03B3;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mi&gt;sin&lt;/mi&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;&amp;#x03B1;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mi&gt;cos&lt;/mi&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;&amp;#x03B3;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mtd&gt;&lt;mtd /&gt;&lt;mtd&gt;&lt;mi&gt;cos&lt;/mi&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;&amp;#x03B1;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mi&gt;cos&lt;/mi&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;&amp;#x03B3;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mi&gt;sin&lt;/mi&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;&amp;#x03B1;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mi&gt;sin&lt;/mi&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;&amp;#x03B3;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd /&gt;&lt;mtd&gt;&lt;mi&gt;sin&lt;/mi&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;&amp;#x03B1;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mi&gt;sin&lt;/mi&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;&amp;#x03B3;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mi&gt;cos&lt;/mi&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;&amp;#x03B1;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mi&gt;cos&lt;/mi&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;&amp;#x03B3;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mtd&gt;&lt;mtd /&gt;&lt;mtd&gt;&lt;mi&gt;sin&lt;/mi&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;&amp;#x03B1;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mi&gt;cos&lt;/mi&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;&amp;#x03B3;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mi&gt;cos&lt;/mi&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;&amp;#x03B1;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mi&gt;sin&lt;/mi&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;&amp;#x03B3;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd /&gt;&lt;mtd&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd /&gt;&lt;mtd&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;/mtable&gt;&lt;mo&gt;]&lt;/mo&gt;&lt;/mrow&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-8907" style="width: 46.033em; display: inline-block;"><span style="display: inline-block; position: relative; width: 37.1em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(2.174em, 1036.79em, 6.393em, -999.997em); top: -4.525em; left: 0em;"><span class="mrow" id="MathJax-Span-8908"><span class="mi" id="MathJax-Span-8909" style="font-family: MathJax_Math-italic;">R</span><span class="mo" id="MathJax-Span-8910" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-8911" style="font-family: MathJax_Math-italic;">α</span><span class="mo" id="MathJax-Span-8912" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-8913" style="font-family: MathJax_Math-italic; padding-left: 0.189em;">β<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-8914" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-8915" style="font-family: MathJax_Math-italic; padding-left: 0.189em;">γ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-8916" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-8917" style="font-family: MathJax_Main; padding-left: 0.251em;">=</span><span class="mrow" id="MathJax-Span-8918" style="padding-left: 0.251em;"><span class="mo" id="MathJax-Span-8919" style="vertical-align: 2.174em;"><span style="display: inline-block; position: relative; width: 0.685em; height: 0px;"><span style="position: absolute; font-family: MathJax_Size4; top: -2.788em; left: 0em;">⎡<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; font-family: MathJax_Size4; top: -0.741em; left: 0em;">⎣<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -1.734em; left: 0em;">⎢<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="mtable" id="MathJax-Span-8920" style="padding-right: 0.189em; padding-left: 0.189em;"><span style="display: inline-block; position: relative; width: 29.842em; height: 0px;"><span style="position: absolute; clip: rect(2.422em, 1001.18em, 6.455em, -999.997em); top: -4.65em; left: 0em;"><span style="display: inline-block; position: relative; width: 1.306em; height: 0px;"><span style="position: absolute; clip: rect(3.105em, 1000.44em, 4.159em, -999.997em); top: -5.394em; left: 50%; margin-left: -0.245em;"><span class="mtd" id="MathJax-Span-8921"><span class="mrow" id="MathJax-Span-8922"><span class="mn" id="MathJax-Span-8923" style="font-family: MathJax_Main;">0</span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.105em, 1000.44em, 4.159em, -999.997em); top: -3.905em; left: 50%; margin-left: -0.245em;"><span class="mtd" id="MathJax-Span-8974"><span class="mrow" id="MathJax-Span-8975"><span class="mn" id="MathJax-Span-8976" style="font-family: MathJax_Main;">0</span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.105em, 1001.18em, 4.221em, -999.997em); top: -2.478em; left: 50%; margin-left: -0.617em;"><span class="mtd" id="MathJax-Span-9027"><span class="mrow" id="MathJax-Span-9028"><span class="mo" id="MathJax-Span-9029" style="font-family: MathJax_Main;">−</span><span class="mn" id="MathJax-Span-9030" style="font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.656em;"></span></span><span style="position: absolute; clip: rect(2.36em, 1000em, 5.648em, -999.997em); top: -3.967em; left: 2.298em;"><span style="display: inline-block; position: relative; width: 0em; height: 0px;"><span style="position: absolute; clip: rect(3.787em, 1000em, 4.159em, -999.997em); top: -5.394em; left: 50%; margin-left: 0em;"><span class="mtd" id="MathJax-Span-8924"><span class="mrow" id="MathJax-Span-8925"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.787em, 1000em, 4.159em, -999.997em); top: -3.905em; left: 50%; margin-left: 0em;"><span class="mtd" id="MathJax-Span-8977"><span class="mrow" id="MathJax-Span-8978"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.787em, 1000em, 4.159em, -999.997em); top: -2.478em; left: 50%; margin-left: 0em;"><span class="mtd" id="MathJax-Span-9031"><span class="mrow" id="MathJax-Span-9032"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(2.298em, 1012.16em, 6.393em, -999.997em); top: -4.65em; left: 3.291em;"><span style="display: inline-block; position: relative; width: 12.286em; height: 0px;"><span style="position: absolute; clip: rect(3.043em, 1012.16em, 4.408em, -999.997em); top: -5.394em; left: 50%; margin-left: -6.138em;"><span class="mtd" id="MathJax-Span-8926"><span class="mrow" id="MathJax-Span-8927"><span class="mi" id="MathJax-Span-8928" style="font-family: MathJax_Main;">cos</span><span class="mo" id="MathJax-Span-8929"></span><span class="mo" id="MathJax-Span-8930" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-8931" style="font-family: MathJax_Math-italic;">α</span><span class="mo" id="MathJax-Span-8932" style="font-family: MathJax_Main;">)</span><span class="mi" id="MathJax-Span-8933" style="font-family: MathJax_Main; padding-left: 0.189em;">sin</span><span class="mo" id="MathJax-Span-8934"></span><span class="mo" id="MathJax-Span-8935" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-8936" style="font-family: MathJax_Math-italic;">γ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-8937" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-8938" style="font-family: MathJax_Main; padding-left: 0.251em;">−</span><span class="mi" id="MathJax-Span-8939" style="font-family: MathJax_Main; padding-left: 0.251em;">sin</span><span class="mo" id="MathJax-Span-8940"></span><span class="mo" id="MathJax-Span-8941" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-8942" style="font-family: MathJax_Math-italic;">α</span><span class="mo" id="MathJax-Span-8943" style="font-family: MathJax_Main;">)</span><span class="mi" id="MathJax-Span-8944" style="font-family: MathJax_Main; padding-left: 0.189em;">cos</span><span class="mo" id="MathJax-Span-8945"></span><span class="mo" id="MathJax-Span-8946" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-8947" style="font-family: MathJax_Math-italic;">γ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-8948" style="font-family: MathJax_Main;">)</span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.043em, 1012.16em, 4.408em, -999.997em); top: -3.905em; left: 50%; margin-left: -6.138em;"><span class="mtd" id="MathJax-Span-8979"><span class="mrow" id="MathJax-Span-8980"><span class="mi" id="MathJax-Span-8981" style="font-family: MathJax_Main;">sin</span><span class="mo" id="MathJax-Span-8982"></span><span class="mo" id="MathJax-Span-8983" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-8984" style="font-family: MathJax_Math-italic;">α</span><span class="mo" id="MathJax-Span-8985" style="font-family: MathJax_Main;">)</span><span class="mi" id="MathJax-Span-8986" style="font-family: MathJax_Main; padding-left: 0.189em;">sin</span><span class="mo" id="MathJax-Span-8987"></span><span class="mo" id="MathJax-Span-8988" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-8989" style="font-family: MathJax_Math-italic;">γ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-8990" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-8991" style="font-family: MathJax_Main; padding-left: 0.251em;">+</span><span class="mi" id="MathJax-Span-8992" style="font-family: MathJax_Main; padding-left: 0.251em;">cos</span><span class="mo" id="MathJax-Span-8993"></span><span class="mo" id="MathJax-Span-8994" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-8995" style="font-family: MathJax_Math-italic;">α</span><span class="mo" id="MathJax-Span-8996" style="font-family: MathJax_Main;">)</span><span class="mi" id="MathJax-Span-8997" style="font-family: MathJax_Main; padding-left: 0.189em;">cos</span><span class="mo" id="MathJax-Span-8998"></span><span class="mo" id="MathJax-Span-8999" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-9000" style="font-family: MathJax_Math-italic;">γ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-9001" style="font-family: MathJax_Main;">)</span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.105em, 1000.44em, 4.159em, -999.997em); top: -2.478em; left: 50%; margin-left: -0.245em;"><span class="mtd" id="MathJax-Span-9033"><span class="mrow" id="MathJax-Span-9034"><span class="mn" id="MathJax-Span-9035" style="font-family: MathJax_Main;">0</span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.656em;"></span></span><span style="position: absolute; clip: rect(2.36em, 1000em, 5.648em, -999.997em); top: -3.967em; left: 16.566em;"><span style="display: inline-block; position: relative; width: 0em; height: 0px;"><span style="position: absolute; clip: rect(3.787em, 1000em, 4.159em, -999.997em); top: -5.394em; left: 50%; margin-left: 0em;"><span class="mtd" id="MathJax-Span-8949"><span class="mrow" id="MathJax-Span-8950"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.787em, 1000em, 4.159em, -999.997em); top: -3.905em; left: 50%; margin-left: 0em;"><span class="mtd" id="MathJax-Span-9002"><span class="mrow" id="MathJax-Span-9003"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.787em, 1000em, 4.159em, -999.997em); top: -2.478em; left: 50%; margin-left: 0em;"><span class="mtd" id="MathJax-Span-9036"><span class="mrow" id="MathJax-Span-9037"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(2.298em, 1012.16em, 6.393em, -999.997em); top: -4.65em; left: 17.559em;"><span style="display: inline-block; position: relative; width: 12.286em; height: 0px;"><span style="position: absolute; clip: rect(3.043em, 1012.16em, 4.408em, -999.997em); top: -5.394em; left: 50%; margin-left: -6.138em;"><span class="mtd" id="MathJax-Span-8951"><span class="mrow" id="MathJax-Span-8952"><span class="mi" id="MathJax-Span-8953" style="font-family: MathJax_Main;">cos</span><span class="mo" id="MathJax-Span-8954"></span><span class="mo" id="MathJax-Span-8955" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-8956" style="font-family: MathJax_Math-italic;">α</span><span class="mo" id="MathJax-Span-8957" style="font-family: MathJax_Main;">)</span><span class="mi" id="MathJax-Span-8958" style="font-family: MathJax_Main; padding-left: 0.189em;">cos</span><span class="mo" id="MathJax-Span-8959"></span><span class="mo" id="MathJax-Span-8960" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-8961" style="font-family: MathJax_Math-italic;">γ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-8962" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-8963" style="font-family: MathJax_Main; padding-left: 0.251em;">+</span><span class="mi" id="MathJax-Span-8964" style="font-family: MathJax_Main; padding-left: 0.251em;">sin</span><span class="mo" id="MathJax-Span-8965"></span><span class="mo" id="MathJax-Span-8966" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-8967" style="font-family: MathJax_Math-italic;">α</span><span class="mo" id="MathJax-Span-8968" style="font-family: MathJax_Main;">)</span><span class="mi" id="MathJax-Span-8969" style="font-family: MathJax_Main; padding-left: 0.189em;">sin</span><span class="mo" id="MathJax-Span-8970"></span><span class="mo" id="MathJax-Span-8971" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-8972" style="font-family: MathJax_Math-italic;">γ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-8973" style="font-family: MathJax_Main;">)</span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.043em, 1012.16em, 4.408em, -999.997em); top: -3.905em; left: 50%; margin-left: -6.138em;"><span class="mtd" id="MathJax-Span-9004"><span class="mrow" id="MathJax-Span-9005"><span class="mi" id="MathJax-Span-9006" style="font-family: MathJax_Main;">sin</span><span class="mo" id="MathJax-Span-9007"></span><span class="mo" id="MathJax-Span-9008" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-9009" style="font-family: MathJax_Math-italic;">α</span><span class="mo" id="MathJax-Span-9010" style="font-family: MathJax_Main;">)</span><span class="mi" id="MathJax-Span-9011" style="font-family: MathJax_Main; padding-left: 0.189em;">cos</span><span class="mo" id="MathJax-Span-9012"></span><span class="mo" id="MathJax-Span-9013" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-9014" style="font-family: MathJax_Math-italic;">γ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-9015" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-9016" style="font-family: MathJax_Main; padding-left: 0.251em;">−</span><span class="mi" id="MathJax-Span-9017" style="font-family: MathJax_Main; padding-left: 0.251em;">cos</span><span class="mo" id="MathJax-Span-9018"></span><span class="mo" id="MathJax-Span-9019" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-9020" style="font-family: MathJax_Math-italic;">α</span><span class="mo" id="MathJax-Span-9021" style="font-family: MathJax_Main;">)</span><span class="mi" id="MathJax-Span-9022" style="font-family: MathJax_Main; padding-left: 0.189em;">sin</span><span class="mo" id="MathJax-Span-9023"></span><span class="mo" id="MathJax-Span-9024" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-9025" style="font-family: MathJax_Math-italic;">γ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-9026" style="font-family: MathJax_Main;">)</span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.105em, 1000.44em, 4.159em, -999.997em); top: -2.478em; left: 50%; margin-left: -0.245em;"><span class="mtd" id="MathJax-Span-9038"><span class="mrow" id="MathJax-Span-9039"><span class="mn" id="MathJax-Span-9040" style="font-family: MathJax_Main;">0</span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.656em;"></span></span></span></span><span class="mo" id="MathJax-Span-9041" style="vertical-align: 2.174em;"><span style="display: inline-block; position: relative; width: 0.685em; height: 0px;"><span style="position: absolute; font-family: MathJax_Size4; top: -2.788em; left: 0em;">⎤<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; font-family: MathJax_Size4; top: -0.741em; left: 0em;">⎦<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -1.734em; left: 0em;">⎥<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.532em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -2.15em; border-left: 0px solid; width: 0px; height: 5.004em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>R</mi><mo stretchy="false">(</mo><mi>α</mi><mo>,</mo><mi>β</mi><mo>,</mo><mi>γ</mi><mo stretchy="false">)</mo><mo>=</mo><mrow><mo>[</mo><mtable rowspacing="4pt" columnspacing="1em"><mtr><mtd><mn>0</mn></mtd><mtd></mtd><mtd><mi>cos</mi><mo>⁡</mo><mo stretchy="false">(</mo><mi>α</mi><mo stretchy="false">)</mo><mi>sin</mi><mo>⁡</mo><mo stretchy="false">(</mo><mi>γ</mi><mo stretchy="false">)</mo><mo>−</mo><mi>sin</mi><mo>⁡</mo><mo stretchy="false">(</mo><mi>α</mi><mo stretchy="false">)</mo><mi>cos</mi><mo>⁡</mo><mo stretchy="false">(</mo><mi>γ</mi><mo stretchy="false">)</mo></mtd><mtd></mtd><mtd><mi>cos</mi><mo>⁡</mo><mo stretchy="false">(</mo><mi>α</mi><mo stretchy="false">)</mo><mi>cos</mi><mo>⁡</mo><mo stretchy="false">(</mo><mi>γ</mi><mo stretchy="false">)</mo><mo>+</mo><mi>sin</mi><mo>⁡</mo><mo stretchy="false">(</mo><mi>α</mi><mo stretchy="false">)</mo><mi>sin</mi><mo>⁡</mo><mo stretchy="false">(</mo><mi>γ</mi><mo stretchy="false">)</mo></mtd></mtr><mtr><mtd><mn>0</mn></mtd><mtd></mtd><mtd><mi>sin</mi><mo>⁡</mo><mo stretchy="false">(</mo><mi>α</mi><mo stretchy="false">)</mo><mi>sin</mi><mo>⁡</mo><mo stretchy="false">(</mo><mi>γ</mi><mo stretchy="false">)</mo><mo>+</mo><mi>cos</mi><mo>⁡</mo><mo stretchy="false">(</mo><mi>α</mi><mo stretchy="false">)</mo><mi>cos</mi><mo>⁡</mo><mo stretchy="false">(</mo><mi>γ</mi><mo stretchy="false">)</mo></mtd><mtd></mtd><mtd><mi>sin</mi><mo>⁡</mo><mo stretchy="false">(</mo><mi>α</mi><mo stretchy="false">)</mo><mi>cos</mi><mo>⁡</mo><mo stretchy="false">(</mo><mi>γ</mi><mo stretchy="false">)</mo><mo>−</mo><mi>cos</mi><mo>⁡</mo><mo stretchy="false">(</mo><mi>α</mi><mo stretchy="false">)</mo><mi>sin</mi><mo>⁡</mo><mo stretchy="false">(</mo><mi>γ</mi><mo stretchy="false">)</mo></mtd></mtr><mtr><mtd><mo>−</mo><mn>1</mn></mtd><mtd></mtd><mtd><mn>0</mn></mtd><mtd></mtd><mtd><mn>0</mn></mtd></mtr></mtable><mo>]</mo></mrow></math></span></span><script type="math/tex" id="MathJax-Element-250">R(\alpha,\beta,\gamma) = \begin{bmatrix} 0 && \cos(\alpha)\sin(\gamma)-\sin(\alpha)\cos(\gamma) && \cos(\alpha)\cos(\gamma)+\sin(\alpha)\sin(\gamma) \\ 0 && \sin(\alpha)\sin(\gamma)+\cos(\alpha)\cos(\gamma) && \sin(\alpha)\cos(\gamma)-\cos(\alpha)\sin(\gamma) \\ -1 && 0 && 0 \end{bmatrix}</script></p>
<p>Apply some trigonometric identities and we can get the following:</p>
<p><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-251-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;R&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;&amp;#x03B1;&lt;/mi&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;&amp;#x03B2;&lt;/mi&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;&amp;#x03B3;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mrow&gt;&lt;mo&gt;[&lt;/mo&gt;&lt;mtable rowspacing=&quot;4pt&quot; columnspacing=&quot;1em&quot;&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd /&gt;&lt;mtd&gt;&lt;mi&gt;sin&lt;/mi&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;&amp;#x03B3;&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mi&gt;&amp;#x03B1;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mtd&gt;&lt;mtd /&gt;&lt;mtd&gt;&lt;mi&gt;cos&lt;/mi&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;&amp;#x03B1;&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mi&gt;&amp;#x03B3;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd /&gt;&lt;mtd&gt;&lt;mi&gt;cos&lt;/mi&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;&amp;#x03B1;&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mi&gt;&amp;#x03B3;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mtd&gt;&lt;mtd /&gt;&lt;mtd&gt;&lt;mi&gt;sin&lt;/mi&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;&amp;#x03B1;&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mi&gt;&amp;#x03B3;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd /&gt;&lt;mtd&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd /&gt;&lt;mtd&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;/mtable&gt;&lt;mo&gt;]&lt;/mo&gt;&lt;/mrow&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-9042" style="width: 26.926em; display: inline-block;"><span style="display: inline-block; position: relative; width: 21.715em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(2.174em, 1021.4em, 6.393em, -999.997em); top: -4.525em; left: 0em;"><span class="mrow" id="MathJax-Span-9043"><span class="mi" id="MathJax-Span-9044" style="font-family: MathJax_Math-italic;">R</span><span class="mo" id="MathJax-Span-9045" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-9046" style="font-family: MathJax_Math-italic;">α</span><span class="mo" id="MathJax-Span-9047" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-9048" style="font-family: MathJax_Math-italic; padding-left: 0.189em;">β<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-9049" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-9050" style="font-family: MathJax_Math-italic; padding-left: 0.189em;">γ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-9051" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-9052" style="font-family: MathJax_Main; padding-left: 0.251em;">=</span><span class="mrow" id="MathJax-Span-9053" style="padding-left: 0.251em;"><span class="mo" id="MathJax-Span-9054" style="vertical-align: 2.174em;"><span style="display: inline-block; position: relative; width: 0.685em; height: 0px;"><span style="position: absolute; font-family: MathJax_Size4; top: -2.788em; left: 0em;">⎡<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; font-family: MathJax_Size4; top: -0.741em; left: 0em;">⎣<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -1.734em; left: 0em;">⎢<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="mtable" id="MathJax-Span-9055" style="padding-right: 0.189em; padding-left: 0.189em;"><span style="display: inline-block; position: relative; width: 14.457em; height: 0px;"><span style="position: absolute; clip: rect(2.422em, 1001.18em, 6.455em, -999.997em); top: -4.65em; left: 0em;"><span style="display: inline-block; position: relative; width: 1.306em; height: 0px;"><span style="position: absolute; clip: rect(3.105em, 1000.44em, 4.159em, -999.997em); top: -5.394em; left: 50%; margin-left: -0.245em;"><span class="mtd" id="MathJax-Span-9056"><span class="mrow" id="MathJax-Span-9057"><span class="mn" id="MathJax-Span-9058" style="font-family: MathJax_Main;">0</span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.105em, 1000.44em, 4.159em, -999.997em); top: -3.905em; left: 50%; margin-left: -0.245em;"><span class="mtd" id="MathJax-Span-9081"><span class="mrow" id="MathJax-Span-9082"><span class="mn" id="MathJax-Span-9083" style="font-family: MathJax_Main;">0</span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.105em, 1001.18em, 4.221em, -999.997em); top: -2.478em; left: 50%; margin-left: -0.617em;"><span class="mtd" id="MathJax-Span-9106"><span class="mrow" id="MathJax-Span-9107"><span class="mo" id="MathJax-Span-9108" style="font-family: MathJax_Main;">−</span><span class="mn" id="MathJax-Span-9109" style="font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.656em;"></span></span><span style="position: absolute; clip: rect(2.36em, 1000em, 5.648em, -999.997em); top: -3.967em; left: 2.298em;"><span style="display: inline-block; position: relative; width: 0em; height: 0px;"><span style="position: absolute; clip: rect(3.787em, 1000em, 4.159em, -999.997em); top: -5.394em; left: 50%; margin-left: 0em;"><span class="mtd" id="MathJax-Span-9059"><span class="mrow" id="MathJax-Span-9060"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.787em, 1000em, 4.159em, -999.997em); top: -3.905em; left: 50%; margin-left: 0em;"><span class="mtd" id="MathJax-Span-9084"><span class="mrow" id="MathJax-Span-9085"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.787em, 1000em, 4.159em, -999.997em); top: -2.478em; left: 50%; margin-left: 0em;"><span class="mtd" id="MathJax-Span-9110"><span class="mrow" id="MathJax-Span-9111"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(2.298em, 1004.47em, 6.393em, -999.997em); top: -4.65em; left: 3.291em;"><span style="display: inline-block; position: relative; width: 4.594em; height: 0px;"><span style="position: absolute; clip: rect(3.043em, 1004.41em, 4.408em, -999.997em); top: -5.394em; left: 50%; margin-left: -2.23em;"><span class="mtd" id="MathJax-Span-9061"><span class="mrow" id="MathJax-Span-9062"><span class="mi" id="MathJax-Span-9063" style="font-family: MathJax_Main;">sin</span><span class="mo" id="MathJax-Span-9064"></span><span class="mo" id="MathJax-Span-9065" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-9066" style="font-family: MathJax_Math-italic;">γ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-9067" style="font-family: MathJax_Main; padding-left: 0.251em;">−</span><span class="mi" id="MathJax-Span-9068" style="font-family: MathJax_Math-italic; padding-left: 0.251em;">α</span><span class="mo" id="MathJax-Span-9069" style="font-family: MathJax_Main;">)</span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.043em, 1004.47em, 4.408em, -999.997em); top: -3.905em; left: 50%; margin-left: -2.292em;"><span class="mtd" id="MathJax-Span-9086"><span class="mrow" id="MathJax-Span-9087"><span class="mi" id="MathJax-Span-9088" style="font-family: MathJax_Main;">cos</span><span class="mo" id="MathJax-Span-9089"></span><span class="mo" id="MathJax-Span-9090" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-9091" style="font-family: MathJax_Math-italic;">α</span><span class="mo" id="MathJax-Span-9092" style="font-family: MathJax_Main; padding-left: 0.251em;">−</span><span class="mi" id="MathJax-Span-9093" style="font-family: MathJax_Math-italic; padding-left: 0.251em;">γ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-9094" style="font-family: MathJax_Main;">)</span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.105em, 1000.44em, 4.159em, -999.997em); top: -2.478em; left: 50%; margin-left: -0.245em;"><span class="mtd" id="MathJax-Span-9112"><span class="mrow" id="MathJax-Span-9113"><span class="mn" id="MathJax-Span-9114" style="font-family: MathJax_Main;">0</span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.656em;"></span></span><span style="position: absolute; clip: rect(2.36em, 1000em, 5.648em, -999.997em); top: -3.967em; left: 8.874em;"><span style="display: inline-block; position: relative; width: 0em; height: 0px;"><span style="position: absolute; clip: rect(3.787em, 1000em, 4.159em, -999.997em); top: -5.394em; left: 50%; margin-left: 0em;"><span class="mtd" id="MathJax-Span-9070"><span class="mrow" id="MathJax-Span-9071"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.787em, 1000em, 4.159em, -999.997em); top: -3.905em; left: 50%; margin-left: 0em;"><span class="mtd" id="MathJax-Span-9095"><span class="mrow" id="MathJax-Span-9096"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.787em, 1000em, 4.159em, -999.997em); top: -2.478em; left: 50%; margin-left: 0em;"><span class="mtd" id="MathJax-Span-9115"><span class="mrow" id="MathJax-Span-9116"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(2.298em, 1004.47em, 6.393em, -999.997em); top: -4.65em; left: 9.867em;"><span style="display: inline-block; position: relative; width: 4.594em; height: 0px;"><span style="position: absolute; clip: rect(3.043em, 1004.47em, 4.408em, -999.997em); top: -5.394em; left: 50%; margin-left: -2.292em;"><span class="mtd" id="MathJax-Span-9072"><span class="mrow" id="MathJax-Span-9073"><span class="mi" id="MathJax-Span-9074" style="font-family: MathJax_Main;">cos</span><span class="mo" id="MathJax-Span-9075"></span><span class="mo" id="MathJax-Span-9076" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-9077" style="font-family: MathJax_Math-italic;">α</span><span class="mo" id="MathJax-Span-9078" style="font-family: MathJax_Main; padding-left: 0.251em;">−</span><span class="mi" id="MathJax-Span-9079" style="font-family: MathJax_Math-italic; padding-left: 0.251em;">γ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-9080" style="font-family: MathJax_Main;">)</span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.043em, 1004.41em, 4.408em, -999.997em); top: -3.905em; left: 50%; margin-left: -2.23em;"><span class="mtd" id="MathJax-Span-9097"><span class="mrow" id="MathJax-Span-9098"><span class="mi" id="MathJax-Span-9099" style="font-family: MathJax_Main;">sin</span><span class="mo" id="MathJax-Span-9100"></span><span class="mo" id="MathJax-Span-9101" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-9102" style="font-family: MathJax_Math-italic;">α</span><span class="mo" id="MathJax-Span-9103" style="font-family: MathJax_Main; padding-left: 0.251em;">−</span><span class="mi" id="MathJax-Span-9104" style="font-family: MathJax_Math-italic; padding-left: 0.251em;">γ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-9105" style="font-family: MathJax_Main;">)</span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.105em, 1000.44em, 4.159em, -999.997em); top: -2.478em; left: 50%; margin-left: -0.245em;"><span class="mtd" id="MathJax-Span-9117"><span class="mrow" id="MathJax-Span-9118"><span class="mn" id="MathJax-Span-9119" style="font-family: MathJax_Main;">0</span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.656em;"></span></span></span></span><span class="mo" id="MathJax-Span-9120" style="vertical-align: 2.174em;"><span style="display: inline-block; position: relative; width: 0.685em; height: 0px;"><span style="position: absolute; font-family: MathJax_Size4; top: -2.788em; left: 0em;">⎤<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; font-family: MathJax_Size4; top: -0.741em; left: 0em;">⎦<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -1.734em; left: 0em;">⎥<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.532em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -2.15em; border-left: 0px solid; width: 0px; height: 5.004em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>R</mi><mo stretchy="false">(</mo><mi>α</mi><mo>,</mo><mi>β</mi><mo>,</mo><mi>γ</mi><mo stretchy="false">)</mo><mo>=</mo><mrow><mo>[</mo><mtable rowspacing="4pt" columnspacing="1em"><mtr><mtd><mn>0</mn></mtd><mtd></mtd><mtd><mi>sin</mi><mo>⁡</mo><mo stretchy="false">(</mo><mi>γ</mi><mo>−</mo><mi>α</mi><mo stretchy="false">)</mo></mtd><mtd></mtd><mtd><mi>cos</mi><mo>⁡</mo><mo stretchy="false">(</mo><mi>α</mi><mo>−</mo><mi>γ</mi><mo stretchy="false">)</mo></mtd></mtr><mtr><mtd><mn>0</mn></mtd><mtd></mtd><mtd><mi>cos</mi><mo>⁡</mo><mo stretchy="false">(</mo><mi>α</mi><mo>−</mo><mi>γ</mi><mo stretchy="false">)</mo></mtd><mtd></mtd><mtd><mi>sin</mi><mo>⁡</mo><mo stretchy="false">(</mo><mi>α</mi><mo>−</mo><mi>γ</mi><mo stretchy="false">)</mo></mtd></mtr><mtr><mtd><mo>−</mo><mn>1</mn></mtd><mtd></mtd><mtd><mn>0</mn></mtd><mtd></mtd><mtd><mn>0</mn></mtd></mtr></mtable><mo>]</mo></mrow></math></span></span><script type="math/tex" id="MathJax-Element-251">R(\alpha,\beta,\gamma) = \begin{bmatrix} 0 && \sin(\gamma-\alpha) && \cos(\alpha-\gamma) \\ 0 &&\cos(\alpha-\gamma) && \sin(\alpha-\gamma) \\ -1 && 0 && 0 \end{bmatrix}</script></p>
<p>In this situation, both yaw and roll refers to the same rotation so we usually assign one of it to be 0, and calculate the other. For me, I assigned yaw to be 0, and calculated roll but you can always do it the other way round. Therefore,</p>
<p><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-252-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;R&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;&amp;#x03B1;&lt;/mi&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;&amp;#x03B2;&lt;/mi&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;&amp;#x03B3;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mrow&gt;&lt;mo&gt;[&lt;/mo&gt;&lt;mtable rowspacing=&quot;4pt&quot; columnspacing=&quot;1em&quot;&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd /&gt;&lt;mtd&gt;&lt;mi&gt;sin&lt;/mi&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;&amp;#x03B3;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mtd&gt;&lt;mtd /&gt;&lt;mtd&gt;&lt;mi&gt;cos&lt;/mi&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mi&gt;&amp;#x03B3;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd /&gt;&lt;mtd&gt;&lt;mi&gt;cos&lt;/mi&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mi&gt;&amp;#x03B3;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mtd&gt;&lt;mtd /&gt;&lt;mtd&gt;&lt;mi&gt;sin&lt;/mi&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mi&gt;&amp;#x03B3;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd /&gt;&lt;mtd&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd /&gt;&lt;mtd&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;/mtable&gt;&lt;mo&gt;]&lt;/mo&gt;&lt;/mrow&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-9121" style="width: 24.073em; display: inline-block;"><span style="display: inline-block; position: relative; width: 19.42em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(2.174em, 1019.11em, 6.393em, -999.997em); top: -4.525em; left: 0em;"><span class="mrow" id="MathJax-Span-9122"><span class="mi" id="MathJax-Span-9123" style="font-family: MathJax_Math-italic;">R</span><span class="mo" id="MathJax-Span-9124" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-9125" style="font-family: MathJax_Math-italic;">α</span><span class="mo" id="MathJax-Span-9126" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-9127" style="font-family: MathJax_Math-italic; padding-left: 0.189em;">β<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-9128" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-9129" style="font-family: MathJax_Math-italic; padding-left: 0.189em;">γ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-9130" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-9131" style="font-family: MathJax_Main; padding-left: 0.251em;">=</span><span class="mrow" id="MathJax-Span-9132" style="padding-left: 0.251em;"><span class="mo" id="MathJax-Span-9133" style="vertical-align: 2.174em;"><span style="display: inline-block; position: relative; width: 0.685em; height: 0px;"><span style="position: absolute; font-family: MathJax_Size4; top: -2.788em; left: 0em;">⎡<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; font-family: MathJax_Size4; top: -0.741em; left: 0em;">⎣<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -1.734em; left: 0em;">⎢<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="mtable" id="MathJax-Span-9134" style="padding-right: 0.189em; padding-left: 0.189em;"><span style="display: inline-block; position: relative; width: 12.162em; height: 0px;"><span style="position: absolute; clip: rect(2.422em, 1001.18em, 6.455em, -999.997em); top: -4.65em; left: 0em;"><span style="display: inline-block; position: relative; width: 1.306em; height: 0px;"><span style="position: absolute; clip: rect(3.105em, 1000.44em, 4.159em, -999.997em); top: -5.394em; left: 50%; margin-left: -0.245em;"><span class="mtd" id="MathJax-Span-9135"><span class="mrow" id="MathJax-Span-9136"><span class="mn" id="MathJax-Span-9137" style="font-family: MathJax_Main;">0</span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.105em, 1000.44em, 4.159em, -999.997em); top: -3.905em; left: 50%; margin-left: -0.245em;"><span class="mtd" id="MathJax-Span-9157"><span class="mrow" id="MathJax-Span-9158"><span class="mn" id="MathJax-Span-9159" style="font-family: MathJax_Main;">0</span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.105em, 1001.18em, 4.221em, -999.997em); top: -2.478em; left: 50%; margin-left: -0.617em;"><span class="mtd" id="MathJax-Span-9180"><span class="mrow" id="MathJax-Span-9181"><span class="mo" id="MathJax-Span-9182" style="font-family: MathJax_Main;">−</span><span class="mn" id="MathJax-Span-9183" style="font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.656em;"></span></span><span style="position: absolute; clip: rect(2.36em, 1000em, 5.648em, -999.997em); top: -3.967em; left: 2.298em;"><span style="display: inline-block; position: relative; width: 0em; height: 0px;"><span style="position: absolute; clip: rect(3.787em, 1000em, 4.159em, -999.997em); top: -5.394em; left: 50%; margin-left: 0em;"><span class="mtd" id="MathJax-Span-9138"><span class="mrow" id="MathJax-Span-9139"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.787em, 1000em, 4.159em, -999.997em); top: -3.905em; left: 50%; margin-left: 0em;"><span class="mtd" id="MathJax-Span-9160"><span class="mrow" id="MathJax-Span-9161"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.787em, 1000em, 4.159em, -999.997em); top: -2.478em; left: 50%; margin-left: 0em;"><span class="mtd" id="MathJax-Span-9184"><span class="mrow" id="MathJax-Span-9185"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(2.298em, 1003.35em, 6.393em, -999.997em); top: -4.65em; left: 3.291em;"><span style="display: inline-block; position: relative; width: 3.415em; height: 0px;"><span style="position: absolute; clip: rect(3.043em, 1002.48em, 4.408em, -999.997em); top: -5.394em; left: 50%; margin-left: -1.3em;"><span class="mtd" id="MathJax-Span-9140"><span class="mrow" id="MathJax-Span-9141"><span class="mi" id="MathJax-Span-9142" style="font-family: MathJax_Main;">sin</span><span class="mo" id="MathJax-Span-9143"></span><span class="mo" id="MathJax-Span-9144" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-9145" style="font-family: MathJax_Math-italic;">γ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-9146" style="font-family: MathJax_Main;">)</span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.043em, 1003.35em, 4.408em, -999.997em); top: -3.905em; left: 50%; margin-left: -1.734em;"><span class="mtd" id="MathJax-Span-9162"><span class="mrow" id="MathJax-Span-9163"><span class="mi" id="MathJax-Span-9164" style="font-family: MathJax_Main;">cos</span><span class="mo" id="MathJax-Span-9165"></span><span class="mo" id="MathJax-Span-9166" style="font-family: MathJax_Main;">(</span><span class="mo" id="MathJax-Span-9167" style="font-family: MathJax_Main;">−</span><span class="mi" id="MathJax-Span-9168" style="font-family: MathJax_Math-italic;">γ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-9169" style="font-family: MathJax_Main;">)</span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.105em, 1000.44em, 4.159em, -999.997em); top: -2.478em; left: 50%; margin-left: -0.245em;"><span class="mtd" id="MathJax-Span-9186"><span class="mrow" id="MathJax-Span-9187"><span class="mn" id="MathJax-Span-9188" style="font-family: MathJax_Main;">0</span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.656em;"></span></span><span style="position: absolute; clip: rect(2.36em, 1000em, 5.648em, -999.997em); top: -3.967em; left: 7.695em;"><span style="display: inline-block; position: relative; width: 0em; height: 0px;"><span style="position: absolute; clip: rect(3.787em, 1000em, 4.159em, -999.997em); top: -5.394em; left: 50%; margin-left: 0em;"><span class="mtd" id="MathJax-Span-9147"><span class="mrow" id="MathJax-Span-9148"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.787em, 1000em, 4.159em, -999.997em); top: -3.905em; left: 50%; margin-left: 0em;"><span class="mtd" id="MathJax-Span-9170"><span class="mrow" id="MathJax-Span-9171"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.787em, 1000em, 4.159em, -999.997em); top: -2.478em; left: 50%; margin-left: 0em;"><span class="mtd" id="MathJax-Span-9189"><span class="mrow" id="MathJax-Span-9190"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(2.298em, 1003.35em, 6.393em, -999.997em); top: -4.65em; left: 8.688em;"><span style="display: inline-block; position: relative; width: 3.415em; height: 0px;"><span style="position: absolute; clip: rect(3.043em, 1003.35em, 4.408em, -999.997em); top: -5.394em; left: 50%; margin-left: -1.734em;"><span class="mtd" id="MathJax-Span-9149"><span class="mrow" id="MathJax-Span-9150"><span class="mi" id="MathJax-Span-9151" style="font-family: MathJax_Main;">cos</span><span class="mo" id="MathJax-Span-9152"></span><span class="mo" id="MathJax-Span-9153" style="font-family: MathJax_Main;">(</span><span class="mo" id="MathJax-Span-9154" style="font-family: MathJax_Main;">−</span><span class="mi" id="MathJax-Span-9155" style="font-family: MathJax_Math-italic;">γ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-9156" style="font-family: MathJax_Main;">)</span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.043em, 1003.23em, 4.408em, -999.997em); top: -3.905em; left: 50%; margin-left: -1.672em;"><span class="mtd" id="MathJax-Span-9172"><span class="mrow" id="MathJax-Span-9173"><span class="mi" id="MathJax-Span-9174" style="font-family: MathJax_Main;">sin</span><span class="mo" id="MathJax-Span-9175"></span><span class="mo" id="MathJax-Span-9176" style="font-family: MathJax_Main;">(</span><span class="mo" id="MathJax-Span-9177" style="font-family: MathJax_Main;">−</span><span class="mi" id="MathJax-Span-9178" style="font-family: MathJax_Math-italic;">γ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-9179" style="font-family: MathJax_Main;">)</span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.105em, 1000.44em, 4.159em, -999.997em); top: -2.478em; left: 50%; margin-left: -0.245em;"><span class="mtd" id="MathJax-Span-9191"><span class="mrow" id="MathJax-Span-9192"><span class="mn" id="MathJax-Span-9193" style="font-family: MathJax_Main;">0</span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.656em;"></span></span></span></span><span class="mo" id="MathJax-Span-9194" style="vertical-align: 2.174em;"><span style="display: inline-block; position: relative; width: 0.685em; height: 0px;"><span style="position: absolute; font-family: MathJax_Size4; top: -2.788em; left: 0em;">⎤<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; font-family: MathJax_Size4; top: -0.741em; left: 0em;">⎦<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -1.734em; left: 0em;">⎥<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.532em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -2.15em; border-left: 0px solid; width: 0px; height: 5.004em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>R</mi><mo stretchy="false">(</mo><mi>α</mi><mo>,</mo><mi>β</mi><mo>,</mo><mi>γ</mi><mo stretchy="false">)</mo><mo>=</mo><mrow><mo>[</mo><mtable rowspacing="4pt" columnspacing="1em"><mtr><mtd><mn>0</mn></mtd><mtd></mtd><mtd><mi>sin</mi><mo>⁡</mo><mo stretchy="false">(</mo><mi>γ</mi><mo stretchy="false">)</mo></mtd><mtd></mtd><mtd><mi>cos</mi><mo>⁡</mo><mo stretchy="false">(</mo><mo>−</mo><mi>γ</mi><mo stretchy="false">)</mo></mtd></mtr><mtr><mtd><mn>0</mn></mtd><mtd></mtd><mtd><mi>cos</mi><mo>⁡</mo><mo stretchy="false">(</mo><mo>−</mo><mi>γ</mi><mo stretchy="false">)</mo></mtd><mtd></mtd><mtd><mi>sin</mi><mo>⁡</mo><mo stretchy="false">(</mo><mo>−</mo><mi>γ</mi><mo stretchy="false">)</mo></mtd></mtr><mtr><mtd><mo>−</mo><mn>1</mn></mtd><mtd></mtd><mtd><mn>0</mn></mtd><mtd></mtd><mtd><mn>0</mn></mtd></mtr></mtable><mo>]</mo></mrow></math></span></span><script type="math/tex" id="MathJax-Element-252">R(\alpha,\beta,\gamma) = \begin{bmatrix} 0 && \sin(\gamma) && \cos(-\gamma) \\ 0 &&\cos(-\gamma) && \sin(-\gamma) \\ -1 && 0 && 0 \end{bmatrix}</script></p>
<p>Now we can determine the roll angle with:</p>
<p><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-253-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mi&gt;o&lt;/mi&gt;&lt;mi&gt;l&lt;/mi&gt;&lt;mi&gt;l&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;msup&gt;&lt;mi&gt;tan&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;mrow&gt;&lt;mo&gt;(&lt;/mo&gt;&lt;mfrac&gt;&lt;msub&gt;&lt;mi&gt;C&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mn&gt;01&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;msub&gt;&lt;mi&gt;C&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mn&gt;02&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mfrac&gt;&lt;mo&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-9195" style="width: 9.805em; display: inline-block;"><span style="display: inline-block; position: relative; width: 7.882em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(1.864em, 1007.7em, 4.035em, -999.997em); top: -3.223em; left: 0em;"><span class="mrow" id="MathJax-Span-9196"><span class="mi" id="MathJax-Span-9197" style="font-family: MathJax_Math-italic;">r</span><span class="mi" id="MathJax-Span-9198" style="font-family: MathJax_Math-italic;">o</span><span class="mi" id="MathJax-Span-9199" style="font-family: MathJax_Math-italic;">l</span><span class="mi" id="MathJax-Span-9200" style="font-family: MathJax_Math-italic;">l</span><span class="mo" id="MathJax-Span-9201" style="font-family: MathJax_Main; padding-left: 0.251em;">=</span><span class="msubsup" id="MathJax-Span-9202" style="padding-left: 0.251em;"><span style="display: inline-block; position: relative; width: 2.422em; height: 0px;"><span style="position: absolute; clip: rect(3.167em, 1001.43em, 4.159em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-9203" style="font-family: MathJax_Main;">tan</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -4.339em; left: 1.43em;"><span class="texatom" id="MathJax-Span-9204"><span class="mrow" id="MathJax-Span-9205"><span class="mo" id="MathJax-Span-9206" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="mn" id="MathJax-Span-9207" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="mo" id="MathJax-Span-9208"></span><span class="mrow" id="MathJax-Span-9209"><span class="mo" id="MathJax-Span-9210" style="vertical-align: 0em;"><span style="font-family: MathJax_Size2;">(</span></span><span class="mfrac" id="MathJax-Span-9211"><span style="display: inline-block; position: relative; width: 1.182em; height: 0px; margin-right: 0.127em; margin-left: 0.127em;"><span style="position: absolute; clip: rect(3.291em, 1001.06em, 4.283em, -999.997em); top: -4.525em; left: 50%; margin-left: -0.555em;"><span class="msubsup" id="MathJax-Span-9212"><span style="display: inline-block; position: relative; width: 1.058em; height: 0px;"><span style="position: absolute; clip: rect(3.291em, 1000.56em, 4.159em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-9213" style="font-size: 70.7%; font-family: MathJax_Math-italic;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.065em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.499em;"><span class="texatom" id="MathJax-Span-9214"><span class="mrow" id="MathJax-Span-9215"><span class="mn" id="MathJax-Span-9216" style="font-size: 50%; font-family: MathJax_Main;">01</span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.291em, 1001.06em, 4.283em, -999.997em); top: -3.533em; left: 50%; margin-left: -0.555em;"><span class="msubsup" id="MathJax-Span-9217"><span style="display: inline-block; position: relative; width: 1.058em; height: 0px;"><span style="position: absolute; clip: rect(3.291em, 1000.56em, 4.159em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-9218" style="font-size: 70.7%; font-family: MathJax_Math-italic;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.065em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.499em;"><span class="texatom" id="MathJax-Span-9219"><span class="mrow" id="MathJax-Span-9220"><span class="mn" id="MathJax-Span-9221" style="font-size: 50%; font-family: MathJax_Main;">02</span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(0.81em, 1001.18em, 1.244em, -999.997em); top: -1.3em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 1.182em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.058em;"></span></span></span></span><span class="mo" id="MathJax-Span-9222" style="vertical-align: 0em;"><span style="font-family: MathJax_Size2;">)</span></span></span></span><span style="display: inline-block; width: 0px; height: 3.229em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.842em; border-left: 0px solid; width: 0px; height: 2.388em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>r</mi><mi>o</mi><mi>l</mi><mi>l</mi><mo>=</mo><msup><mi>tan</mi><mrow class="MJX-TeXAtom-ORD"><mo>−</mo><mn>1</mn></mrow></msup><mo>⁡</mo><mrow><mo>(</mo><mfrac><msub><mi>C</mi><mrow class="MJX-TeXAtom-ORD"><mn>01</mn></mrow></msub><msub><mi>C</mi><mrow class="MJX-TeXAtom-ORD"><mn>02</mn></mrow></msub></mfrac><mo>)</mo></mrow></math></span></span><script type="math/tex" id="MathJax-Element-253">roll = \tan^{-1}\left(\frac{C_{01}}{C_{02}}\right)</script></p>
<p>If you are asking why did I use <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-254-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;C&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mn&gt;01&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;msub&gt;&lt;mi&gt;C&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mn&gt;02&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-9223" style="width: 5.772em; display: inline-block;"><span style="display: inline-block; position: relative; width: 4.656em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(1.492em, 1004.66em, 2.733em, -999.997em); top: -2.354em; left: 0em;"><span class="mrow" id="MathJax-Span-9224"><span class="msubsup" id="MathJax-Span-9225"><span style="display: inline-block; position: relative; width: 1.492em; height: 0px;"><span style="position: absolute; clip: rect(3.105em, 1000.75em, 4.159em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-9226" style="font-family: MathJax_Math-italic;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.065em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.748em;"><span class="texatom" id="MathJax-Span-9227"><span class="mrow" id="MathJax-Span-9228"><span class="mn" id="MathJax-Span-9229" style="font-size: 70.7%; font-family: MathJax_Main;">01</span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="mi" id="MathJax-Span-9230" style="font-family: MathJax_Math-italic;">a</span><span class="mi" id="MathJax-Span-9231" style="font-family: MathJax_Math-italic;">n</span><span class="mi" id="MathJax-Span-9232" style="font-family: MathJax_Math-italic;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="msubsup" id="MathJax-Span-9233"><span style="display: inline-block; position: relative; width: 1.492em; height: 0px;"><span style="position: absolute; clip: rect(3.105em, 1000.75em, 4.159em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-9234" style="font-family: MathJax_Math-italic;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.065em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.748em;"><span class="texatom" id="MathJax-Span-9235"><span class="mrow" id="MathJax-Span-9236"><span class="mn" id="MathJax-Span-9237" style="font-size: 70.7%; font-family: MathJax_Main;">02</span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.36em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.304em; border-left: 0px solid; width: 0px; height: 1.235em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>C</mi><mrow class="MJX-TeXAtom-ORD"><mn>01</mn></mrow></msub><mi>a</mi><mi>n</mi><mi>d</mi><msub><mi>C</mi><mrow class="MJX-TeXAtom-ORD"><mn>02</mn></mrow></msub></math></span></span><script type="math/tex" id="MathJax-Element-254">C_{01} and C_{02}</script> when it is possible to get the answer with just any one of the cells, it is because I wanted to rely on the arctan2 function which automatically finds the quadrant for me.</p>
<h6><span style="text-decoration: underline;">CASE 3</span></h6>
<p>For the case of a pitch angle of -90 degrees, the rotation matrix simplifies to:</p>
<p><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-255-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;R&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;&amp;#x03B1;&lt;/mi&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;&amp;#x03B2;&lt;/mi&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;&amp;#x03B3;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mrow&gt;&lt;mo&gt;[&lt;/mo&gt;&lt;mtable rowspacing=&quot;4pt&quot; columnspacing=&quot;1em&quot;&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd /&gt;&lt;mtd&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mi&gt;cos&lt;/mi&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;&amp;#x03B1;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mi&gt;sin&lt;/mi&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;&amp;#x03B3;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mi&gt;sin&lt;/mi&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;&amp;#x03B1;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mi&gt;cos&lt;/mi&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;&amp;#x03B3;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mtd&gt;&lt;mtd /&gt;&lt;mtd&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mi&gt;cos&lt;/mi&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;&amp;#x03B1;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mi&gt;cos&lt;/mi&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;&amp;#x03B3;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mi&gt;sin&lt;/mi&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;&amp;#x03B1;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mi&gt;sin&lt;/mi&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;&amp;#x03B3;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd /&gt;&lt;mtd&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mi&gt;sin&lt;/mi&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;&amp;#x03B1;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mi&gt;sin&lt;/mi&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;&amp;#x03B3;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mi&gt;cos&lt;/mi&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;&amp;#x03B1;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mi&gt;cos&lt;/mi&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;&amp;#x03B3;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mtd&gt;&lt;mtd /&gt;&lt;mtd&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mi&gt;sin&lt;/mi&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;&amp;#x03B1;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mi&gt;cos&lt;/mi&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;&amp;#x03B3;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mi&gt;cos&lt;/mi&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;&amp;#x03B1;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mi&gt;sin&lt;/mi&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;&amp;#x03B3;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd /&gt;&lt;mtd&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd /&gt;&lt;mtd&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;/mtable&gt;&lt;mo&gt;]&lt;/mo&gt;&lt;/mrow&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-9238" style="width: 47.398em; display: inline-block;"><span style="display: inline-block; position: relative; width: 38.217em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(2.174em, 1037.91em, 6.393em, -999.997em); top: -4.525em; left: 0em;"><span class="mrow" id="MathJax-Span-9239"><span class="mi" id="MathJax-Span-9240" style="font-family: MathJax_Math-italic;">R</span><span class="mo" id="MathJax-Span-9241" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-9242" style="font-family: MathJax_Math-italic;">α</span><span class="mo" id="MathJax-Span-9243" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-9244" style="font-family: MathJax_Math-italic; padding-left: 0.189em;">β<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-9245" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-9246" style="font-family: MathJax_Math-italic; padding-left: 0.189em;">γ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-9247" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-9248" style="font-family: MathJax_Main; padding-left: 0.251em;">=</span><span class="mrow" id="MathJax-Span-9249" style="padding-left: 0.251em;"><span class="mo" id="MathJax-Span-9250" style="vertical-align: 2.174em;"><span style="display: inline-block; position: relative; width: 0.685em; height: 0px;"><span style="position: absolute; font-family: MathJax_Size4; top: -2.788em; left: 0em;">⎡<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; font-family: MathJax_Size4; top: -0.741em; left: 0em;">⎣<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -1.734em; left: 0em;">⎢<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="mtable" id="MathJax-Span-9251" style="padding-right: 0.189em; padding-left: 0.189em;"><span style="display: inline-block; position: relative; width: 30.958em; height: 0px;"><span style="position: absolute; clip: rect(2.36em, 1000.44em, 6.269em, -999.997em); top: -4.587em; left: 0em;"><span style="display: inline-block; position: relative; width: 0.499em; height: 0px;"><span style="position: absolute; clip: rect(3.105em, 1000.44em, 4.159em, -999.997em); top: -5.394em; left: 50%; margin-left: -0.245em;"><span class="mtd" id="MathJax-Span-9252"><span class="mrow" id="MathJax-Span-9253"><span class="mn" id="MathJax-Span-9254" style="font-family: MathJax_Main;">0</span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.105em, 1000.44em, 4.159em, -999.997em); top: -3.905em; left: 50%; margin-left: -0.245em;"><span class="mtd" id="MathJax-Span-9307"><span class="mrow" id="MathJax-Span-9308"><span class="mn" id="MathJax-Span-9309" style="font-family: MathJax_Main;">0</span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.105em, 1000.44em, 4.159em, -999.997em); top: -2.478em; left: 50%; margin-left: -0.245em;"><span class="mtd" id="MathJax-Span-9362"><span class="mrow" id="MathJax-Span-9363"><span class="mn" id="MathJax-Span-9364" style="font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.594em;"></span></span><span style="position: absolute; clip: rect(2.36em, 1000em, 5.648em, -999.997em); top: -3.967em; left: 1.492em;"><span style="display: inline-block; position: relative; width: 0em; height: 0px;"><span style="position: absolute; clip: rect(3.787em, 1000em, 4.159em, -999.997em); top: -5.394em; left: 50%; margin-left: 0em;"><span class="mtd" id="MathJax-Span-9255"><span class="mrow" id="MathJax-Span-9256"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.787em, 1000em, 4.159em, -999.997em); top: -3.905em; left: 50%; margin-left: 0em;"><span class="mtd" id="MathJax-Span-9310"><span class="mrow" id="MathJax-Span-9311"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.787em, 1000em, 4.159em, -999.997em); top: -2.478em; left: 50%; margin-left: 0em;"><span class="mtd" id="MathJax-Span-9365"><span class="mrow" id="MathJax-Span-9366"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(2.298em, 1013.15em, 6.393em, -999.997em); top: -4.65em; left: 2.484em;"><span style="display: inline-block; position: relative; width: 13.217em; height: 0px;"><span style="position: absolute; clip: rect(3.043em, 1013.15em, 4.408em, -999.997em); top: -5.394em; left: 50%; margin-left: -6.635em;"><span class="mtd" id="MathJax-Span-9257"><span class="mrow" id="MathJax-Span-9258"><span class="mo" id="MathJax-Span-9259" style="font-family: MathJax_Main;">−</span><span class="mi" id="MathJax-Span-9260" style="font-family: MathJax_Main; padding-left: 0.189em;">cos</span><span class="mo" id="MathJax-Span-9261"></span><span class="mo" id="MathJax-Span-9262" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-9263" style="font-family: MathJax_Math-italic;">α</span><span class="mo" id="MathJax-Span-9264" style="font-family: MathJax_Main;">)</span><span class="mi" id="MathJax-Span-9265" style="font-family: MathJax_Main; padding-left: 0.189em;">sin</span><span class="mo" id="MathJax-Span-9266"></span><span class="mo" id="MathJax-Span-9267" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-9268" style="font-family: MathJax_Math-italic;">γ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-9269" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-9270" style="font-family: MathJax_Main; padding-left: 0.251em;">−</span><span class="mi" id="MathJax-Span-9271" style="font-family: MathJax_Main; padding-left: 0.251em;">sin</span><span class="mo" id="MathJax-Span-9272"></span><span class="mo" id="MathJax-Span-9273" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-9274" style="font-family: MathJax_Math-italic;">α</span><span class="mo" id="MathJax-Span-9275" style="font-family: MathJax_Main;">)</span><span class="mi" id="MathJax-Span-9276" style="font-family: MathJax_Main; padding-left: 0.189em;">cos</span><span class="mo" id="MathJax-Span-9277"></span><span class="mo" id="MathJax-Span-9278" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-9279" style="font-family: MathJax_Math-italic;">γ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-9280" style="font-family: MathJax_Main;">)</span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.043em, 1013.15em, 4.408em, -999.997em); top: -3.905em; left: 50%; margin-left: -6.635em;"><span class="mtd" id="MathJax-Span-9312"><span class="mrow" id="MathJax-Span-9313"><span class="mo" id="MathJax-Span-9314" style="font-family: MathJax_Main;">−</span><span class="mi" id="MathJax-Span-9315" style="font-family: MathJax_Main; padding-left: 0.189em;">sin</span><span class="mo" id="MathJax-Span-9316"></span><span class="mo" id="MathJax-Span-9317" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-9318" style="font-family: MathJax_Math-italic;">α</span><span class="mo" id="MathJax-Span-9319" style="font-family: MathJax_Main;">)</span><span class="mi" id="MathJax-Span-9320" style="font-family: MathJax_Main; padding-left: 0.189em;">sin</span><span class="mo" id="MathJax-Span-9321"></span><span class="mo" id="MathJax-Span-9322" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-9323" style="font-family: MathJax_Math-italic;">γ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-9324" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-9325" style="font-family: MathJax_Main; padding-left: 0.251em;">+</span><span class="mi" id="MathJax-Span-9326" style="font-family: MathJax_Main; padding-left: 0.251em;">cos</span><span class="mo" id="MathJax-Span-9327"></span><span class="mo" id="MathJax-Span-9328" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-9329" style="font-family: MathJax_Math-italic;">α</span><span class="mo" id="MathJax-Span-9330" style="font-family: MathJax_Main;">)</span><span class="mi" id="MathJax-Span-9331" style="font-family: MathJax_Main; padding-left: 0.189em;">cos</span><span class="mo" id="MathJax-Span-9332"></span><span class="mo" id="MathJax-Span-9333" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-9334" style="font-family: MathJax_Math-italic;">γ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-9335" style="font-family: MathJax_Main;">)</span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.105em, 1000.44em, 4.159em, -999.997em); top: -2.478em; left: 50%; margin-left: -0.245em;"><span class="mtd" id="MathJax-Span-9367"><span class="mrow" id="MathJax-Span-9368"><span class="mn" id="MathJax-Span-9369" style="font-family: MathJax_Main;">0</span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.656em;"></span></span><span style="position: absolute; clip: rect(2.36em, 1000em, 5.648em, -999.997em); top: -3.967em; left: 16.752em;"><span style="display: inline-block; position: relative; width: 0em; height: 0px;"><span style="position: absolute; clip: rect(3.787em, 1000em, 4.159em, -999.997em); top: -5.394em; left: 50%; margin-left: 0em;"><span class="mtd" id="MathJax-Span-9281"><span class="mrow" id="MathJax-Span-9282"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.787em, 1000em, 4.159em, -999.997em); top: -3.905em; left: 50%; margin-left: 0em;"><span class="mtd" id="MathJax-Span-9336"><span class="mrow" id="MathJax-Span-9337"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.787em, 1000em, 4.159em, -999.997em); top: -2.478em; left: 50%; margin-left: 0em;"><span class="mtd" id="MathJax-Span-9370"><span class="mrow" id="MathJax-Span-9371"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(2.298em, 1013.15em, 6.393em, -999.997em); top: -4.65em; left: 17.745em;"><span style="display: inline-block; position: relative; width: 13.217em; height: 0px;"><span style="position: absolute; clip: rect(3.043em, 1013.15em, 4.408em, -999.997em); top: -5.394em; left: 50%; margin-left: -6.635em;"><span class="mtd" id="MathJax-Span-9283"><span class="mrow" id="MathJax-Span-9284"><span class="mo" id="MathJax-Span-9285" style="font-family: MathJax_Main;">−</span><span class="mi" id="MathJax-Span-9286" style="font-family: MathJax_Main; padding-left: 0.189em;">cos</span><span class="mo" id="MathJax-Span-9287"></span><span class="mo" id="MathJax-Span-9288" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-9289" style="font-family: MathJax_Math-italic;">α</span><span class="mo" id="MathJax-Span-9290" style="font-family: MathJax_Main;">)</span><span class="mi" id="MathJax-Span-9291" style="font-family: MathJax_Main; padding-left: 0.189em;">cos</span><span class="mo" id="MathJax-Span-9292"></span><span class="mo" id="MathJax-Span-9293" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-9294" style="font-family: MathJax_Math-italic;">γ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-9295" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-9296" style="font-family: MathJax_Main; padding-left: 0.251em;">+</span><span class="mi" id="MathJax-Span-9297" style="font-family: MathJax_Main; padding-left: 0.251em;">sin</span><span class="mo" id="MathJax-Span-9298"></span><span class="mo" id="MathJax-Span-9299" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-9300" style="font-family: MathJax_Math-italic;">α</span><span class="mo" id="MathJax-Span-9301" style="font-family: MathJax_Main;">)</span><span class="mi" id="MathJax-Span-9302" style="font-family: MathJax_Main; padding-left: 0.189em;">sin</span><span class="mo" id="MathJax-Span-9303"></span><span class="mo" id="MathJax-Span-9304" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-9305" style="font-family: MathJax_Math-italic;">γ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-9306" style="font-family: MathJax_Main;">)</span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.043em, 1013.15em, 4.408em, -999.997em); top: -3.905em; left: 50%; margin-left: -6.635em;"><span class="mtd" id="MathJax-Span-9338"><span class="mrow" id="MathJax-Span-9339"><span class="mo" id="MathJax-Span-9340" style="font-family: MathJax_Main;">−</span><span class="mi" id="MathJax-Span-9341" style="font-family: MathJax_Main; padding-left: 0.189em;">sin</span><span class="mo" id="MathJax-Span-9342"></span><span class="mo" id="MathJax-Span-9343" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-9344" style="font-family: MathJax_Math-italic;">α</span><span class="mo" id="MathJax-Span-9345" style="font-family: MathJax_Main;">)</span><span class="mi" id="MathJax-Span-9346" style="font-family: MathJax_Main; padding-left: 0.189em;">cos</span><span class="mo" id="MathJax-Span-9347"></span><span class="mo" id="MathJax-Span-9348" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-9349" style="font-family: MathJax_Math-italic;">γ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-9350" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-9351" style="font-family: MathJax_Main; padding-left: 0.251em;">−</span><span class="mi" id="MathJax-Span-9352" style="font-family: MathJax_Main; padding-left: 0.251em;">cos</span><span class="mo" id="MathJax-Span-9353"></span><span class="mo" id="MathJax-Span-9354" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-9355" style="font-family: MathJax_Math-italic;">α</span><span class="mo" id="MathJax-Span-9356" style="font-family: MathJax_Main;">)</span><span class="mi" id="MathJax-Span-9357" style="font-family: MathJax_Main; padding-left: 0.189em;">sin</span><span class="mo" id="MathJax-Span-9358"></span><span class="mo" id="MathJax-Span-9359" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-9360" style="font-family: MathJax_Math-italic;">γ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-9361" style="font-family: MathJax_Main;">)</span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.105em, 1000.44em, 4.159em, -999.997em); top: -2.478em; left: 50%; margin-left: -0.245em;"><span class="mtd" id="MathJax-Span-9372"><span class="mrow" id="MathJax-Span-9373"><span class="mn" id="MathJax-Span-9374" style="font-family: MathJax_Main;">0</span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.656em;"></span></span></span></span><span class="mo" id="MathJax-Span-9375" style="vertical-align: 2.174em;"><span style="display: inline-block; position: relative; width: 0.685em; height: 0px;"><span style="position: absolute; font-family: MathJax_Size4; top: -2.788em; left: 0em;">⎤<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; font-family: MathJax_Size4; top: -0.741em; left: 0em;">⎦<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -1.734em; left: 0em;">⎥<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.532em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -2.15em; border-left: 0px solid; width: 0px; height: 5.004em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>R</mi><mo stretchy="false">(</mo><mi>α</mi><mo>,</mo><mi>β</mi><mo>,</mo><mi>γ</mi><mo stretchy="false">)</mo><mo>=</mo><mrow><mo>[</mo><mtable rowspacing="4pt" columnspacing="1em"><mtr><mtd><mn>0</mn></mtd><mtd></mtd><mtd><mo>−</mo><mi>cos</mi><mo>⁡</mo><mo stretchy="false">(</mo><mi>α</mi><mo stretchy="false">)</mo><mi>sin</mi><mo>⁡</mo><mo stretchy="false">(</mo><mi>γ</mi><mo stretchy="false">)</mo><mo>−</mo><mi>sin</mi><mo>⁡</mo><mo stretchy="false">(</mo><mi>α</mi><mo stretchy="false">)</mo><mi>cos</mi><mo>⁡</mo><mo stretchy="false">(</mo><mi>γ</mi><mo stretchy="false">)</mo></mtd><mtd></mtd><mtd><mo>−</mo><mi>cos</mi><mo>⁡</mo><mo stretchy="false">(</mo><mi>α</mi><mo stretchy="false">)</mo><mi>cos</mi><mo>⁡</mo><mo stretchy="false">(</mo><mi>γ</mi><mo stretchy="false">)</mo><mo>+</mo><mi>sin</mi><mo>⁡</mo><mo stretchy="false">(</mo><mi>α</mi><mo stretchy="false">)</mo><mi>sin</mi><mo>⁡</mo><mo stretchy="false">(</mo><mi>γ</mi><mo stretchy="false">)</mo></mtd></mtr><mtr><mtd><mn>0</mn></mtd><mtd></mtd><mtd><mo>−</mo><mi>sin</mi><mo>⁡</mo><mo stretchy="false">(</mo><mi>α</mi><mo stretchy="false">)</mo><mi>sin</mi><mo>⁡</mo><mo stretchy="false">(</mo><mi>γ</mi><mo stretchy="false">)</mo><mo>+</mo><mi>cos</mi><mo>⁡</mo><mo stretchy="false">(</mo><mi>α</mi><mo stretchy="false">)</mo><mi>cos</mi><mo>⁡</mo><mo stretchy="false">(</mo><mi>γ</mi><mo stretchy="false">)</mo></mtd><mtd></mtd><mtd><mo>−</mo><mi>sin</mi><mo>⁡</mo><mo stretchy="false">(</mo><mi>α</mi><mo stretchy="false">)</mo><mi>cos</mi><mo>⁡</mo><mo stretchy="false">(</mo><mi>γ</mi><mo stretchy="false">)</mo><mo>−</mo><mi>cos</mi><mo>⁡</mo><mo stretchy="false">(</mo><mi>α</mi><mo stretchy="false">)</mo><mi>sin</mi><mo>⁡</mo><mo stretchy="false">(</mo><mi>γ</mi><mo stretchy="false">)</mo></mtd></mtr><mtr><mtd><mn>1</mn></mtd><mtd></mtd><mtd><mn>0</mn></mtd><mtd></mtd><mtd><mn>0</mn></mtd></mtr></mtable><mo>]</mo></mrow></math></span></span><script type="math/tex" id="MathJax-Element-255">R(\alpha,\beta,\gamma) = \begin{bmatrix} 0 && -\cos(\alpha)\sin(\gamma)-\sin(\alpha)\cos(\gamma) && -\cos(\alpha)\cos(\gamma)+\sin(\alpha)\sin(\gamma) \\ 0 && -\sin(\alpha)\sin(\gamma)+\cos(\alpha)\cos(\gamma) && -\sin(\alpha)\cos(\gamma)-\cos(\alpha)\sin(\gamma) \\ 1 && 0 && 0 \end{bmatrix}</script></p>
<p>Once again, simplifying with trigonometric identities,</p>
<p><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-256-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;R&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;&amp;#x03B1;&lt;/mi&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;&amp;#x03B2;&lt;/mi&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;&amp;#x03B3;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mrow&gt;&lt;mo&gt;[&lt;/mo&gt;&lt;mtable rowspacing=&quot;4pt&quot; columnspacing=&quot;1em&quot;&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd /&gt;&lt;mtd&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mi&gt;sin&lt;/mi&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;&amp;#x03B1;&lt;/mi&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mi&gt;&amp;#x03B3;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mtd&gt;&lt;mtd /&gt;&lt;mtd&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mi&gt;cos&lt;/mi&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;&amp;#x03B1;&lt;/mi&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mi&gt;&amp;#x03B3;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd /&gt;&lt;mtd&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mi&gt;cos&lt;/mi&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;&amp;#x03B1;&lt;/mi&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mi&gt;&amp;#x03B3;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mtd&gt;&lt;mtd /&gt;&lt;mtd&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mi&gt;sin&lt;/mi&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;&amp;#x03B1;&lt;/mi&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mi&gt;&amp;#x03B3;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd /&gt;&lt;mtd&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd /&gt;&lt;mtd&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;/mtable&gt;&lt;mo&gt;]&lt;/mo&gt;&lt;/mrow&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-9376" style="width: 28.353em; display: inline-block;"><span style="display: inline-block; position: relative; width: 22.832em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(2.174em, 1022.52em, 6.393em, -999.997em); top: -4.525em; left: 0em;"><span class="mrow" id="MathJax-Span-9377"><span class="mi" id="MathJax-Span-9378" style="font-family: MathJax_Math-italic;">R</span><span class="mo" id="MathJax-Span-9379" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-9380" style="font-family: MathJax_Math-italic;">α</span><span class="mo" id="MathJax-Span-9381" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-9382" style="font-family: MathJax_Math-italic; padding-left: 0.189em;">β<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-9383" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-9384" style="font-family: MathJax_Math-italic; padding-left: 0.189em;">γ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-9385" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-9386" style="font-family: MathJax_Main; padding-left: 0.251em;">=</span><span class="mrow" id="MathJax-Span-9387" style="padding-left: 0.251em;"><span class="mo" id="MathJax-Span-9388" style="vertical-align: 2.174em;"><span style="display: inline-block; position: relative; width: 0.685em; height: 0px;"><span style="position: absolute; font-family: MathJax_Size4; top: -2.788em; left: 0em;">⎡<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; font-family: MathJax_Size4; top: -0.741em; left: 0em;">⎣<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -1.734em; left: 0em;">⎢<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="mtable" id="MathJax-Span-9389" style="padding-right: 0.189em; padding-left: 0.189em;"><span style="display: inline-block; position: relative; width: 15.574em; height: 0px;"><span style="position: absolute; clip: rect(2.36em, 1000.44em, 6.269em, -999.997em); top: -4.587em; left: 0em;"><span style="display: inline-block; position: relative; width: 0.499em; height: 0px;"><span style="position: absolute; clip: rect(3.105em, 1000.44em, 4.159em, -999.997em); top: -5.394em; left: 50%; margin-left: -0.245em;"><span class="mtd" id="MathJax-Span-9390"><span class="mrow" id="MathJax-Span-9391"><span class="mn" id="MathJax-Span-9392" style="font-family: MathJax_Main;">0</span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.105em, 1000.44em, 4.159em, -999.997em); top: -3.905em; left: 50%; margin-left: -0.245em;"><span class="mtd" id="MathJax-Span-9417"><span class="mrow" id="MathJax-Span-9418"><span class="mn" id="MathJax-Span-9419" style="font-family: MathJax_Main;">0</span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.105em, 1000.44em, 4.159em, -999.997em); top: -2.478em; left: 50%; margin-left: -0.245em;"><span class="mtd" id="MathJax-Span-9444"><span class="mrow" id="MathJax-Span-9445"><span class="mn" id="MathJax-Span-9446" style="font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.594em;"></span></span><span style="position: absolute; clip: rect(2.36em, 1000em, 5.648em, -999.997em); top: -3.967em; left: 1.492em;"><span style="display: inline-block; position: relative; width: 0em; height: 0px;"><span style="position: absolute; clip: rect(3.787em, 1000em, 4.159em, -999.997em); top: -5.394em; left: 50%; margin-left: 0em;"><span class="mtd" id="MathJax-Span-9393"><span class="mrow" id="MathJax-Span-9394"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.787em, 1000em, 4.159em, -999.997em); top: -3.905em; left: 50%; margin-left: 0em;"><span class="mtd" id="MathJax-Span-9420"><span class="mrow" id="MathJax-Span-9421"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.787em, 1000em, 4.159em, -999.997em); top: -2.478em; left: 50%; margin-left: 0em;"><span class="mtd" id="MathJax-Span-9447"><span class="mrow" id="MathJax-Span-9448"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(2.298em, 1005.46em, 6.393em, -999.997em); top: -4.65em; left: 2.484em;"><span style="display: inline-block; position: relative; width: 5.524em; height: 0px;"><span style="position: absolute; clip: rect(3.043em, 1005.34em, 4.408em, -999.997em); top: -5.394em; left: 50%; margin-left: -2.726em;"><span class="mtd" id="MathJax-Span-9395"><span class="mrow" id="MathJax-Span-9396"><span class="mo" id="MathJax-Span-9397" style="font-family: MathJax_Main;">−</span><span class="mi" id="MathJax-Span-9398" style="font-family: MathJax_Main; padding-left: 0.189em;">sin</span><span class="mo" id="MathJax-Span-9399"></span><span class="mo" id="MathJax-Span-9400" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-9401" style="font-family: MathJax_Math-italic;">α</span><span class="mo" id="MathJax-Span-9402" style="font-family: MathJax_Main; padding-left: 0.251em;">+</span><span class="mi" id="MathJax-Span-9403" style="font-family: MathJax_Math-italic; padding-left: 0.251em;">γ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-9404" style="font-family: MathJax_Main;">)</span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.043em, 1005.46em, 4.408em, -999.997em); top: -3.905em; left: 50%; margin-left: -2.788em;"><span class="mtd" id="MathJax-Span-9422"><span class="mrow" id="MathJax-Span-9423"><span class="mo" id="MathJax-Span-9424" style="font-family: MathJax_Main;">−</span><span class="mi" id="MathJax-Span-9425" style="font-family: MathJax_Main; padding-left: 0.189em;">cos</span><span class="mo" id="MathJax-Span-9426"></span><span class="mo" id="MathJax-Span-9427" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-9428" style="font-family: MathJax_Math-italic;">α</span><span class="mo" id="MathJax-Span-9429" style="font-family: MathJax_Main; padding-left: 0.251em;">+</span><span class="mi" id="MathJax-Span-9430" style="font-family: MathJax_Math-italic; padding-left: 0.251em;">γ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-9431" style="font-family: MathJax_Main;">)</span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.105em, 1000.44em, 4.159em, -999.997em); top: -2.478em; left: 50%; margin-left: -0.245em;"><span class="mtd" id="MathJax-Span-9449"><span class="mrow" id="MathJax-Span-9450"><span class="mn" id="MathJax-Span-9451" style="font-family: MathJax_Main;">0</span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.656em;"></span></span><span style="position: absolute; clip: rect(2.36em, 1000em, 5.648em, -999.997em); top: -3.967em; left: 9.06em;"><span style="display: inline-block; position: relative; width: 0em; height: 0px;"><span style="position: absolute; clip: rect(3.787em, 1000em, 4.159em, -999.997em); top: -5.394em; left: 50%; margin-left: 0em;"><span class="mtd" id="MathJax-Span-9405"><span class="mrow" id="MathJax-Span-9406"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.787em, 1000em, 4.159em, -999.997em); top: -3.905em; left: 50%; margin-left: 0em;"><span class="mtd" id="MathJax-Span-9432"><span class="mrow" id="MathJax-Span-9433"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.787em, 1000em, 4.159em, -999.997em); top: -2.478em; left: 50%; margin-left: 0em;"><span class="mtd" id="MathJax-Span-9452"><span class="mrow" id="MathJax-Span-9453"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(2.298em, 1005.46em, 6.393em, -999.997em); top: -4.65em; left: 10.053em;"><span style="display: inline-block; position: relative; width: 5.524em; height: 0px;"><span style="position: absolute; clip: rect(3.043em, 1005.46em, 4.408em, -999.997em); top: -5.394em; left: 50%; margin-left: -2.788em;"><span class="mtd" id="MathJax-Span-9407"><span class="mrow" id="MathJax-Span-9408"><span class="mo" id="MathJax-Span-9409" style="font-family: MathJax_Main;">−</span><span class="mi" id="MathJax-Span-9410" style="font-family: MathJax_Main; padding-left: 0.189em;">cos</span><span class="mo" id="MathJax-Span-9411"></span><span class="mo" id="MathJax-Span-9412" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-9413" style="font-family: MathJax_Math-italic;">α</span><span class="mo" id="MathJax-Span-9414" style="font-family: MathJax_Main; padding-left: 0.251em;">+</span><span class="mi" id="MathJax-Span-9415" style="font-family: MathJax_Math-italic; padding-left: 0.251em;">γ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-9416" style="font-family: MathJax_Main;">)</span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.043em, 1005.34em, 4.408em, -999.997em); top: -3.905em; left: 50%; margin-left: -2.726em;"><span class="mtd" id="MathJax-Span-9434"><span class="mrow" id="MathJax-Span-9435"><span class="mo" id="MathJax-Span-9436" style="font-family: MathJax_Main;">−</span><span class="mi" id="MathJax-Span-9437" style="font-family: MathJax_Main; padding-left: 0.189em;">sin</span><span class="mo" id="MathJax-Span-9438"></span><span class="mo" id="MathJax-Span-9439" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-9440" style="font-family: MathJax_Math-italic;">α</span><span class="mo" id="MathJax-Span-9441" style="font-family: MathJax_Main; padding-left: 0.251em;">+</span><span class="mi" id="MathJax-Span-9442" style="font-family: MathJax_Math-italic; padding-left: 0.251em;">γ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-9443" style="font-family: MathJax_Main;">)</span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.105em, 1000.44em, 4.159em, -999.997em); top: -2.478em; left: 50%; margin-left: -0.245em;"><span class="mtd" id="MathJax-Span-9454"><span class="mrow" id="MathJax-Span-9455"><span class="mn" id="MathJax-Span-9456" style="font-family: MathJax_Main;">0</span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.656em;"></span></span></span></span><span class="mo" id="MathJax-Span-9457" style="vertical-align: 2.174em;"><span style="display: inline-block; position: relative; width: 0.685em; height: 0px;"><span style="position: absolute; font-family: MathJax_Size4; top: -2.788em; left: 0em;">⎤<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; font-family: MathJax_Size4; top: -0.741em; left: 0em;">⎦<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -1.734em; left: 0em;">⎥<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.532em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -2.15em; border-left: 0px solid; width: 0px; height: 5.004em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>R</mi><mo stretchy="false">(</mo><mi>α</mi><mo>,</mo><mi>β</mi><mo>,</mo><mi>γ</mi><mo stretchy="false">)</mo><mo>=</mo><mrow><mo>[</mo><mtable rowspacing="4pt" columnspacing="1em"><mtr><mtd><mn>0</mn></mtd><mtd></mtd><mtd><mo>−</mo><mi>sin</mi><mo>⁡</mo><mo stretchy="false">(</mo><mi>α</mi><mo>+</mo><mi>γ</mi><mo stretchy="false">)</mo></mtd><mtd></mtd><mtd><mo>−</mo><mi>cos</mi><mo>⁡</mo><mo stretchy="false">(</mo><mi>α</mi><mo>+</mo><mi>γ</mi><mo stretchy="false">)</mo></mtd></mtr><mtr><mtd><mn>0</mn></mtd><mtd></mtd><mtd><mo>−</mo><mi>cos</mi><mo>⁡</mo><mo stretchy="false">(</mo><mi>α</mi><mo>+</mo><mi>γ</mi><mo stretchy="false">)</mo></mtd><mtd></mtd><mtd><mo>−</mo><mi>sin</mi><mo>⁡</mo><mo stretchy="false">(</mo><mi>α</mi><mo>+</mo><mi>γ</mi><mo stretchy="false">)</mo></mtd></mtr><mtr><mtd><mn>1</mn></mtd><mtd></mtd><mtd><mn>0</mn></mtd><mtd></mtd><mtd><mn>0</mn></mtd></mtr></mtable><mo>]</mo></mrow></math></span></span><script type="math/tex" id="MathJax-Element-256">R(\alpha,\beta,\gamma) = \begin{bmatrix} 0 && -\sin(\alpha+\gamma) && -\cos(\alpha+\gamma) \\ 0 && -\cos(\alpha+\gamma) &&-\sin(\alpha+\gamma) \\ 1 && 0 && 0 \end{bmatrix}</script></p>
<p>I assigned yaw to be 0 so the above equation further simplifies to:</p>
<p><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-257-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;R&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;&amp;#x03B1;&lt;/mi&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;&amp;#x03B2;&lt;/mi&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;&amp;#x03B3;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mrow&gt;&lt;mo&gt;[&lt;/mo&gt;&lt;mtable rowspacing=&quot;4pt&quot; columnspacing=&quot;1em&quot;&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd /&gt;&lt;mtd&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mi&gt;sin&lt;/mi&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;&amp;#x03B3;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mtd&gt;&lt;mtd /&gt;&lt;mtd&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mi&gt;cos&lt;/mi&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;&amp;#x03B3;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd /&gt;&lt;mtd&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mi&gt;cos&lt;/mi&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;&amp;#x03B3;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mtd&gt;&lt;mtd /&gt;&lt;mtd&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mi&gt;sin&lt;/mi&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;&amp;#x03B3;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd /&gt;&lt;mtd&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd /&gt;&lt;mtd&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;/mtable&gt;&lt;mo&gt;]&lt;/mo&gt;&lt;/mrow&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-9458" style="width: 23.576em; display: inline-block;"><span style="display: inline-block; position: relative; width: 18.986em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(2.174em, 1018.68em, 6.393em, -999.997em); top: -4.525em; left: 0em;"><span class="mrow" id="MathJax-Span-9459"><span class="mi" id="MathJax-Span-9460" style="font-family: MathJax_Math-italic;">R</span><span class="mo" id="MathJax-Span-9461" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-9462" style="font-family: MathJax_Math-italic;">α</span><span class="mo" id="MathJax-Span-9463" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-9464" style="font-family: MathJax_Math-italic; padding-left: 0.189em;">β<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-9465" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-9466" style="font-family: MathJax_Math-italic; padding-left: 0.189em;">γ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-9467" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-9468" style="font-family: MathJax_Main; padding-left: 0.251em;">=</span><span class="mrow" id="MathJax-Span-9469" style="padding-left: 0.251em;"><span class="mo" id="MathJax-Span-9470" style="vertical-align: 2.174em;"><span style="display: inline-block; position: relative; width: 0.685em; height: 0px;"><span style="position: absolute; font-family: MathJax_Size4; top: -2.788em; left: 0em;">⎡<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; font-family: MathJax_Size4; top: -0.741em; left: 0em;">⎣<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -1.734em; left: 0em;">⎢<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="mtable" id="MathJax-Span-9471" style="padding-right: 0.189em; padding-left: 0.189em;"><span style="display: inline-block; position: relative; width: 11.728em; height: 0px;"><span style="position: absolute; clip: rect(2.36em, 1000.44em, 6.269em, -999.997em); top: -4.587em; left: 0em;"><span style="display: inline-block; position: relative; width: 0.499em; height: 0px;"><span style="position: absolute; clip: rect(3.105em, 1000.44em, 4.159em, -999.997em); top: -5.394em; left: 50%; margin-left: -0.245em;"><span class="mtd" id="MathJax-Span-9472"><span class="mrow" id="MathJax-Span-9473"><span class="mn" id="MathJax-Span-9474" style="font-family: MathJax_Main;">0</span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.105em, 1000.44em, 4.159em, -999.997em); top: -3.905em; left: 50%; margin-left: -0.245em;"><span class="mtd" id="MathJax-Span-9495"><span class="mrow" id="MathJax-Span-9496"><span class="mn" id="MathJax-Span-9497" style="font-family: MathJax_Main;">0</span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.105em, 1000.44em, 4.159em, -999.997em); top: -2.478em; left: 50%; margin-left: -0.245em;"><span class="mtd" id="MathJax-Span-9518"><span class="mrow" id="MathJax-Span-9519"><span class="mn" id="MathJax-Span-9520" style="font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.594em;"></span></span><span style="position: absolute; clip: rect(2.36em, 1000em, 5.648em, -999.997em); top: -3.967em; left: 1.492em;"><span style="display: inline-block; position: relative; width: 0em; height: 0px;"><span style="position: absolute; clip: rect(3.787em, 1000em, 4.159em, -999.997em); top: -5.394em; left: 50%; margin-left: 0em;"><span class="mtd" id="MathJax-Span-9475"><span class="mrow" id="MathJax-Span-9476"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.787em, 1000em, 4.159em, -999.997em); top: -3.905em; left: 50%; margin-left: 0em;"><span class="mtd" id="MathJax-Span-9498"><span class="mrow" id="MathJax-Span-9499"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.787em, 1000em, 4.159em, -999.997em); top: -2.478em; left: 50%; margin-left: 0em;"><span class="mtd" id="MathJax-Span-9521"><span class="mrow" id="MathJax-Span-9522"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(2.298em, 1003.54em, 6.393em, -999.997em); top: -4.65em; left: 2.484em;"><span style="display: inline-block; position: relative; width: 3.601em; height: 0px;"><span style="position: absolute; clip: rect(3.043em, 1003.41em, 4.408em, -999.997em); top: -5.394em; left: 50%; margin-left: -1.734em;"><span class="mtd" id="MathJax-Span-9477"><span class="mrow" id="MathJax-Span-9478"><span class="mo" id="MathJax-Span-9479" style="font-family: MathJax_Main;">−</span><span class="mi" id="MathJax-Span-9480" style="font-family: MathJax_Main; padding-left: 0.189em;">sin</span><span class="mo" id="MathJax-Span-9481"></span><span class="mo" id="MathJax-Span-9482" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-9483" style="font-family: MathJax_Math-italic;">γ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-9484" style="font-family: MathJax_Main;">)</span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.043em, 1003.54em, 4.408em, -999.997em); top: -3.905em; left: 50%; margin-left: -1.796em;"><span class="mtd" id="MathJax-Span-9500"><span class="mrow" id="MathJax-Span-9501"><span class="mo" id="MathJax-Span-9502" style="font-family: MathJax_Main;">−</span><span class="mi" id="MathJax-Span-9503" style="font-family: MathJax_Main; padding-left: 0.189em;">cos</span><span class="mo" id="MathJax-Span-9504"></span><span class="mo" id="MathJax-Span-9505" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-9506" style="font-family: MathJax_Math-italic;">γ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-9507" style="font-family: MathJax_Main;">)</span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.105em, 1000.44em, 4.159em, -999.997em); top: -2.478em; left: 50%; margin-left: -0.245em;"><span class="mtd" id="MathJax-Span-9523"><span class="mrow" id="MathJax-Span-9524"><span class="mn" id="MathJax-Span-9525" style="font-family: MathJax_Main;">0</span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.656em;"></span></span><span style="position: absolute; clip: rect(2.36em, 1000em, 5.648em, -999.997em); top: -3.967em; left: 7.137em;"><span style="display: inline-block; position: relative; width: 0em; height: 0px;"><span style="position: absolute; clip: rect(3.787em, 1000em, 4.159em, -999.997em); top: -5.394em; left: 50%; margin-left: 0em;"><span class="mtd" id="MathJax-Span-9485"><span class="mrow" id="MathJax-Span-9486"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.787em, 1000em, 4.159em, -999.997em); top: -3.905em; left: 50%; margin-left: 0em;"><span class="mtd" id="MathJax-Span-9508"><span class="mrow" id="MathJax-Span-9509"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.787em, 1000em, 4.159em, -999.997em); top: -2.478em; left: 50%; margin-left: 0em;"><span class="mtd" id="MathJax-Span-9526"><span class="mrow" id="MathJax-Span-9527"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(2.298em, 1003.54em, 6.393em, -999.997em); top: -4.65em; left: 8.13em;"><span style="display: inline-block; position: relative; width: 3.601em; height: 0px;"><span style="position: absolute; clip: rect(3.043em, 1003.54em, 4.408em, -999.997em); top: -5.394em; left: 50%; margin-left: -1.796em;"><span class="mtd" id="MathJax-Span-9487"><span class="mrow" id="MathJax-Span-9488"><span class="mo" id="MathJax-Span-9489" style="font-family: MathJax_Main;">−</span><span class="mi" id="MathJax-Span-9490" style="font-family: MathJax_Main; padding-left: 0.189em;">cos</span><span class="mo" id="MathJax-Span-9491"></span><span class="mo" id="MathJax-Span-9492" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-9493" style="font-family: MathJax_Math-italic;">γ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-9494" style="font-family: MathJax_Main;">)</span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.043em, 1003.41em, 4.408em, -999.997em); top: -3.905em; left: 50%; margin-left: -1.734em;"><span class="mtd" id="MathJax-Span-9510"><span class="mrow" id="MathJax-Span-9511"><span class="mo" id="MathJax-Span-9512" style="font-family: MathJax_Main;">−</span><span class="mi" id="MathJax-Span-9513" style="font-family: MathJax_Main; padding-left: 0.189em;">sin</span><span class="mo" id="MathJax-Span-9514"></span><span class="mo" id="MathJax-Span-9515" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-9516" style="font-family: MathJax_Math-italic;">γ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-9517" style="font-family: MathJax_Main;">)</span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.105em, 1000.44em, 4.159em, -999.997em); top: -2.478em; left: 50%; margin-left: -0.245em;"><span class="mtd" id="MathJax-Span-9528"><span class="mrow" id="MathJax-Span-9529"><span class="mn" id="MathJax-Span-9530" style="font-family: MathJax_Main;">0</span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.656em;"></span></span></span></span><span class="mo" id="MathJax-Span-9531" style="vertical-align: 2.174em;"><span style="display: inline-block; position: relative; width: 0.685em; height: 0px;"><span style="position: absolute; font-family: MathJax_Size4; top: -2.788em; left: 0em;">⎤<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; font-family: MathJax_Size4; top: -0.741em; left: 0em;">⎦<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -1.734em; left: 0em;">⎥<span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.532em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -2.15em; border-left: 0px solid; width: 0px; height: 5.004em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>R</mi><mo stretchy="false">(</mo><mi>α</mi><mo>,</mo><mi>β</mi><mo>,</mo><mi>γ</mi><mo stretchy="false">)</mo><mo>=</mo><mrow><mo>[</mo><mtable rowspacing="4pt" columnspacing="1em"><mtr><mtd><mn>0</mn></mtd><mtd></mtd><mtd><mo>−</mo><mi>sin</mi><mo>⁡</mo><mo stretchy="false">(</mo><mi>γ</mi><mo stretchy="false">)</mo></mtd><mtd></mtd><mtd><mo>−</mo><mi>cos</mi><mo>⁡</mo><mo stretchy="false">(</mo><mi>γ</mi><mo stretchy="false">)</mo></mtd></mtr><mtr><mtd><mn>0</mn></mtd><mtd></mtd><mtd><mo>−</mo><mi>cos</mi><mo>⁡</mo><mo stretchy="false">(</mo><mi>γ</mi><mo stretchy="false">)</mo></mtd><mtd></mtd><mtd><mo>−</mo><mi>sin</mi><mo>⁡</mo><mo stretchy="false">(</mo><mi>γ</mi><mo stretchy="false">)</mo></mtd></mtr><mtr><mtd><mn>1</mn></mtd><mtd></mtd><mtd><mn>0</mn></mtd><mtd></mtd><mtd><mn>0</mn></mtd></mtr></mtable><mo>]</mo></mrow></math></span></span><script type="math/tex" id="MathJax-Element-257">R(\alpha,\beta,\gamma) = \begin{bmatrix} 0 && -\sin(\gamma) && -\cos(\gamma) \\ 0 && -\cos(\gamma) &&-\sin(\gamma) \\ 1 && 0 && 0 \end{bmatrix}</script></p>
<p>Now we can determine the roll angle with:</p>
<p><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-258-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mi&gt;o&lt;/mi&gt;&lt;mi&gt;l&lt;/mi&gt;&lt;mi&gt;l&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;msup&gt;&lt;mi&gt;tan&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;mrow&gt;&lt;mo&gt;(&lt;/mo&gt;&lt;mfrac&gt;&lt;mrow&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;C&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mn&gt;01&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;mrow&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;C&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mn&gt;02&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;mo&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-9532" style="width: 10.487em; display: inline-block;"><span style="display: inline-block; position: relative; width: 8.44em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(1.864em, 1008.25em, 4.035em, -999.997em); top: -3.223em; left: 0em;"><span class="mrow" id="MathJax-Span-9533"><span class="mi" id="MathJax-Span-9534" style="font-family: MathJax_Math-italic;">r</span><span class="mi" id="MathJax-Span-9535" style="font-family: MathJax_Math-italic;">o</span><span class="mi" id="MathJax-Span-9536" style="font-family: MathJax_Math-italic;">l</span><span class="mi" id="MathJax-Span-9537" style="font-family: MathJax_Math-italic;">l</span><span class="mo" id="MathJax-Span-9538" style="font-family: MathJax_Main; padding-left: 0.251em;">=</span><span class="msubsup" id="MathJax-Span-9539" style="padding-left: 0.251em;"><span style="display: inline-block; position: relative; width: 2.422em; height: 0px;"><span style="position: absolute; clip: rect(3.167em, 1001.43em, 4.159em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-9540" style="font-family: MathJax_Main;">tan</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -4.339em; left: 1.43em;"><span class="texatom" id="MathJax-Span-9541"><span class="mrow" id="MathJax-Span-9542"><span class="mo" id="MathJax-Span-9543" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="mn" id="MathJax-Span-9544" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="mo" id="MathJax-Span-9545"></span><span class="mrow" id="MathJax-Span-9546"><span class="mo" id="MathJax-Span-9547" style="vertical-align: 0em;"><span style="font-family: MathJax_Size2;">(</span></span><span class="mfrac" id="MathJax-Span-9548"><span style="display: inline-block; position: relative; width: 1.74em; height: 0px; margin-right: 0.127em; margin-left: 0.127em;"><span style="position: absolute; clip: rect(3.291em, 1001.62em, 4.283em, -999.997em); top: -4.525em; left: 50%; margin-left: -0.803em;"><span class="mrow" id="MathJax-Span-9549"><span class="mo" id="MathJax-Span-9550" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="msubsup" id="MathJax-Span-9551"><span style="display: inline-block; position: relative; width: 1.058em; height: 0px;"><span style="position: absolute; clip: rect(3.291em, 1000.56em, 4.159em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-9552" style="font-size: 70.7%; font-family: MathJax_Math-italic;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.065em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.499em;"><span class="texatom" id="MathJax-Span-9553"><span class="mrow" id="MathJax-Span-9554"><span class="mn" id="MathJax-Span-9555" style="font-size: 50%; font-family: MathJax_Main;">01</span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.291em, 1001.62em, 4.283em, -999.997em); top: -3.533em; left: 50%; margin-left: -0.803em;"><span class="mrow" id="MathJax-Span-9556"><span class="mo" id="MathJax-Span-9557" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="msubsup" id="MathJax-Span-9558"><span style="display: inline-block; position: relative; width: 1.058em; height: 0px;"><span style="position: absolute; clip: rect(3.291em, 1000.56em, 4.159em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-9559" style="font-size: 70.7%; font-family: MathJax_Math-italic;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.065em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.499em;"><span class="texatom" id="MathJax-Span-9560"><span class="mrow" id="MathJax-Span-9561"><span class="mn" id="MathJax-Span-9562" style="font-size: 50%; font-family: MathJax_Main;">02</span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(0.81em, 1001.74em, 1.244em, -999.997em); top: -1.3em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 1.74em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.058em;"></span></span></span></span><span class="mo" id="MathJax-Span-9563" style="vertical-align: 0em;"><span style="font-family: MathJax_Size2;">)</span></span></span></span><span style="display: inline-block; width: 0px; height: 3.229em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.842em; border-left: 0px solid; width: 0px; height: 2.388em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>r</mi><mi>o</mi><mi>l</mi><mi>l</mi><mo>=</mo><msup><mi>tan</mi><mrow class="MJX-TeXAtom-ORD"><mo>−</mo><mn>1</mn></mrow></msup><mo>⁡</mo><mrow><mo>(</mo><mfrac><mrow><mo>−</mo><msub><mi>C</mi><mrow class="MJX-TeXAtom-ORD"><mn>01</mn></mrow></msub></mrow><mrow><mo>−</mo><msub><mi>C</mi><mrow class="MJX-TeXAtom-ORD"><mn>02</mn></mrow></msub></mrow></mfrac><mo>)</mo></mrow></math></span></span><script type="math/tex" id="MathJax-Element-258">roll = \tan^{-1}\left(\frac{-C_{01}}{-C_{02}}\right)</script></p>
<p>And finally we are done! All the above can be written in python code as follows:</p>
<pre class="theme:monokai lang:default decode:true " title="Euler Angles">def getRotMat(q):
    c00 = q[0] ** 2 + q[1] ** 2 - q[2] ** 2 - q[3] ** 2
    c01 = 2 * (q[1] * q[2] - q[0] * q[3])
    c02 = 2 * (q[1] * q[3] + q[0] * q[2])
    c10 = 2 * (q[1] * q[2] + q[0] * q[3])
    c11 = q[0] ** 2 - q[1] ** 2 + q[2] ** 2 - q[3] ** 2
    c12 = 2 * (q[2] * q[3] - q[0] * q[1])
    c20 = 2 * (q[1] * q[3] - q[0] * q[2])
    c21 = 2 * (q[2] * q[3] + q[0] * q[1])
    c22 = q[0] ** 2 - q[1] ** 2 - q[2] ** 2 + q[3] ** 2

    rotMat = np.array([[c00, c01, c02], [c10, c11, c12], [c20, c21, c22]])
    return rotMat

def getEulerAngles(q):
    m = getRotMat(q)
    test = -m[2, 0]
    if test &gt; 0.99999:
        yaw = 0
        pitch = np.pi / 2
        roll = np.arctan2(m[0, 1], m[0, 2])
    elif test &lt; -0.99999:
        yaw = 0
        pitch = -np.pi / 2
        roll = np.arctan2(-m[0, 1], -m[0, 2])
    else:
        yaw = np.arctan2(m[1, 0], m[0, 0])
        pitch = np.arcsin(-m[2, 0])
        roll = np.arctan2(m[2, 1], m[2, 2])

    yaw = rad2deg(yaw)
    pitch = rad2deg(pitch)
    roll = rad2deg(roll)

    return yaw, pitch, roll</pre>
<p>Alright, what’s left is the interface between the Quaternion class and the actual code which is not that interesting so I am going to skip it. If you are wondering about the convertToComputerFrame method, it is actually for the next part and I was just lazy to erase it. Basically, the axis of the physical sensor is in a different orientation from the axis in Pygame so a conversion is required such that the rotation of the sensor can be reflected correctly in Pygame. If you have any other questions, feel free to write in the comments section below!</p>
<p>Below is how the program should look like when it runs.</p>
<p><iframe loading="lazy" title="Implementation of Quaternion Rotation" width="1100" height="619" src="./Attitude Determination with Quaternion using Extended Kalman Filter Archives - ThePoorEngineer_files/jeOVxccTo4Q.html" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe></p>
<div id="gyroRotation"></div>
<hr>
<h2>Implementing Rotations with MEMS Gyrometer Data</h2>
<p>We are now finally ready to interact with our Gyro sensor. I used the <a href="https://www.pololu.com/product/2468">Pololu&nbsp;MinIMU-9 v3 sensor</a> for the gyro (which is discontinued), and the Arduino UNO to read the data from the sensor and pass it to the computer. Here are the source code for the relevant components.</p>
<ul>
<li><span style="font-size: 12pt;"><a href="https://thepoorengineer.com/wp-content/uploads/2018/07/ArduinoExtractSensorData.zip">Arduino Code</a></span></li>
<li><span style="font-size: 12pt;"><a href="https://thepoorengineer.com/wp-content/uploads/2018/07/PythonIMU_naive.zip">Python Code</a></span></li>
</ul>
<p>The “AccelGyro” folder in the Arduino Code is actually a library for the <a href="https://www.pololu.com/product/2468">pololu&nbsp;MinIMU-9 v3 sensor</a> so you need to place it in your Arduino’s libraries folder for it to work. If you have the exact same model, you can use the code as it is. If your sensor is of another model, or you are using another type of micro-controller, all you have to do is follow the format in which the data is sent to the computer and the Python Code should still work fine. Here’s the format which I used:</p>
<pre class="lang:default decode:true" title="Format for Interfacing with the Python Code">sendToPC(&amp;gyroData.X, &amp;gyroData.Y, &amp;gyroData.Z, 
         &amp;accelData.X, &amp;accelData.Y, &amp;accelData.Z,
         &amp;magData.X, &amp;magData.Y, &amp;magData.Z);

-------------------------------------------------------------

void sendToPC(int* data1, int* data2, int* data3, 
              int* data4, int* data5, int* data6, 
              int* data7, int* data8, int* data9)
{
  byte* byteData1 = (byte*)(data1);
  byte* byteData2 = (byte*)(data2);
  byte* byteData3 = (byte*)(data3);
  byte* byteData4 = (byte*)(data4);
  byte* byteData5 = (byte*)(data5);
  byte* byteData6 = (byte*)(data6);
  byte* byteData7 = (byte*)(data7);
  byte* byteData8 = (byte*)(data8);
  byte* byteData9 = (byte*)(data9);
  byte buf[18] = {byteData1[0], byteData1[1],
                 byteData2[0], byteData2[1],
                 byteData3[0], byteData3[1],
                 byteData4[0], byteData4[1],
                 byteData5[0], byteData5[1],
                 byteData6[0], byteData6[1],
                 byteData7[0], byteData7[1],
                 byteData8[0], byteData8[1],
                 byteData9[0], byteData9[1]};
  Serial.write(buf, 18);
}</pre>
<p>Basically, the data is sent in the following order: gyro_X, gyro_Y, gyro_Z, accelerometer_X,&nbsp;accelerometer_Y,&nbsp;accelerometer_Z, magnetometer_X,&nbsp;magnetometer_Y,&nbsp;magnetometer_Z, and each variable is a 2 byte integer.</p>
<p>For the Python Code, you have to mark the directory containing all the files as “Sources Root” so that the IDE knows where to find the files.&nbsp;You can do this by right clicking the folder in Pycharm, the select “Mark Directory as”, then “sources root”. If you do this right, the folder should be marked blue in Pycharm. The readSensor_naive is an adaptation from one of my previous project so if you want to understand it, please take a look at <strong><a href="https://thepoorengineer.com/en/arduino-python-plot/">this post.</a>&nbsp;</strong>I did change a few of the parameters (and the parameter names too) but it should still be roughly the same. If you have any questions about it, don’t hesitate to write in the comments section below!</p>
<p>One last point though, in the getSerialData method for the python code, you will see some random constants as from the extract below.</p>
<pre class="lang:default decode:true " title="Reading Sensor Values">def getSerialData(self):
    privateData = self.rawData[:]
    for i in range(self.numParams):
        data = privateData[(i*self.dataNumBytes):(self.dataNumBytes + i*self.dataNumBytes)]
        value,  = struct.unpack(self.dataType, data)
        if i == 0:
            value = ((value * 0.00875) - 0.464874541896) / 180.0 * np.pi
        elif i == 1:
            value = ((value * 0.00875) - 9.04805461852) / 180.0 * np.pi
        elif i == 2:
            value = ((value * 0.00875) + 0.23642053973) / 180.0 * np.pi
        elif i == 3:
            value = (value * 0.061) - 48.9882695319
        elif i == 4:
            value = (value * 0.061) - 58.9882695319
        elif i == 5:
            value = (value * 0.061) - 75.9732905214
        elif i == 6:
            value = value * 0.080
        elif i == 7:
            value = value * 0.080
        elif i == 8:
            value = value * 0.080
        self.data[i] = value
    return self.data</pre>
<p>These are actually the sensor bias value which I have determined through collecting the data while the sensor is stationary. It will most likely be different with your sensor so be sure to calibrate it first before using. If you look carefully at the readSensor_naive.py code, there is actually code for you to export the sensor readings to CSV. You can use those to get a list of values of sensor output to determine its bias value.</p>
<p>On a side note, the reason why I labeled the code as “naive” is because it does not take into account the noise of the gyrometer. This causes the calculated orientation to gradually drift away with no means of identifying the actually orientation. It’ll be easier to understand if you watch the demo video below.</p>
<p><iframe loading="lazy" title="Naive Implementation of Quaternion Rotations with MEMS Gyrometer" width="1100" height="619" src="./Attitude Determination with Quaternion using Extended Kalman Filter Archives - ThePoorEngineer_files/oIVzNR2M-WY.html" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe></p>
<p>*does anyone have an easy solution to the graphics problem when using painter’s algorithm with perspective view? If you switch the projection method in BoardDisplay.py to <span style="font-family: &#39;courier new&#39;, courier, monospace;">projectOnePointPerspective</span>, you will see that the painter’s algorithm does not work correctly. I suspect that it is due to the depth calculation but I have no idea how to go about correcting it. Will appreciate any help that I can get!</p>
<p style="text-align: right;"><a href="https://thepoorengineer.com/en/calibrating-the-magnetometer/"><span style="font-size: 14pt;"><span style="text-decoration: underline;"><strong><span style="font-size: 12pt;">Go to Next Section</span></strong></span></span></a></p>
    
    
                       
	</div><!-- .entry-content -->

	<footer class="entry-footer">
			</footer><!-- .entry-footer -->
</article><!-- #post-## -->








<article id="post-1718" class="post-1718 post type-post status-publish format-standard hentry category-attitude-determination-with-quaternion-using-ekf clearfix" itemscope="itemscope" itemtype="http://schema.org/BlogPosting" itemprop="blogPost">

	   
	<header class="entry-header">
  
		<h2 class="entry-title" itemprop="headline"><a href="https://thepoorengineer.com/en/preparing-the-graphics/" rel="bookmark">Preparing the Graphics</a></h2>    
    

				<div class="entry-meta">
			<span class="posted-on">Posted on <a href="https://thepoorengineer.com/en/preparing-the-graphics/" rel="bookmark"><time class="entry-date published" datetime="2018-07-10T21:17:01+09:00">July 10, 2018</time><time class="updated" datetime="2020-10-02T00:05:33+09:00" itemprop="dateUpdated">October 2, 2020</time></a></span>		</div><!-- .entry-meta -->
			</header><!-- .entry-header -->

	<div class="entry-content" itemprop="text">
    
    
  	<h3>Table of Contents</h3>
<ol>
<li><a href="https://thepoorengineer.com/en/attitude-determination/">Foreword and Introduction</a></li>
<li><strong><span style="color: red;">Preparing the Graphics</span></strong>
<ul>
<li><strong><a href="https://thepoorengineer.com/en/category/projects/attitude-determination-with-quaternion-using-ekf/#wireframe">Creating the Wireframe</a></strong></li>
<li><strong><a href="https://thepoorengineer.com/en/category/projects/attitude-determination-with-quaternion-using-ekf/#perspective">Creating a Perspective View</a></strong></li>
<li><strong><a href="https://thepoorengineer.com/en/category/projects/attitude-determination-with-quaternion-using-ekf/#pygame">Drawing in Pygame</a></strong></li>
</ul>
</li>
<li><a href="https://thepoorengineer.com/en/quaternion/">Quaternion Rotation</a>
<ul>
<li><a href="https://thepoorengineer.com/en/quaternion/#quaternion">Quaternion basics</a></li>
<li><a href="https://thepoorengineer.com/en/quaternion/#testRotation">Testing Quaternion Rotation in Pygame</a></li>
<li><a href="https://thepoorengineer.com/en/quaternion/#gyroRotation">Implementing Rotations with MEMS Gyrometer Data</a></li>
</ul>
</li>
<li><a href="https://thepoorengineer.com/en/calibrating-the-magnetometer/">Calibrating the Magnetometer</a>
<ul>
<li><a href="https://thepoorengineer.com/en/calibrating-the-magnetometer/#ErrorModel">Error Modelling</a></li>
<li><a href="https://thepoorengineer.com/en/calibrating-the-magnetometer/#MeasurementModel">Measurement Model</a></li>
<li><a href="https://thepoorengineer.com/en/calibrating-the-magnetometer/#Calibration">Calibration</a></li>
</ul>
</li>
<li><a href="https://thepoorengineer.com/en/ekf-impl/">Extended Kalman Filter Implementation</a>
<ul>
<li><a href="https://thepoorengineer.com/en/ekf-impl/#KalmanStates">Kalman Filter States</a></li>
<li><a href="https://thepoorengineer.com/en/ekf-impl/#AccelData">Accelerometer Data</a></li>
<li><a href="https://thepoorengineer.com/en/ekf-impl/#MagData">Magnetometer Data</a></li>
<li><a href="https://thepoorengineer.com/en/ekf-impl/#EKFimpl">Quaternion EKF Implementation</a></li>
</ul>
</li>
<li><a href="https://thepoorengineer.com/en/ekf-impl/#conclusion">Conclusion</a></li>
</ol>
<p>In this section, we are going to create the visualization tool so as to understand the problems and result more intuitively. Actually, it’s just to make things look a little cooler. I mean, who would like to be looking at numbers when you can have an animation! Here are the full source code for this section for your reference:</p>
<ol>
<li><a href="https://thepoorengineer.com/wp-content/uploads/2018/06/BoardDisplay.txt"><span style="font-size: 12pt;">Python BoardDisplay Code</span></a></li>
<li><a href="https://thepoorengineer.com/wp-content/uploads/2018/06/Wireframe.txt"><span style="font-size: 12pt;">Python Wireframe Code</span></a></li>
</ol>
<p>Oh, before I forget, the BoardDisplay code references the Wireframe code so you will need to mark the folder containing the Wireframe.py as the source root. You can do this by right clicking the folder in Pycharm, the select “Mark Directory as”, then “sources root”. If you do this right, the folder should be marked blue.</p>
<div id="wireframe"></div>
<hr>
<h2>Creating the Wireframe</h2>
<p>In order to display an object in Pygame, we will first need to fully define its coordinates. To make things simple, I am just going to display a rectangular block to mimic the board which I am using so all we need to do is to define the 6 faces of the block. We are going to do this in 3 steps. First, we will have a class called “Node” to define the xyz coordinates of a point, then we will have another class called “Face” which takes in 4 “Nodes” to define a face of the rectangular block. We will then have 1 last class called “Wireframe” which stored the information of the cube, and also acts as an interface between the Pygame displaying code, and the back-end calculation code.</p>
<p>The back-end calculation part will come in the 3rd section when we start talking about quaternions so for now, we will only concentrate on displaying the block in Pygame. Here’s the code for the 3 classes stated above.</p>
<pre class="theme:monokai lang:default decode:true" title="Wireframe"># Node stores each point of the block
class Node:
    def __init__(self, coordinates, color):
        self.x = coordinates[0]
        self.y = coordinates[1]
        self.z = coordinates[2]
        self.color = color

# Face stores 4 nodes that make up a face of the block
class Face:
    def __init__(self, nodes, color):
        self.nodeIndexes = nodes
        self.color = color

# Wireframe stores the details of the block
class Wireframe:
    def __init__(self):
        self.nodes = []
        self.edges = []
        self.faces = []

    def addNodes(self, nodeList, colorList):
        for node, color in zip(nodeList, colorList):
            self.nodes.append(Node(node, color))

    def addFaces(self, faceList, colorList):
        for indexes, color in zip(faceList, colorList):
            self.faces.append(Face(indexes, color))

    def outputNodes(self):
        print("\n --- Nodes --- ")
        for i, node in enumerate(self.nodes):
            print(" %d: (%.2f, %.2f, %.2f) \t Color: (%d, %d, %d)" %
                 (i, node.x, node.y, node.z, node.color[0], node.color[1], node.color[2]))

    def outputFaces(self):
        print("\n --- Faces --- ")
        for i, face in enumerate(self.faces):
            print("Face %d:" % i)
            print("Color: (%d, %d, %d)" % (face.color[0], face.color[1], face.color[2]))
            for nodeIndex in face.nodeIndexes:
                print("\tNode %d" % nodeIndex)</pre>
<p>I have also created some convenience functions for logging purposes. This helps to ensure that we inserted the information correctly into the class. We will be using this class in the main “BoardDisplay” code. Here is an example of how you can use the class to initialize parameters for the block.</p>
<pre class="theme:monokai lang:default decode:true">def initializeBlock():
    block = wf.Wireframe()

    block_nodes = [(x, y, z) for x in (-1.5, 1.5) for y in (-1, 1) for z in (-0.1, 0.1)]
    node_colors = [(255, 255, 255)] * len(block_nodes)
    block.addNodes(block_nodes, node_colors)
    block.outputNodes()

    faces = [(0, 2, 6, 4), (0, 1, 3, 2), (1, 3, 7, 5), (4, 5, 7, 6), (2, 3, 7, 6), (0, 1, 5, 4)]
    colors = [(255, 0, 255), (255, 0, 0), (0, 255, 0), (0, 0, 255), (0, 255, 255), (255, 255, 0)]
    block.addFaces(faces, colors)
    block.outputFaces()

    return block</pre>
<p>If you run the above code, you should get a print out of all the nodes and faces that you have created. If you used exactly what I have written above, this is the output that you should get:</p>
<p>— Nodes —<br>
0: (-1.50, -1.00, -0.10) Color: (255, 255, 255)<br>
1: (-1.50, -1.00, 0.10) Color: (255, 255, 255)<br>
2: (-1.50, 1.00, -0.10) Color: (255, 255, 255)<br>
3: (-1.50, 1.00, 0.10) Color: (255, 255, 255)<br>
4: (1.50, -1.00, -0.10) Color: (255, 255, 255)<br>
5: (1.50, -1.00, 0.10) Color: (255, 255, 255)<br>
6: (1.50, 1.00, -0.10) Color: (255, 255, 255)<br>
7: (1.50, 1.00, 0.10) Color: (255, 255, 255)</p>
<p>— Faces —<br>
Face 0:<br>
Color: (255, 0, 255)<br>
Node 0<br>
Node 2<br>
Node 6<br>
Node 4<br>
Face 1:<br>
…<br>
…<br>
…</p>
<p>I only copied the print out for Face 0 but you should get print outs of up till Face 5 since we inserted information for 6 faces in total. Let us first begin with the Nodes. We have inserted information for 8 nodes, and as you can see in the print out, they are being indexed from 0 to 7. The color information is redundant for this project because we will be showing the colors of each face instead of the color for the nodes. However, the index of the Nodes are very important because the face object refers to this information. For example, I specified Face 0 to be the face that is enclosed by Node 0, 2, 6 and 4. Below is a diagram which shows the ordering of indexes that I used. The center of the block is located at the origin of the axes.</p>
<figure id="attachment_1727" aria-describedby="caption-attachment-1727" style="width: 539px" class="wp-caption aligncenter"><img loading="lazy" class="size-full wp-image-1727" src="./Attitude Determination with Quaternion using Extended Kalman Filter Archives - ThePoorEngineer_files/WireframeNodeIndex.png" alt="" width="539" height="525" srcset="https://thepoorengineer.com/wp-content/uploads/2018/06/WireframeNodeIndex.png 539w, https://thepoorengineer.com/wp-content/uploads/2018/06/WireframeNodeIndex-300x292.png 300w" sizes="(max-width: 539px) 100vw, 539px"><figcaption id="caption-attachment-1727" class="wp-caption-text">Wireframe Node Index</figcaption></figure>
<p>With this, we have now a fully defined block. The next step is to create the view that you see on top in Pygame.</p>
<div id="perspective"></div>
<hr>
<h2>Creating a Perspective View</h2>
<p>Your computer screen shows a 2 dimensional image. There should be no depth because it is just a flat piece of screen. So why does the diagram in the previous section look like a 3D figure to our eyes? This is actually due to the lines that make up the object (and also the axis) which gives an illusion of depth. <strong><a href="https://design.tutsplus.com/articles/live-perspective-a-new-approach-to-depth-in-drawing--cms-22100">Here</a></strong> is an article on the topic of depth perception which I though was really interesting so feel free to read through it if you are interested. Creating “depth” on the computer is not that difficult but if you do not draw the object with a perspective view, for example an orthographic view, it will look distorted to our eyes even though it is actually correct.</p>
<p>In this section, we will only talk about a simple implementation of the one vanishing point perspective view. You can look up <strong><a href="https://en.wikipedia.org/wiki/Perspective_(graphical)">wikipedia</a> </strong>for more details on other perspective views. Below is the diagram of the perspective view that I am going to create for my viewer.</p>
<figure id="attachment_1732" aria-describedby="caption-attachment-1732" style="width: 751px" class="wp-caption aligncenter"><img loading="lazy" class="size-full wp-image-1732" src="./Attitude Determination with Quaternion using Extended Kalman Filter Archives - ThePoorEngineer_files/OnePointPerspectiveView.png" alt="" width="751" height="671" srcset="https://thepoorengineer.com/wp-content/uploads/2018/06/OnePointPerspectiveView.png 751w, https://thepoorengineer.com/wp-content/uploads/2018/06/OnePointPerspectiveView-300x268.png 300w" sizes="(max-width: 751px) 100vw, 751px"><figcaption id="caption-attachment-1732" class="wp-caption-text">One Vanishing Point Perspective View</figcaption></figure>
<p>Firstly, I am going to make the origin the vanishing point, so I will have to shift the object out of the origin. In order to do this, I will shift the center of the object by “P” in the z direction so the new center of the object will now be at (0, 0, P) as shown in the diagram. Next, I am going to put my “screen” at a distance “S” on the z-axis. This screen is the Pygame screen which is 2 dimensional. What we need to do now is to project all the 8 points on the cube onto the screen. If you look closely at the projection, you’ll realize that this is simply a linear scaling of the x and y coordinates based on the distance away from the screen.</p>
<p>Let us take Node 0 with coordinates (-1.50, -1.00, -0.10) as a example. When we shift our object out of the origin, the new coordinate of this Node will be&nbsp;(-1.50, -1.00, -0.10+P). In order to project this point onto the screen, we can scale it based on similar triangles. When z=0, we know that the point vanishes so x and y both becomes zero. This serves as a reference point for our calculations. If the screen is located at z=S=5, then our new projected x-coordinate will be:</p>
<p><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-259-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mstyle mathsize=&quot;1.44em&quot;&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;msup&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo&gt;&amp;#x2032;&lt;/mo&gt;&lt;/msup&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mfrac&gt;&lt;mi&gt;S&lt;/mi&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;/mfrac&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mfrac&gt;&lt;mn&gt;5&lt;/mn&gt;&lt;mrow&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;0.10&lt;/mn&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mi&gt;P&lt;/mi&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1.50&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;/mstyle&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-9564" style="width: 21.839em; display: inline-block;"><span style="display: inline-block; position: relative; width: 17.621em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(1.182em, 1017.5em, 3.477em, -999.997em); top: -2.664em; left: 0em;"><span class="mrow" id="MathJax-Span-9565"><span class="mstyle" id="MathJax-Span-9566"><span class="mrow" id="MathJax-Span-9567"><span class="texatom" id="MathJax-Span-9568"><span class="mrow" id="MathJax-Span-9569"><span class="msup" id="MathJax-Span-9570"><span style="display: inline-block; position: relative; width: 1.244em; height: 0px;"><span style="position: absolute; clip: rect(3.167em, 1000.75em, 4.159em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-9571" style="font-size: 144%; font-family: MathJax_Math-italic;">x</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -4.463em; left: 0.81em;"><span class="mo" id="MathJax-Span-9572" style="font-size: 101.8%; font-family: MathJax_Main;">′</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="mo" id="MathJax-Span-9573" style="font-size: 144%; font-family: MathJax_Main; padding-left: 0.251em;">=</span><span class="mfrac" id="MathJax-Span-9574" style="padding-left: 0.375em;"><span style="display: inline-block; position: relative; width: 0.81em; height: 0px; margin-right: 0.189em; margin-left: 0.189em;"><span style="position: absolute; clip: rect(3.043em, 1000.68em, 4.159em, -999.997em); top: -4.525em; left: 50%; margin-left: -0.307em;"><span class="mi" id="MathJax-Span-9575" style="font-size: 101.8%; font-family: MathJax_Math-italic;">S<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.353em, 1000.5em, 4.159em, -999.997em); top: -3.471em; left: 50%; margin-left: -0.245em;"><span class="mi" id="MathJax-Span-9576" style="font-size: 101.8%; font-family: MathJax_Math-italic;">z<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(0.872em, 1000.81em, 1.306em, -999.997em); top: -1.424em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.4px solid; width: 0.81em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.12em;"></span></span></span></span><span class="mo" id="MathJax-Span-9577" style="font-size: 144%; font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-9578" style="font-size: 144%; font-family: MathJax_Math-italic;">x</span><span class="mo" id="MathJax-Span-9579" style="font-size: 144%; font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-9580" style="font-size: 144%; font-family: MathJax_Main; padding-left: 0.251em;">=</span><span class="mfrac" id="MathJax-Span-9581" style="padding-left: 0.375em;"><span style="display: inline-block; position: relative; width: 4.346em; height: 0px; margin-right: 0.189em; margin-left: 0.189em;"><span style="position: absolute; clip: rect(3.105em, 1000.44em, 4.159em, -999.997em); top: -4.525em; left: 50%; margin-left: -0.245em;"><span class="mn" id="MathJax-Span-9582" style="font-size: 101.8%; font-family: MathJax_Main;">5</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.105em, 1004.16em, 4.221em, -999.997em); top: -3.409em; left: 50%; margin-left: -2.106em;"><span class="mrow" id="MathJax-Span-9583"><span class="mo" id="MathJax-Span-9584" style="font-size: 101.8%; font-family: MathJax_Main;">−</span><span class="mn" id="MathJax-Span-9585" style="font-size: 101.8%; font-family: MathJax_Main;">0.10</span><span class="mo" id="MathJax-Span-9586" style="font-size: 101.8%; font-family: MathJax_Main;">+</span><span class="mi" id="MathJax-Span-9587" style="font-size: 101.8%; font-family: MathJax_Math-italic;">P<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.065em;"></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(0.872em, 1004.35em, 1.306em, -999.997em); top: -1.424em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.4px solid; width: 4.346em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.12em;"></span></span></span></span><span class="mo" id="MathJax-Span-9588" style="font-size: 144%; font-family: MathJax_Main;">(</span><span class="mo" id="MathJax-Span-9589" style="font-size: 144%; font-family: MathJax_Main;">−</span><span class="mn" id="MathJax-Span-9590" style="font-size: 144%; font-family: MathJax_Main;">1.50</span><span class="mo" id="MathJax-Span-9591" style="font-size: 144%; font-family: MathJax_Main;">)</span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.671em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.842em; border-left: 0px solid; width: 0px; height: 2.542em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mstyle mathsize="1.44em"><mrow class="MJX-TeXAtom-ORD"><msup><mi>x</mi><mo>′</mo></msup><mo>=</mo><mfrac><mi>S</mi><mi>z</mi></mfrac><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mo>=</mo><mfrac><mn>5</mn><mrow><mo>−</mo><mn>0.10</mn><mo>+</mo><mi>P</mi></mrow></mfrac><mo stretchy="false">(</mo><mo>−</mo><mn>1.50</mn><mo stretchy="false">)</mo></mrow></mstyle></math></span></span><script type="math/tex" id="MathJax-Element-259">\Large{x’=\frac{S}{z}(x)=\frac{5}{-0.10+P}(-1.50)}</script></p>
<p>and our new&nbsp;projected y-coordinate will be:</p>
<p><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-260-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mstyle mathsize=&quot;1.44em&quot;&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;msup&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mo&gt;&amp;#x2032;&lt;/mo&gt;&lt;/msup&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mfrac&gt;&lt;mi&gt;S&lt;/mi&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;/mfrac&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mfrac&gt;&lt;mn&gt;5&lt;/mn&gt;&lt;mrow&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;0.10&lt;/mn&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mi&gt;P&lt;/mi&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1.00&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;/mstyle&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-9592" style="width: 21.653em; display: inline-block;"><span style="display: inline-block; position: relative; width: 17.435em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(1.182em, 1017.31em, 3.477em, -999.997em); top: -2.664em; left: 0em;"><span class="mrow" id="MathJax-Span-9593"><span class="mstyle" id="MathJax-Span-9594"><span class="mrow" id="MathJax-Span-9595"><span class="texatom" id="MathJax-Span-9596"><span class="mrow" id="MathJax-Span-9597"><span class="msup" id="MathJax-Span-9598"><span style="display: inline-block; position: relative; width: 1.182em; height: 0px;"><span style="position: absolute; clip: rect(3.167em, 1000.75em, 4.47em, -999.997em); top: -3.967em; left: 0em;"><span class="mi" id="MathJax-Span-9599" style="font-size: 144%; font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; top: -4.463em; left: 0.748em;"><span class="mo" id="MathJax-Span-9600" style="font-size: 101.8%; font-family: MathJax_Main;">′</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span></span></span><span class="mo" id="MathJax-Span-9601" style="font-size: 144%; font-family: MathJax_Main; padding-left: 0.251em;">=</span><span class="mfrac" id="MathJax-Span-9602" style="padding-left: 0.375em;"><span style="display: inline-block; position: relative; width: 0.81em; height: 0px; margin-right: 0.189em; margin-left: 0.189em;"><span style="position: absolute; clip: rect(3.043em, 1000.68em, 4.159em, -999.997em); top: -4.525em; left: 50%; margin-left: -0.307em;"><span class="mi" id="MathJax-Span-9603" style="font-size: 101.8%; font-family: MathJax_Math-italic;">S<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.353em, 1000.5em, 4.159em, -999.997em); top: -3.471em; left: 50%; margin-left: -0.245em;"><span class="mi" id="MathJax-Span-9604" style="font-size: 101.8%; font-family: MathJax_Math-italic;">z<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(0.872em, 1000.81em, 1.306em, -999.997em); top: -1.424em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.4px solid; width: 0.81em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.12em;"></span></span></span></span><span class="mo" id="MathJax-Span-9605" style="font-size: 144%; font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-9606" style="font-size: 144%; font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-9607" style="font-size: 144%; font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-9608" style="font-size: 144%; font-family: MathJax_Main; padding-left: 0.251em;">=</span><span class="mfrac" id="MathJax-Span-9609" style="padding-left: 0.375em;"><span style="display: inline-block; position: relative; width: 4.346em; height: 0px; margin-right: 0.189em; margin-left: 0.189em;"><span style="position: absolute; clip: rect(3.105em, 1000.44em, 4.159em, -999.997em); top: -4.525em; left: 50%; margin-left: -0.245em;"><span class="mn" id="MathJax-Span-9610" style="font-size: 101.8%; font-family: MathJax_Main;">5</span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(3.105em, 1004.16em, 4.221em, -999.997em); top: -3.409em; left: 50%; margin-left: -2.106em;"><span class="mrow" id="MathJax-Span-9611"><span class="mo" id="MathJax-Span-9612" style="font-size: 101.8%; font-family: MathJax_Main;">−</span><span class="mn" id="MathJax-Span-9613" style="font-size: 101.8%; font-family: MathJax_Main;">0.10</span><span class="mo" id="MathJax-Span-9614" style="font-size: 101.8%; font-family: MathJax_Main;">+</span><span class="mi" id="MathJax-Span-9615" style="font-size: 101.8%; font-family: MathJax_Math-italic;">P<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.065em;"></span></span></span><span style="display: inline-block; width: 0px; height: 3.973em;"></span></span><span style="position: absolute; clip: rect(0.872em, 1004.35em, 1.306em, -999.997em); top: -1.424em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.4px solid; width: 4.346em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.12em;"></span></span></span></span><span class="mo" id="MathJax-Span-9616" style="font-size: 144%; font-family: MathJax_Main;">(</span><span class="mo" id="MathJax-Span-9617" style="font-size: 144%; font-family: MathJax_Main;">−</span><span class="mn" id="MathJax-Span-9618" style="font-size: 144%; font-family: MathJax_Main;">1.00</span><span class="mo" id="MathJax-Span-9619" style="font-size: 144%; font-family: MathJax_Main;">)</span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.671em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.842em; border-left: 0px solid; width: 0px; height: 2.542em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mstyle mathsize="1.44em"><mrow class="MJX-TeXAtom-ORD"><msup><mi>y</mi><mo>′</mo></msup><mo>=</mo><mfrac><mi>S</mi><mi>z</mi></mfrac><mo stretchy="false">(</mo><mi>y</mi><mo stretchy="false">)</mo><mo>=</mo><mfrac><mn>5</mn><mrow><mo>−</mo><mn>0.10</mn><mo>+</mo><mi>P</mi></mrow></mfrac><mo stretchy="false">(</mo><mo>−</mo><mn>1.00</mn><mo stretchy="false">)</mo></mrow></mstyle></math></span></span><script type="math/tex" id="MathJax-Element-260">\Large{y’=\frac{S}{z}(y)=\frac{5}{-0.10+P}(-1.00)}</script></p>
<p>The projected depth is a little more complicated so I will not go through it here since this is not the main topic of this series of posts. If you would like more information on it, you can look up <strong><a href="https://www.ics.uci.edu/~majumder/VC/classes/perspective.pdf">here</a></strong> for more information. Actually, on this point, I learnt quite a bit about computer graphics, and it is by no means an easy topic. I should have just went ahead to use the openGL libraries for a better demonstration but I chose to implement everything from scratch. As a result of this, it took me much longer to get things done, and there were some unresolved issues as well. Anyway, I hope that through this post, you will get to know more about computer graphics, and the multitude of problems that follows.</p>
<p>Alright, back to the point, the above equations are implemented in my python <strong><a href="https://thepoorengineer.com/wp-content/uploads/2018/06/BoardDisplay.txt">BoardDisplay</a></strong> code. Below is an extract of the code:</p>
<pre class="theme:monokai lang:default decode:true" title="One vanishing point perspective view algorithm">def projectOnePointPerspective(self, x, y, z, win_width, win_height, P, S, scaling_constant, pvDepth):
    # In Pygame, the y axis is downward pointing.
    # In order to make y point upwards, a rotation around x axis by 180 degrees is needed.
    # This will result in y' = -y and z' = -z
    xPrime = x
    yPrime = -y
    zPrime = -z
    xProjected = xPrime * (S / (zPrime + P)) * scaling_constant + win_width / 2
    yProjected = yPrime * (S / (zPrime + P)) * scaling_constant + win_height / 2
    pvDepth.append(1 / (zPrime + P))
    return (round(xProjected), round(yProjected))</pre>
<p>We are now ready to draw the points onto our Pygame screen so let us move to the next section</p>
<div id="pygame"></div>
<hr>
<h2>Drawing in Pygame</h2>
<p>In order to display the object, I used Pygame’s draw polygon method. Here’s the <strong><a href="https://www.pygame.org/docs/ref/draw.html#pygame.draw.polygon">documentation</a> </strong>for it if you want to check it out. Basically, we can use the <span style="font-family: &#39;courier new&#39;, courier, monospace;">pygame.draw.polygon</span> method to draw a polygon by supplying it with the a list of points. Since our block is simple a six sided rectangle, we have to call this function with a list of 4 points for a total of 6 times, one time for each face, in total. However, it is impossible to show all 6 sides of the block because at any one time, we would be able to see only 3 of the faces. So how do we determine which faces are visible? We can do this using the simple painter’s algorithm.</p>
<p>When painting landscapes, we usually start painting from the furthest landscapes, then gradually paint over those landscapes to draw objects that are closer. This is what the painter’s algorithm does as well. All we have to do is to order the 6 faces in terms of its depth (at the center of the face), then draw the polygon starting from the furthest face. This is implemented in the code as follows:</p>
<pre class="theme:monokai lang:default decode:true" title="Painter&#39;s Algorithm"># Calculate the average Z values of each face.
avg_z = []
for face in self.wireframe.faces:
    n = pvDepth
    z = (n[face.nodeIndexes[0]] + n[face.nodeIndexes[1]] +
         n[face.nodeIndexes[2]] + n[face.nodeIndexes[3]]) / 4.0
    avg_z.append(z)
# Draw the faces using the Painter's algorithm:
for idx, val in sorted(enumerate(avg_z), key=itemgetter(1)):
    face = self.wireframe.faces[idx]
    pointList = [pvNodes[face.nodeIndexes[0]],
                 pvNodes[face.nodeIndexes[1]],
                 pvNodes[face.nodeIndexes[2]],
                 pvNodes[face.nodeIndexes[3]]]
    print(pointList)
    pygame.draw.polygon(self.screen, face.color, pointList)</pre>
<p>First, we determine the depth of the center of the face (average depth of the nodes of the face), then sort it in increasing order and draw them in order. That’s it. Simple isn’t it?</p>
<p>However, the painter’s algorithm will not work for many situations. For example, you will see later that the painter’s algorithm does not work perfectly in the perspective view as it is. I do not yet have a solution for this problem so if you any suggestions, please write it down in the comments section. I’ll appreciate any help that I can get.</p>
<p>Anyway, for now, your block is stationary so you cannot see anything except for a green rectangle like this:</p>
<figure id="attachment_1741" aria-describedby="caption-attachment-1741" style="width: 639px" class="wp-caption aligncenter"><img loading="lazy" class="size-full wp-image-1741" src="./Attitude Determination with Quaternion using Extended Kalman Filter Archives - ThePoorEngineer_files/SimpleDisplay.png" alt="" width="639" height="504" srcset="https://thepoorengineer.com/wp-content/uploads/2018/06/SimpleDisplay.png 639w, https://thepoorengineer.com/wp-content/uploads/2018/06/SimpleDisplay-300x237.png 300w" sizes="(max-width: 639px) 100vw, 639px"><figcaption id="caption-attachment-1741" class="wp-caption-text">Simple Pygame Block Display</figcaption></figure>
<p>In the next section, we will be starting on the topic of quaternion rotations so you will be able to make the stationary block above rotate.</p>
<p style="text-align: right;"><a href="https://thepoorengineer.com/en/quaternion/"><span style="font-size: 14pt;"><span style="text-decoration: underline;"><strong><span style="font-size: 12pt;">Go to Next Section</span></strong></span></span></a></p>
    
    
                       
	</div><!-- .entry-content -->

	<footer class="entry-footer">
			</footer><!-- .entry-footer -->
</article><!-- #post-## -->








<article id="post-1710" class="post-1710 post type-post status-publish format-standard hentry category-attitude-determination-with-quaternion-using-ekf clearfix" itemscope="itemscope" itemtype="http://schema.org/BlogPosting" itemprop="blogPost">

	   
	<header class="entry-header">
  
		<h2 class="entry-title" itemprop="headline"><a href="https://thepoorengineer.com/en/attitude-determination/" rel="bookmark">Attitude Determination with Quaternion using Extended Kalman Filter</a></h2>    
    

				<div class="entry-meta">
			<span class="posted-on">Posted on <a href="https://thepoorengineer.com/en/attitude-determination/" rel="bookmark"><time class="entry-date published" datetime="2018-07-10T21:16:40+09:00">July 10, 2018</time><time class="updated" datetime="2018-09-10T22:26:38+09:00" itemprop="dateUpdated">September 10, 2018</time></a></span>		</div><!-- .entry-meta -->
			</header><!-- .entry-header -->

	<div class="entry-content" itemprop="text">
    
    
  	<h3>Table of Contents</h3>
<ol>
<li><strong><span style="color: red;">Foreword and Introduction</span></strong></li>
<li><a href="https://thepoorengineer.com/en/preparing-the-graphics/">Preparing the Graphics</a>
<ul>
<li><a href="https://thepoorengineer.com/en/preparing-the-graphics/#wireframe">Creating the Wireframe</a></li>
<li><a href="https://thepoorengineer.com/en/preparing-the-graphics/#perspective">Creating a Perspective View</a></li>
<li><a href="https://thepoorengineer.com/en/preparing-the-graphics/#pygame">Drawing in Pygame</a></li>
</ul>
</li>
<li><a href="https://thepoorengineer.com/en/quaternion/">Quaternion Rotation</a>
<ul>
<li><a href="https://thepoorengineer.com/en/quaternion/#quaternion">Quaternion basics</a></li>
<li><a href="https://thepoorengineer.com/en/quaternion/#testRotation">Testing Quaternion Rotation in Pygame</a></li>
<li><a href="https://thepoorengineer.com/en/quaternion/#gyroRotation">Implementing Rotations with MEMS Gyrometer Data</a></li>
</ul>
</li>
<li><a href="https://thepoorengineer.com/en/calibrating-the-magnetometer/">Calibrating the Magnetometer</a>
<ul>
<li><a href="https://thepoorengineer.com/en/calibrating-the-magnetometer/#ErrorModel">Error Modelling</a></li>
<li><a href="https://thepoorengineer.com/en/calibrating-the-magnetometer/#MeasurementModel">Measurement Model</a></li>
<li><a href="https://thepoorengineer.com/en/calibrating-the-magnetometer/#Calibration">Calibration</a></li>
</ul>
</li>
<li><a href="https://thepoorengineer.com/en/ekf-impl/">Extended Kalman Filter Implementation</a>
<ul>
<li><a href="https://thepoorengineer.com/en/ekf-impl/#KalmanStates">Kalman Filter States</a></li>
<li><a href="https://thepoorengineer.com/en/ekf-impl/#AccelData">Accelerometer Data</a></li>
<li><a href="https://thepoorengineer.com/en/ekf-impl/#MagData">Magnetometer Data</a></li>
<li><a href="https://thepoorengineer.com/en/ekf-impl/#EKFimpl">Quaternion EKF Implementation</a></li>
</ul>
</li>
<li><a href="https://thepoorengineer.com/en/ekf-impl/#conclusion">Conclusion</a></li>
</ol>
<hr>
<h2>Foreword</h2>
<p>It has been around 3 months since I last posted something on my blog, and the reason for that is THIS! Well, part of it is because I had to work in the day and could only continue this project in the night and during weekends, but another part of it is due to the inaccurate information from sites that come out from google search. Once you get into a more difficult topic, you will realize that the only sources of information that you can rely on are journal papers. Implementations that are readily available online and look simple are really attractive when you are starting on a new topic, but they usually prove to be misleading and wrong so always be critical of what you read online. Just because it “looks” like it is working, doesn’t necessarily mean that it is working correctly.</p>
<p>I did a 2D implementation for sensor fusion in <strong><a href="https://thepoorengineer.com/en/angle-control-absolute/">this project</a> </strong>but moving on to a 3D implementation was really a huge jump in my opinion. I took a long time to get things to work, and I hope that this tutorial will help those who are starting out in the world of 3D navigation systems to understand the concepts better. To this end, I will provide a sample program to illustrate a simple (relatively) Extended Kalman Filter Implementation which fuses 3 sensors, namely the gyrometer, accelerometer and the magnetometer.</p>
<hr>
<h2>Introduction</h2>
<p>When you search for articles regarding navigation systems or attitude determination systems, you will most likely, if not surely, encounter the Kalman Filter as well. Specifically, the Extended Kalman Filter (EKF) or the Unscented Kalman Filter (UKF). In this project, I will demonstrate an implementation of attitude determination with quaternions using the EKF, and also explain the need to fuse several sensor data together in order to get the system to work.</p>
<p>The sensors that will be used are the gyrometer, accelerometer and the magnetometer. The Arduino is used to read data from the sensor, but the data processing will be done in python. In addition to this, I created a simple display using Pygame in order to visualize the results better. I will also provide a simple method for calibrating the magnetometer since their readings vary greatly depending on the surroundings.</p>
<p>This series of post will assume that you are familiar with Python, and have some basic knowledge on matrix operators and calculus. Don’t worry if you are not so familiar with the mathematics because I will try to explain them as simply as I can. For starters, here’s a video of what you will get out of this project.</p>
<p><iframe loading="lazy" title="Attitude Determination with Quaternion using Extended Kalman Filter" width="1100" height="619" src="./Attitude Determination with Quaternion using Extended Kalman Filter Archives - ThePoorEngineer_files/0g8-Z5h3pgw.html" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe></p>
<p>So without further ado, let us begin by preparing the required visualization tool in Pygame.</p>
<p style="text-align: right;"><a href="https://thepoorengineer.com/en/graphics/"><span style="font-size: 14pt;"><span style="text-decoration: underline;"><strong><span style="font-size: 12pt;">Go to Next Section</span></strong></span></span></a></p>
    
    
                       
	</div><!-- .entry-content -->

	<footer class="entry-footer">
			</footer><!-- .entry-footer -->
</article><!-- #post-## -->




     
<div class="pagination clearfix"></div></div><div class="col-md-4"><aside id="sidebar-right" class="widget-area" itemscope="" itemtype="http://schema.org/WPSideBar"><div id="categories-2" class="widget widget_categories"><h3 class="widget-title">Categories</h3><form action="https://thepoorengineer.com/" method="get"><label class="screen-reader-text" for="cat">Categories</label><select name="cat" id="cat" class="postform">
	<option value="-1">Select Category</option>
	<option class="level-0" value="4">LIFE&nbsp;&nbsp;(40)</option>
	<option class="level-1" value="85">&nbsp;&nbsp;&nbsp;Czech Republic&nbsp;&nbsp;(1)</option>
	<option class="level-2" value="87">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Prague&nbsp;&nbsp;(1)</option>
	<option class="level-1" value="26">&nbsp;&nbsp;&nbsp;Indonesia&nbsp;&nbsp;(1)</option>
	<option class="level-2" value="73">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Pekanbaru&nbsp;&nbsp;(1)</option>
	<option class="level-1" value="25">&nbsp;&nbsp;&nbsp;Japan (current)&nbsp;&nbsp;(29)</option>
	<option class="level-2" value="75">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Gunma&nbsp;&nbsp;(6)</option>
	<option class="level-2" value="77">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Kumamoto&nbsp;&nbsp;(1)</option>
	<option class="level-2" value="8">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Kyoto&nbsp;&nbsp;(8)</option>
	<option class="level-2" value="7">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Osaka&nbsp;&nbsp;(4)</option>
	<option class="level-2" value="79">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Shizuoka&nbsp;&nbsp;(1)</option>
	<option class="level-2" value="6">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Tokyo (current)&nbsp;&nbsp;(9)</option>
	<option class="level-1" value="20">&nbsp;&nbsp;&nbsp;Singapore&nbsp;&nbsp;(9)</option>
	<option class="level-2" value="35">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;National Service&nbsp;&nbsp;(2)</option>
	<option class="level-2" value="69">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;National University of Singapore&nbsp;&nbsp;(5)</option>
	<option class="level-0" value="5">PROJECTS&nbsp;&nbsp;(28)</option>
	<option class="level-1" value="10">&nbsp;&nbsp;&nbsp;Arduino&nbsp;&nbsp;(21)</option>
	<option class="level-2" value="83">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ePaper Clock&nbsp;&nbsp;(1)</option>
	<option class="level-2" value="94">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Feedback Control System&nbsp;&nbsp;(8)</option>
	<option class="level-2" value="15">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Plant Watering Automation&nbsp;&nbsp;(5)</option>
	<option class="level-3" value="17">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;With Bluetooth and Display&nbsp;&nbsp;(3)</option>
	<option class="level-3" value="18">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;With PICAXE-08M2&nbsp;&nbsp;(1)</option>
	<option class="level-2" value="101">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Spinning LED Display&nbsp;&nbsp;(3)</option>
	<option class="level-2" value="14">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Starter Kit&nbsp;&nbsp;(1)</option>
	<option class="level-2" value="90">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Wireless Transmission&nbsp;&nbsp;(3)</option>
	<option class="level-1" value="96" selected="selected">&nbsp;&nbsp;&nbsp;Attitude Determination with Quaternion using Extended Kalman Filter&nbsp;&nbsp;(5)</option>
	<option class="level-1" value="9">&nbsp;&nbsp;&nbsp;C++ Snake&nbsp;&nbsp;(1)</option>
	<option class="level-0" value="99">Real Time Frequency Plot&nbsp;&nbsp;(1)</option>
	<option class="level-0" value="11">WOODCARVING&nbsp;&nbsp;(4)</option>
	<option class="level-1" value="81">&nbsp;&nbsp;&nbsp;Miniature Figures&nbsp;&nbsp;(1)</option>
	<option class="level-1" value="71">&nbsp;&nbsp;&nbsp;Nameplate&nbsp;&nbsp;(2)</option>
	<option class="level-1" value="92">&nbsp;&nbsp;&nbsp;Wooden Frame&nbsp;&nbsp;(1)</option>
</select>
</form>
<script type="text/javascript">
/* <![CDATA[ */
(function() {
	var dropdown = document.getElementById( "cat" );
	function onCatChange() {
		if ( dropdown.options[ dropdown.selectedIndex ].value > 0 ) {
			dropdown.parentNode.submit();
		}
	}
	dropdown.onchange = onCatChange;
})();
/* ]]> */
</script>

			</div><div id="archives-2" class="widget widget_archive"><h3 class="widget-title">Archives</h3>
			<ul>
					<li><a href="https://thepoorengineer.com/en/2019/09/">September 2019</a>&nbsp;(3)</li>
	<li><a href="https://thepoorengineer.com/en/2019/02/">February 2019</a>&nbsp;(1)</li>
	<li><a href="https://thepoorengineer.com/en/2019/01/">January 2019</a>&nbsp;(1)</li>
	<li><a href="https://thepoorengineer.com/en/2018/09/">September 2018</a>&nbsp;(1)</li>
	<li><a href="https://thepoorengineer.com/en/2018/07/">July 2018</a>&nbsp;(4)</li>
	<li><a href="https://thepoorengineer.com/en/2018/03/">March 2018</a>&nbsp;(3)</li>
	<li><a href="https://thepoorengineer.com/en/2018/02/">February 2018</a>&nbsp;(5)</li>
	<li><a href="https://thepoorengineer.com/en/2017/11/">November 2017</a>&nbsp;(6)</li>
	<li><a href="https://thepoorengineer.com/en/2017/07/">July 2017</a>&nbsp;(2)</li>
	<li><a href="https://thepoorengineer.com/en/2017/04/">April 2017</a>&nbsp;(6)</li>
	<li><a href="https://thepoorengineer.com/en/2017/03/">March 2017</a>&nbsp;(4)</li>
	<li><a href="https://thepoorengineer.com/en/2017/02/">February 2017</a>&nbsp;(2)</li>
	<li><a href="https://thepoorengineer.com/en/2017/01/">January 2017</a>&nbsp;(9)</li>
	<li><a href="https://thepoorengineer.com/en/2016/12/">December 2016</a>&nbsp;(24)</li>
	<li><a href="https://thepoorengineer.com/en/2016/11/">November 2016</a>&nbsp;(1)</li>
			</ul>

			</div></aside></div></div></div> 
            
        </main>
</div>



		
	</div><!-- #content -->

<a class="back-to-top"><span class="fa fa-angle-up"></span></a>

<footer id="colophon" class="site-footer" itemscope="itemscope" itemtype="http://schema.org/WPFooter">

               
                   
 
        
             
         <nav id="footer-nav">
            <ul id="footer-menu" class="menu"><li id="menu-item-68" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-68"><a href="https://thepoorengineer.com/en/6-2/about-me/">About</a></li>
<li id="menu-item-169" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-169"><a href="https://thepoorengineer.com/en/6-2/life/">Life</a></li>
<li id="menu-item-176" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-176"><a href="https://thepoorengineer.com/en/6-2/projects/">Projects</a></li>
<li id="menu-item-479" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-479"><a href="https://thepoorengineer.com/en/6-2/woodcarving/">Woodcarving</a></li>
<li id="menu-item-71" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-71"><a href="https://thepoorengineer.com/en/6-2/contact-me/">Contact</a></li>
</ul>        </nav>
               
         <div class="site-info">
          Copyright © 
          2022 ThePoorEngineer.&nbsp;All rights reserved.        </div>
        
	</footer><!-- #colophon -->
    
</div><!-- #page -->

<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 0 0" width="0" height="0" focusable="false" role="none" style="visibility: hidden; position: absolute; left: -9999px; overflow: hidden;"><defs><filter id="wp-duotone-dark-grayscale"><fecolormatrix color-interpolation-filters="sRGB" type="matrix" values=" .299 .587 .114 0 0 .299 .587 .114 0 0 .299 .587 .114 0 0 .299 .587 .114 0 0 "></fecolormatrix><fecomponenttransfer color-interpolation-filters="sRGB"><fefuncr type="table" tableValues="0 0.49803921568627"></fefuncr><fefuncg type="table" tableValues="0 0.49803921568627"></fefuncg><fefuncb type="table" tableValues="0 0.49803921568627"></fefuncb><fefunca type="table" tableValues="1 1"></fefunca></fecomponenttransfer><fecomposite in2="SourceGraphic" operator="in"></fecomposite></filter></defs></svg><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 0 0" width="0" height="0" focusable="false" role="none" style="visibility: hidden; position: absolute; left: -9999px; overflow: hidden;"><defs><filter id="wp-duotone-grayscale"><fecolormatrix color-interpolation-filters="sRGB" type="matrix" values=" .299 .587 .114 0 0 .299 .587 .114 0 0 .299 .587 .114 0 0 .299 .587 .114 0 0 "></fecolormatrix><fecomponenttransfer color-interpolation-filters="sRGB"><fefuncr type="table" tableValues="0 1"></fefuncr><fefuncg type="table" tableValues="0 1"></fefuncg><fefuncb type="table" tableValues="0 1"></fefuncb><fefunca type="table" tableValues="1 1"></fefunca></fecomponenttransfer><fecomposite in2="SourceGraphic" operator="in"></fecomposite></filter></defs></svg><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 0 0" width="0" height="0" focusable="false" role="none" style="visibility: hidden; position: absolute; left: -9999px; overflow: hidden;"><defs><filter id="wp-duotone-purple-yellow"><fecolormatrix color-interpolation-filters="sRGB" type="matrix" values=" .299 .587 .114 0 0 .299 .587 .114 0 0 .299 .587 .114 0 0 .299 .587 .114 0 0 "></fecolormatrix><fecomponenttransfer color-interpolation-filters="sRGB"><fefuncr type="table" tableValues="0.54901960784314 0.98823529411765"></fefuncr><fefuncg type="table" tableValues="0 1"></fefuncg><fefuncb type="table" tableValues="0.71764705882353 0.25490196078431"></fefuncb><fefunca type="table" tableValues="1 1"></fefunca></fecomponenttransfer><fecomposite in2="SourceGraphic" operator="in"></fecomposite></filter></defs></svg><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 0 0" width="0" height="0" focusable="false" role="none" style="visibility: hidden; position: absolute; left: -9999px; overflow: hidden;"><defs><filter id="wp-duotone-blue-red"><fecolormatrix color-interpolation-filters="sRGB" type="matrix" values=" .299 .587 .114 0 0 .299 .587 .114 0 0 .299 .587 .114 0 0 .299 .587 .114 0 0 "></fecolormatrix><fecomponenttransfer color-interpolation-filters="sRGB"><fefuncr type="table" tableValues="0 1"></fefuncr><fefuncg type="table" tableValues="0 0.27843137254902"></fefuncg><fefuncb type="table" tableValues="0.5921568627451 0.27843137254902"></fefuncb><fefunca type="table" tableValues="1 1"></fefunca></fecomponenttransfer><fecomposite in2="SourceGraphic" operator="in"></fecomposite></filter></defs></svg><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 0 0" width="0" height="0" focusable="false" role="none" style="visibility: hidden; position: absolute; left: -9999px; overflow: hidden;"><defs><filter id="wp-duotone-midnight"><fecolormatrix color-interpolation-filters="sRGB" type="matrix" values=" .299 .587 .114 0 0 .299 .587 .114 0 0 .299 .587 .114 0 0 .299 .587 .114 0 0 "></fecolormatrix><fecomponenttransfer color-interpolation-filters="sRGB"><fefuncr type="table" tableValues="0 0"></fefuncr><fefuncg type="table" tableValues="0 0.64705882352941"></fefuncg><fefuncb type="table" tableValues="0 1"></fefuncb><fefunca type="table" tableValues="1 1"></fefunca></fecomponenttransfer><fecomposite in2="SourceGraphic" operator="in"></fecomposite></filter></defs></svg><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 0 0" width="0" height="0" focusable="false" role="none" style="visibility: hidden; position: absolute; left: -9999px; overflow: hidden;"><defs><filter id="wp-duotone-magenta-yellow"><fecolormatrix color-interpolation-filters="sRGB" type="matrix" values=" .299 .587 .114 0 0 .299 .587 .114 0 0 .299 .587 .114 0 0 .299 .587 .114 0 0 "></fecolormatrix><fecomponenttransfer color-interpolation-filters="sRGB"><fefuncr type="table" tableValues="0.78039215686275 1"></fefuncr><fefuncg type="table" tableValues="0 0.94901960784314"></fefuncg><fefuncb type="table" tableValues="0.35294117647059 0.47058823529412"></fefuncb><fefunca type="table" tableValues="1 1"></fefunca></fecomponenttransfer><fecomposite in2="SourceGraphic" operator="in"></fecomposite></filter></defs></svg><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 0 0" width="0" height="0" focusable="false" role="none" style="visibility: hidden; position: absolute; left: -9999px; overflow: hidden;"><defs><filter id="wp-duotone-purple-green"><fecolormatrix color-interpolation-filters="sRGB" type="matrix" values=" .299 .587 .114 0 0 .299 .587 .114 0 0 .299 .587 .114 0 0 .299 .587 .114 0 0 "></fecolormatrix><fecomponenttransfer color-interpolation-filters="sRGB"><fefuncr type="table" tableValues="0.65098039215686 0.40392156862745"></fefuncr><fefuncg type="table" tableValues="0 1"></fefuncg><fefuncb type="table" tableValues="0.44705882352941 0.4"></fefuncb><fefunca type="table" tableValues="1 1"></fefunca></fecomponenttransfer><fecomposite in2="SourceGraphic" operator="in"></fecomposite></filter></defs></svg><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 0 0" width="0" height="0" focusable="false" role="none" style="visibility: hidden; position: absolute; left: -9999px; overflow: hidden;"><defs><filter id="wp-duotone-blue-orange"><fecolormatrix color-interpolation-filters="sRGB" type="matrix" values=" .299 .587 .114 0 0 .299 .587 .114 0 0 .299 .587 .114 0 0 .299 .587 .114 0 0 "></fecolormatrix><fecomponenttransfer color-interpolation-filters="sRGB"><fefuncr type="table" tableValues="0.098039215686275 1"></fefuncr><fefuncg type="table" tableValues="0 0.66274509803922"></fefuncg><fefuncb type="table" tableValues="0.84705882352941 0.41960784313725"></fefuncb><fefunca type="table" tableValues="1 1"></fefunca></fecomponenttransfer><fecomposite in2="SourceGraphic" operator="in"></fecomposite></filter></defs></svg><script type="text/javascript" id="apss-frontend-mainjs-js-extra">
/* <![CDATA[ */
var frontend_ajax_object = {"ajax_url":"https:\/\/thepoorengineer.com\/wp-admin\/admin-ajax.php","ajax_nonce":"662945d5ba"};
/* ]]> */
</script>
<script type="text/javascript" src="./Attitude Determination with Quaternion using Extended Kalman Filter Archives - ThePoorEngineer_files/frontend.js(1).download" id="apss-frontend-mainjs-js"></script>
<script type="text/javascript" src="./Attitude Determination with Quaternion using Extended Kalman Filter Archives - ThePoorEngineer_files/ctct-plugin-recaptcha-v2.min.js.download" id="recaptcha-v2-js"></script>
<script async="async" defer="" type="text/javascript" src="./Attitude Determination with Quaternion using Extended Kalman Filter Archives - ThePoorEngineer_files/api.js.download" id="recaptcha-lib-v2-js"></script>
<script type="text/javascript" src="./Attitude Determination with Quaternion using Extended Kalman Filter Archives - ThePoorEngineer_files/ctct-plugin-frontend.min.js.download" id="ctct_frontend_forms-js"></script>
<script type="text/javascript" src="./Attitude Determination with Quaternion using Extended Kalman Filter Archives - ThePoorEngineer_files/navigation.js.download" id="aberration-navigation-js"></script>
<script type="text/javascript" src="./Attitude Determination with Quaternion using Extended Kalman Filter Archives - ThePoorEngineer_files/functions.js.download" id="aberration-functions-js"></script>
<script type="text/javascript" src="./Attitude Determination with Quaternion using Extended Kalman Filter Archives - ThePoorEngineer_files/skip-link-focus-fix.js.download" id="skip-link-focus-fix-js"></script>
<script type="text/javascript">
(function() {
				var expirationDate = new Date();
				expirationDate.setTime( expirationDate.getTime() + 31536000 * 1000 );
				document.cookie = "pll_language=en; expires=" + expirationDate.toUTCString() + "; path=/; secure; SameSite=Lax";
			}());
</script>




<!--
Performance optimized by W3 Total Cache. Learn more: https://www.boldgrid.com/w3-total-cache/

Object Caching 5/843 objects using disk
Page Caching using disk: enhanced 

Served from: thepoorengineer.com @ 2022-01-27 16:37:07 by W3 Total Cache
--><div id="cbde7b96-0f26-4e7c-9f37-4651dbb641e6-quickmenu"></div><div style="position: absolute; width: 0px; height: 0px; overflow: hidden; padding: 0px; border: 0px; margin: 0px;"><div id="MathJax_Font_Test" style="position: absolute; visibility: hidden; top: 0px; left: 0px; width: auto; padding: 0px; border: 0px; margin: 0px; white-space: nowrap; text-align: left; text-indent: 0px; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal; font-size: 40px; font-weight: normal; font-style: normal; font-family: MathJax_Size2, sans-serif;"></div></div></body></html>